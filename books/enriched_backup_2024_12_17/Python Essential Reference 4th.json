{
  "metadata": {
    "title": "Python Essential Reference 4th",
    "author": "David M. Beazley",
    "publisher": "Addison-Wesley Professional",
    "edition": "4th Edition",
    "isbn": "978-0-672-32862-6",
    "total_pages": 742,
    "conversion_date": "2025-11-05T18:39:16.091178",
    "conversion_method": "PyMuPDF + OCR fallback"
  },
  "chapters": [
    {
      "number": 1,
      "title": "A Tutorial Introduction",
      "start_page": 31,
      "end_page": 45,
      "detection_method": "regex_chapter",
      "chapter_number": 1,
      "summary": "If this is the case, you can continue to follow along with this chapter,\nbut be aware that the print statement turned into a function in Python 3 Key topics include python, function, and functions. Covers function.",
      "keywords": [
        "Python",
        "line",
        "function",
        "list",
        "print line",
        "program",
        "statement",
        "file",
        "Tutorial Introduction",
        "Lib",
        "strings",
        "print statement",
        "Format",
        "string",
        "principal"
      ],
      "concepts": [
        "python",
        "function",
        "functions",
        "functionality",
        "printed",
        "line",
        "listing",
        "values",
        "string",
        "useful"
      ],
      "similar_chapters": [
        {
          "book": "Python Distilled",
          "chapter": 3,
          "title": "Segment 3 (pages 19-26)",
          "relevance_score": 0.58,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 11,
          "title": "Segment 11 (pages 99-114)",
          "relevance_score": 0.57,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 10,
          "title": "Introducing Python Statements",
          "relevance_score": 0.57,
          "method": "api"
        },
        {
          "book": "Python Cookbook 3rd",
          "chapter": 14,
          "title": "Testing, Debugging, and Exceptions",
          "relevance_score": 0.54,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 9,
          "title": "Segment 9 (pages 71-78)",
          "relevance_score": 0.54,
          "method": "api"
        }
      ]
    },
    {
      "number": 2,
      "title": "Objects and Classes",
      "start_page": 46,
      "end_page": 50,
      "detection_method": "regex_chapter",
      "chapter_number": 2,
      "summary": "This chapter covers objects and classes. Key topics include objects, methods, and statements. Note for this to work,\n# a web server must be actively writing data to the log.",
      "keywords": [
        "object",
        "stack",
        "statement",
        "Python",
        "methods",
        "class Stack",
        "module",
        "statement class Stack",
        "file",
        "program",
        "block",
        "statements",
        "exception",
        "import statement"
      ],
      "concepts": [
        "objects",
        "methods",
        "statements",
        "classes",
        "stack",
        "file",
        "imported",
        "line",
        "program",
        "programming"
      ],
      "similar_chapters": [
        {
          "book": "Python Distilled",
          "chapter": 20,
          "title": "Segment 20 (pages 167-175)",
          "relevance_score": 0.62,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 49,
          "title": "Segment 49 (pages 993-1010)",
          "relevance_score": 0.61,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 2,
          "title": "Segment 2 (pages 9-18)",
          "relevance_score": 0.61,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 11,
          "title": "Segment 11 (pages 90-99)",
          "relevance_score": 0.61,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 38,
          "title": "Segment 38 (pages 345-352)",
          "relevance_score": 0.61,
          "method": "api"
        }
      ]
    },
    {
      "number": 3,
      "title": "Lexical Conventions and Syntax",
      "start_page": 51,
      "end_page": 58,
      "detection_method": "regex_chapter",
      "chapter_number": 3,
      "summary": "This chapter covers lexical conventions and syntax. Key topics include character, strings, and code. Running Python with\nthe -t option prints warning messages when tabs and spaces are mixed inconsistently\nwithin the same program block.The -tt option turns these warning messages into\nTabError exceptions.",
      "keywords": [
        "string",
        "Python",
        "String Literals",
        "character",
        "Unicode",
        "object",
        "Unicode characters",
        "strings",
        "Literals",
        "Unicode string literal",
        "code",
        "escape",
        "Unicode string",
        "escape codes",
        "Lib"
      ],
      "concepts": [
        "character",
        "strings",
        "code",
        "coding",
        "objects",
        "literals",
        "line",
        "integers",
        "identifiers",
        "identify"
      ],
      "similar_chapters": [
        {
          "book": "Learning Python Ed6",
          "chapter": 10,
          "title": "Introducing Python Statements",
          "relevance_score": 0.64,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 4,
          "title": "Segment 4 (pages 27-34)",
          "relevance_score": 0.57,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 29,
          "title": "Segment 29 (pages 258-268)",
          "relevance_score": 0.56,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 6,
          "title": "Segment 6 (pages 43-50)",
          "relevance_score": 0.54,
          "method": "api"
        },
        {
          "book": "The Little Book Of Python-Anti-Patterns",
          "chapter": 6,
          "title": "Segment 6 (pages 43-52)",
          "relevance_score": 0.54,
          "method": "api"
        }
      ]
    },
    {
      "number": 4,
      "title": "Types and Objects",
      "start_page": 59,
      "end_page": 79,
      "detection_method": "regex_chapter",
      "chapter_number": 4,
      "summary": "This chapter covers types and objects. Key topics include types, method, and objects. Covers method, function. Here’s an example:\nif type(s) is list:\ns.append(item)\nif type(d) is dict:\nd.update(t)\nBecause types can be specialized by defining classes, a better way to check types is to\nuse the built-in isinstance(object, type) function.",
      "keywords": [
        "object",
        "Types",
        "method",
        "Built-in Types",
        "Python",
        "Built-in Python Types",
        "function",
        "returns",
        "string",
        "string object types",
        "Python object",
        "items",
        "list",
        "built-in",
        "Lib"
      ],
      "concepts": [
        "types",
        "method",
        "objects",
        "function",
        "functions",
        "functional",
        "strings",
        "item",
        "returned",
        "operator"
      ],
      "similar_chapters": [
        {
          "book": "Learning Python Ed6",
          "chapter": 4,
          "title": "Introducing Python Object Types",
          "relevance_score": 0.78,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 29,
          "title": "Segment 29 (pages 576-595)",
          "relevance_score": 0.71,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 20,
          "title": "Segment 20 (pages 392-414)",
          "relevance_score": 0.68,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 5,
          "title": "Numeric Types",
          "relevance_score": 0.64,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 8,
          "title": "Lists and Dictionaries",
          "relevance_score": 0.64,
          "method": "api"
        }
      ]
    },
    {
      "number": 5,
      "title": "Table 3.11",
      "start_page": 80,
      "end_page": 90,
      "detection_method": "regex_chapter",
      "chapter_number": 5,
      "summary": "This chapter covers table 3.11. Key topics include object, method, and operators. Covers method. The _ _del_ _() method is invoked when an object is about to be destroyed.This\nmethod is invoked only when an object is no longer in use.",
      "keywords": [
        "method",
        "self,other",
        "Object",
        "Special Methods",
        "Python",
        "Object Behavior",
        "Attribute",
        "Special",
        "Lib",
        "slice",
        "Behavior",
        "returns",
        "format",
        "Special Methods attributes",
        "descriptor object"
      ],
      "concepts": [
        "object",
        "method",
        "operators",
        "operations",
        "operation",
        "types",
        "values",
        "slicing",
        "slices",
        "function"
      ],
      "similar_chapters": [
        {
          "book": "Fluent Python 2nd",
          "chapter": 13,
          "title": "Segment 13 (pages 250-271)",
          "relevance_score": 0.74,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 25,
          "title": "Segment 25 (pages 219-229)",
          "relevance_score": 0.74,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 13,
          "title": "Segment 13 (pages 108-115)",
          "relevance_score": 0.65,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 18,
          "title": "Segment 18 (pages 175-187)",
          "relevance_score": 0.63,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 24,
          "title": "Segment 24 (pages 208-218)",
          "relevance_score": 0.61,
          "method": "api"
        }
      ]
    },
    {
      "number": 6,
      "title": "Operators and Expressions",
      "start_page": 91,
      "end_page": 106,
      "detection_method": "regex_chapter",
      "chapter_number": 6,
      "summary": "This chapter covers operators and expressions. Key topics include operators, operation, and operations. The round() function rounds a floating-point number, x, to the nearest multiple of 10\nto the power minus n.",
      "keywords": [
        "format",
        "string",
        "sequence",
        "operator",
        "String Formatting",
        "object",
        "Function",
        "Expressions",
        "number",
        "Lib",
        "strings",
        "integer",
        "character",
        "Advanced String Formatting",
        "format specifier"
      ],
      "concepts": [
        "operators",
        "operation",
        "operations",
        "strings",
        "string",
        "value",
        "formatting",
        "format",
        "functions",
        "function"
      ],
      "similar_chapters": [
        {
          "book": "Python Distilled",
          "chapter": 8,
          "title": "Segment 8 (pages 62-70)",
          "relevance_score": 0.57,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 9,
          "title": "Segment 9 (pages 71-78)",
          "relevance_score": 0.55,
          "method": "api"
        },
        {
          "book": "Computer Systems A Programmer’s Perspective",
          "chapter": 8,
          "title": "Segment 8 (pages 140-157)",
          "relevance_score": 0.53,
          "method": "api"
        },
        {
          "book": "Computer Systems A Programmer’s Perspective",
          "chapter": 9,
          "title": "Segment 9 (pages 158-179)",
          "relevance_score": 0.53,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 35,
          "title": "Segment 35 (pages 700-717)",
          "relevance_score": 0.53,
          "method": "api"
        }
      ]
    },
    {
      "number": 7,
      "title": "Program Structure and Control Flow",
      "start_page": 107,
      "end_page": 168,
      "detection_method": "regex_chapter",
      "chapter_number": 7,
      "summary": "This chapter covers program structure and control flow. Key topics include function, functions, and functional. Covers function, exception. In the statement for i in s, the variable i is known as the iteration variable.",
      "keywords": [
        "function",
        "class Foo",
        "Python",
        "object",
        "foo",
        "Lib",
        "Base class",
        "Functions",
        "exception",
        "statement",
        "classes",
        "base classes",
        "class object",
        "method",
        "attribute"
      ],
      "concepts": [
        "function",
        "functions",
        "functional",
        "object",
        "statement",
        "statements",
        "method",
        "python",
        "types",
        "typing"
      ],
      "similar_chapters": [
        {
          "book": "Effective-Python",
          "chapter": 11,
          "title": "Segment 11 (pages 99-114)",
          "relevance_score": 0.7,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 14,
          "title": "Segment 14 (pages 116-123)",
          "relevance_score": 0.68,
          "method": "api"
        },
        {
          "book": "The Little Book Of Python-Anti-Patterns",
          "chapter": 1,
          "title": "Segment 1 (pages 1-8)",
          "relevance_score": 0.66,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 11,
          "title": "Segment 11 (pages 90-99)",
          "relevance_score": 0.65,
          "method": "api"
        },
        {
          "book": "makinggames",
          "chapter": 8,
          "title": "Segment 8 (pages 60-68)",
          "relevance_score": 0.65,
          "method": "api"
        }
      ]
    },
    {
      "number": 8,
      "title": "Modules, Packages, and Distribution",
      "start_page": 169,
      "end_page": 182,
      "detection_method": "regex_chapter",
      "chapter_number": 8,
      "summary": "Underneath the covers, a module object is a layer over a dic-\ntionary that is used to hold the contents of the module namespace.This dictionary is\navailable as the __dict__ of a module, and whenever you look up or change a value in\na module, you’re working with this dictionary Key topics include modules, important, and imported.",
      "keywords": [
        "module",
        "Python",
        "file",
        "package",
        "spam import",
        "import statement",
        "python setup.py",
        "Python modules",
        "directory",
        "module import",
        "spam import foo",
        "statement",
        "Spam",
        "code",
        "Lib"
      ],
      "concepts": [
        "modules",
        "important",
        "imported",
        "python",
        "packages",
        "packaging",
        "file",
        "spam",
        "code",
        "installing"
      ],
      "similar_chapters": [
        {
          "book": "Python Cookbook 3rd",
          "chapter": 10,
          "title": "Modules and Packages",
          "relevance_score": 0.67,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 28,
          "title": "Segment 28 (pages 247-257)",
          "relevance_score": 0.65,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 27,
          "title": "Segment 27 (pages 238-246)",
          "relevance_score": 0.64,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 40,
          "title": "Segment 40 (pages 420-428)",
          "relevance_score": 0.6,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 9,
          "title": "Tuples, Files, and Everything Else",
          "relevance_score": 0.58,
          "method": "api"
        }
      ]
    },
    {
      "number": 9,
      "title": "Input and Output",
      "start_page": 183,
      "end_page": 198,
      "detection_method": "regex_chapter",
      "chapter_number": 9,
      "summary": "For example, the argument to the -o or --output argument is placed in\nopts.outfile, whereas args is a list of the remaining arguments such as\n['infile1', ..., 'infileN'].The optparse module automatically provides a -h\nor --help option that lists the available options if requested by the user Key topics include encodings, encode, and files.",
      "keywords": [
        "File",
        "Unicode",
        "encoding",
        "python",
        "Unicode strings",
        "Unicode character",
        "Python Unicode string",
        "Output",
        "file object",
        "character",
        "string",
        "strings",
        "Unicode files",
        "Input",
        "Unicode String Handling"
      ],
      "concepts": [
        "encodings",
        "encode",
        "files",
        "characters",
        "string",
        "python",
        "method",
        "value",
        "output",
        "data"
      ],
      "similar_chapters": [
        {
          "book": "Learning Python Ed6",
          "chapter": 6,
          "title": "The Dynamic Typing Interlude",
          "relevance_score": 0.52,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 8,
          "title": "Segment 8 (pages 147-169)",
          "relevance_score": 0.47,
          "method": "api"
        },
        {
          "book": "Python Cookbook 3rd",
          "chapter": 4,
          "title": "Iterators and Generators",
          "relevance_score": 0.46,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 9,
          "title": "Tuples, Files, and Everything Else",
          "relevance_score": 0.45,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 7,
          "title": "String Fundamentals",
          "relevance_score": 0.44,
          "method": "api"
        }
      ]
    },
    {
      "number": 10,
      "title": "Execution Environment",
      "start_page": 199,
      "end_page": 206,
      "detection_method": "regex_chapter",
      "chapter_number": 10,
      "summary": "This chapter covers execution environment. Key topics include python, option, and optional. -x\nignores the first line of a program in the event that it’s not a valid Python statement (for\nexample, when the first line starts the Python interpreter in a script).",
      "keywords": [
        "Python",
        "program",
        "interpreter",
        "module",
        "Lib",
        "file",
        "site",
        "directory",
        "Environment",
        "Python interpreter",
        "Python installation",
        "interactive",
        "option",
        "site module",
        "Environment Variables"
      ],
      "concepts": [
        "python",
        "option",
        "optional",
        "module",
        "files",
        "interpreter",
        "important",
        "imports",
        "program",
        "programming"
      ],
      "similar_chapters": [
        {
          "book": "Learning Python Ed6",
          "chapter": 2,
          "title": "How Python Runs Programs",
          "relevance_score": 0.63,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 29,
          "title": "Segment 29 (pages 258-268)",
          "relevance_score": 0.62,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 39,
          "title": "Segment 39 (pages 411-419)",
          "relevance_score": 0.6,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 40,
          "title": "Segment 40 (pages 420-428)",
          "relevance_score": 0.6,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 3,
          "title": "How You Run Programs",
          "relevance_score": 0.57,
          "method": "api"
        }
      ]
    },
    {
      "number": 11,
      "title": "Testing, Debugging, Profiling, and Tuning",
      "start_page": 207,
      "end_page": 226,
      "detection_method": "regex_chapter",
      "chapter_number": 11,
      "summary": "This chapter covers testing, debugging, profiling, and tuning. Key topics include function, functions, and functionality. Covers function. For example, a programmer\nmight modify a function but forget to update the documentation.",
      "keywords": [
        "function",
        "module",
        "Python",
        "program",
        "Debugger",
        "Lib",
        "code",
        "functions",
        "run",
        "pdb Module",
        "line",
        "test failure",
        "pdb",
        "timeit",
        "FAST"
      ],
      "concepts": [
        "function",
        "functions",
        "functionality",
        "python",
        "useful",
        "uses",
        "module",
        "runs",
        "run",
        "running"
      ],
      "similar_chapters": [
        {
          "book": "Python Cookbook 3rd",
          "chapter": 14,
          "title": "Testing, Debugging, and Exceptions",
          "relevance_score": 0.72,
          "method": "api"
        },
        {
          "book": "Python Architecture Patterns",
          "chapter": 14,
          "title": "[ 465 ]",
          "relevance_score": 0.65,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 44,
          "title": "Segment 44 (pages 462-467)",
          "relevance_score": 0.64,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 14,
          "title": "Segment 14 (pages 116-123)",
          "relevance_score": 0.64,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 38,
          "title": "Segment 38 (pages 403-410)",
          "relevance_score": 0.63,
          "method": "api"
        }
      ]
    },
    {
      "number": 12,
      "title": "Built-In Functions and Exceptions",
      "start_page": 227,
      "end_page": 244,
      "detection_method": "regex_chapter",
      "chapter_number": 12,
      "summary": "However, a\nbytearray also provides all of the operations normally associated with strings (that is,\nslicing, find(), split(), replace(), and so on).When using these string operations,\nyou should be careful to preface all string literals with b in order to indicate that you’re\nworking with bytes Key topics include object, values, and exceptions. Covers function, exception.",
      "keywords": [
        "Python",
        "object",
        "function",
        "string",
        "Built-In Functions",
        "type",
        "returns",
        "exception",
        "Exceptions",
        "Functions",
        "integer",
        "Lib",
        "argument",
        "Type representing",
        "list"
      ],
      "concepts": [
        "object",
        "values",
        "exceptions",
        "exception",
        "python",
        "type",
        "returns",
        "functions",
        "function",
        "functionality"
      ],
      "similar_chapters": [
        {
          "book": "Learning Python Ed6",
          "chapter": 4,
          "title": "Introducing Python Object Types",
          "relevance_score": 0.51,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 7,
          "title": "String Fundamentals",
          "relevance_score": 0.48,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 6,
          "title": "The Dynamic Typing Interlude",
          "relevance_score": 0.46,
          "method": "api"
        },
        {
          "book": "Python Data Analysis 3rd",
          "chapter": 3,
          "title": "Built-In Data Structures,",
          "relevance_score": 0.46,
          "method": "api"
        },
        {
          "book": "Python Cookbook 3rd",
          "chapter": 14,
          "title": "Testing, Debugging, and Exceptions",
          "relevance_score": 0.44,
          "method": "api"
        }
      ]
    },
    {
      "number": 13,
      "title": "Python Runtime Services",
      "start_page": 245,
      "end_page": 268,
      "detection_method": "regex_chapter",
      "chapter_number": 13,
      "summary": "gc\nThe gc module provides an interface for controlling the garbage collector used to col-\nlect cycles in objects such as lists, tuples, dictionaries, and instances.As various types of\ncontainer objects are created, they’re placed on a list that’s internal to the interpreter Key topics include objects, module, and functions. Covers function.",
      "keywords": [
        "object",
        "Python Runtime Services",
        "Python",
        "Returns True",
        "returns",
        "Python Runtime",
        "module",
        "Python objects",
        "function",
        "type",
        "frame",
        "file",
        "list",
        "Runtime Services",
        "Lib"
      ],
      "concepts": [
        "objects",
        "module",
        "functions",
        "function",
        "returns",
        "types",
        "flags",
        "value",
        "files",
        "python"
      ],
      "similar_chapters": [
        {
          "book": "Python Microservices Development",
          "chapter": 22,
          "title": "Segment 22 (pages 175-182)",
          "relevance_score": 0.56,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 20,
          "title": "Segment 20 (pages 198-208)",
          "relevance_score": 0.55,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 13,
          "title": "Segment 13 (pages 250-271)",
          "relevance_score": 0.55,
          "method": "api"
        },
        {
          "book": "Python Data Analysis 3rd",
          "chapter": 3,
          "title": "Built-In Data Structures,",
          "relevance_score": 0.52,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 34,
          "title": "Segment 34 (pages 677-699)",
          "relevance_score": 0.51,
          "method": "api"
        }
      ]
    },
    {
      "number": 14,
      "title": "Mathematics",
      "start_page": 269,
      "end_page": 282,
      "detection_method": "regex_chapter",
      "chapter_number": 14,
      "summary": "This chapter covers mathematics. Key topics include decimal, contexts, and random. For the most part, you manipulate Decimal objects using the standard\nPython math operators.",
      "keywords": [
        "Decimal",
        "context",
        "returns",
        "Rounds",
        "decimal context",
        "random number",
        "number",
        "random",
        "Decimal numbers",
        "random number generator",
        "Fraction",
        "current decimal context",
        "Lib",
        "Decimal Objects",
        "Functions"
      ],
      "concepts": [
        "decimal",
        "contexts",
        "random",
        "randomize",
        "numbers",
        "classes",
        "values",
        "rounding",
        "returning",
        "function"
      ],
      "similar_chapters": [
        {
          "book": "Learning Python Ed6",
          "chapter": 4,
          "title": "Introducing Python Object Types",
          "relevance_score": 0.55,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 32,
          "title": "Segment 32 (pages 336-344)",
          "relevance_score": 0.51,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 19,
          "title": "Segment 19 (pages 372-391)",
          "relevance_score": 0.5,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 5,
          "title": "Numeric Types",
          "relevance_score": 0.5,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 11,
          "title": "Segment 11 (pages 99-114)",
          "relevance_score": 0.49,
          "method": "api"
        }
      ]
    },
    {
      "number": 15,
      "title": "Data Structures, Algorithms, and Code Simplification",
      "start_page": 283,
      "end_page": 302,
      "detection_method": "regex_chapter",
      "chapter_number": 15,
      "summary": "This chapter covers data structures, algorithms, and code simplification. Key topics include item, function, and functions. Covers function. The module defines the following type:\narray(typecode [, initializer])\nCreates an array of type typecode.",
      "keywords": [
        "items",
        "function",
        "Returns",
        "iterable",
        "list",
        "array",
        "base class",
        "Data Structures",
        "Lib",
        "Creates",
        "Code Simplification",
        "tuple",
        "object",
        "Data",
        "Code"
      ],
      "concepts": [
        "item",
        "function",
        "functions",
        "functionality",
        "iteration",
        "iterate",
        "iterations",
        "list",
        "values",
        "returned"
      ],
      "similar_chapters": [
        {
          "book": "Python Cookbook 3rd",
          "chapter": 1,
          "title": "Data Structures and Algorithms",
          "relevance_score": 0.63,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 43,
          "title": "Segment 43 (pages 452-461)",
          "relevance_score": 0.59,
          "method": "api"
        },
        {
          "book": "C++ Templates_ The Complete Guide",
          "chapter": 2,
          "title": "Segment 2 (pages 36-70)",
          "relevance_score": 0.57,
          "method": "api"
        },
        {
          "book": "Python Data Analysis 3rd",
          "chapter": 3,
          "title": "Built-In Data Structures,",
          "relevance_score": 0.57,
          "method": "api"
        },
        {
          "book": "C++ Templates_ The Complete Guide",
          "chapter": 76,
          "title": "Segment 76 (pages 2442-2473)",
          "relevance_score": 0.56,
          "method": "api"
        }
      ]
    },
    {
      "number": 16,
      "title": "String and Text Handling",
      "start_page": 303,
      "end_page": 322,
      "detection_method": "regex_chapter",
      "chapter_number": 16,
      "summary": "I/O-Related Functions\nThe codecs module provides a collection of high-level functions that are used to sim-\nplify I/O involving encoded text Key topics include string, strings, and characters.",
      "keywords": [
        "String",
        "format string",
        "character",
        "strings",
        "format",
        "Returns",
        "Text",
        "Matches",
        "Unicode character",
        "Text Handling",
        "Lib",
        "group",
        "Python",
        "pattern",
        "Unicode"
      ],
      "concepts": [
        "string",
        "strings",
        "characters",
        "matches",
        "matched",
        "format",
        "formatting",
        "returns",
        "value",
        "encoded"
      ],
      "similar_chapters": [
        {
          "book": "Python Cookbook 3rd",
          "chapter": 6,
          "title": "Data Encoding and Processing",
          "relevance_score": 0.59,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 6,
          "title": "The Dynamic Typing Interlude",
          "relevance_score": 0.58,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 8,
          "title": "Segment 8 (pages 147-169)",
          "relevance_score": 0.56,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 6,
          "title": "Segment 6 (pages 43-50)",
          "relevance_score": 0.53,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 7,
          "title": "String Fundamentals",
          "relevance_score": 0.5,
          "method": "api"
        }
      ]
    },
    {
      "number": 17,
      "title": "Python Database Access",
      "start_page": 323,
      "end_page": 338,
      "detection_method": "regex_chapter",
      "chapter_number": 17,
      "summary": "This chapter covers python database access. Key topics include database, modules. If the database supports transactions,\nthis must be called for any changes to take effect.",
      "keywords": [
        "Database",
        "Python Database Access",
        "SQLite",
        "database modules",
        "module",
        "Python Database",
        "SQL",
        "Database API",
        "Database Access",
        "object",
        "Python",
        "function",
        "database file",
        "data",
        "result"
      ],
      "concepts": [
        "database",
        "cur",
        "modules",
        "tables",
        "data",
        "values",
        "types",
        "file",
        "python",
        "function"
      ],
      "similar_chapters": [
        {
          "book": "Building LLM Powered Applications",
          "chapter": 34,
          "title": "Segment 34 (pages 283-291)",
          "relevance_score": 0.64,
          "method": "api"
        },
        {
          "book": "Release It! Design and Deploy Production-Ready Software",
          "chapter": 44,
          "title": "Segment 44 (pages 362-366)",
          "relevance_score": 0.59,
          "method": "api"
        },
        {
          "book": "Python Data Analysis 3rd",
          "chapter": 3,
          "title": "Built-In Data Structures,",
          "relevance_score": 0.58,
          "method": "api"
        },
        {
          "book": "Python Architecture Patterns",
          "chapter": 4,
          "title": "[ 113 ]",
          "relevance_score": 0.55,
          "method": "api"
        },
        {
          "book": "Python Data Analysis 3rd",
          "chapter": 1,
          "title": "Preliminaries",
          "relevance_score": 0.54,
          "method": "api"
        }
      ]
    },
    {
      "number": 18,
      "title": "File and Directory Handling",
      "start_page": 339,
      "end_page": 356,
      "detection_method": "regex_chapter",
      "chapter_number": 18,
      "summary": "filecmp\nThe filecmp module provides the following functions, which can be used to compare\nfiles and directories:\ncmp(file1, file2 [, shallow])\nCompares the files file1 and file2 and returns True if they’re equal, False if not Key topics include file, returns, and compressed.",
      "keywords": [
        "File",
        "file object",
        "open file object",
        "archive",
        "returns True",
        "zip file",
        "returns",
        "Directory",
        "archive member",
        "object",
        "data",
        "filename",
        "Directory Handling",
        "temporary file",
        "string"
      ],
      "concepts": [
        "file",
        "returns",
        "compressed",
        "compress",
        "compresses",
        "filenames",
        "data",
        "directory",
        "directories",
        "object"
      ],
      "similar_chapters": [
        {
          "book": "A Philosophy of Software Design",
          "chapter": 5,
          "title": "Segment 5 (pages 36-43)",
          "relevance_score": 0.39,
          "method": "api"
        },
        {
          "book": "operating_systems_three_easy_pieces",
          "chapter": 48,
          "title": "Segment 48 (pages 486-493)",
          "relevance_score": 0.39,
          "method": "api"
        },
        {
          "book": "operating_systems_three_easy_pieces",
          "chapter": 49,
          "title": "Segment 49 (pages 494-511)",
          "relevance_score": 0.39,
          "method": "api"
        },
        {
          "book": "operating_systems_three_easy_pieces",
          "chapter": 50,
          "title": "Segment 50 (pages 512-520)",
          "relevance_score": 0.39,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 6,
          "title": "The Dynamic Typing Interlude",
          "relevance_score": 0.38,
          "method": "api"
        }
      ]
    },
    {
      "number": 19,
      "title": "Operating System Services",
      "start_page": 357,
      "end_page": 438,
      "detection_method": "regex_chapter",
      "chapter_number": 19,
      "summary": "This chapter covers operating system services. Key topics include files, returned, and unix. Notes\nn This module is only available in Python 2.",
      "keywords": [
        "Operating System Services",
        "file",
        "Operating System",
        "System Services",
        "UNIX",
        "Returns",
        "Returns True",
        "object",
        "time",
        "System",
        "Lib",
        "file object",
        "file descriptor",
        "path",
        "log messages"
      ],
      "concepts": [
        "files",
        "returned",
        "unix",
        "path",
        "logging",
        "log",
        "logs",
        "times",
        "timed",
        "value"
      ],
      "similar_chapters": [
        {
          "book": "Python Microservices Development",
          "chapter": 3,
          "title": "Segment 3 (pages 17-24)",
          "relevance_score": 0.54,
          "method": "api"
        },
        {
          "book": "Python Microservices Development",
          "chapter": 12,
          "title": "Segment 12 (pages 90-98)",
          "relevance_score": 0.54,
          "method": "api"
        },
        {
          "book": "Python Microservices Development",
          "chapter": 22,
          "title": "Segment 22 (pages 175-182)",
          "relevance_score": 0.53,
          "method": "api"
        },
        {
          "book": "operating_systems_three_easy_pieces",
          "chapter": 49,
          "title": "Segment 49 (pages 494-511)",
          "relevance_score": 0.53,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 30,
          "title": "Segment 30 (pages 269-279)",
          "relevance_score": 0.52,
          "method": "api"
        }
      ]
    },
    {
      "number": 20,
      "title": "Threads and Concurrency",
      "start_page": 439,
      "end_page": 476,
      "detection_method": "regex_chapter",
      "chapter_number": 20,
      "summary": "If you’re\nscratching your head saying,“I don’t get it,” then it might be wise to do a bit more\nreading before diving into the rest of this chapter Key topics include threads, processes, and process. Covers method.",
      "keywords": [
        "thread",
        "process",
        "lock",
        "queue",
        "Returns True",
        "Lib",
        "item",
        "Returns",
        "method",
        "object",
        "server",
        "shared",
        "Process item print",
        "Python"
      ],
      "concepts": [
        "threads",
        "processes",
        "process",
        "processing",
        "object",
        "locks",
        "returns",
        "programs",
        "programming"
      ],
      "similar_chapters": [
        {
          "book": "Effective-Python",
          "chapter": 25,
          "title": "Segment 25 (pages 249-264)",
          "relevance_score": 0.65,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 37,
          "title": "Segment 37 (pages 738-758)",
          "relevance_score": 0.65,
          "method": "api"
        },
        {
          "book": "Game Programming Gems 8",
          "chapter": 36,
          "title": "Segment 36 (pages 333-342)",
          "relevance_score": 0.61,
          "method": "api"
        },
        {
          "book": "C++ Concurrency in Action",
          "chapter": 5,
          "title": "Segment 5 (pages 37-49)",
          "relevance_score": 0.6,
          "method": "api"
        },
        {
          "book": "C++ Concurrency in Action",
          "chapter": 16,
          "title": "Segment 16 (pages 141-154)",
          "relevance_score": 0.6,
          "method": "api"
        }
      ]
    },
    {
      "number": 21,
      "title": "Network Programming and Sockets",
      "start_page": 477,
      "end_page": 522,
      "detection_method": "regex_chapter",
      "chapter_number": 21,
      "summary": "452\nChapter 21 Network Programming and Sockets\nAn example of establishing a UDP connection appears in the socket module section\nlater in this chapter Key topics include sockets, server.",
      "keywords": [
        "socket",
        "address",
        "Network Programming",
        "data",
        "server",
        "socket object",
        "Lib",
        "Network",
        "string",
        "TCP",
        "task",
        "IPPROTO",
        "protocol",
        "sock",
        "socket type"
      ],
      "concepts": [
        "sockets",
        "ipv",
        "server",
        "data",
        "protocols",
        "address",
        "addressing",
        "addresses",
        "returns",
        "connection"
      ],
      "similar_chapters": [
        {
          "book": "Game Programming Gems 3",
          "chapter": 57,
          "title": "Segment 57 (pages 541-549)",
          "relevance_score": 0.58,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 33,
          "title": "Segment 33 (pages 299-307)",
          "relevance_score": 0.56,
          "method": "api"
        },
        {
          "book": "Release It! Design and Deploy Production-Ready Software",
          "chapter": 7,
          "title": "Segment 7 (pages 51-58)",
          "relevance_score": 0.56,
          "method": "api"
        },
        {
          "book": "Game Programming Gems 7",
          "chapter": 54,
          "title": "Segment 54 (pages 522-529)",
          "relevance_score": 0.53,
          "method": "api"
        },
        {
          "book": "Computer Systems A Programmer’s Perspective",
          "chapter": 48,
          "title": "Segment 48 (pages 961-980)",
          "relevance_score": 0.51,
          "method": "api"
        }
      ]
    },
    {
      "number": 22,
      "title": "Internet Application Programming",
      "start_page": 523,
      "end_page": 556,
      "detection_method": "regex_chapter",
      "chapter_number": 22,
      "summary": "This chapter covers internet application programming. Key topics include server, requests. If the last argument\ncallback is a function, it is used as a callback function to process the returned directo-\nry listing data.This callback function works in the same way as the callback used by the\nretrlines() method.",
      "keywords": [
        "Internet Application Programming",
        "server",
        "HTTP server",
        "HTTP POST request",
        "Python",
        "url",
        "request",
        "HTTP headers",
        "HTTP request",
        "http Package",
        "string",
        "data",
        "Internet Application",
        "Application Programming",
        "HTTP cookies"
      ],
      "concepts": [
        "server",
        "requests",
        "url",
        "urls",
        "data",
        "headers",
        "string",
        "strings",
        "returned",
        "value"
      ],
      "similar_chapters": [
        {
          "book": "Python Microservices Development",
          "chapter": 38,
          "title": "Segment 38 (pages 321-334)",
          "relevance_score": 0.56,
          "method": "api"
        },
        {
          "book": "A Philosophy of Software Design",
          "chapter": 10,
          "title": "Segment 10 (pages 77-87)",
          "relevance_score": 0.55,
          "method": "api"
        },
        {
          "book": "Python Microservices Development",
          "chapter": 6,
          "title": "Segment 6 (pages 41-48)",
          "relevance_score": 0.55,
          "method": "api"
        },
        {
          "book": "Python Microservices Development",
          "chapter": 3,
          "title": "Segment 3 (pages 17-24)",
          "relevance_score": 0.54,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 18,
          "title": "Segment 18 (pages 175-187)",
          "relevance_score": 0.53,
          "method": "api"
        }
      ]
    },
    {
      "number": 23,
      "title": "Web Programming",
      "start_page": 557,
      "end_page": 572,
      "detection_method": "regex_chapter",
      "chapter_number": 23,
      "summary": "This chapter covers web programming. Key topics include data, form, and function. </p>\n</body>\n</html>\nIn this example, the JavaScript function ShowPopup() initiates a request to a Python\nscript popupdata.py on the server.The result of this script is just a fragment of\nHTML, which is then displayed in a popup window.",
      "keywords": [
        "cgi",
        "WSGI",
        "string",
        "data",
        "server",
        "CGI scripts",
        "html",
        "WSGI application",
        "base",
        "Web Programming",
        "form",
        "Python",
        "byte string",
        "Web",
        "CGI program"
      ],
      "concepts": [
        "data",
        "form",
        "function",
        "functions",
        "environ",
        "string",
        "strings",
        "programming",
        "programs",
        "value"
      ],
      "similar_chapters": [
        {
          "book": "Python Microservices Development",
          "chapter": 6,
          "title": "Segment 6 (pages 41-48)",
          "relevance_score": 0.49,
          "method": "api"
        },
        {
          "book": "Python Microservices Development",
          "chapter": 5,
          "title": "Segment 5 (pages 33-40)",
          "relevance_score": 0.47,
          "method": "api"
        },
        {
          "book": "Python Microservices Development",
          "chapter": 38,
          "title": "Segment 38 (pages 321-334)",
          "relevance_score": 0.46,
          "method": "api"
        },
        {
          "book": "Building LLM Powered Applications",
          "chapter": 41,
          "title": "Segment 41 (pages 342-350)",
          "relevance_score": 0.43,
          "method": "api"
        },
        {
          "book": "Python Microservices Development",
          "chapter": 8,
          "title": "Segment 8 (pages 57-64)",
          "relevance_score": 0.43,
          "method": "api"
        }
      ]
    },
    {
      "number": 24,
      "title": "Internet Data Handling and Encoding",
      "start_page": 573,
      "end_page": 610,
      "detection_method": "regex_chapter",
      "chapter_number": 24,
      "summary": "This chapter covers internet data handling and encoding. Key topics include data, encoding, and encode. b2a_hex(data)\nConverts a string of binary data to a hexadecimal encoding.This function is also called\nas hexlify(data).",
      "keywords": [
        "Internet Data Handling",
        "Data",
        "XML",
        "message",
        "string",
        "XML data",
        "Internet Data",
        "Data Handling",
        "element",
        "Returns",
        "object",
        "XML element",
        "xml Package",
        "text",
        "default"
      ],
      "concepts": [
        "data",
        "encoding",
        "encode",
        "xml",
        "element",
        "elements",
        "returns",
        "text",
        "messages",
        "string"
      ],
      "similar_chapters": [
        {
          "book": "Designing Data-Intensive Applications",
          "chapter": 15,
          "title": "Segment 15 (pages 135-143)",
          "relevance_score": 0.58,
          "method": "api"
        },
        {
          "book": "Python Cookbook 3rd",
          "chapter": 6,
          "title": "Data Encoding and Processing",
          "relevance_score": 0.57,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 8,
          "title": "Segment 8 (pages 147-169)",
          "relevance_score": 0.56,
          "method": "api"
        },
        {
          "book": "Designing Data-Intensive Applications",
          "chapter": 18,
          "title": "Segment 18 (pages 161-168)",
          "relevance_score": 0.52,
          "method": "api"
        },
        {
          "book": "Computer Systems A Programmer’s Perspective",
          "chapter": 5,
          "title": "Segment 5 (pages 79-99)",
          "relevance_score": 0.5,
          "method": "api"
        }
      ]
    },
    {
      "number": 25,
      "title": "Miscellaneous Library Modules",
      "start_page": 611,
      "end_page": 616,
      "detection_method": "regex_chapter",
      "chapter_number": 25,
      "summary": "This chapter covers miscellaneous library modules. Key topics include files, modules, and python.",
      "keywords": [
        "Python",
        "Modules",
        "Lib",
        "Description",
        "Access",
        "extension",
        "Library",
        "interface",
        "extension modules",
        "Python source",
        "file",
        "Miscellaneous Library Modules",
        "Data",
        "modules provide",
        "Embedding"
      ],
      "concepts": [
        "files",
        "modules",
        "python",
        "function",
        "functionality",
        "functions",
        "protocols",
        "accesses",
        "access",
        "accessed"
      ],
      "similar_chapters": [
        {
          "book": "Python Cookbook 3rd",
          "chapter": 10,
          "title": "Modules and Packages",
          "relevance_score": 0.74,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 40,
          "title": "Segment 40 (pages 420-428)",
          "relevance_score": 0.71,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 2,
          "title": "Segment 2 (pages 9-18)",
          "relevance_score": 0.71,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 28,
          "title": "Segment 28 (pages 247-257)",
          "relevance_score": 0.69,
          "method": "api"
        },
        {
          "book": "Learning Python Ed6",
          "chapter": 9,
          "title": "Tuples, Files, and Everything Else",
          "relevance_score": 0.64,
          "method": "api"
        }
      ]
    },
    {
      "number": 26,
      "title": "Extending and Embedding Python",
      "start_page": 617,
      "end_page": 742,
      "detection_method": "regex_chapter",
      "chapter_number": 26,
      "summary": "This chapter covers extending and embedding python. Key topics include modules, functionality, and function. Covers function, method. 5.00\nAn Extension Module Prototype\nExtension modules are built by writing a separate C source file that contains a set of\nwrapper functions which provide the glue between the Python interpreter and the\nunderlying C code.",
      "keywords": [
        "Module",
        "Python",
        "function",
        "objects",
        "method",
        "DOM Node objects",
        "Python object",
        "Lib",
        "Embedding Python",
        "Message objects",
        "attribute",
        "Python Type",
        "DOM Element objects",
        "operator module",
        "Python type object"
      ],
      "concepts": [
        "modules",
        "functionality",
        "function",
        "functions",
        "object",
        "method",
        "methodical",
        "attributes",
        "classes",
        "python"
      ],
      "similar_chapters": [
        {
          "book": "Python Data Analysis 3rd",
          "chapter": 3,
          "title": "Built-In Data Structures,",
          "relevance_score": 0.64,
          "method": "api"
        },
        {
          "book": "Effective-Python",
          "chapter": 40,
          "title": "Segment 40 (pages 420-428)",
          "relevance_score": 0.63,
          "method": "api"
        },
        {
          "book": "Python Distilled",
          "chapter": 2,
          "title": "Segment 2 (pages 9-18)",
          "relevance_score": 0.63,
          "method": "api"
        },
        {
          "book": "Python Cookbook 3rd",
          "chapter": 14,
          "title": "Testing, Debugging, and Exceptions",
          "relevance_score": 0.62,
          "method": "api"
        },
        {
          "book": "Fluent Python 2nd",
          "chapter": 20,
          "title": "Segment 20 (pages 392-414)",
          "relevance_score": 0.61,
          "method": "api"
        }
      ]
    }
  ],
  "pages": [
    {
      "page_number": 1,
      "chapter": null,
      "content": "ww\nDavid M. Beazley\n\nPython\n\nEssential Reference\n\nFourth Edition\n\nDeveloper’s Library",
      "content_length": 85,
      "extraction_method": "OCR"
    },
    {
      "page_number": 2,
      "chapter": null,
      "content": "Python\nE S S E N T I A L  R E F E R E N C E\nFourth Edition\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 81,
      "extraction_method": "Direct"
    },
    {
      "page_number": 3,
      "chapter": null,
      "content": "informit.com/devlibrary\nDeveloper’s \nLibrary\nESSENTIAL REFERENCES FOR PROGRAMMING PROFESSIONALS\nDeveloper’s Library books are designed to provide practicing programmers with\nunique, high-quality references and tutorials on the programming languages and\ntechnologies they use in their daily work.\nAll books in the Developer’s Library are written by expert technology practitioners\nwho are especially skilled at organizing and presenting information in a way that’s\nuseful for other programmers.\nKey titles include some of the best, most widely acclaimed books within their \ntopic areas:\nPHP and MySQL Web Development\nLuke Welling & Laura Thomson\nISBN 978-0-672-32916-6\nMySQL\nPaul DuBois\nISBN-13: 978-0-672-32938-8\nLinux Kernel Development\nRobert Love\nISBN-13: 978-0-672-32946-3\nPython Essential Reference\nDavid Beazley\nISBN-13: 978-0-672-32862-6\nProgramming in Objective-C\nStephen G. Kochan\nISBN-13: 978-0-321-56615-7\nPostgreSQL\nKorry Douglas\nISBN-13: 978-0-672-33015-5\nDeveloper’s Library books are available at most retail and online bookstores, as well\nas by subscription from Safari Books Online at safari.informit.com\nDeveloper’s Library\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1164,
      "extraction_method": "Direct"
    },
    {
      "page_number": 4,
      "chapter": null,
      "content": "Python\nE S S E N T I A L  R E F E R E N C E\nDavid M. Beazley\nFourth Edition\nUpper Saddle River, NJ • Boston • Indianapolis • San Francisco\nNew York • Toronto • Montreal • London • Munich • Paris • Madrid\nCape Town • Sydney • Tokyo • Singapore • Mexico City\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 279,
      "extraction_method": "Direct"
    },
    {
      "page_number": 5,
      "chapter": null,
      "content": "Python Essential Reference\nFourth Edition\nCopyright © 2009 by Pearson Education, Inc.\nAll rights reserved. No part of this book shall be reproduced, stored in\na retrieval system, or transmitted by any means, electronic, mechani-\ncal, photocopying, recording, or otherwise, without written permission\nfrom the publisher. No patent liability is assumed with respect to the\nuse of the information contained herein. Although every precaution\nhas been taken in the preparation of this book, the publisher and\nauthor assume no responsibility for errors or omissions. Nor is any\nliability assumed for damages resulting from the use of the informa-\ntion contained herein.\nISBN-13: 978-0-672-32978-4 \nISBN-10: 0-672-32978-6\nPrinted in the United States of America\nFirst Printing June 2009\nLibrary of Congress Cataloging-in-Publication data is on file.\nTrademarks\nAll terms mentioned in this book that are known to be trademarks or\nservice marks have been appropriately capitalized. Addison-Wesley\ncannot attest to the accuracy of this information. Use of a term in\nthis book should not be regarded as affecting the validity of any trade-\nmark or service mark.\nWarning and Disclaimer\nEvery effort has been made to make this book as complete and as\naccurate as possible, but no warranty or fitness is implied. The infor-\nmation provided is on an “as is” basis. The author and the publisher\nshall have neither liability nor responsibility to any person or entity\nwith respect to any loss or damages arising from the information con-\ntained in this book.\nBulk Sales\nAddison-Wesley offers excellent discounts on this book when ordered\nin quantity for bulk purchases or special sales. For more information,\nplease contact\nU.S. Corporate and Government Sales\n1-800-382-3419\ncorpsales@pearsontechgroup.com\nFor sales outside of the U.S., please contact\nInternational Sales\ninternational@pearson.com\nTo register this product and gain access to bonus content, go to\nwww.informit.com/register to sign in and enter the ISBN. After you\nregister the product, a link to the additional content will be listed on\nyour Account page, under Registered Products.\nAcquisitions Editor\nMark Taber\nDevelopment Editor\nMichael Thurston\nManaging Editor\nPatrick Kanouse\nProject Editor\nSeth Kerney\nCopy Editor\nLisa Thibault\nIndexer\nDavid Beazley\nProofreader\nMegan Wade\nTechnical Editors\nNoah Gift \nKurt Grandis\nPublishing\nCoordinator\nVanessa Evans\nBook Designer\nGary Adair\nCompositor\nBronkella Publishing\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2487,
      "extraction_method": "Direct"
    },
    {
      "page_number": 6,
      "chapter": null,
      "content": "❖\nFor Paula,Thomas., and his brother on the way.\n❖\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 73,
      "extraction_method": "Direct"
    },
    {
      "page_number": 7,
      "chapter": null,
      "content": "Contents at a Glance\nIntroduction\n1\nPart I: The Python Language\n1 A Tutorial Introduction\n5\n2 Lexical Conventions and Syntax\n25\n3 Types and Objects\n33\n4 Operators and Expressions\n65\n5 Program Structure and Control Flow\n81\n6 Functions and Functional Programming\n93\n7 Classes and Object-Oriented Programming\n117\n8 Modules, Packages, and Distribution\n143\n9 Input and Output\n157\n10 Execution Environment\n173\n11 Testing, Debugging, Profiling, and Tuning\n181\nPart II: The Python Library\n12 Built-In Functions\n201\n13 Python Runtime Services\n219\n14 Mathematics\n243\n15 Data Structures, Algorithms, and Code Simplification\n257\n16 String and Text Handling\n277\n17 Python Database Access\n297\n18 File and Directory Handling\n313\n19 Operating System Services\n331\n20 Threads and Concurrency\n413\n21 Network Programming and Sockets\n449\n22 Internet Application Programming\n497\n23 Web Programming\n531\n24 Internet Data Handling and Encoding\n545\n25 Miscellaneous Library Modules\n585\nPart III: Extending and Embedding\n26 Extending and Embedding Python\n591\nAppendix: Python 3\n621\nIndex\n639\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1087,
      "extraction_method": "Direct"
    },
    {
      "page_number": 8,
      "chapter": null,
      "content": "Table of Contents\nIntroduction\n1\nI: The Python Language\n1\nA Tutorial Introduction\n5\nRunning Python\n5\nVariables and Arithmetic Expressions\n7\nConditionals\n9\nFile Input and Output\n10\nStrings\n11\nLists\n12\nTuples\n14\nSets\n15\nDictionaries\n16\nIteration and Looping\n17\nFunctions\n18\nGenerators\n19\nCoroutines\n20\nObjects and Classes\n21\nExceptions\n22\nModules\n23\nGetting Help\n24\n2\nLexical Conventions and Syntax\n25\nLine Structure and Indentation\n25\nIdentifiers and Reserved Words\n26\nNumeric Literals\n26\nString Literals\n27\nContainers\n29\nOperators, Delimiters, and Special Symbols\n30\nDocumentation Strings\n30\nDecorators\n30\nSource Code Encoding\n31\n3\nTypes and Objects\n33\nTerminology\n33\nObject Identity and Type\n33\nReference Counting and Garbage Collection\n34\nReferences and Copies\n35\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 788,
      "extraction_method": "Direct"
    },
    {
      "page_number": 9,
      "chapter": null,
      "content": "viii\nContents\nFirst-Class Objects\n36\nBuilt-in Types for Representing Data\n37\nThe None Type\n38\nNumeric Types\n38\nSequence Types\n39\nMapping Types\n44\nSet Types\n46\nBuilt-in Types for Representing Program Structure\n47\nCallable Types\n47\nClasses, Types, and Instances\n50\nModules\n50\nBuilt-in Types for Interpreter Internals\n51\nCode Objects\n51\nFrame Objects\n52\nTraceback Objects\n52\nGenerator Objects\n53\nSlice Objects\n53\nEllipsis Object\n54\nObject Behavior and Special Methods\n54\nObject Creation and Destruction\n54\nObject String Representation\n55\nObject Comparison and Ordering\n56\nType Checking\n57\nAttribute Access\n57\nAttribute Wrapping and Descriptors\n58\nSequence and Mapping Methods\n58\nIteration\n59\nMathematical Operations\n60\nCallable Interface\n62\nContext Management Protocol\n62\nObject Inspection and dir()\n63\n4\nOperators and Expressions\n65\nOperations on Numbers\n65\nOperations on Sequences\n67\nString Formatting\n70\nAdvanced String Formatting\n72\nOperations on Dictionaries\n74\nOperations on Sets\n75\nAugmented Assignment\n75\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1032,
      "extraction_method": "Direct"
    },
    {
      "page_number": 10,
      "chapter": null,
      "content": "ix\nContents\nThe Attribute (.) Operator\n76\nThe Function Call () Operator\n76\nConversion Functions\n76\nBoolean Expressions and Truth Values\n77\nObject Equality and Identity\n78\nOrder of Evaluation\n78\nConditional Expressions\n79\n5\nProgram Structure and Control Flow\n81\nProgram Structure and Execution\n81\nConditional Execution\n81\nLoops and Iteration\n82\nExceptions\n84\nBuilt-in Exceptions\n86\nDefining New Exceptions\n88\nContext Managers and the with Statement\n89\nAssertions and __debug__\n91\n6\nFunctions and Functional Programming\n93\nFunctions\n93\nParameter Passing and Return Values\n95\nScoping Rules\n96\nFunctions as Objects and Closures\n98\nDecorators\n101\nGenerators and yield\n102\nCoroutines and yield Expressions\n104\nUsing Generators and Coroutines\n106\nList Comprehensions\n108\nGenerator Expressions\n109\nDeclarative Programming\n110\nThe lambda Operator\n112\nRecursion\n112\nDocumentation Strings\n113\nFunction Attributes\n114\neval(), exec(), and compile()\n115\n7\nClasses and Object-Oriented Programming\n117\nThe class Statement\n117\nClass Instances\n118\nScoping Rules\n118\nInheritance\n119\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1086,
      "extraction_method": "Direct"
    },
    {
      "page_number": 11,
      "chapter": null,
      "content": "Polymorphism Dynamic Binding and Duck Typing\n122\nStatic Methods and Class Methods\n123\nProperties\n124\nDescriptors\n126\nData Encapsulation and Private Attributes\n127\nObject Memory Management\n128\nObject Representation and Attribute Binding\n131\n__slots__\n132\nOperator Overloading\n133\nTypes and Class Membership Tests\n134\nAbstract Base Classes\n136\nMetaclasses\n138\nClass Decorators\n141\n8\nModules, Packages, and Distribution\n143\nModules and the import Statement\n143\nImporting Selected Symbols from a Module\n145\nExecution as the Main Program\n146\nThe Module Search Path\n147\nModule Loading and Compilation\n147\nModule Reloading and Unloading\n149\nPackages\n149\nDistributing Python Programs and Libraries\n152\nInstalling Third-Party Libraries\n154\n9\nInput and Output\n157\nReading Command-Line Options\n157\nEnvironment Variables\n158\nFiles and File Objects\n158\nStandard Input, Output, and Error\n161\nThe print Statement\n162\nThe print() Function\n163\nVariable Interpolation in Text Output\n163\nGenerating Output\n164\nUnicode String Handling\n165\nUnicode I/O\n167\nUnicode Data Encodings\n168\nUnicode Character Properties\n170\nObject Persistence and the pickle Module\n171\nx\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1173,
      "extraction_method": "Direct"
    },
    {
      "page_number": 12,
      "chapter": null,
      "content": "10\nExecution Environment\n173\nInterpreter Options and Environment\n173\nInteractive Sessions\n175\nLaunching Python Applications\n176\nSite Configuration Files\n177\nPer-user Site Packages\n177\nEnabling Future Features\n178\nProgram Termination\n179\n11\nTesting, Debugging, Profiling, and Tuning\n181\nDocumentation Strings and the doctest Module\n181\nUnit Testing and the unittest Module\n183\nThe Python Debugger and the pdb Module\n186\nDebugger Commands\n187\nDebugging from the Command Line\n189\nConfiguring the Debugger\n190\nProgram Profiling\n190\nTuning and Optimization\n191\nMaking Timing Measurements\n191\nMaking Memory Measurements\n192\nDisassembly\n193\nTuning Strategies\n194\nII: The Python Library\n199\n12\nBuilt-In Functions and Exceptions\n201\nBuilt-in Functions and Types\n201\nBuilt-In Exceptions\n212\nException Base Classes\n212\nException Instances\n212\nPredefined Exception Classes\n213\nBuilt-In Warnings\n216\nfuture_builtins\n217\n13\nPython Runtime Services\n219\natexit\n219\ncopy\n219\nNotes\n220\nxi\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1002,
      "extraction_method": "Direct"
    },
    {
      "page_number": 13,
      "chapter": null,
      "content": "gc\n220\nNotes\n222\ninspect\n222\nmarshal\n226\nNotes\n226\npickle\n226\nNotes\n229\nsys\n229\nVariables\n229\nFunctions\n233\ntraceback\n235\ntypes\n237\nNotes\n237\nwarnings\n238\nNotes\n239\nweakref\n240\nExample\n242\nNotes\n242\n14\nMathematics\n243\ndecimal\n243\nDecimal Objects\n244\nContext Objects\n244\nFunctions and Constants\n247\nExamples\n248\nNotes\n249\nfractions\n250\nmath\n251\nNotes\n252\nnumbers\n252\nNotes\n253\nrandom\n254\nSeeding and Initialization\n254\nRandom Integers\n254\nRandom Sequences\n254\nReal-Valued Random Distributions\n255\nNotes\n256\nxii\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 541,
      "extraction_method": "Direct"
    },
    {
      "page_number": 14,
      "chapter": null,
      "content": "15\nData Structures, Algorithms, and Code Simplification\n257\nabc\n257\narray\n259\nNotes\n261\nbisect\n261\ncollections\n262\ndeque and defaultdict\n262\nNamed Tuples\n263\nAbstract Base Classes\n265\ncontextlib\n267\nfunctools\n268\nheapq\n269\nitertools\n270\nExamples\n273\noperator\n273\n16\nString and Text Handling\n277\ncodecs\n277\nLow-Level codecs Interface\n277\nI/O-Related Functions\n279\nUseful Constants\n279\nStandard Encodings\n280\nNotes\n280\nre\n281\nPattern Syntax\n281\nFunctions\n283\nRegular Expression Objects\n284\nMatch Objects\n285\nExample\n286\nNotes\n287\nstring\n287\nConstants\n287\nFormatter Objects\n288\nTemplate Strings\n289\nUtility Functions\n290\nstruct\n290\nPacking and Unpacking Functions\n290\nStruct Objects\n291\nxiii\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 720,
      "extraction_method": "Direct"
    },
    {
      "page_number": 15,
      "chapter": null,
      "content": "Format Codes\n291\nNotes\n292\nunicodedata\n293\n17\nPython Database Access\n297\nRelational Database API Specification\n297\nConnections\n297\nCursors\n298\nForming Queries\n300\nType Objects\n301\nError Handling\n302\nMultithreading\n302\nMapping Results into Dictionaries\n303\nDatabase API Extensions\n303\nsqlite3 Module\n303\nModule-Level Functions\n304\nConnection Objects\n305\nCursors and Basic Operations\n308\nDBM-Style Database Modules\n310\nshelve Module\n311\n18\nFile and Directory Handling\n313\nbz2\n313\nfilecmp\n314\nfnmatch\n316\nExamples\n316\nglob\n317\nExample\n317\ngzip\n317\nNotes\n317\nshutil\n318\ntarfile\n319\nExceptions\n322\nExample\n322\ntempfile\n323\nzipfile\n324\nzlib\n328\nxiv\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 674,
      "extraction_method": "Direct"
    },
    {
      "page_number": 16,
      "chapter": null,
      "content": "19\nOperating System Services\n331\ncommands\n331\nNotes\n332\nconfigParser, Configparser\n332\nThe ConfigParser Class\n332\nExample\n334\nNotes\n336\ndatetime\n336\ndate Objects\n336\ntime Objects\n338\ndatetime objects\n339\ntimedelta objects\n340\nMathematical Operations Involving Dates\n341\ntzinfo Objects\n342\nDate and Time Parsing\n343\nerrno\n343\nPOSIX Error Codes\n344\nWindows Error Codes\n346\nfcntl\n347\nExample\n348\nNotes\n349\nio\n349\nBase I/O Interface\n349\nRaw I/O\n350\nBuffered Binary I/O\n351\nText I/O\n353\nThe open() Function\n354\nAbstract Base Classes\n354\nlogging\n355\nLogging Levels\n355\nBasic Configuration\n355\nLogger Objects\n356\nHandler Objects\n362\nMessage Formatting\n364\nMiscellaneous Utility Functions\n366\nLogging Configuration\n366\nPerformance Considerations\n369\nNotes\n369\nxv\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 786,
      "extraction_method": "Direct"
    },
    {
      "page_number": 17,
      "chapter": null,
      "content": "mmap\n369\nNotes\n372\nmsvcrt\n372\noptparse\n374\nExample\n377\nNotes\n378\nos\n378\nProcess Environment\n379\nFile Creation and File Descriptors\n381\nFiles and Directories\n386\nProcess Management\n390\nSystem Configuration\n395\nExceptions\n396\nos.path\n396\nsignal\n399\nExample\n401\nNotes\n401\nsubprocess\n402\nExamples\n404\nNotes\n404\ntime\n405\nNotes\n407\nwinreg\n408\nNotes\n411\n20\nThreads and Concurrency\n413\nBasic Concepts\n413\nConcurrent Programming and Python\n414\nmultiprocessing\n415\nProcesses\n415\nInterprocess Communication\n417\nProcess Pools\n424\nShared Data and Synchronization\n426\nManaged Objects\n428\nConnections\n433\nMiscellaneous Utility Functions\n434\nGeneral Advice on Multiprocessing\n435\nthreading\n436\nThread Objects\n436\nTimer Objects\n437\nxvi\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 750,
      "extraction_method": "Direct"
    },
    {
      "page_number": 18,
      "chapter": null,
      "content": "Lock Objects\n438\nRLock\n438\nSemaphore and Bounded Semaphore\n439\nEvents\n440\nCondition Variables\n441\nWorking with Locks\n442\nThread Termination and Suspension\n443\nUtility Functions\n443\nThe Global Interpreter Lock\n444\nProgramming with Threads\n444\nqueue, Queue\n444\nQueue Example with Threads\n445\nCoroutines and Microthreading\n446\n21\nNetwork Programming and Sockets\n449\nNetwork Programming Basics\n449\nasynchat\n452\nasyncore\n455\nExample\n457\nselect\n459\nAdvanced Module Features\n460\nAdvanced Asynchronous I/O Example\n460\nWhen to Consider Asynchronous Networking\n467\nsocket\n469\nAddress Families\n470\nSocket Types\n470\nAddressing\n471\nFunctions\n473\nExceptions\n485\nExample\n485\nNotes\n486\nssl\n486\nExamples\n489\nSocketServer\n489\nHandlers\n490\nServers\n491\nDefining Customized Servers\n492\nCustomization of Application Servers\n494\nxvii\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 842,
      "extraction_method": "Direct"
    },
    {
      "page_number": 19,
      "chapter": null,
      "content": "22\nInternet Application Programming\n497\nftplib\n497\nExample\n500\nhttp Package\n500\nhttp.client (httplib)\n502\nhttp.server (BaseHTTPServer, CGIHTTPServer,\nSimpleHTTPServer)\n506\nhttp.cookies (Cookie)\n511\nhttp.cookiejar (cookielib)\n513\nsmtplib\n513\nExample\n514\nurllib Package\n514\nurllib.request (urllib2)\n515\nurllib.response\n520\nurllib.parse\n520\nurllib.error\n523\nurllib.robotparser (robotparser)\n523\nNotes\n524\nxmlrpc Package\n524\nxmlrpc.client (xmlrpclib)\n524\nxmlrpc.server (SimpleXMLRPCServer, DocXMLRPCServer)\n527\n23\nWeb Programming\n531\ncgi\n533\nCGI Programming Advice\n537\nNotes\n538\ncgitb\n539\nwsgiref\n540\nThe WSGI Specification\n540\nwsgiref Package\n542\nwebbrowser\n544\n24\nInternet Data Handling and Encoding\n545\nbase64\n545\nbinascii\n547\ncsv\n548\nDialects\n551\nExample\n551\nxviii\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 796,
      "extraction_method": "Direct"
    },
    {
      "page_number": 20,
      "chapter": null,
      "content": "email Package\n552\nParsing Email\n552\nComposing Email\n555\nNotes\n558\nhashlib\n559\nhmac\n559\nExample\n560\nHTMLParser\n561\nExample\n562\njson\n563\nmimetypes\n566\nquopri\n567\nxml Package\n568\nXML Example Document\n569\nxml.dom.minidom\n570\nxml.etree.ElementTree\n573\nxml.sax\n580\nxml.sax.saxutils\n583\n25\nMiscellaneous Library Modules\n585\nPython Services\n585\nString Processing\n586\nOperating System Modules\n586\nNetwork\n587\nInternet Data Handling\n587\nInternationalization\n587\nMultimedia Services\n588\nMiscellaneous\n588\nIII: Extending and Embedding\n589\n26\nExtending and Embedding Python\n591\nExtension Modules\n591\nAn Extension Module Prototype\n593\nNaming Extension Modules\n595\nCompiling and Packaging Extensions\n596\nType Conversion from Python to C\n597\nType Conversion from C to Python\n602\nxix\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 798,
      "extraction_method": "Direct"
    },
    {
      "page_number": 21,
      "chapter": null,
      "content": "Adding Values to a Module\n604\nError Handling\n605\nReference Counting\n607\nThreads\n607\nEmbedding the Python Interpreter\n608\nAn Embedding Template\n608\nCompilation and Linking\n608\nBasic Interpreter Operation and Setup\n608\nAccessing Python from C\n610\nConverting Python Objects to C\n611\nctypes\n612\nLoading Shared Libraries\n612\nForeign Functions\n612\nDatatypes\n613\nCalling Foreign Functions\n615\nAlternative Type Construction Methods\n616\nUtility Functions\n617\nExample\n618\nAdvanced Extending and Embedding\n619\nJython and IronPython\n620\nAppendix\nPython 3\n621\nWho Should Be Using Python 3?\n621\nNew Language Features\n622\nSource Code Encoding and Identifiers\n622\nSet Literals\n622\nSet and Dictionary Comprehensions\n623\nExtended Iterable Unpacking\n623\nNonlocal Variables\n624\nFunction Annotations\n624\nKeyword-Only Arguments\n625\nEllipsis as an Expression\n626\nChained Exceptions\n626\nImproved super()\n627\nAdvanced Metaclasses\n627\nCommon Pitfalls\n629\nText Versus Bytes\n629\nNew I/O System\n631\nxx\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1004,
      "extraction_method": "Direct"
    },
    {
      "page_number": 22,
      "chapter": null,
      "content": "print() and exec() Functions\n631\nUse of Iterators and Views\n632\nIntegers and Integer Division\n633\nComparisons\n633\nIterators and Generators\n633\nFile Names, Arguments, and Environment Variables\n633\nLibrary Reorganization\n634\nAbsolute Imports\n634\nCode Migration and 2to3\n634\nPorting Code to Python 2.6\n634\nProviding Test Coverage\n635\nUsing the 2to3 Tool\n635\nA Practical Porting Strategy\n637\nSimultaneous Python 2 and Python 3 Support\n638\nParticipate\n638\nIndex 639\nxxi\nContents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 496,
      "extraction_method": "Direct"
    },
    {
      "page_number": 23,
      "chapter": null,
      "content": "About the Author\nDavid M. Beazley is a long-time Python enthusiast, having been involved with the\nPython community since 1996. He is probably best known for his work on SWIG, a\npopular software package for integrating C/C++ programs with other programming\nlanguages, including Python, Perl, Ruby,Tcl, and Java. He has also written a number of\nother programming tools, including PLY, a Python implementation of lex and yacc.\nDave spent seven years working in the Theoretical Physics Division at Los Alamos\nNational Laboratory, where he helped pioneer the use of Python with massively parallel\nsupercomputers.After that, Dave went off to work as an evil professor, where he\nenjoyed tormenting college students with a variety of insane programming projects.\nHowever, he has since seen the error of his ways and is now working as an independent\nsoftware developer, consultant, Python trainer, and occasional jazz musician living in\nChicago. He can be contacted at http://www.dabeaz.com.\nAbout the Technical Editor\nNoah Gift is the co-author of Python For UNIX and Linux System Administration\n(O’Reilly) and is also working on Google App Engine In Action (Manning). He is an\nauthor, speaker, consultant, and community leader, writing for publications such as IBM\ndeveloperWorks, Red Hat Magazine, O’Reilly, and MacTech. His consulting company’s\nwebsite is http://www.giftcs.com, and much of his writing can be found at\nhttp://noahgift.com.You can also follow Noah on Twitter.\nNoah has a master’s degree in CIS from Cal State, Los Angeles, a B.S. in nutritional\nscience from Cal Poly San Luis Obispo, is an Apple and LPI-certified SysAdmin, and\nhas worked at companies such as Caltech, Disney Feature Animation, Sony Imageworks,\nand Turner Studios. He is currently working at Weta Digital in New Zealand. In his free\ntime he enjoys spending time with his wife Leah and their son Liam, composing for the\npiano, running marathons, and exercising religiously.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1973,
      "extraction_method": "Direct"
    },
    {
      "page_number": 24,
      "chapter": null,
      "content": "Acknowledgments\nThis book would not be possible without the support of many people. First and fore-\nmost, I’d like to thank Noah Gift for jumping into the project and providing his amaz-\ning feedback on the fourth edition. Kurt Grandis also provided useful comments for\nmany chapters. I’d also like to acknowledge past technical reviewers Timothy\nBoronczyk, Paul DuBois, Mats Wichmann, David Ascher, and Tim Bell for their valuable\ncomments and advice that made earlier editions a success. Guido van Rossum, Jeremy\nHylton, Fred Drake, Roger Masse, and Barry Warsaw also provided tremendous assis-\ntance with the first edition while hosting me for a few weeks back in the hot summer\nof 1999. Last, but not least, this book would not be possible without all of the feedback\nI received from readers.There are far too many people to list individually, but I have\ndone my best to incorporate your suggestions for making the book even better. I’d also\nlike to thank all the folks at Addison-Wesley and Pearson Education for their continued\ncommitment to the project and assistance. Mark Taber, Michael Thurston, Seth Kerney,\nand Lisa Thibault all helped out to get this edition out the door in good shape.A special\nthanks is in order for Robin Drake, whose tremendous effort in editing previous edi-\ntions made the third edition possible. Finally, I’d like to acknowledge my amazing wife\nand partner Paula Kamen for all of her encouragement, diabolical humor, and love.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1486,
      "extraction_method": "Direct"
    },
    {
      "page_number": 25,
      "chapter": null,
      "content": "We Want to Hear from You!\nAs the reader of this book, you are our most important critic and commentator.We\nvalue your opinion and want to know what we’re doing right, what we could do better,\nwhat areas you’d like to see us publish in, and any other words of wisdom you’re willing\nto pass our way.\nYou can email or write me directly to let me know what you did or didn’t like about\nthis book—as well as what we can do to make our books stronger.\nPlease note that I cannot help you with technical problems related to the topic of this book, and\nthat due to the high volume of mail I receive, I might not be able to reply to every message.\nWhen you write, please be sure to include this book’s title and author as well as your\nname and phone or email address. I will carefully review your comments and share\nthem with the author and editors who worked on the book.\nEmail:\nfeedback@developers-library.info\nMail:\nMark Taber\nAssociate Publisher\nPearson Education\n800 East 96th Street\nIndianapolis, IN 46240 USA\nReader Services\nVisit our website and register this book at informit.com/register for convenient access\nto any updates, downloads, or errata that might be available for this book.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1208,
      "extraction_method": "Direct"
    },
    {
      "page_number": 26,
      "chapter": null,
      "content": "Introduction\nThis book is intended to be a concise reference to the Python programming language.\nAlthough an experienced programmer will probably be able to learn Python from this\nbook, it’s not intended to be an extended tutorial or a treatise on how to program.\nRather, the goal is to present the core Python language, and the most essential parts of\nthe Python library in a manner that’s accurate and concise.This book assumes that the\nreader has prior programming experience with Python or another language such as C\nor Java. In addition, a general familiarity with systems programming topics (for example,\nbasic operating system concepts and network programming) may be useful in under-\nstanding certain parts of the library reference.\nPython is freely available for download at http://www.python.org.Versions are avail-\nable for almost every operating system, including UNIX,Windows, and Macintosh. In\naddition, the Python website includes links to documentation, how-to guides, and a\nwide assortment of third-party software.\nThis edition of Python Essential Reference comes at a pivotal time in Python’s evolu-\ntion. Python 2.6 and Python 3.0 are being released almost simultaneously.Yet, Python 3\nis a release that breaks backwards compatibility with prior Python versions.As an author\nand programmer, I’m faced with a dilemma: do I simply jump forward to Python 3.0 or\ndo I build upon the Python 2.x releases that are more familiar to most programmers?\nYears ago, as a C programmer I used to treat certain books as the ultimate authority\non what programming language features should be used. For example, if you were using\nsomething that wasn’t documented in the K&R book, it probably wasn’t going to be\nportable and should be approached with caution.This approach served me very well as\na programmer and it’s the approach I have decided to take in this edition of the\nEssential Reference. Namely, I have chosen to omit features of Python 2 that have been\nremoved from Python 3. Likewise, I don’t focus on features of Python 3 that have not\nbeen back-ported (although such features are still covered in an appendix).As a result, I\nhope this book can be a useful companion for Python programmers, regardless of what\nPython version is being used.\nThe fourth edition of Python Essential Reference also includes some of the most excit-\ning changes since its initial publication nearly ten years ago. Much of Python’s develop-\nment throughout the last few years has focused on new programming language fea-\ntures—especially related to functional and meta programming.As a result, the chapters\non functions and object-oriented programming have been greatly expanded to cover\ntopics such as generators, iterators, coroutines, decorators, and metaclasses.The library\nchapters have been updated to focus on more modern modules. Examples and code\nfragments have also been updated throughout the book. I think most programmers will\nbe quite pleased with the expanded coverage.\nFinally, it should be noted that Python already includes thousands of pages of useful\ndocumentation.The contents of this book are largely based on that documentation, but\nwith a number of key differences. First, this reference presents information in a much\nmore compact form, with different examples and alternative descriptions of many top-\nics. Second, a significant number of topics in the library reference have been expanded\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3428,
      "extraction_method": "Direct"
    },
    {
      "page_number": 27,
      "chapter": null,
      "content": "to include outside reference material.This is especially true for low-level system and\nnetworking modules in which effective use of a module normally relies on a myriad of\noptions listed in manuals and outside references. In addition, in order to produce a more\nconcise reference, a number of deprecated and relatively obscure library modules have\nbeen omitted.\nIn writing this book, it has been my goal to produce a reference containing virtually\neverything I have needed to use Python and its large collection of modules.Although\nthis is by no means a gentle introduction to the Python language, I hope that you find\nthe contents of this book to be a useful addition to your programming reference library\nfor many years to come. I welcome your comments.\nDavid Beazley\nChicago, Illinois\nJune, 2009\n2\nIntroduction\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 836,
      "extraction_method": "Direct"
    },
    {
      "page_number": 28,
      "chapter": null,
      "content": "I\nThe Python Language\n1\nA Tutorial Introduction\n2\nLexical Conventions and Syntax\n3\nTypes and Objects\n4\nOperators and Expressions\n5\nProgram Structure and Control Flow\n6\nFunctions and Functional Programming\n7\nClasses and Object-Oriented Programming\n8\nModules, Packages, and Distribution\n9\nInput and Output\n10\nExecution Environment\n11\nTesting, Debugging, Profiling, and Tuning\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 396,
      "extraction_method": "Direct"
    },
    {
      "page_number": 29,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 30,
      "chapter": null,
      "content": "1\nA Tutorial Introduction\nThis chapter provides a quick introduction to Python.The goal is to illustrate most of\nPython’s essential features without getting too bogged down in special rules or details.\nTo do this, the chapter briefly covers basic concepts such as variables, expressions, con-\ntrol flow, functions, generators, classes, and input/output.This chapter is not intended to\nprovide comprehensive coverage. However, experienced programmers should be able to\nextrapolate from the material in this chapter to create more advanced programs.\nBeginners are encouraged to try a few examples to get a feel for the language. If you\nare new to Python and using Python 3, you might want to follow this chapter using\nPython 2.6 instead.Virtually all the major concepts apply to both versions, but there are\na small number of critical syntax changes in Python 3—mostly related to printing and\nI/O—that might break many of the examples shown in this section. Please refer to\nAppendix A,“Python 3,” for further details.\nRunning Python\nPython programs are executed by an interpreter. Usually, the interpreter is started by\nsimply typing python into a command shell. However, there are many different imple-\nmentations of the interpreter and Python development environments (for example,\nJython, IronPython, IDLE,ActivePython,Wing IDE, pydev, etc.), so you should consult\nthe documentation for startup details.When the interpreter starts, a prompt appears at\nwhich you can start typing programs into a simple read-evaluation loop. For example, in\nthe following output, the interpreter displays its copyright message and presents the user\nwith the >>> prompt, at which the user types the familiar “Hello World” command:\nPython 2.6rc2 (r26rc2:66504, Sep 19 2008, 08:50:24)\n[GCC 4.0.1 (Apple Inc. build 5465)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> print \"Hello World\"\nHello World\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1944,
      "extraction_method": "Direct"
    },
    {
      "page_number": 31,
      "chapter": null,
      "content": "6\nChapter 1\nA Tutorial Introduction\nNote\nIf you try the preceding example and it fails with a SyntaxError, you are probably\nusing Python 3. If this is the case, you can continue to follow along with this chapter,\nbut be aware that the print statement turned into a function in Python 3. Simply add\nparentheses around the items to be printed in the examples that follow. For instance:\n>>> print(\"Hello World\")\nHello World\n>>>\nPutting parentheses around the item to be printed also works in Python 2 as long as\nyou are printing just a single item. However, it’s not a syntax that you commonly see in\nexisting Python code. In later chapters, this syntax is sometimes used in examples in\nwhich the primary focus is a feature not directly related to printing, but where the exam-\nple is supposed to work with both Python 2 and 3. \nPython’s interactive mode is one of its most useful features. In the interactive shell,\nyou can type any valid statement or sequence of statements and immediately view the\nresults. Many people, including the author, even use interactive Python as their desktop\ncalculator. For example:\n>>> 6000 + 4523.50 + 134.12\n10657.620000000001\n>>> _ + 8192.32\n18849.940000000002\n>>>\nWhen you use Python interactively, the special variable _ holds the result of the last\noperation.This can be useful if you want to save or use the result of the last operation\nin subsequent statements. However, it’s important to stress that this variable is only\ndefined when working interactively.\nIf you want to create a program that you can run repeatedly, put statements in a file\nsuch as the following:\n# helloworld.py\nprint \"Hello World\"\nPython source files are ordinary text files and normally have a .py suffix.The # charac-\nter denotes a comment that extends to the end of the line.\nTo execute the helloworld.py file, you provide the filename to the interpreter as\nfollows:\n% python helloworld.py\nHello World\n%\nOn Windows, Python programs can be started by double-clicking a .py file or typing\nthe name of the program into the Run command on the Windows Start menu.This\nlaunches the interpreter and runs the program in a console window. However, be aware\nthat the console window will disappear immediately after the program completes its\nexecution (often before you can read its output). For debugging, it is better to run the\nprogram within a Python development tool such as IDLE.\nOn UNIX, you can use #! on the first line of the program, like this:\n#!/usr/bin/env python\nprint \"Hello World\"\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2522,
      "extraction_method": "Direct"
    },
    {
      "page_number": 32,
      "chapter": null,
      "content": "7\nVariables and Arithmetic Expressions\nThe interpreter runs statements until it reaches the end of the input file. If it’s running\ninteractively, you can exit the interpreter by typing the EOF (end of file) character or\nby selecting Exit from pull-down menu of a Python IDE. On UNIX, EOF is Ctrl+D;\non Windows, it’s Ctrl+Z.A program can request to exit by raising the SystemExit\nexception.\n>>> raise SystemExit\nVariables and Arithmetic Expressions\nThe program in Listing 1.1 shows the use of variables and expressions by performing a\nsimple compound-interest calculation.\nListing 1.1\nSimple Compound-Interest Calculation\nprincipal = 1000        # Initial amount\nrate = 0.05             # Interest rate\nnumyears = 5            # Number of years\nyear = 1\nwhile year <= numyears:\nprincipal = principal * (1 + rate)\nprint year, principal     # Reminder: print(year, principal) in Python 3 \nyear += 1\nThe output of this program is the following table:\n1 1050.0\n2 1102.5\n3 1157.625\n4 1215.50625\n5 1276.2815625\nPython is a dynamically typed language where variable names are bound to different\nvalues, possibly of varying types, during program execution.The assignment operator\nsimply creates an association between a name and a value.Although each value has an\nassociated type such as an integer or string, variable names are untyped and can be\nmade to refer to any type of data during execution.This is different from C, for exam-\nple, in which a name represents a fixed type, size, and location in memory into which a\nvalue is stored.The dynamic behavior of Python can be seen in Listing 1.1 with the\nprincipal variable. Initially, it’s assigned to an integer value. However, later in the pro-\ngram it’s reassigned as follows:\nprincipal = principal * (1 + rate)\nThis statement evaluates the expression and reassociates the name principal with the\nresult. Although the original value of principal was an integer 1000, the new value is\nnow a floating-point number (rate is defined as a float, so the value of the above\nexpression is also a float).Thus, the apparent “type” of principal dynamically changes\nfrom an integer to a float in the middle of the program. However, to be precise, it’s not\nthe type of principal that has changed, but rather the value to which the principal\nname refers.\nA newline terminates each statement. However, you can use a semicolon to separate\nstatements on the same line, as shown here:\nprincipal = 1000; rate = 0.05; numyears = 5;\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2480,
      "extraction_method": "Direct"
    },
    {
      "page_number": 33,
      "chapter": null,
      "content": "8\nChapter 1\nA Tutorial Introduction\nThe while statement tests the conditional expression that immediately follows. If the\ntested statement is true, the body of the while statement executes.The condition is\nthen retested and the body executed again until the condition becomes false. Because\nthe body of the loop is denoted by indentation, the three statements following while in\nListing 1.1 execute on each iteration. Python doesn’t specify the amount of required\nindentation, as long as it’s consistent within a block. However, it is most common (and\ngenerally recommended) to use four spaces per indentation level.\nOne problem with the program in Listing 1.1 is that the output isn’t very pretty.To\nmake it better, you could right-align the columns and limit the precision of principal\nto two digits.There are several ways to achieve this formatting.The most widely used\napproach is to use the string formatting operator (%) like this:\nprint \"%3d %0.2f\" % (year, principal)\nprint(\"%3d %0.2f\" % (year, principal))   # Python 3\nNow the output of the program looks like this:\n1 1050.00\n2 1102.50\n3 1157.63\n4 1215.51\n5 1276.28\nFormat strings contain ordinary text and special formatting-character sequences such as\n\"%d\", \"%s\", and \"%f\".These sequences specify the formatting of a particular type of\ndata such as an integer, string, or floating-point number, respectively.The special-\ncharacter sequences can also contain modifiers that specify a width and precision. For\nexample, \"%3d\" formats an integer right-aligned in a column of width 3, and \"%0.2f\"\nformats a floating-point number so that only two digits appear after the decimal point.\nThe behavior of format strings is almost identical to the C printf() function and is\ndescribed in detail in Chapter 4,“Operators and Expressions.”\nA more modern approach to string formatting is to format each part individually\nusing the format() function. For example:\nprint format(year,\"3d\"),format(principal,\"0.2f\")\nprint(format(year,\"3d\"),format(principal,\"0.2f\")) # Python 3\nformat() uses format specifiers that are similar to those used with the traditional string\nformatting operator (%). For example, \"3d\" formats an integer right-aligned in a col-\numn of width 3, and \"0.2f\" formats a float-point number to have two digits of accura-\ncy. Strings also have a format() method that can be used to format many values at\nonce. For example:\nprint \"{0:3d} {1:0.2f}\".format(year,principal)\nprint(\"{0:3d} {1:0.2f}\".format(year,principal)) # Python 3\nIn this example, the number before the colon in \"{0:3d}\" and \"{1:0.2f}\" refers to\nthe associated argument passed to the format() method and the part after the colon is\nthe format specifier.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2702,
      "extraction_method": "Direct"
    },
    {
      "page_number": 34,
      "chapter": null,
      "content": "9\nConditionals\nConditionals\nThe if and else statements can perform simple tests. Here’s an example:\nif a < b:\nprint \"Computer says Yes\"\nelse:\nprint \"Computer says No\"\nThe bodies of the if and else clauses are denoted by indentation.The else clause is\noptional.\nTo create an empty clause, use the pass statement, as follows:\nif a < b:\npass      # Do nothing\nelse:\nprint \"Computer says No\"\nYou can form Boolean expressions by using the or, and, and not keywords:\nif product == \"game\" and type == \"pirate memory\" \\\nand not (age < 4 or age > 8):\nprint \"I'll take it!\"\nNote\nWriting complex test cases commonly results in statements that involve an annoyingly\nlong line of code. To improve readability, you can continue any statement to the next line\nby using a backslash (\\) at the end of a line as shown. If you do this, the normal inden-\ntation rules don’t apply to the next line, so you are free to format the continued lines as\nyou wish.\nPython does not have a special switch or case statement for testing values.To handle\nmultiple-test cases, use the elif statement, like this:\nif suffix == \".htm\": \ncontent = \"text/html\"\nelif suffix == \".jpg\":\ncontent = \"image/jpeg\"\nelif suffix == \".png\":\ncontent = \"image/png\"\nelse:\nraise RuntimeError(\"Unknown content type\")\nTo denote truth values, use the Boolean values True and False. Here’s an example:\nif 'spam' in s:\nhas_spam = True\nelse:\nhas_spam = False\nAll relational operators such as < and > return True or False as results.The in opera-\ntor used in this example is commonly used to check whether a value is contained inside\nof another object such as a string, list, or dictionary. It also returns True or False, so\nthe preceding example could be shortened to this:\nhas_spam = 'spam' in s\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1759,
      "extraction_method": "Direct"
    },
    {
      "page_number": 35,
      "chapter": null,
      "content": "10\nChapter 1\nA Tutorial Introduction\nFile Input and Output\nThe following program opens a file and reads its contents line by line:\nf = open(\"foo.txt\")           # Returns a file object\nline = f.readline()           # Invokes readline() method on file\nwhile line:\nprint line,               # trailing ',' omits newline character\n# print(line,end='')      # Use in Python 3\nline = f.readline()\nf.close()\nThe open() function returns a new file object. By invoking methods on this object,\nyou can perform various file operations.The readline() method reads a single line of\ninput, including the terminating newline.The empty string is returned at the end of the\nfile.\nIn the example, the program is simply looping over all the lines in the file foo.txt.\nWhenever a program loops over a collection of data like this (for instance input lines,\nnumbers, strings, etc.), it is commonly known as iteration. Because iteration is such a com-\nmon operation, Python provides a dedicated statement, for, that is used to iterate over\nitems. For instance, the same program can be written much more succinctly as follows:\nfor line in open(\"foo.txt\"):\nprint line,\nTo make the output of a program go to a file, you can supply a file to the print state-\nment using >>, as shown in the following example:\nf = open(\"out\",\"w\")     # Open file for writing\nwhile year <= numyears:\nprincipal = principal * (1 + rate)\nprint >>f,\"%3d %0.2f\" % (year,principal)\nyear += 1\nf.close()\nThe >> syntax only works in Python 2. If you are using Python 3, change the print\nstatement to the following:\nprint(\"%3d %0.2f\" % (year,principal),file=f)\nIn addition, file objects support a write() method that can be used to write raw data.\nFor example, the print statement in the previous example could have been written this\nway:\nf.write(\"%3d %0.2f\\n\" % (year,principal))\nAlthough these examples have worked with files, the same techniques apply to the stan-\ndard output and input streams of the interpreter. For example, if you wanted to read\nuser input interactively, you can read from the file sys.stdin. If you want to write data\nto the screen, you can write to sys.stdout, which is the same file used to output data\nproduced by the print statement. For example:\nimport sys\nsys.stdout.write(\"Enter your name :\")\nname = sys.stdin.readline()\nIn Python 2, this code can also be shortened to the following:\nname = raw_input(\"Enter your name :\")\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2422,
      "extraction_method": "Direct"
    },
    {
      "page_number": 36,
      "chapter": null,
      "content": "11\nStrings\nIn Python 3, the raw_input() function is called input(), but it works in exactly the\nsame manner.\nStrings\nTo create string literals, enclose them in single, double, or triple quotes as follows:\na = \"Hello World\"\nb = 'Python is groovy'\nc = \"\"\"Computer says 'No'\"\"\"\nThe same type of quote used to start a string must be used to terminate it.Triple-\nquoted strings capture all the text that appears prior to the terminating triple quote, as\nopposed to single- and double-quoted strings, which must be specified on one logical\nline.Triple-quoted strings are useful when the contents of a string literal span multiple\nlines of text such as the following:\nprint '''Content-type: text/html\n<h1> Hello World </h1>\nClick <a href=\"http://www.python.org\">here</a>.\n'''\nStrings are stored as sequences of characters indexed by integers, starting at zero.To\nextract a single character, use the indexing operator s[i] like this:\na = \"Hello World\"\nb = a[4]                # b = 'o'\nTo extract a substring, use the slicing operator s[i:j].This extracts all characters from\ns whose index k is in the range i <= k < j. If either index is omitted, the beginning\nor end of the string is assumed, respectively:\nc = a[:5]              # c = \"Hello\"\nd = a[6:]               # d = \"World\"\ne = a[3:8]              # e = \"lo Wo\"\nStrings are concatenated with the plus (+) operator:\ng = a + \" This is a test\"\nPython never implicitly interprets the contents of a string as numerical data (i.e., as in\nother languages such as Perl or PHP). For example, + always concatenates strings:\nx = \"37\"\ny = \"42\"\nz = x + y     # z = \"3742\" (String Concatenation)\nTo perform mathematical calculations, strings first have to be converted into a numeric\nvalue using a function such as int() or float(). For example:\nz = int(x) + int(y)   # z = 79  (Integer +)\nNon-string values can be converted into a string representation by using the str(),\nrepr(), or format() function. Here’s an example:\ns = \"The value of x is \" + str(x)\ns = \"The value of x is \" + repr(x)\ns = \"The value of x is \" + format(x,\"4d\")\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2094,
      "extraction_method": "Direct"
    },
    {
      "page_number": 37,
      "chapter": null,
      "content": "12\nChapter 1\nA Tutorial Introduction\nAlthough str() and repr() both create strings, their output is usually slightly differ-\nent. str() produces the output that you get when you use the print statement,\nwhereas repr() creates a string that you type into a program to exactly represent the\nvalue of an object. For example:\n>>> x = 3.4\n>>> str(x)\n'3.4'\n>>> repr(x)\n'3.3999999999999999'\n>>>\nThe inexact representation of 3.4 in the previous example is not a bug in Python. It is\nan artifact of double-precision floating-point numbers, which by their design can not\nexactly represent base-10 decimals on the underlying computer hardware.\nThe format() function is used to convert a value to a string with a specific format-\nting applied. For example:\n>>> format(x,\"0.5f\")\n'3.40000'\n>>>\nLists\nLists are sequences of arbitrary objects.You create a list by enclosing values in square\nbrackets, as follows:\nnames = [ \"Dave\", \"Mark\", \"Ann\", \"Phil\" ]\nLists are indexed by integers, starting with zero. Use the indexing operator to access and\nmodify individual items of the list:\na = names[2]             # Returns the third item of the list, \"Ann\"\nnames[0] = \"Jeff\"        # Changes the first item to \"Jeff\"\nTo append new items to the end of a list, use the append() method:\nnames.append(\"Paula\")\nTo insert an item into the middle of a list, use the insert() method:\nnames.insert(2, \"Thomas\")\nYou can extract or reassign a portion of a list by using the slicing operator:\nb = names[0:2]                      # Returns [ \"Jeff\", \"Mark\" ]\nc = names[2:]                       # Returns [ \"Thomas\", \"Ann\", \"Phil\", \"Paula\" ]\nnames[1] = 'Jeff'                   # Replace the 2nd item in names with 'Jeff'\nnames[0:2] = ['Dave','Mark','Jeff'] # Replace the first two items of\n# the list with the list on the right.\nUse the plus (+) operator to concatenate lists:\na = [1,2,3] + [4,5]     # Result is [1,2,3,4,5]\nAn empty list is created in one of two ways:\nnames = []        # An empty list\nnames = list()    # An empty list\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2028,
      "extraction_method": "Direct"
    },
    {
      "page_number": 38,
      "chapter": null,
      "content": "13\nLists\nLists can contain any kind of Python object, including other lists, as in the following\nexample:\na = [1,\"Dave\",3.14, [\"Mark\", 7, 9, [100,101]], 10]\nItems contained in nested lists are accessed by applying more than one indexing opera-\ntion, as follows:\na[1]            # Returns \"Dave\"\na[3][2]         # Returns 9\na[3][3][1]      # Returns 101\nThe program in Listing 1.2 illustrates a few more advanced features of lists by reading a\nlist of numbers from a file specified on the command line and outputting the minimum\nand maximum values.\nListing 1.2\nAdvanced List Features\nimport sys                       # Load the sys module\nif len(sys.argv) != 2            # Check number of command line arguments :\nprint \"Please supply a filename\"\nraise SystemExit(1)\nf = open(sys.argv[1])            # Filename on the command line\nlines = f.readlines()            # Read all lines into a list\nf.close()\n# Convert all of the input values from strings to floats\nfvalues = [float(line) for line in lines]\n# Print min and max values\nprint \"The minimum value is \", min(fvalues)\nprint \"The maximum value is \", max(fvalues)\nThe first line of this program uses the import statement to load the sys module from\nthe Python library.This module is being loaded in order to obtain command-line argu-\nments.\nThe open() function uses a filename that has been supplied as a command-line\noption and placed in the list sys.argv.The readlines() method reads all the input\nlines into a list of strings.\nThe expression [float(line) for line in lines] constructs a new list by\nlooping over all the strings in the list lines and applying the function float() to each\nelement.This particularly powerful method of constructing a list is known as a list com-\nprehension. Because the lines in a file can also be read using a for loop, the program can\nbe shortened by converting values using a single statement like this:\nfvalues = [float(line) for line in open(sys.argv[1])]\nAfter the input lines have been converted into a list of floating-point numbers, the\nbuilt-in min() and max() functions compute the minimum and maximum values.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2130,
      "extraction_method": "Direct"
    },
    {
      "page_number": 39,
      "chapter": null,
      "content": "14\nChapter 1\nA Tutorial Introduction\nTuples\nTo create simple data structures, you can pack a collection of values together into a sin-\ngle object using a tuple.You create a tuple by enclosing a group of values in parentheses\nlike this:\nstock = ('GOOG', 100, 490.10)\naddress = ('www.python.org', 80)\nperson = (first_name, last_name, phone)\nPython often recognizes that a tuple is intended even if the parentheses are missing:\nstock = 'GOOG', 100, 490.10\naddress = 'www.python.org',80\nperson = first_name, last_name, phone\nFor completeness, 0- and 1-element tuples can be defined, but have special syntax:\na = ()         # 0-tuple (empty tuple)\nb = (item,)    # 1-tuple (note the trailing comma)\nc = item,      # 1-tuple (note the trailing comma) \nThe values in a tuple can be extracted by numerical index just like a list. However, it is\nmore common to unpack tuples into a set of variables like this:\nname, shares, price = stock\nhost, port = address\nfirst_name, last_name, phone = person\nAlthough tuples support most of the same operations as lists (such as indexing, slicing,\nand concatenation), the contents of a tuple cannot be modified after creation (that is,\nyou cannot replace, delete, or append new elements to an existing tuple).This reflects\nthe fact that a tuple is best viewed as a single object consisting of several parts, not as a\ncollection of distinct objects to which you might insert or remove items.\nBecause there is so much overlap between tuples and lists, some programmers are\ninclined to ignore tuples altogether and simply use lists because they seem to be more\nflexible.Although this works, it wastes memory if your program is going to create a\nlarge number of small lists (that is, each containing fewer than a dozen items).This is\nbecause lists slightly overallocate memory to optimize the performance of operations\nthat add new items. Because tuples are immutable, they use a more compact representa-\ntion where there is no extra space.\nTuples and lists are often used together to represent data. For example, this program\nshows how you might read a file consisting of different columns of data separated by\ncommas:\n# File containing lines of the form \"name,shares,price\"\nfilename = \"portfolio.csv\"\nportfolio = []\nfor line in open(filename):\nfields = line.split(\",\")       # Split each line into a list\nname   = fields[0]             # Extract and convert individual fields\nshares = int(fields[1])\nprice  = float(fields[2])\nstock  = (name,shares,price)   # Create a tuple (name, shares, price)\nportfolio.append(stock)        # Append to list of records\nThe split() method of strings splits a string into a list of fields separated by the given\ndelimiter character.The resulting portfolio data structure created by this program\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2778,
      "extraction_method": "Direct"
    },
    {
      "page_number": 40,
      "chapter": null,
      "content": "15\nSets\nlooks like a two-dimension array of rows and columns. Each row is represented by a\ntuple and can be accessed as follows:\n>>> portfolio[0]\n('GOOG', 100, 490.10)\n>>> portfolio[1]\n('MSFT', 50, 54.23)\n>>>\nIndividual items of data can be accessed like this:\n>>> portfolio[1][1]\n50\n>>> portfolio[1][2]\n54.23\n>>>\nHere’s an easy way to loop over all of the records and expand fields into a set of \nvariables:\ntotal = 0.0\nfor name, shares, price in portfolio:\ntotal += shares * price\nSets\nA set is used to contain an unordered collection of objects.To create a set, use the\nset() function and supply a sequence of items such as follows:\ns = set([3,5,9,10])       # Create a set of numbers\nt = set(\"Hello\")          # Create a set of unique characters \nUnlike lists and tuples, sets are unordered and cannot be indexed by numbers.\nMoreover, the elements of a set are never duplicated. For example, if you inspect the\nvalue of t from the preceding code, you get the following:\n>>> t\nset(['H', 'e', 'l', 'o'])\nNotice that only one 'l' appears.\nSets support a standard collection of operations, including union, intersection, differ-\nence, and symmetric difference. Here’s an example:\na = t | s           # Union of t and s\nb = t & s           # Intersection of t and s\nc = t – s           # Set difference (items in t, but not in s)\nd = t ^ s           # Symmetric difference (items in t or s, but not both)\nNew items can be added to a set using add() or update():\nt.add('x')             # Add a single item\ns.update([10,37,42])   # Adds multiple items to s\nAn item can be removed using remove():\nt.remove('H')\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1629,
      "extraction_method": "Direct"
    },
    {
      "page_number": 41,
      "chapter": null,
      "content": "16\nChapter 1\nA Tutorial Introduction\nDictionaries\nA dictionary is an associative array or hash table that contains objects indexed by keys.\nYou create a dictionary by enclosing the values in curly braces ({ }), like this:\nstock = {\n\"name\"   : \"GOOG\",\n\"shares\" : 100,\n\"price\"  : 490.10\n}\nTo access members of a dictionary, use the key-indexing operator as follows:\nname  = stock[\"name\"]\nvalue = stock[\"shares\"] * shares[\"price\"]\nInserting or modifying objects works like this:\nstock[\"shares\"] = 75\nstock[\"date\"]   = \"June 7, 2007\"\nAlthough strings are the most common type of key, you can use many other Python\nobjects, including numbers and tuples. Some objects, including lists and dictionaries,\ncannot be used as keys because their contents can change.\nA dictionary is a useful way to define an object that consists of named fields as\nshown previously. However, dictionaries are also used as a container for performing fast\nlookups on unordered data. For example, here’s a dictionary of stock prices:\nprices = {\n\"GOOG\" : 490.10,\n\"AAPL\" : 123.50,\n\"IBM\"  : 91.50,\n\"MSFT\" : 52.13\n}\nAn empty dictionary is created in one of two ways:\nprices = {}     # An empty dict\nprices = dict() # An empty dict\nDictionary membership is tested with the in operator, as in the following example:\nif \"SCOX\" in prices:\np = prices[\"SCOX\"]\nelse:\np = 0.0\nThis particular sequence of steps can also be performed more compactly as follows:\np = prices.get(\"SCOX\",0.0)\nTo obtain a list of dictionary keys, convert a dictionary to a list:\nsyms = list(prices)         # syms = [\"AAPL\", \"MSFT\", \"IBM\", \"GOOG\"]\nUse the del statement to remove an element of a dictionary:\ndel prices[\"MSFT\"]\nDictionaries are probably the most finely tuned data type in the Python interpreter. So,\nif you are merely trying to store and work with data in your program, you are almost\nalways better off using a dictionary than trying to come up with some kind of custom\ndata structure on your own.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1969,
      "extraction_method": "Direct"
    },
    {
      "page_number": 42,
      "chapter": null,
      "content": "17\nIteration and Looping\nIteration and Looping\nThe most widely used looping construct is the for statement, which is used to iterate\nover a collection of items. Iteration is one of Python’s richest features. However, the\nmost common form of iteration is to simply loop over all the members of a sequence\nsuch as a string, list, or tuple. Here’s an example:\nfor n in [1,2,3,4,5,6,7,8,9]:\nprint \"2 to the %d power is %d\" % (n, 2**n)\nIn this example, the variable n will be assigned successive items from the list\n[1,2,3,4,…,9] on each iteration. Because looping over ranges of integers is quite\ncommon, the following shortcut is often used for that purpose:\nfor n in range(1,10):\nprint \"2 to the %d power is %d\" % (n, 2**n)\nThe range(i,j [,stride]) function creates an object that represents a range of inte-\ngers with values i to j-1. If the starting value is omitted, it’s taken to be zero.An\noptional stride can also be given as a third argument. Here’s an example:\na = range(5)         # a = 0,1,2,3,4\nb = range(1,8)       # b = 1,2,3,4,5,6,7\nc = range(0,14,3)    # c = 0,3,6,9,12\nd = range(8,1,-1)    # d = 8,7,6,5,4,3,2\nOne caution with range() is that in Python 2, the value it creates is a fully populated\nlist with all of the integer values. For extremely large ranges, this can inadvertently con-\nsume all available memory.Therefore, in older Python code, you will see programmers\nusing an alternative function xrange(). For example:\nfor i in xrange(100000000):    # i = 0,1,2,...,99999999\nstatements\nThe object created by xrange() computes the values it represents on demand when\nlookups are requested. For this reason, it is the preferred way to represent extremely\nlarge ranges of integer values. In Python 3, the xrange() function has been renamed to\nrange() and the functionality of the old range() function has been removed.\nThe for statement is not limited to sequences of integers and can be used to iterate\nover many kinds of objects including strings, lists, dictionaries, and files. Here’s an \nexample:\na = \"Hello World\"\n# Print out the individual characters in a\nfor c in a:\nprint c\nb = [\"Dave\",\"Mark\",\"Ann\",\"Phil\"]\n# Print out the members of a list\nfor name in b:\nprint name\nc = { 'GOOG' : 490.10, 'IBM' : 91.50, 'AAPL' : 123.15 }\n# Print out all of the members of a dictionary\nfor key in c:\nprint key, c[key]\n# Print all of the lines in a file\nf = open(\"foo.txt\")\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2408,
      "extraction_method": "Direct"
    },
    {
      "page_number": 43,
      "chapter": null,
      "content": "18\nChapter 1\nA Tutorial Introduction\nfor line in f:\nprint line,\nThe for loop is one of Python’s most powerful language features because you can cre-\nate custom iterator objects and generator functions that supply it with sequences of val-\nues. More details about iterators and generators can be found later in this chapter and in\nChapter 6,“Functions and Functional Programming.”\nFunctions\nYou use the def statement to create a function, as shown in the following example:\ndef remainder(a,b):\nq = a // b       # // is truncating division.\nr = a - q*b\nreturn r\nTo invoke a function, simply use the name of the function followed by its arguments\nenclosed in parentheses, such as result = remainder(37,15).You can use a tuple to\nreturn multiple values from a function, as shown here:\ndef divide(a,b):\nq = a // b        # If a and b are integers, q is integer\nr = a - q*b\nreturn (q,r)\nWhen returning multiple values in a tuple, you can easily unpack the result into sepa-\nrate variables like this:\nquotient, remainder = divide(1456,33)\nTo assign a default value to a function parameter, use assignment:\ndef connect(hostname,port,timeout=300):\n# Function body\nWhen default values are given in a function definition, they can be omitted from subse-\nquent function calls.When omitted, the argument will simply take on the default value.\nHere’s an example:\nconnect('www.python.org', 80)\nYou also can invoke functions by using keyword arguments and supplying the argu-\nments in arbitrary order. However, this requires you to know the names of the argu-\nments in the function definition. Here’s an example:\nconnect(port=80,hostname=\"www.python.org\")\nWhen variables are created or assigned inside a function, their scope is local.That is, the\nvariable is only defined inside the body of the function and is destroyed when the func-\ntion returns.To modify the value of a global variable from inside a function, use the\nglobal statement as follows:\ncount = 0\n...\ndef foo():\nglobal count\ncount += 1             # Changes the global variable count\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2055,
      "extraction_method": "Direct"
    },
    {
      "page_number": 44,
      "chapter": null,
      "content": "19\nGenerators\nGenerators\nInstead of returning a single value, a function can generate an entire sequence of results\nif it uses the yield statement. For example:\ndef countdown(n):\nprint \"Counting down!\"\nwhile n > 0:\nyield n       # Generate a value (n)\nn -= 1\nAny function that uses yield is known as a generator. Calling a generator function cre-\nates an object that produces a sequence of results through successive calls to a next()\nmethod (or __next__() in Python 3). For example:\n>>> c = countdown(5)\n>>> c.next()\nCounting down!\n5\n>>> c.next()\n4\n>>> c.next()\n3\n>>>\nThe next() call makes a generator function run until it reaches the next yield state-\nment.At this point, the value passed to yield is returned by next(), and the function\nsuspends execution.The function resumes execution on the statement following yield\nwhen next() is called again.This process continues until the function returns.\nNormally you would not manually call next() as shown. Instead, you hook it up to\na for loop like this:\n>>> for i in countdown(5):\n...\nprint i,\nCounting down!\n5 4 3 2 1 \n>>>\nGenerators are an extremely powerful way of writing programs based on processing\npipelines, streams, or data flow. For example, the following generator function mimics\nthe behavior of the UNIX tail -f command that’s commonly used to monitor log\nfiles:\n# tail a file (like tail -f)\nimport time\ndef tail(f):\nf.seek(0,2)     # Move to EOF\nwhile True:\nline = f.readline()     # Try reading a new line of text\nif not line:            # If nothing, sleep briefly and try again\ntime.sleep(0.1)\ncontinue\nyield line\nHere’s a generator that looks for a specific substring in a sequence of lines:\ndef grep(lines, searchtext):\nfor line in lines:\nif searchtext in line: yield line\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1766,
      "extraction_method": "Direct"
    },
    {
      "page_number": 45,
      "chapter": null,
      "content": "20\nChapter 1\nA Tutorial Introduction\nHere’s an example of hooking both of these generators together to create a simple pro-\ncessing pipeline:\n# A python implementation of Unix \"tail -f | grep python\"\nwwwlog  = tail(open(\"access-log\"))\npylines = grep(wwwlog,\"python\")\nfor line in pylines:\nprint line,\nA subtle aspect of generators is that they are often mixed together with other iterable\nobjects such as lists or files. Specifically, when you write a statement such as for item\nin s, s could represent a list of items, the lines of a file, the result of a generator func-\ntion, or any number of other objects that support iteration.The fact that you can just\nplug different objects in for s can be a powerful tool for creating extensible programs.\nCoroutines\nNormally, functions operate on a single set of input arguments. However, a function can\nalso be written to operate as a task that processes a sequence of inputs sent to it.This\ntype of function is known as a coroutine and is created by using the yield statement as\nan expression (yield) as shown in this example:\ndef print_matches(matchtext):\nprint \"Looking for\", matchtext\nwhile True:\nline = (yield)       # Get a line of text\nif matchtext in line:\nprint line\nTo use this function, you first call it, advance it to the first (yield), and then start\nsending data to it using send(). For example:\n>>> matcher = print_matches(\"python\")\n>>> matcher.next()\n# Advance to the first (yield)\nLooking for python\n>>> matcher.send(\"Hello World\")\n>>> matcher.send(\"python is cool\")\npython is cool\n>>> matcher.send(\"yow!\")\n>>> matcher.close()\n# Done with the matcher function call\n>>>\nA coroutine is suspended until a value is sent to it using send().When this happens,\nthat value is returned by the (yield) expression inside the coroutine and is processed\nby the statements that follow. Processing continues until the next (yield) expression is\nencountered—at which point the function suspends.This continues until the coroutine\nfunction returns or close() is called on it as shown in the previous example.\nCoroutines are useful when writing concurrent programs based on producer-\nconsumer problems where one part of a program is producing data to be consumed by\nanother part of the program. In this model, a coroutine represents a consumer of data.\nHere is an example of using generators and coroutines together:\n# A set of matcher coroutines\nmatchers = [\nprint_matches(\"python\"),\nprint_matches(\"guido\"),\nprint_matches(\"jython\")\n]\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2501,
      "extraction_method": "Direct"
    },
    {
      "page_number": 46,
      "chapter": null,
      "content": "21\nObjects and Classes\n# Prep all of the matchers by calling next()\nfor m in matchers: m.next()\n# Feed an active log file into all matchers.  Note for this to work,\n# a web server must be actively writing data to the log.\nwwwlog  = tail(open(\"access-log\"))\nfor line in wwwlog:\nfor m in matchers:\nm.send(line)       # Send data into each matcher coroutine\nFurther details about coroutines can be found in Chapter 6.\nObjects and Classes\nAll values used in a program are objects.An object consists of internal data and methods\nthat perform various kinds of operations involving that data.You have already used\nobjects and methods when working with the built-in types such as strings and lists. For\nexample:\nitems = [37, 42]    # Create a list object\nitems.append(73)    # Call the append() method\nThe dir() function lists the methods available on an object and is a useful tool for\ninteractive experimentation. For example:\n>>> items = [37, 42]\n>>> dir(items)\n['_ _add_ _', '_ _class_ _', '_ _contains_ _', '_ _delattr_ _', '_ _delitem_ _',\n...\n'append', 'count', 'extend', 'index', 'insert', 'pop',\n'remove', 'reverse', 'sort']\n>>>\nWhen inspecting objects, you will see familiar methods such as append() and\ninsert() listed. However, you will also see special methods that always begin and end\nwith a double underscore.These methods implement various language operations. For\nexample, the _ _add_ _() method implements the + operator:\n>>> items._ _add_ _([73,101])\n[37, 42, 73, 101]\n>>>\nThe class statement is used to define new types of objects and for object-oriented\nprogramming. For example, the following class defines a simple stack with push(),\npop(), and length() operations:\nclass Stack(object):\ndef _ _init_ _(self):              # Initialize the stack\nself.stack = [ ]\ndef push(self,object):\nself.stack.append(object)\ndef pop(self):\nreturn self.stack.pop()\ndef length(self):\nreturn len(self.stack)\nIn the first line of the class definition, the statement class Stack(object) declares\nStack to be an object.The use of parentheses is how Python specifies inheritance—in\nthis case, Stack inherits from object, which is the root of all Python types. Inside the\nclass definition, methods are defined using the def statement.The first argument in each\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2277,
      "extraction_method": "Direct"
    },
    {
      "page_number": 47,
      "chapter": null,
      "content": "22\nChapter 1\nA Tutorial Introduction\nmethod always refers to the object itself. By convention, self is the name used for this\nargument.All operations involving the attributes of an object must explicitly refer to the\nself variable. Methods with leading and trailing double underscores are special meth-\nods. For example, _ _init_ _ is used to initialize an object after it’s created.\nTo use a class, write code such as the following:\ns = Stack()           # Create a stack\ns.push(\"Dave\")        # Push some things onto it\ns.push(42)\ns.push([3,4,5])\nx = s.pop()           # x gets [3,4,5]\ny = s.pop()           # y gets 42\ndel s                 # Destroy s\nIn this example, an entirely new object was created to implement the stack. However, a\nstack is almost identical to the built-in list object.Therefore, an alternative approach\nwould be to inherit from list and add an extra method:\nclass Stack(list):\n# Add push() method for stack interface\n# Note: lists already provide a pop() method.\ndef push(self,object):\nself.append(object)\nNormally, all of the methods defined within a class apply only to instances of that class\n(that is, the objects that are created). However, different kinds of methods can be\ndefined such as static methods familiar to C++ and Java programmers. For example:\nclass EventHandler(object):\n@staticmethod\ndef dispatcherThread():\nwhile (1):\n# Wait for requests\n...\nEventHandler.dispatcherThread()          # Call method like a function\nIn this case, @staticmethod declares the method that follows to be a static method.\n@staticmethod is an example of using an a decorator, a topic that is discussed further in\nChapter 6.\nExceptions\nIf an error occurs in your program, an exception is raised and a traceback message such\nas the following appears:\nTraceback (most recent call last):\nFile \"foo.py\", line 12, in <module>\nIOError: [Errno 2] No such file or directory: 'file.txt'\nThe traceback message indicates the type of error that occurred, along with its location.\nNormally, errors cause a program to terminate. However, you can catch and handle\nexceptions using try and except statements, like this:\ntry:\nf = open(\"file.txt\",\"r\")\nexcept IOError as e:\nprint e\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2208,
      "extraction_method": "Direct"
    },
    {
      "page_number": 48,
      "chapter": null,
      "content": "23\nModules\nIf an IOError occurs, details concerning the cause of the error are placed in e and con-\ntrol passes to the code in the except block. If some other kind of exception is raised,\nit’s passed to the enclosing code block (if any). If no errors occur, the code in the\nexcept block is ignored.When an exception is handled, program execution resumes\nwith the statement that immediately follows the last except block.The program does\nnot return to the location where the exception occurred.\nThe raise statement is used to signal an exception.When raising an exception, you\ncan use one of the built-in exceptions, like this:\nraise RuntimeError(\"Computer says no\")\nOr you can create your own exceptions, as described in the section “Defining New\nExceptions” in Chapter 5,“ Program Structure and Control Flow.”\nProper management of system resources such as locks, files, and network connections\nis often a tricky problem when combined with exception handling.To simplify such\nprogramming, you can use the with statement with certain kinds of objects. Here is an\nexample of writing code that uses a mutex lock:\nimport threading\nmessage_lock = threading.Lock()\n...\nwith message_lock:\nmessages.add(newmessage)\nIn this example, the message_lock object is automatically acquired when the with\nstatement executes.When execution leaves the context of the with block, the lock is\nautomatically released.This management takes place regardless of what happens inside\nthe with block. For example, if an exception occurs, the lock is released when control\nleaves the context of the block.\nThe with statement is normally only compatible with objects related to system\nresources or the execution environment such as files, connections, and locks. However,\nuser-defined objects can define their own custom processing.This is covered in more\ndetail in the “Context Management Protocol” section of Chapter 3,“Types and\nObjects.”\nModules\nAs your programs grow in size, you will want to break them into multiple files for easi-\ner maintenance.To do this, Python allows you to put definitions in a file and use them\nas a module that can be imported into other programs and scripts.To create a module,\nput the relevant statements and definitions into a file that has the same name as the\nmodule. (Note that the file must have a .py suffix.) Here’s an example:\n# file :  div.py\ndef divide(a,b):\nq = a/b        # If a and b are integers, q is an integer\nr = a - q*b\nreturn (q,r)\nTo use your module in other programs, you can use the import statement:\nimport div\na, b = div.divide(2305, 29)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2589,
      "extraction_method": "Direct"
    },
    {
      "page_number": 49,
      "chapter": null,
      "content": "24\nChapter 1\nA Tutorial Introduction\nThe import statement creates a new namespace and executes all the statements in the\nassociated .py file within that namespace.To access the contents of the namespace after\nimport, simply use the name of the module as a prefix, as in div.divide() in the pre-\nceding example.\nIf you want to import a module using a different name, supply the import statement\nwith an optional as qualifier, as follows:\nimport div as foo\na,b = foo.divide(2305,29)\nTo import specific definitions into the current namespace, use the from statement:\nfrom div import divide\na,b = divide(2305,29)       # No longer need the div prefix\nTo load all of a module’s contents into the current namespace, you can also use the \nfollowing:\nfrom div import *\nAs with objects, the dir() function lists the contents of a module and is a useful tool\nfor interactive experimentation:\n>>> import string\n>>> dir(string)\n['_ _builtins_ _', '_ _doc_ _', '_ _file_ _', '_ _name_ _', '_idmap',\n'_idmapL', '_lower', '_swapcase', '_upper', 'atof', 'atof_error',\n'atoi', 'atoi_error', 'atol', 'atol_error', 'capitalize',\n'capwords', 'center', 'count', 'digits', 'expandtabs', 'find',\n...\n>>>\nGetting Help\nWhen working with Python, you have several sources of quickly available information.\nFirst, when Python is running in interactive mode, you can use the help() command\nto get information about built-in modules and other aspects of Python. Simply type\nhelp() by itself for general information or help('modulename') for information\nabout a specific module.The help() command can also be used to return information\nabout specific functions if you supply a function name.\nMost Python functions have documentation strings that describe their usage.To\nprint the doc string, simply print the _ _doc_ _ attribute. Here’s an example:\n>>> print issubclass._ _doc_ _\nissubclass(C, B) -> bool\nReturn whether class C is a subclass (i.e., a derived class) of class B.\nWhen using a tuple as the second argument issubclass(X, (A, B, ...)),\nis a shortcut for issubclass(X, A) or issubclass(X, B) or ... (etc.).\n>>>\nLast, but not least, most Python installations also include the command pydoc, which\ncan be used to return documentation about Python modules. Simply type pydoc\ntopic at a system command prompt.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2308,
      "extraction_method": "Direct"
    },
    {
      "page_number": 50,
      "chapter": null,
      "content": "2\nLexical Conventions and\nSyntax\nThis chapter describes the syntactic and lexical conventions of a Python program.\nTopics include line structure, grouping of statements, reserved words, literals, operators,\ntokens, and source code encoding.\nLine Structure and Indentation\nEach statement in a program is terminated with a newline. Long statements can span\nmultiple lines by using the line-continuation character (\\), as shown in the following\nexample:\na = math.cos(3 * (x - n)) + \\\nmath.sin(3 * (y - n))\nYou don’t need the line-continuation character when the definition of a triple-quoted\nstring, list, tuple, or dictionary spans multiple lines. More generally, any part of a pro-\ngram enclosed in parentheses (...), brackets [...], braces {...}, or triple quotes can\nspan multiple lines without use of the line-continuation character because they clearly\ndenote the start and end of a definition.\nIndentation is used to denote different blocks of code, such as the bodies of func-\ntions, conditionals, loops, and classes.The amount of indentation used for the first state-\nment of a block is arbitrary, but the indentation of the entire block must be consistent.\nHere’s an example:\nif a:\nstatement1\n# Consistent indentation\nstatement2\nelse:\nstatement3\nstatement4\n# Inconsistent indentation (error)\nIf the body of a function, conditional, loop, or class is short and contains only a single\nstatement, it can be placed on the same line, like this:\nif a:  statement1\nelse:  statement2\nTo denote an empty body or block, use the pass statement. Here’s an example:\nif a:\npass\nelse:\nstatements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1610,
      "extraction_method": "Direct"
    },
    {
      "page_number": 51,
      "chapter": null,
      "content": "26\nChapter 2 Lexical Conventions and Syntax\nAlthough tabs can be used for indentation, this practice is discouraged.The use of spaces\nis universally preferred (and encouraged) by the Python programming community.\nWhen tab characters are encountered, they’re converted into the number of spaces\nrequired to move to the next column that’s a multiple of 8 (for example, a tab appear-\ning in column 11 inserts enough spaces to move to column 16). Running Python with\nthe -t option prints warning messages when tabs and spaces are mixed inconsistently\nwithin the same program block.The -tt option turns these warning messages into\nTabError exceptions.\nTo place more than one statement on a line, separate the statements with a semi-\ncolon (;).A line containing a single statement can also be terminated by a semicolon,\nalthough this is unnecessary.\nThe # character denotes a comment that extends to the end of the line.A # appear-\ning inside a quoted string doesn’t start a comment, however.\nFinally, the interpreter ignores all blank lines except when running in interactive\nmode. In this case, a blank line signals the end of input when typing a statement that\nspans multiple lines.\nIdentifiers and Reserved Words\nAn identifier is a name used to identify variables, functions, classes, modules, and other\nobjects. Identifiers can include letters, numbers, and the underscore character (_) but\nmust always start with a nonnumeric character. Letters are currently confined to the\ncharacters A–Z and a–z in the ISO–Latin character set. Because identifiers are case-\nsensitive, FOO is different from foo. Special symbols such as $, %, and @ are not allowed\nin identifiers. In addition, words such as if, else, and for are reserved and cannot be\nused as identifier names.The following list shows all the reserved words:\nand\ndel\nfrom\nnonlocal\ntry\nas\nelif\nglobal\nnot\nwhile\nassert\nelse\nif\nor\nwith\nbreak\nexcept\nimport\npass\nyield\nclass\nexec\nin\nprint\ncontinue\nfinally\nis\nraise\ndef\nfor\nlambda\nreturn\nIdentifiers starting or ending with underscores often have special meanings. For exam-\nple, identifiers starting with a single underscore such as _foo are not imported by the\nfrom module import * statement. Identifiers with leading and trailing double under-\nscores such as _ _init_ _ are reserved for special methods, and identifiers with leading\ndouble underscores such as _ _bar are used to implement private class members, as\ndescribed in Chapter 7,“Classes and Object-Oriented Programming.” General-purpose\nuse of similar identifiers should be avoided.\nNumeric Literals\nThere are four types of built-in numeric literals:\nn Booleans\nn Integers\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2655,
      "extraction_method": "Direct"
    },
    {
      "page_number": 52,
      "chapter": null,
      "content": "27\nString Literals\nn Floating-point numbers\nn Complex numbers\nThe identifiers True and False are interpreted as Boolean values with the integer val-\nues of 1 and 0, respectively.A number such as 1234 is interpreted as a decimal integer.\nTo specify an integer using octal, hexadecimal, or binary notation, precede the value\nwith 0, 0x, or 0b, respectively (for example, 0644, 0x100fea8, or 0b11101010).\nIntegers in Python can have an arbitrary number of digits, so if you want to specify a\nreally large integer, just write out all of the digits, as in 12345678901234567890.\nHowever, when inspecting values and looking at old Python code, you might see large\nnumbers written with a trailing l (lowercase L) or L character, as in\n12345678901234567890L.This trailing L is related to the fact that Python internally\nrepresents integers as either a fixed-precision machine integer or an arbitrary precision\nlong integer type depending on the magnitude of the value. In older versions of\nPython, you could explicitly choose to use either type and would add the trailing L to\nexplicitly indicate the long type.Today, this distinction is unnecessary and is actively dis-\ncouraged. So, if you want a large integer value, just write it without the L.\nNumbers such as 123.34 and 1.2334e+02 are interpreted as floating-point num-\nbers.An integer or floating-point number with a trailing j or J, such as 12.34J, is an\nimaginary number.You can create complex numbers with real and imaginary parts by\nadding a real number and an imaginary number, as in 1.2 + 12.34J.\nString Literals\nString literals are used to specify a sequence of characters and are defined by enclosing\ntext in single ('), double (\"), or triple (''' or \"\"\") quotes.There is no semantic differ-\nence between quoting styles other than the requirement that you use the same type of\nquote to start and terminate a string. Single- and double-quoted strings must be defined\non a single line, whereas triple-quoted strings can span multiple lines and include all of\nthe enclosed formatting (that is, newlines, tabs, spaces, and so on).Adjacent strings (sepa-\nrated by white space, newline, or a line-continuation character) such as \"hello\"\n'world' are concatenated to form a single string \"helloworld\".\nWithin string literals, the backslash (\\) character is used to escape special characters\nsuch as newlines, the backslash itself, quotes, and nonprinting characters.Table 2.1 shows\nthe accepted escape codes. Unrecognized escape sequences are left in the string unmod-\nified and include the leading backslash.\nTable 2.1\nStandard Character Escape Codes\nCharacter\nDescription\n\\\nNewline continuation\n\\\\\nBackslash\n\\'\nSingle quote\n\\\"\nDouble quote\n\\a\nBell\n\\b\nBackspace\n\\e\nEscape\n\\0\nNull\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2751,
      "extraction_method": "Direct"
    },
    {
      "page_number": 53,
      "chapter": null,
      "content": "28\nChapter 2 Lexical Conventions and Syntax\nTable 2.1\nContinued\nCharacter\nDescription\n\\n\nLine feed\n\\v\nVertical tab\n\\t\nHorizontal tab\n\\r\nCarriage return\n\\f\nForm feed\n\\OOO\nOctal value (\\000 to \\377)\n\\uxxxx\nUnicode character (\\u0000 to \\uffff)\n\\Uxxxxxxxx\nUnicode character (\\U00000000 to \\Uffffffff)\n\\N{charname}\nUnicode character name\n\\xhh\nHexadecimal value (\\x00 to \\xff)\nThe escape codes \\OOO and \\x are used to embed characters into a string literal that\ncan’t be easily typed (that is, control codes, nonprinting characters, symbols, internation-\nal characters, and so on). For these escape codes, you have to specify an integer value\ncorresponding to a character value. For example, if you wanted to write a string literal\nfor the word “Jalapeño”, you might write it as \"Jalape\\xf1o\" where \\xf1 is the char-\nacter code for ñ.\nIn Python 2 string literals correspond to 8-bit character or byte-oriented data.A\nserious limitation of these strings is that they do not fully support international charac-\nter sets and Unicode.To address this limitation, Python 2 uses a separate string type for\nUnicode data.To write a Unicode string literal, you prefix the first quote with the letter\n“u”. For example:\ns = u\"Jalape\\u00f1o\"\nIn Python 3, this prefix character is unnecessary (and is actually a syntax error) as all\nstrings are already Unicode. Python 2 will emulate this behavior if you run the inter-\npreter with the -U option (in which case all string literals will be treated as Unicode\nand the u prefix can be omitted).\nRegardless of which Python version you are using, the escape codes of \\u, \\U, and\n\\N in Table 2.1 are used to insert arbitrary characters into a Unicode literal. Every\nUnicode character has an assigned code point, which is typically denoted in Unicode\ncharts as U+XXXX where XXXX is a sequence of four or more hexadecimal digits. (Note\nthat this notation is not Python syntax but is often used by authors when describing\nUnicode characters.) For example, the character ñ has a code point of U+00F1.The \\u\nescape code is used to insert Unicode characters with code points in the range U+0000\nto U+FFFF (for example, \\u00f1).The \\U escape code is used to insert characters in the\nrange U+10000 and above (for example, \\U00012345). One subtle caution concerning\nthe \\U escape code is that Unicode characters with code points above U+10000 usually\nget decomposed into a pair of characters known as a surrogate pair.This has to do with\nthe internal representation of Unicode strings and is covered in more detail in Chapter\n3,“Types and Objects.”\nUnicode characters also have a descriptive name. If you know the name, you can use\nthe \\N{character name} escape sequence. For example:\ns = u\"Jalape\\N{LATIN SMALL LETTER N WITH TILDE}o\"\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2772,
      "extraction_method": "Direct"
    },
    {
      "page_number": 54,
      "chapter": null,
      "content": "29\nContainers\nFor an authoritative reference on code points and character names, consult\nhttp://www.unicode.org/charts.\nOptionally, you can precede a string literal with an r or R, such as in r'\\d'.These\nstrings are known as raw strings because all their backslash characters are left intact—that is,\nthe string literally contains the enclosed text, including the backslashes.The main use of raw\nstrings is to specify literals where the backslash character has some significance. Examples\nmight include the specification of regular expression patterns with the re module or speci-\nfying a filename on a Windows machine (for example, r'c:\\newdata\\tests').\nRaw strings cannot end in a single backslash, such as r\"\\\".Within raw strings,\n\\uXXXX escape sequences are still interpreted as Unicode characters, provided that the\nnumber of preceding \\ characters is odd. For instance, ur\"\\u1234\" defines a raw\nUnicode string with the single character U+1234, whereas ur\"\\\\u1234\" defines a\nseven-character string in which the first two characters are slashes and the remaining five\ncharacters are the literal \"u1234\".Also, in Python 2.2, the r must appear after the u in\nraw Unicode strings as shown. In Python 3.0, the u prefix is unnecessary.\nString literals should not be defined using a sequence of raw bytes that correspond to\na data encoding such as UTF-8 or UTF-16. For example, directly writing a raw UTF-8\nencoded string such as 'Jalape\\xc3\\xb1o' simply produces a nine-character string\nU+004A, U+0061, U+006C, U+0061, U+0070, U+0065, U+00C3, U+00B1,\nU+006F, which is probably not what you intended.This is because in UTF-8, the multi-\nbyte sequence \\xc3\\xb1 is supposed to represent the single character U+00F1, not the\ntwo characters U+00C3 and U+00B1.To specify an encoded byte string as a literal, pre-\nfix the first quote with a \"b\" as in b\"Jalape\\xc3\\xb1o\".When defined, this literally\ncreates a string of single bytes. From this representation, it is possible to create a normal\nstring by decoding the value of the byte literal with its decode() method. More details\nabout this are covered in Chapter 3 and Chapter 4,“Operators and Expressions.”\nThe use of byte literals is quite rare in most programs because this syntax did not\nappear until Python 2.6, and in that version there is no difference between a byte literal\nand a normal string. In Python 3, however, byte literals are mapped to a new bytes\ndatatype that behaves differently than a normal string (see Appendix A,“Python 3”).\nContainers\nValues enclosed in square brackets [...], parentheses (...), and braces {...} denote a\ncollection of objects contained in a list, tuple, and dictionary, respectively, as in the fol-\nlowing example:\na = [ 1, 3.4, 'hello' ]           # A list\nb = ( 10, 20, 30 )                # A tuple\nc = { 'a': 3, 'b': 42 }           # A dictionary\nList, tuple, and dictionary literals can span multiple lines without using the line-\ncontinuation character (\\). In addition, a trailing comma is allowed on the last item. For\nexample:\na = [ 1, \n3.4,\n'hello',\n]\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3072,
      "extraction_method": "Direct"
    },
    {
      "page_number": 55,
      "chapter": null,
      "content": "30\nChapter 2 Lexical Conventions and Syntax\nOperators, Delimiters, and Special Symbols\nThe following operators are recognized:\n+    -    *    **    /    //    %    <<    >>    &    |\n^\n~\n<     >    <=   >=    ==   !=    <>   +=\n-=   *=   /=   //=   %=  **=   &=    |=   ^=    >>=  <<=\nThe following tokens serve as delimiters for expressions, lists, dictionaries, and various\nparts of a statement:\n(    )    [    ]    {    }   ,    :    .    `    =    ;\nFor example, the equal (=) character serves as a delimiter between the name and value\nof an assignment, whereas the comma (,) character is used to delimit arguments to a\nfunction, elements in lists and tuples, and so on.The period (.) is also used in floating-\npoint numbers and in the ellipsis (...) used in extended slicing operations.\nFinally, the following special symbols are also used:\n'     \"     #     \\    @\nThe characters $ and ? have no meaning in Python and cannot appear in a program\nexcept inside a quoted string literal.\nDocumentation Strings\nIf the first statement of a module, class, or function definition is a string, that string\nbecomes a documentation string for the associated object, as in the following example:\ndef fact(n):\n\"This function computes a factorial\"\nif (n <= 1): return 1\nelse: return n * fact(n - 1)\nCode-browsing and documentation-generation tools sometimes use documentation\nstrings.The strings are accessible in the _ _doc_ _ attribute of an object, as shown here:\n>>> print fact._ _doc_ _\nThis function computes a factorial\n>>>\nThe indentation of the documentation string must be consistent with all the other\nstatements in a definition. In addition, a documentation string cannot be computed or\nassigned from a variable as an expression.The documentation string always has to be a\nstring literal enclosed in quotes.\nDecorators\nFunction, method, or class definitions may be preceded by a special symbol known as a\ndecorator, the purpose of which is to modify the behavior of the definition that follows.\nDecorators are denoted with the @ symbol and must be placed on a separate line imme-\ndiately before the corresponding function, method, or class. Here’s an example:\nclass Foo(object):\n@staticmethod\ndef bar():\npass\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2235,
      "extraction_method": "Direct"
    },
    {
      "page_number": 56,
      "chapter": null,
      "content": "31\nSource Code Encoding\nMore than one decorator can be used, but each one must be on a separate line. Here’s\nan example:\n@foo\n@bar\ndef spam():\npass\nMore information about decorators can be found in Chapter 6,“Functions and\nFunctional Programming,” and Chapter 7,“Classes and Object-Oriented\nProgramming.”\nSource Code Encoding\nPython source programs are normally written in standard 7-bit ASCII. However, users\nworking in Unicode environments may find this awkward—especially if they must\nwrite a lot of string literals with international characters.\nIt is possible to write Python source code in a different encoding by including a spe-\ncial encoding comment in the first or second line of a Python program:\n#!/usr/bin/env python\n# -*- coding: UTF-8 -*-\ns = \"Jalapeño\"  # String in quotes is directly encoded in UTF-8.\nWhen the special coding: comment is supplied, string literals may be typed in directly\nusing a Unicode-aware editor. However, other elements of Python, including identifier\nnames and reserved words, should still be restricted to ASCII characters.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1088,
      "extraction_method": "Direct"
    },
    {
      "page_number": 57,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 58,
      "chapter": null,
      "content": "3\nTypes and Objects\nAll the data stored in a Python program is built around the concept of an object.\nObjects include fundamental data types such as numbers, strings, lists, and dictionaries.\nHowever, it’s also possible to create user-defined objects in the form of classes. In addi-\ntion, most objects related to program structure and the internal operation of the inter-\npreter are also exposed.This chapter describes the inner workings of the Python object\nmodel and provides an overview of the built-in data types. Chapter 4,“Operators and\nExpressions,” further describes operators and expressions. Chapter 7,“Classes and\nObject-Oriented Programming,” describes how to create user-defined objects.\nTerminology\nEvery piece of data stored in a program is an object. Each object has an identity, a type\n(which is also known as its class), and a value. For example, when you write a = 42, an\ninteger object is created with the value of 42.You can view the identity of an object as a\npointer to its location in memory. a is a name that refers to this specific location.\nThe type of an object, also known as the object’s class, describes the internal repre-\nsentation of the object as well as the methods and operations that it supports.When an\nobject of a particular type is created, that object is sometimes called an instance of that\ntype.After an instance is created, its identity and type cannot be changed. If an object’s\nvalue can be modified, the object is said to be mutable. If the value cannot be modified,\nthe object is said to be immutable.An object that contains references to other objects is\nsaid to be a container or collection.\nMost objects are characterized by a number of data attributes and methods.An attrib-\nute is a value associated with an object.A method is a function that performs some sort\nof operation on an object when the method is invoked as a function.Attributes and\nmethods are accessed using the dot (.) operator, as shown in the following example:\na = 3 + 4j          # Create a complex number\nr = a.real          # Get the real part (an attribute)\nb = [1, 2, 3]       # Create a list\nb.append(7)         # Add a new element using the append method\nObject Identity and Type\nThe built-in function id() returns the identity of an object as an integer.This integer\nusually corresponds to the object’s location in memory, although this is specific to the\nPython implementation and no such interpretation of the identity should be made.The\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2492,
      "extraction_method": "Direct"
    },
    {
      "page_number": 59,
      "chapter": null,
      "content": "34\nChapter 3 Types and Objects\nis operator compares the identity of two objects.The built-in function type() returns\nthe type of an object. Here’s an example of different ways you might compare two\nobjects:\n# Compare two objects\ndef compare(a,b):\nif a is b:\n# a and b are the same object\nstatements\nif a == b:\n# a and b have the same value\nstatements\nif type(a) is type(b):\n# a and b have the same type\nstatements\nThe type of an object is itself an object known as the object’s class.This object is\nuniquely defined and is always the same for all instances of a given type.Therefore, the\ntype can be compared using the is operator.All type objects are assigned names that\ncan be used to perform type checking. Most of these names are built-ins, such as list,\ndict, and file. Here’s an example:\nif type(s) is list:\ns.append(item)\nif type(d) is dict:\nd.update(t)\nBecause types can be specialized by defining classes, a better way to check types is to\nuse the built-in isinstance(object, type) function. Here’s an example:\nif isinstance(s,list):\ns.append(item)\nif isinstance(d,dict):\nd.update(t)\nBecause the isinstance() function is aware of inheritance, it is the preferred way to\ncheck the type of any Python object.\nAlthough type checks can be added to a program, type checking is often not as use-\nful as you might imagine. For one, excessive checking severely affects performance.\nSecond, programs don’t always define objects that neatly fit into an inheritance hierar-\nchy. For instance, if the purpose of the preceding isinstance(s,list) statement is to\ntest whether s is “list-like,” it wouldn’t work with objects that had the same program-\nming interface as a list but didn’t directly inherit from the built-in list type.Another\noption for adding type-checking to a program is to define abstract base classes.This is\ndescribed in Chapter 7.\nReference Counting and Garbage Collection\nAll objects are reference-counted.An object’s reference count is increased whenever it’s\nassigned to a new name or placed in a container such as a list, tuple, or dictionary, as\nshown here:\na = 37       # Creates an object with value 37\nb = a        # Increases reference count on 37\nc = []\nc.append(b)  # Increases reference count on 37\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2249,
      "extraction_method": "Direct"
    },
    {
      "page_number": 60,
      "chapter": null,
      "content": "35\nReferences and Copies\nThis example creates a single object containing the value 37. a is merely a name that\nrefers to the newly created object.When b is assigned a, b becomes a new name for the\nsame object and the object’s reference count increases. Likewise, when you place b into\na list, the object’s reference count increases again.Throughout the example, only one\nobject contains 37.All other operations are simply creating new references to the\nobject.\nAn object’s reference count is decreased by the del statement or whenever a refer-\nence goes out of scope (or is reassigned). Here’s an example:\ndel a      # Decrease reference count of 37\nb = 42     # Decrease reference count of 37\nc[0] = 2.0 # Decrease reference count of 37\nThe current reference count of an object can be obtained using the \nsys.getrefcount() function. For example:\n>>> a = 37\n>>> import sys\n>>> sys.getrefcount(a)\n7\n>>>\nIn many cases, the reference count is much higher than you might guess. For immutable\ndata such as numbers and strings, the interpreter aggressively shares objects between dif-\nferent parts of the program in order to conserve memory.\nWhen an object’s reference count reaches zero, it is garbage-collected. However, in\nsome cases a circular dependency may exist among a collection of objects that are no\nlonger in use. Here’s an example:\na = { }\nb = { }\na['b'] = b      # a contains reference to b\nb['a'] = a      # b contains reference to a\ndel a\ndel b\nIn this example, the del statements decrease the reference count of a and b and destroy\nthe names used to refer to the underlying objects. However, because each object con-\ntains a reference to the other, the reference count doesn’t drop to zero and the objects\nremain allocated (resulting in a memory leak).To address this problem, the interpreter\nperiodically executes a cycle detector that searches for cycles of inaccessible objects and\ndeletes them.The cycle-detection algorithm runs periodically as the interpreter allocates\nmore and more memory during execution.The exact behavior can be fine-tuned and\ncontrolled using functions in the gc module (see Chapter 13,“Python Runtime\nServices”).\nReferences and Copies\nWhen a program makes an assignment such as a = b, a new reference to b is created.\nFor immutable objects such as numbers and strings, this assignment effectively creates a\ncopy of b. However, the behavior is quite different for mutable objects such as lists and\ndictionaries. Here’s an example:\n>>> a = [1,2,3,4]\n>>> b = a\n# b is a reference to a\n>>> b is a\nTrue\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2560,
      "extraction_method": "Direct"
    },
    {
      "page_number": 61,
      "chapter": null,
      "content": "36\nChapter 3 Types and Objects\n>>> b[2] = -100\n# Change an element in b\n>>> a\n# Notice how a also changed\n[1, 2, -100, 4]\n>>>\nBecause a and b refer to the same object in this example, a change made to one of the\nvariables is reflected in the other.To avoid this, you have to create a copy of an object\nrather than a new reference.\nTwo types of copy operations are applied to container objects such as lists and dic-\ntionaries: a shallow copy and a deep copy.A shallow copy creates a new object but popu-\nlates it with references to the items contained in the original object. Here’s an example:\n>>> a = [ 1, 2, [3,4] ]\n>>> b = list(a)\n# Create a shallow copy of a.\n>>> b is a\nFalse\n>>> b.append(100)\n# Append element to b.\n>>> b\n[1, 2, [3, 4], 100]\n>>> a\n# Notice that a is unchanged\n[1, 2, [3, 4]]\n>>> b[2][0] = -100\n# Modify an element inside b\n>>> b\n[1, 2, [-100, 4], 100]\n>>> a\n# Notice the change inside a\n[1, 2, [-100, 4]]\n>>>\nIn this case, a and b are separate list objects, but the elements they contain are shared.\nTherefore, a modification to one of the elements of a also modifies an element of b, as\nshown.\nA deep copy creates a new object and recursively copies all the objects it contains.\nThere is no built-in operation to create deep copies of objects. However, the\ncopy.deepcopy() function in the standard library can be used, as shown in the follow-\ning example:\n>>> import copy\n>>> a = [1, 2, [3, 4]]\n>>> b = copy.deepcopy(a)\n>>> b[2][0] = -100\n>>> b\n[1, 2, [-100, 4]]\n>>> a\n# Notice that a is unchanged\n[1, 2, [3, 4]]\n>>>\nFirst-Class Objects\nAll objects in Python are said to be “first class.”This means that all objects that can be\nnamed by an identifier have equal status. It also means that all objects that can be\nnamed can be treated as data. For example, here is a simple dictionary containing two\nvalues:\nitems = {\n'number' : 42\n'text' : \"Hello World\"\n}\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1903,
      "extraction_method": "Direct"
    },
    {
      "page_number": 62,
      "chapter": null,
      "content": "37\nBuilt-in Types for Representing Data\nThe first-class nature of objects can be seen by adding some more unusual items to this\ndictionary. Here are some examples:\nitems[\"func\"]  = abs            # Add the abs() function\nimport math\nitems[\"mod\"]   = math           # Add a module\nitems[\"error\"] = ValueError     # Add an exception type\nnums = [1,2,3,4]\nitems[\"append\"] = nums.append   # Add a method of another object\nIn this example, the items dictionary contains a function, a module, an exception, and\na method of another object. If you want, you can use dictionary lookups on items in\nplace of the original names and the code will still work. For example:\n>>> items[\"func\"](-45)\n# Executes abs(-45)\n45\n>>> items[\"mod\"].sqrt(4)\n# Executes math.sqrt(4)\n2.0\n>>> try:\n...\nx = int(\"a lot\")\n... except items[\"error\"] as e:\n# Same as except ValueError as e\n...\nprint(\"Couldn't convert\")\n...\nCouldn't convert\n>>> items[\"append\"](100)\n# Executes nums.append(100)\n>>> nums\n[1, 2, 3, 4, 100]\n>>>\nThe fact that everything in Python is first-class is often not fully appreciated by new\nprogrammers. However, it can be used to write very compact and flexible code. For\nexample, suppose you had a line of text such as \"GOOG,100,490.10\" and you wanted\nto convert it into a list of fields with appropriate type-conversion. Here’s a clever way\nthat you might do it by creating a list of types (which are first-class objects) and execut-\ning a few simple list processing operations:\n>>> line = \"GOOG,100,490.10\"\n>>> field_types = [str, int, float]\n>>> raw_fields = line.split(',')\n>>> fields = [ty(val) for ty,val in zip(field_types,raw_fields)]\n>>> fields\n['GOOG', 100, 490.10000000000002]\n>>>\nBuilt-in Types for Representing Data\nThere are approximately a dozen built-in data types that are used to represent most of\nthe data used in programs.These are grouped into a few major categories as shown in\nTable 3.1.The Type Name column in the table lists the name or expression that you can\nuse to check for that type using isinstance() and other type-related functions.\nCertain types are only available in Python 2 and have been indicated as such (in Python\n3, they have been deprecated or merged into one of the other types).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2233,
      "extraction_method": "Direct"
    },
    {
      "page_number": 63,
      "chapter": null,
      "content": "38\nChapter 3 Types and Objects\nTable 3.1\nBuilt-In Types for Data Representation\nType Category\nType Name\nDescription\nNone\ntype(None)\nThe null object None\nNumbers\nint\nInteger\nlong\nArbitrary-precision integer (Python 2 only)\nfloat\nFloating point\ncomplex\nComplex number\nbool\nBoolean (True or False)\nSequences\nstr\nCharacter string\nunicode\nUnicode character string (Python 2 only)\nlist\nList\ntuple\nTuple\nxrange\nA range of integers created by xrange() (In Python 3,\nit is called range.)\nMapping\ndict\nDictionary\nSets\nset\nMutable set\nfrozenset\nImmutable set\nThe None Type\nThe None type denotes a null object (an object with no value). Python provides exactly\none null object, which is written as None in a program.This object is returned by func-\ntions that don’t explicitly return a value. None is frequently used as the default value of\noptional arguments, so that the function can detect whether the caller has actually\npassed a value for that argument. None has no attributes and evaluates to False in\nBoolean expressions.\nNumeric Types\nPython uses five numeric types: Booleans, integers, long integers, floating-point num-\nbers, and complex numbers. Except for Booleans, all numeric objects are signed.All\nnumeric types are immutable.\nBooleans are represented by two values: True and False.The names True and\nFalse are respectively mapped to the numerical values of 1 and 0.\nIntegers represent whole numbers in the range of –2147483648 to 2147483647 (the\nrange may be larger on some machines). Long integers represent whole numbers of\nunlimited range (limited only by available memory).Although there are two integer\ntypes, Python tries to make the distinction seamless (in fact, in Python 3, the two types\nhave been unified into a single integer type).Thus, although you will sometimes see ref-\nerences to long integers in existing Python code, this is mostly an implementation detail\nthat can be ignored—just use the integer type for all integer operations.The one excep-\ntion is in code that performs explicit type checking for integer values. In Python 2, the\nexpression isinstance(x, int) will return False if x is an integer that has been\npromoted to a long.\nFloating-point numbers are represented using the native double-precision (64-bit)\nrepresentation of floating-point numbers on the machine. Normally this is IEEE 754,\nwhich provides approximately 17 digits of precision and an exponent in the range of\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2432,
      "extraction_method": "Direct"
    },
    {
      "page_number": 64,
      "chapter": null,
      "content": "39\nBuilt-in Types for Representing Data\n–308 to 308.This is the same as the double type in C. Python doesn’t support 32-bit\nsingle-precision floating-point numbers. If precise control over the space and precision\nof numbers is an issue in your program, consider using the numpy extension (which can\nbe found at http://numpy.sourceforge.net).\nComplex numbers are represented as a pair of floating-point numbers.The real and\nimaginary parts of a complex number z are available in z.real and z.imag.The\nmethod z.conjugate() calculates the complex conjugate of z (the conjugate of a+bj\nis a-bj).\nNumeric types have a number of properties and methods that are meant to simplify\noperations involving mixed arithmetic. For simplified compatibility with rational num-\nbers (found in the fractions module), integers have the properties x.numerator and\nx.denominator.An integer or floating-point number y has the properties y.real and\ny.imag as well as the method y.conjugate() for compatibility with complex num-\nbers.A floating-point  number y can be converted into a pair of integers representing \na fraction using y.as_integer_ratio().The method y.is_integer() tests if a \nfloating-point  number y represents an integer value. Methods y.hex() and\ny.fromhex() can be used to work with floating-point  numbers using their low-level\nbinary representation.\nSeveral additional numeric types are defined in library modules.The decimal mod-\nule provides support for generalized base-10 decimal arithmetic.The fractions mod-\nule adds a rational number type.These modules are covered in Chapter 14,\n“Mathematics.”\nSequence Types\nSequences represent ordered sets of objects indexed by non-negative integers and include\nstrings, lists, and tuples. Strings are sequences of characters, and lists and tuples are\nsequences of arbitrary Python objects. Strings and tuples are immutable; lists allow inser-\ntion, deletion, and substitution of elements.All sequences support iteration.\nOperations Common to All Sequences\nTable 3.2 shows the operators and methods that you can apply to all sequence types.\nElement i of sequence s is selected using the indexing operator s[i], and subse-\nquences are selected using the slicing operator s[i:j] or extended slicing operator\ns[i:j:stride] (these operations are described in Chapter 4).The length of any\nsequence is returned using the built-in len(s) function.You can find the minimum\nand maximum values of a sequence by using the built-in min(s) and max(s) functions.\nHowever, these functions only work for sequences in which the elements can be\nordered (typically numbers and strings). sum(s) sums items in s but only works for\nnumeric data.\nTable 3.3 shows the additional operators that can be applied to mutable sequences\nsuch as lists.\nTable 3.2\nOperations and Methods Applicable to All Sequences\nItem\nDescription\ns[i]\nReturns element i of a sequence\ns[i:j]\nReturns a slice\ns[i:j:stride]\nReturns an extended slice\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2962,
      "extraction_method": "Direct"
    },
    {
      "page_number": 65,
      "chapter": null,
      "content": "40\nChapter 3 Types and Objects\nTable 3.2\nContinued\nItem\nDescription\nlen(s)\nNumber of elements in s\nmin(s)\nMinimum value in s\nmax(s)\nMaximum value in s\nsum(s [,initial])\nSum of items in s\nall(s)\nChecks whether all items in s are True.\nany(s)\nChecks whether any item in s is True.\nTable 3.3\nOperations Applicable to Mutable Sequences\nItem\nDescription\ns[i] = v\nItem assignment\ns[i:j] = t\nSlice assignment\ns[i:j:stride] = t\nExtended slice assignment\ndel s[i]\nItem deletion\ndel s[i:j]\nSlice deletion\ndel s[i:j:stride]\nExtended slice deletion\nLists\nLists support the methods shown in Table 3.4.The built-in function list(s) converts\nany iterable type to a list. If s is already a list, this function constructs a new list that’s a\nshallow copy of s.The s.append(x) method appends a new element, x, to the end of\nthe list.The s.index(x) method searches the list for the first occurrence of x. If no\nsuch element is found, a ValueError exception is raised. Similarly, the s.remove(x)\nmethod removes the first occurrence of x from the list or raises ValueError if no such\nitem exists.The s.extend(t) method extends the list s by appending the elements in\nsequence t.\nThe s.sort() method sorts the elements of a list and optionally accepts a key func-\ntion and reverse flag, both of which must be specified as keyword arguments.The key\nfunction is a function that is applied to each element prior to comparison during sort-\ning. If given, this function should take a single item as input and return the value that\nwill be used to perform the comparison while sorting. Specifying a key function is use-\nful if you want to perform special kinds of sorting operations such as sorting a list of\nstrings, but with case insensitivity.The s.reverse() method reverses the order of the\nitems in the list. Both the sort() and reverse() methods operate on the list elements\nin place and return None.\nTable 3.4\nList Methods\nMethod\nDescription\nlist(s)\nConverts s to a list.\ns.append(x)\nAppends a new element, x, to the end of s.\ns.extend(t)\nAppends a new list, t, to the end of s.\ns.count(x)\nCounts occurrences of x in s.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2121,
      "extraction_method": "Direct"
    },
    {
      "page_number": 66,
      "chapter": null,
      "content": "41\nBuilt-in Types for Representing Data\nTable 3.4\nContinued\nMethod\nDescription\ns.index(x [,start [,stop]]) Returns the smallest i where s[i]==x. start\nand stop optionally specify the starting and ending\nindex for the search.\ns.insert(i,x)\nInserts x at index i.\ns.pop([i])\nReturns the element i and removes it from the\nlist. If i is omitted, the last element is returned.\ns.remove(x)\nSearches for x and removes it from s.\ns.reverse()\nReverses items of s in place.\ns.sort([key [, reverse]])\nSorts items of s in place. key is a key function.\nreverse is a flag that sorts the list in reverse\norder. key and reverse should always be speci-\nfied as keyword arguments.\nStrings\nPython 2 provides two string object types. Byte strings are sequences of bytes contain-\ning 8-bit data.They may contain binary data and embedded NULL bytes. Unicode\nstrings are sequences of unencoded Unicode characters, which are internally represented\nby 16-bit integers.This allows for 65,536 unique character values.Although the\nUnicode standard supports up to 1 million unique character values, these extra charac-\nters are not supported by Python by default. Instead, they are encoded as a special two-\ncharacter (4-byte) sequence known as a surrogate pair—the interpretation of which is up\nto the application.As an optional feature, Python may be built to store Unicode charac-\nters using 32-bit integers.When enabled, this allows Python to represent the entire\nrange of Unicode values from U+000000 to U+110000.All Unicode-related functions\nare adjusted accordingly.\nStrings support the methods shown in Table 3.5.Although these methods operate on\nstring instances, none of these methods actually modifies the underlying string data.\nThus, methods such as s.capitalize(), s.center(), and s.expandtabs() always\nreturn a new string as opposed to modifying the string s. Character tests such as\ns.isalnum() and s.isupper() return True or False if all the characters in the string\ns satisfy the test. Furthermore, these tests always return False if the length of the string\nis zero.\nThe s.find(), s.index(), s.rfind(), and s.rindex() methods are used to\nsearch s for a substring.All these functions return an integer index to the substring in\ns. In addition, the find() method returns -1 if the substring isn’t found, whereas the\nindex() method raises a ValueError exception.The s.replace() method is used to\nreplace a substring with replacement text. It is important to emphasize that all of these\nmethods only work with simple substrings. Regular expression pattern matching and\nsearching is handled by functions in the re library module.\nThe s.split() and s.rsplit() methods split a string into a list of fields separated\nby a delimiter.The s.partition() and s.rpartition() methods search for a separa-\ntor substring and partition s into three parts corresponding to text before the separator,\nthe separator itself, and text after the separator.\nMany of the string methods accept optional start and end parameters, which are\ninteger values specifying the starting and ending indices in s. In most cases, these values\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3115,
      "extraction_method": "Direct"
    },
    {
      "page_number": 67,
      "chapter": null,
      "content": "42\nChapter 3 Types and Objects\nmay be given negative values, in which case the index is taken from the end of the\nstring.\nThe s.translate() method is used to perform advanced character substitutions\nsuch as quickly stripping all control characters out of a string.As an argument, it accepts\na translation table containing a one-to-one mapping of characters in the original string\nto characters in the result. For 8-bit strings, the translation table is a 256-character\nstring. For Unicode, the translation table can be any sequence object s where s[n]\nreturns an integer character code or Unicode character corresponding to the Unicode\ncharacter with integer value n.\nThe s.encode() and s.decode() methods are used to transform string data to and\nfrom a specified character encoding.As input, these accept an encoding name such as\n'ascii', 'utf-8', or 'utf-16'.These methods are most commonly used to convert\nUnicode strings into a data encoding suitable for I/O operations and are described fur-\nther in Chapter 9,“Input and Output.” Be aware that in Python 3, the encode()\nmethod is only available on strings, and the decode() method is only available on the\nbytes datatype.\nThe s.format() method is used to perform string formatting.As arguments, it\naccepts any combination of positional and keyword arguments. Placeholders in s denot-\ned by {item} are replaced by the appropriate argument. Positional arguments can be\nreferenced using placeholders such as {0} and {1}. Keyword arguments are referenced\nusing a placeholder with a name such as {name}. Here is an example:\n>>> a = \"Your name is {0} and your age is {age}\"\n>>> a.format(\"Mike\", age=40)\n'Your name is Mike and your age is 40'\n>>>\nWithin the special format strings, the {item} placeholders can also include simple\nindex and attribute lookup.A placeholder of {item[n]} where n is a number performs\na sequence lookup on item.A placeholder of {item[key]} where key is a non-\nnumeric string performs a dictionary lookup of item[\"key\"].A placeholder of\n{item.attr} refers to attribute attr of item. Further details on the format()\nmethod can be found in the “String Formatting” section of Chapter 4.\nTable 3.5\nString Methods\nMethod\nDescription\ns.capitalize()\nCapitalizes the first character.\ns.center(width [, pad])\nCenters the string in a field of length\nwidth. pad is a padding character.\ns.count(sub [,start [,end]])\nCounts occurrences of the specified\nsubstring sub.\ns.decode([encoding [,errors]])\nDecodes a string and returns a\nUnicode string (byte strings only).\ns.encode([encoding [,errors]])\nReturns an encoded version of the\nstring (unicode strings only).\ns.endswith(suffix [,start [,end]])\nChecks the end of the string for a suffix.\ns.expandtabs([tabsize])\nReplaces tabs with spaces.\ns.find(sub [, start [,end]])\nFinds the first occurrence of the speci-\nfied substring sub or returns -1.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2879,
      "extraction_method": "Direct"
    },
    {
      "page_number": 68,
      "chapter": null,
      "content": "43\nBuilt-in Types for Representing Data\nTable 3.5\nContinued\nMethod\nDescription\ns.format(*args, **kwargs)\nFormats s.\ns.index(sub [, start [,end]])\nFinds the first occurrence of the speci-\nfied substring sub or raises an error.\ns.isalnum()\nChecks whether all characters are\nalphanumeric.\ns.isalpha()\nChecks whether all characters are\nalphabetic.\ns.isdigit()\nChecks whether all characters are digits.\ns.islower()\nChecks whether all characters are low-\nercase.\ns.isspace()\nChecks whether all characters are\nwhitespace.\ns.istitle()\nChecks whether the string is a title-\ncased string (first letter of each word\ncapitalized).\ns.isupper()\nChecks whether all characters are\nuppercase.\ns.join(t)\nJoins the strings in sequence t with s\nas a separator.\ns.ljust(width [, fill])\nLeft-aligns s in a string of size width.\ns.lower()\nConverts to lowercase.\ns.lstrip([chrs])\nRemoves leading whitespace or charac-\nters supplied in chrs.\ns.partition(sep)\nPartitions a string based on a separa-\ntor string sep.  Returns a tuple\n(head,sep,tail) or (s, \"\",\"\") if\nsep isn’t found.\ns.replace(old, new [,maxreplace])\nReplaces a substring.\ns.rfind(sub [,start [,end]])\nFinds the last occurrence of a substring.\ns.rindex(sub [,start [,end]])\nFinds the last occurrence or raises an\nerror.\ns.rjust(width [, fill])\nRight-aligns s in a string of length\nwidth.\ns.rpartition(sep)\nPartitions s based on a separator sep,\nbut searches from the end of the string. \ns.rsplit([sep [,maxsplit]])\nSplits a string from the end of the string\nusing sep as a delimiter. maxsplit is\nthe maximum number of splits to per-\nform. If maxsplit is omitted, the result\nis identical to the split() method.\ns.rstrip([chrs])\nRemoves trailing whitespace or charac-\nters supplied in chrs.\ns.split([sep [,maxsplit]])\nSplits a string using sep as a delimiter.\nmaxsplit is the maximum number of\nsplits to perform.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1872,
      "extraction_method": "Direct"
    },
    {
      "page_number": 69,
      "chapter": null,
      "content": "44\nChapter 3 Types and Objects\nTable 3.5\nContinued\ns.splitlines([keepends])\nSplits a string into a list of lines. If\nkeepends is 1, trailing newlines are\npreserved.\ns.startswith(prefix [,start [,end]]) Checks whether a string starts with\nprefix.\ns.strip([chrs])\nRemoves leading and trailing white-\nspace or characters supplied in chrs.\ns.swapcase()\nConverts uppercase to lowercase, and\nvice versa.\ns.title()\nReturns a title-cased version of the\nstring.\ns.translate(table [,deletechars])\nTranslates a string using a character\ntranslation table table, removing char-\nacters in deletechars.\ns.upper()\nConverts a string to uppercase.\ns.zfill(width)\nPads a string with zeros on the left up\nto the specified width.\nxrange() Objects\nThe built-in function xrange([i,]j [,stride]) creates an object that represents a\nrange of integers k such that i <= k < j.The first index, i, and the stride are\noptional and have default values of 0 and 1, respectively.An xrange object calculates its\nvalues whenever it’s accessed and although an xrange object looks like a sequence, it is\nactually somewhat limited. For example, none of the standard slicing operations are sup-\nported.This limits the utility of xrange to only a few applications such as iterating in\nsimple loops.\nIt should be noted that in Python 3, xrange() has been renamed to range().\nHowever, it operates in exactly the same manner as described here.\nMapping Types\nA mapping object represents an arbitrary collection of objects that are indexed by another\ncollection of nearly arbitrary key values. Unlike a sequence, a mapping object is\nunordered and can be indexed by numbers, strings, and other objects. Mappings are\nmutable.\nDictionaries are the only built-in mapping type and are Python’s version of a hash\ntable or associative array.You can use any immutable object as a dictionary key value\n(strings, numbers, tuples, and so on). Lists, dictionaries, and tuples containing mutable\nobjects cannot be used as keys (the dictionary type requires key values to remain con-\nstant).\nTo select an item in a mapping object, use the key index operator m[k], where k is a\nkey value. If the key is not found, a KeyError exception is raised.The len(m) function\nreturns the number of items contained in a mapping object.Table 3.6 lists the methods\nand operations.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2329,
      "extraction_method": "Direct"
    },
    {
      "page_number": 70,
      "chapter": null,
      "content": "45\nBuilt-in Types for Representing Data\nTable 3.6\nMethods and Operations for Dictionaries\nItem\nDescription\nlen(m)\nReturns the number of items in m.\nm[k]\nReturns the item of m with key k.\nm[k]=x\nSets m[k] to x.\ndel m[k]\nRemoves m[k] from m.\nk in m\nReturns True if k is a key in m.\nm.clear()\nRemoves all items from m.\nm.copy()\nMakes a copy of m.\nm.fromkeys(s [,value]) Create a new dictionary with keys from sequence s and\nvalues all set to value.\nm.get(k [,v])\nReturns m[k] if found; otherwise, returns v.\nm.has_key(k)\nReturns True if m has key k; otherwise, returns False.\n(Deprecated, use the in operator instead. Python 2 only)\nm.items()\nReturns a sequence of (key,value) pairs.\nm.keys()\nReturns a sequence of key values.\nm.pop(k [,default])\nReturns m[k] if found and removes it from m; otherwise,\nreturns default if supplied or raises KeyError if not.\nm.popitem()\nRemoves a random (key,value) pair from m and returns\nit as a tuple.\nm.setdefault(k [, v]) Returns m[k] if found; otherwise, returns v and sets\nm[k] = v.\nm.update(b)\nAdds all objects from b to m.\nm.values()\nReturns a sequence of all values in m.\nMost of the methods in Table 3.6 are used to manipulate or retrieve the contents of a\ndictionary.The m.clear() method removes all items.The m.update(b) method\nupdates the current mapping object by inserting all the (key,value) pairs found in the\nmapping object b.The m.get(k [,v]) method retrieves an object but allows for an\noptional default value, v, that’s returned if no such key exists.The m.setdefault(k\n[,v]) method is similar to m.get(), except that in addition to returning v if no object\nexists, it sets m[k] = v. If v is omitted, it defaults to None.The m.pop() method\nreturns an item from a dictionary and removes it at the same time.The m.popitem()\nmethod is used to iteratively destroy the contents of a dictionary.\nThe m.copy() method makes a shallow copy of the items contained in a mapping\nobject and places them in a new mapping object.The m.fromkeys(s [,value])\nmethod creates a new mapping with keys all taken from a sequence s. The type of the\nresulting mapping will be the same as m.The value associated with all of these keys is set\nto None unless an alternative value is given with the optional value parameter.The\nfromkeys() method is defined as a class method, so an alternative way to invoke it\nwould be to use the class name such as dict.fromkeys().\nThe m.items() method returns a sequence containing (key,value) pairs.The\nm.keys() method returns a sequence with all the key values, and the m.values()\nmethod returns a sequence with all the values. For these methods, you should assume\nthat the only safe operation that can be performed on the result is iteration. In Python\n2 the result is a list, but in Python 3 the result is an iterator that iterates over the current\ncontents of the mapping. If you write code that simply assumes it is an iterator, it will\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2924,
      "extraction_method": "Direct"
    },
    {
      "page_number": 71,
      "chapter": null,
      "content": "46\nChapter 3 Types and Objects\nbe generally compatible with both versions of Python. If you need to store the result of\nthese methods as data, make a copy by storing it in a list. For example, items =\nlist(m.items()). If you simply want a list of all keys, use keys = list(m).\nSet Types\nA set is an unordered collection of unique items. Unlike sequences, sets provide no\nindexing or slicing operations.They are also unlike dictionaries in that there are no key\nvalues associated with the objects.The items placed into a set must be immutable.Two\ndifferent set types are available: set is a mutable set, and frozenset is an immutable\nset. Both kinds of sets are created using a pair of built-in functions:\ns = set([1,5,10,15])\nf = frozenset(['a',37,'hello'])\nBoth set() and frozenset() populate the set by iterating over the supplied argu-\nment. Both kinds of sets provide the methods outlined in Table 3.7.\nTable 3.7\nMethods and Operations for Set Types\nItem\nDescription\nlen(s)\nReturns the number of items in s.\ns.copy()\nMakes a copy of s.\ns.difference(t)\nSet difference. Returns all the items in s, but not in t.\ns.intersection(t)\nIntersection. Returns all the items that are both in s\nand in t.\ns.isdisjoint(t)\nReturns True if s and t have no items in common.\ns.issubset(t)\nReturns True if s is a subset of t.\ns.issuperset(t)\nReturns True if s is a superset of t.\ns.symmetric_difference(t) Symmetric difference. Returns all the items that are\nin s or t, but not in both sets.\ns.union(t)\nUnion. Returns all items in s or t.\nThe s.difference(t), s.intersection(t), s.symmetric_difference(t), and\ns.union(t) methods provide the standard mathematical operations on sets.The\nreturned value has the same type as s (set or frozenset).The parameter t can be any\nPython object that supports iteration.This includes sets, lists, tuples, and strings.These\nset operations are also available as mathematical operators, as described further in\nChapter 4.\nMutable sets (set) additionally provide the methods outlined in Table 3.8.\nTable 3.8\nMethods for Mutable Set Types\nItem\nDescription\ns.add(item)\nAdds item to s. Has no effect if item is\nalready in s.\ns.clear()\nRemoves all items from s.\ns.difference_update(t)\nRemoves all the items from s that are also\nin t.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2272,
      "extraction_method": "Direct"
    },
    {
      "page_number": 72,
      "chapter": null,
      "content": "47\nBuilt-in Types for Representing Program Structure\nTable 3.8\nContinued\nItem\nDescription\ns.discard(item)\nRemoves item from s. If item is not a\nmember of s, nothing happens.\ns.intersection_update(t)\nComputes the intersection of s and t and\nleaves the result in s.\ns.pop()\nReturns an arbitrary set element and\nremoves it from s.\ns.remove(item)\nRemoves item from s. If item is not a\nmember, KeyError is raised.\ns.symmetric_difference_update(t) Computes the symmetric difference of s and t\nand leaves the result in s.\ns.update(t)\nAdds all the items in t to s. t may be anoth-\ner set, a sequence, or any object that sup-\nports iteration.\nAll these operations modify the set s in place.The parameter t can be any object that\nsupports iteration.\nBuilt-in Types for Representing Program\nStructure\nIn Python, functions, classes, and modules are all objects that can be manipulated as\ndata.Table 3.9 shows types that are used to represent various elements of a program\nitself.\nTable 3.9\nBuilt-in Python Types for Program Structure\nType Category\nType Name\nDescription\nCallable\ntypes.BuiltinFunctionType\nBuilt-in function or method\ntype\nType of built-in types and classes\nobject\nAncestor of all types and classes\ntypes.FunctionType\nUser-defined function\ntypes.MethodType\nClass method\nModules\ntypes.ModuleType\nModule\nClasses\nobject\nAncestor of all types and classes\nTypes\ntype\nType of built-in types and classes\nNote that object and type appear twice in Table 3.9 because classes and types are\nboth callable as a function.\nCallable Types\nCallable types represent objects that support the function call operation.There are sev-\neral flavors of objects with this property, including user-defined functions, built-in func-\ntions, instance methods, and classes.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1768,
      "extraction_method": "Direct"
    },
    {
      "page_number": 73,
      "chapter": null,
      "content": "48\nChapter 3 Types and Objects\nUser-Defined Functions\nUser-defined functions are callable objects created at the module level by using the def\nstatement or with the lambda operator. Here’s an example:\ndef foo(x,y):\nreturn x + y\nbar = lambda x,y: x + y\nA user-defined function f has the following attributes:\nAttribute(s)\nDescription\nf._ _doc_ _\nDocumentation string\nf._ _name_ _\nFunction name\nf._ _dict_ _\nDictionary containing function attributes\nf._ _code_ _\nByte-compiled code\nf._ _defaults_ _\nTuple containing the default arguments\nf._ _globals_ _\nDictionary defining the global namespace\nf._ _closure_ _\nTuple containing data related to nested scopes\nIn older versions of Python 2, many of the preceding attributes had names such as\nfunc_code, func_defaults, and so on.The attribute names listed are compatible with\nPython 2.6 and Python 3.\nMethods\nMethods are functions that are defined inside a class definition.There are three common\ntypes of methods—instance methods, class methods, and static methods:\nclass Foo(object):\ndef instance_method(self,arg):\nstatements\n@classmethod\ndef class_method(cls,arg):\nstatements\n@staticmethod\ndef static_method(arg):\nstatements\nAn instance method is a method that operates on an instance belonging to a given class.\nThe instance is passed to the method as the first argument, which is called self by\nconvention.A class method operates on the class itself as an object.The class object is\npassed to a class method in the first argument, cls.A static method is a just a function\nthat happens to be packaged inside a class. It does not receive an instance or a class\nobject as a first argument.\nBoth instance and class methods are represented by a special object of type\ntypes.MethodType. However, understanding this special type requires a careful under-\nstanding of how object attribute lookup (.) works.The process of looking something\nup on an object (.) is always a separate operation from that of making a function call.\nWhen you invoke a method, both operations occur, but as distinct steps.This example\nillustrates the process of invoking f.instance_method(arg) on an instance of Foo in\nthe preceding listing:\nf = Foo()                 # Create an instance\nmeth = f.instance_method  # Lookup the method and notice the lack of ()\nmeth(37)                  # Now call the method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2349,
      "extraction_method": "Direct"
    },
    {
      "page_number": 74,
      "chapter": null,
      "content": "49\nBuilt-in Types for Representing Program Structure\nIn this example, meth is known as a bound method.A bound method is a callable object\nthat wraps both a function (the method) and an associated instance.When you call a\nbound method, the instance is passed to the method as the first parameter (self).Thus,\nmeth in the example can be viewed as a method call that is primed and ready to go but\nwhich has not been invoked using the function call operator ().\nMethod lookup can also occur on the class itself. For example:\numeth = Foo.instance_method   # Lookup instance_method on Foo\numeth(f,37)                   # Call it, but explicitly supply self\nIn this example, umeth is known as an unbound method.An unbound method is a callable\nobject that wraps the method function, but which expects an instance of the proper\ntype to be passed as the first argument. In the example, we have passed f, a an instance\nof Foo, as the first argument. If you pass the wrong kind of object, you get a\nTypeError. For example:\n>>> umeth(\"hello\",5)\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: descriptor 'instance_method' requires a 'Foo' object but received a\n'str'\n>>>\nFor user-defined classes, bound and unbound methods are both represented as an object\nof type types.MethodType, which is nothing more than a thin wrapper around an\nordinary function object.The following attributes are defined for method objects:\nAttribute\nDescription\nm._ _doc_ _\nDocumentation string\nm._ _name_ _\nMethod name\nm._ _class_ _\nClass in which this method was defined\nm._ _func_ _\nFunction object implementing the method\nm._ _self_ _\nInstance associated with the method (None if unbound)\nOne subtle feature of Python 3 is that unbound methods are no longer wrapped by a\ntypes.MethodType object. If you access Foo.instance_method as shown in earlier\nexamples, you simply obtain the raw function object that implements the method.\nMoreover, you’ll find that there is no longer any type checking on the self parameter.\nBuilt-in Functions and Methods\nThe object types.BuiltinFunctionType is used to represent functions and methods\nimplemented in C and C++.The following attributes are available for built-in methods:\nAttribute\nDescription\nb._ _doc_ _\nDocumentation string\nb._ _name_ _\nFunction/method name\nb._ _self_ _\nInstance associated with the method (if bound)\nFor built-in functions such as len(), _ _self_ _ is set to None, indicating that the func-\ntion isn’t bound to any specific object. For built-in methods such as x.append, where x\nis a list object, _ _self_ _ is set to x.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2608,
      "extraction_method": "Direct"
    },
    {
      "page_number": 75,
      "chapter": null,
      "content": "50\nChapter 3 Types and Objects\nClasses and Instances as Callables\nClass objects and instances also operate as callable objects.A class object is created by\nthe class statement and is called as a function in order to create new instances. In this\ncase, the arguments to the function are passed to the _ _init_ _() method of the class\nin order to initialize the newly created instance.An instance can emulate a function if it\ndefines a special method, _ _call_ _(). If this method is defined for an instance, x, then\nx(args) invokes the method x._ _call_ _(args).\nClasses, Types, and Instances\nWhen you define a class, the class definition normally produces an object of type type.\nHere’s an example:\n>>> class Foo(object):\n...\npass\n...\n>>> type(Foo)\n<type 'type'>\nThe following table shows commonly used attributes of a type object t:\nAttribute\nDescription\nt._ _doc_ _\nDocumentation string\nt._ _name_ _\nClass name\nt._ _bases_ _\nTuple of base classes\nt._ _dict_ _\nDictionary holding class methods and variables\nt._ _module_ _\nModule name in which the class is defined\nt._ _abstractmethods_ _\nSet of abstract method names (may be undefined if\nthere aren’t any)\nWhen an object instance is created, the type of the instance is the class that defined it.\nHere’s an example:\n>>> f = Foo()\n>>> type(f)\n<class '_ _main_ _.Foo'>\nThe following table shows special attributes of an instance i:\nAttribute\nDescription\ni.__class_ _\nClass to which the instance belongs\ni._ _dict_ _\nDictionary holding instance data\nThe _ _dict_ _ attribute is normally where all of the data associated with an instance is\nstored.When you make assignments such as i.attr = value, the value is stored here.\nHowever, if a user-defined class uses _ _slots_ _, a more efficient internal representation\nis used and instances will not have a _ _dict_ _ attribute. More details on objects and\nthe organization of the Python object system can be found in Chapter 7.\nModules\nThe module type is a container that holds objects loaded with the import statement.\nWhen the statement import foo appears in a program, for example, the name foo is\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2119,
      "extraction_method": "Direct"
    },
    {
      "page_number": 76,
      "chapter": null,
      "content": "51\nBuilt-in Types for Interpreter Internals\nassigned to the corresponding module object. Modules define a namespace that’s imple-\nmented using a dictionary accessible in the attribute _ _dict_ _.Whenever an attribute\nof a module is referenced (using the dot operator), it’s translated into a dictionary\nlookup. For example, m.x is equivalent to m._ _dict_ _[\"x\"]. Likewise, assignment to\nan attribute such as m.x = y is equivalent to m._ _dict_ _[\"x\"] = y.The following\nattributes are available:\nAttribute\nDescription\nm._ _dict_ _\nDictionary associated with the module\nm._ _doc_ _\nModule documentation string\nm._ _name_ _\nName of the module\nm._ _file_ _\nFile from which the module was loaded\nm._ _path_ _\nFully qualified package name, only defined when the module object\nrefers to a package\nBuilt-in Types for Interpreter Internals\nA number of objects used by the internals of the interpreter are exposed to the user.\nThese include traceback objects, code objects, frame objects, generator objects, slice\nobjects, and the Ellipsis as shown in Table 3.10. It is relatively rare for programs to\nmanipulate these objects directly, but they may be of practical use to tool-builders and\nframework designers.\nTable 3.10\nBuilt-in Python Types for Interpreter Internals\nType Name\nDescription\ntypes.CodeType\nByte-compiled code\ntypes.FrameType\nExecution frame\ntypes.GeneratorType\nGenerator object\ntypes.TracebackType\nStack traceback of an exception\nslice\nGenerated by extended slices\nEllipsis\nUsed in extended slices\nCode Objects\nCode objects represent raw byte-compiled executable code, or bytecode, and are typically\nreturned by the built-in compile() function. Code objects are similar to functions\nexcept that they don’t contain any context related to the namespace in which the code\nwas defined, nor do code objects store information about default argument values.A\ncode object, c, has the following read-only attributes:\nAttribute\nDescription\nc.co_name\nFunction name.\nc.co_argcount\nNumber of positional arguments (including default values).\nc.co_nlocals\nNumber of local variables used by the function.\nc.co_varnames\nTuple containing names of local variables.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2177,
      "extraction_method": "Direct"
    },
    {
      "page_number": 77,
      "chapter": null,
      "content": "52\nChapter 3 Types and Objects\nAttribute\nDescription\nc.co_cellvars\nTuple containing names of variables referenced by nested func-\ntions.\nc.co_freevars\nTuple containing names of free variables used by nested func-\ntions.\nc.co_code\nString representing raw bytecode.\nc.co_consts\nTuple containing the literals used by the bytecode.\nc.co_names\nTuple containing names used by the bytecode.\nc.co_filename\nName of the file in which the code was compiled.\nc.co_firstlineno First line number of the function.\nc.co_lnotab\nString encoding bytecode offsets to line numbers.\nc.co_stacksize\nRequired stack size (including local variables).\nc.co_flags\nInteger containing interpreter flags. Bit 2 is set if the function\nuses a variable number of positional arguments using \"*args\".\nBit 3 is set if the function allows arbitrary keyword arguments\nusing \"**kwargs\". All other bits are reserved.\nFrame Objects\nFrame objects are used to represent execution frames and most frequently occur in\ntraceback objects (described next).A frame object, f, has the following read-only \nattributes:\nAttribute\nDescription\nf.f_back\nPrevious stack frame (toward the caller).\nf.f_code\nCode object being executed.\nf.f_locals\nDictionary used for local variables.\nf.f_globals\nDictionary used for global variables.\nf.f_builtins\nDictionary used for built-in names.\nf.f_lineno\nLine number.\nf.f_lasti\nCurrent instruction. This is an index into the bytecode string of\nf_code.\nThe following attributes can be modified (and are used by debuggers and other tools):\nAttribute\nDescription\nf.f_trace\nFunction called at the start of each source code line\nf.f_exc_type\nMost recent exception type (Python 2 only)\nf.f_exc_value\nMost recent exception value (Python 2 only)\nf.f_exc_traceback\nMost recent exception traceback (Python 2 only)\nTraceback Objects\nTraceback objects are created when an exception occurs and contain stack trace infor-\nmation.When an exception handler is entered, the stack trace can be retrieved using the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1998,
      "extraction_method": "Direct"
    },
    {
      "page_number": 78,
      "chapter": null,
      "content": "53\nBuilt-in Types for Interpreter Internals\nsys.exc_info() function.The following read-only attributes are available in traceback\nobjects:\nAttribute\nDescription\nt.tb_next\nNext level in the stack trace (toward the execution frame where the\nexception occurred)\nt.tb_frame\nExecution frame object of the current level\nt.tb_lineno\nLine number where the exception occurred\nt.tb_lasti\nInstruction being executed in the current level\nGenerator Objects\nGenerator objects are created when a generator function is invoked (see Chapter 6,\n“Functions and Functional Programming”).A generator function is defined whenever a\nfunction makes use of the special yield keyword.The generator object serves as both\nan iterator and a container for information about the generator function itself.The fol-\nlowing attributes and methods are available:\nAttribute\nDescription\ng.gi_code\nCode object for the generator function.\ng.gi_frame\nExecution frame of the generator function.\ng.gi_running\nInteger indicating whether or not the generator function\nis currently running.\ng.next()\nExecute the function until the next yield statement and\nreturn the value (this method is called _ _next_ _ in\nPython 3).\ng.send(value)\nSends a value to a generator. The passed value is\nreturned by the yield expression in the generator that\nexecutes until the next yield expression is encoun-\ntered. send() returns the value passed to yield in\nthis expression.\ng.close()\nCloses a generator by raising a GeneratorExit excep-\ntion in the generator function. This method executes auto-\nmatically when a generator object is garbage-collected. \ng.throw(exc [,exc_value Raises an exception in a generator at the point of the \n[,exc_tb ]])\ncurrent yield statement. exc is the exception type,\nexc_value is the exception value, and exc_tb is an\noptional traceback. If the resulting exception is caught\nand handled, returns the value passed to the next\nyield statement.\nSlice Objects\nSlice objects are used to represent slices given in extended slice syntax, such as\na[i:j:stride], a[i:j, n:m], or a[..., i:j]. Slice objects are also created using\nthe built-in slice([i,] j [,stride]) function.The following read-only attributes\nare available:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2210,
      "extraction_method": "Direct"
    },
    {
      "page_number": 79,
      "chapter": null,
      "content": "54\nChapter 3 Types and Objects\nAttribute\nDescription\ns.start\nLower bound of the slice; None if omitted\ns.stop\nUpper bound of the slice; None if omitted\ns.step\nStride of the slice; None if omitted\nSlice objects also provide a single method, s.indices(length).This function takes a\nlength and returns a tuple (start,stop,stride) that indicates how the slice would\nbe applied to a sequence of that length. Here’s an example:\ns = slice(10,20)   #  Slice object represents [10:20]\ns.indices(100)     #  Returns (10,20,1) —> [10:20]\ns.indices(15)      #  Returns (10,15,1) —> [10:15]\nEllipsis Object\nThe Ellipsis object is used to indicate the presence of an ellipsis (...) in an index\nlookup [].There is a single object of this type, accessed through the built-in name\nEllipsis. It has no attributes and evaluates as True. None of Python’s built-in types\nmake use of Ellipsis, but it may be useful if you are trying to build advanced func-\ntionality into the indexing operator [] on your own objects.The following code shows\nhow an Ellipsis gets created and passed into the indexing operator:\nclass Example(object):\ndef _ _getitem_ _(self,index):\nprint(index)\ne = Example()\ne[3, ..., 4]       # Calls e._ _getitem_ _((3, Ellipsis, 4))\nObject Behavior and Special Methods\nObjects in Python are generally classified according to their behaviors and the features\nthat they implement. For example, all of the sequence types such as strings, lists, and\ntuples are grouped together merely because they all happen to support a common set of\nsequence operations such as s[n], len(s), etc.All basic interpreter operations are\nimplemented through special object methods.The names of special methods are always\npreceded and followed by double underscores (_ _).These methods are automatically\ntriggered by the interpreter as a program executes. For example, the operation x + y is\nmapped to an internal method, x._ _add_ _(y), and an indexing operation, x[k], is\nmapped to x._ _getitem_ _(k).The behavior of each data type depends entirely on the\nset of special methods that it implements.\nUser-defined classes can define new objects that behave like the built-in types simply\nby supplying an appropriate subset of the special methods described in this section. In\naddition, built-in types such as lists and dictionaries can be specialized (via inheritance)\nby redefining some of the special methods.\nThe next few sections describe the special methods associated with different cate-\ngories of interpreter features.\nObject Creation and Destruction\nThe methods in Table 3.11 create, initialize, and destroy instances. _ _new_ _() is a class\nmethod that is called to create an instance.The _ _init_ _() method initializes the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2730,
      "extraction_method": "Direct"
    },
    {
      "page_number": 80,
      "chapter": null,
      "content": "55\nObject Behavior and Special Methods\nattributes of an object and is called immediately after an object has been newly created.\nThe _ _del_ _() method is invoked when an object is about to be destroyed.This\nmethod is invoked only when an object is no longer in use. It’s important to note that\nthe statement del x only decrements an object’s reference count and doesn’t necessari-\nly result in a call to this function. Further details about these methods can be found in\nChapter 7.\nTable 3.11\nSpecial Methods for Object Creation and Destruction\nMethod\nDescription\n_ _new_ _(cls [,*args [,**kwargs]])\nA class method called to create a new\ninstance\n_ _init_ _(self [,*args [,**kwargs]])\nCalled to initialize a new instance\n_ _del_ _(self)\nCalled when an instance is being\ndestroyed\nThe _ _new_ _() and _ _init_ _() methods are used together to create and initialize\nnew instances.When an object is created by calling A(args), it is translated into the\nfollowing steps:\nx = A._ _new_ _(A,args)\nis isinstance(x,A): x._ _init_ _(args)\nIn user-defined objects, it is rare to define _ _new_ _() or _ _del_ _(). _ _new_ _() is\nusually only defined in metaclasses or in user-defined objects that happen to inherit\nfrom one of the immutable types (integers, strings, tuples, and so on). _ _del_ _() is only\ndefined in situations in which there is some kind of critical resource management issue,\nsuch as releasing a lock or shutting down a connection.\nObject String Representation\nThe methods in Table 3.12 are used to create various string representations of an object.\nTable 3.12\nSpecial Methods for Object Representation\nMethod\nDescription\n_ _format_ _(self, format_spec)\nCreates a formatted representation\n_ _repr_ _(self)\nCreates a string representation of an object\n_ _str_ _(self)\nCreates a simple string representation\nThe _ _repr_ _() and _ _str_ _() methods create simple string representations of an\nobject.The _ _repr_ _() method normally returns an expression string that can be eval-\nuated to re-create the object.This is also the method responsible for creating the output\nof values you see when inspecting variables in the interactive interpreter.This method is\ninvoked by the built-in repr() function. Here’s an example of using repr() and\neval() together:\na = [2,3,4,5]      # Create a list\ns = repr(a)        # s = '[2, 3, 4, 5]'\nb = eval(s)        # Turns s back into a list\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2408,
      "extraction_method": "Direct"
    },
    {
      "page_number": 81,
      "chapter": null,
      "content": "56\nChapter 3 Types and Objects\nIf a string expression cannot be created, the convention is for _ _repr_ _() to return a\nstring of the form <...message...>, as shown here:\nf = open(\"foo\")\na = repr(f)        # a = \"<open file 'foo', mode 'r' at dc030>\"\nThe _ _str_ _() method is called by the built-in str() function and by functions relat-\ned to printing. It differs from _ _repr_ _() in that the string it returns can be more\nconcise and informative to the user. If this method is undefined, the _ _repr_ _()\nmethod is invoked.\nThe _ _format_ _() method is called by the format() function or the format()\nmethod of strings.The format_spec argument is a string containing the format specifi-\ncation.This string is the same as the format_spec argument to format(). For example:\nformat(x,\"spec\")            # Calls x._ _format_ _(\"spec\")\n\"x is {0:spec}\".format(x)   # Calls x._ _format_ _(\"spec\")\nThe syntax of the format specification is arbitrary and can be customized on an object-\nby-object basis. However, a standard syntax is described in Chapter 4.\nObject Comparison and Ordering\nTable 3.13 shows methods that can be used to perform simple tests on an object.The\n_ _bool_ _() method is used for truth-value testing and should return True or False. If\nundefined, the _ _len_ _() method is a fallback that is invoked to determine truth.The\n_ _hash_ _() method is defined on objects that want to work as keys in a dictionary.\nThe value returned is an integer that should be identical for two objects that compare\nas equal. Furthermore, mutable objects should not define this method; any changes to\nan object will alter the hash value and make it impossible to locate an object on subse-\nquent dictionary lookups.\nTable 3.13\nSpecial Methods for Object Testing and Hashing\nMethod\nDescription\n__bool__(self)\nReturns False or True for truth-value testing \n__hash__(self)\nComputes an integer hash index\nObjects can implement one or more of the relational operators (<, >, <=, >=, ==, !=).\nEach of these methods takes two arguments and is allowed to return any kind of object,\nincluding a Boolean value, a list, or any other Python type. For instance, a numerical\npackage might use this to perform an element-wise comparison of two matrices,\nreturning a matrix with the results. If a comparison can’t be made, these functions may\nalso raise an exception.Table 3.14 shows the special methods for comparison operators.\nTable 3.14\nMethods for Comparisons\nMethod\nResult\n__lt__(self,other)\nself < other\n__le__(self,other)\nself <= other\n__gt__(self,other)\nself > other\n__ge__(self,other)\nself >= other\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2613,
      "extraction_method": "Direct"
    },
    {
      "page_number": 82,
      "chapter": null,
      "content": "57\nObject Behavior and Special Methods\nTable 3.14\nContinued\nMethod\nResult\n__eq__(self,other)\nself == other\n__ne__(self,other)\nself != other\nIt is not necessary for an object to implement all of the operations in Table 3.14.\nHowever, if you want to be able to compare objects using == or use an object as a dic-\ntionary key, the _ _eq_ _() method should be defined. If you want to be able to sort\nobjects or use functions such as min() or max(), then _ _lt_ _() must be minimally\ndefined.\nType Checking\nThe methods in Table 3.15 can be used to redefine the behavior of the type checking\nfunctions isinstance() and issubclass().The most common application of these\nmethods is in defining abstract base classes and interfaces, as described in Chapter 7.\nTable 3.15\nMethods for Type Checking\nMethod\nResult\n__instancecheck__(cls,object)\nisinstance(object, cls)\n__subclasscheck__(cls, sub)\nissubclass(sub, cls)\nAttribute Access\nThe methods in Table 3.16 read, write, and delete the attributes of an object using the\ndot (.) operator and the del operator, respectively.\nTable 3.16\nSpecial Methods for Attribute Access\nMethod\nDescription\n__getattribute__(self,name)\nReturns the attribute self.name.\n__getattr__(self, name)\nReturns the attribute self.name if not found\nthrough normal attribute lookup or raise\nAttributeError.\n__setattr__(self, name, value) Sets the attribute self.name = value.\nOverrides the default mechanism.\n__delattr__(self, name)\nDeletes the attribute self.name.\nWhenever an attribute is accessed, the _ _getattribute_ _() method is always invoked.\nIf the attribute is located, it is returned. Otherwise, the _ _getattr_ _() method is\ninvoked.The default behavior of _ _getattr_ _() is to raise an AttributeError\nexception.The _ _setattr_ _() method is always invoked when setting an attribute,\nand the _ _delattr_ _() method is always invoked when deleting an attribute.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1907,
      "extraction_method": "Direct"
    },
    {
      "page_number": 83,
      "chapter": null,
      "content": "58\nChapter 3 Types and Objects\nAttribute Wrapping and Descriptors\nA subtle aspect of attribute manipulation is that sometimes the attributes of an object\nare wrapped with an extra layer of logic that interact with the get, set, and delete opera-\ntions described in the previous section.This kind of wrapping is accomplished by creat-\ning a descriptor object that implements one or more of the methods in Table 3.17. Keep\nin mind that descriptions are optional and rarely need to be defined.\nTable 3.17\nSpecial Methods for Descriptor Object\nMethod\nDescription\n__get__(self,instance,cls)\nReturns an attribute value or raises\nAttributeError\n__set__(self,instance,value) Sets the attribute to value\n__delete__(self,instance)\nDeletes the attribute\nThe _ _get_ _(), _ _set_ _(), and _ _delete_ _() methods of a descriptor are meant to\ninteract with the default implementation of _ _getattribute_ _(), _ _setattr_ _(),\nand _ _delattr_ _() methods on classes and types.This interaction occurs if you place\nan instance of a descriptor object in the body of a user-defined class. In this case, all\naccess to the descriptor attribute will implicitly invoke the appropriate method on the\ndescriptor object itself.Typically, descriptors are used to implement the low-level func-\ntionality of the object system including bound and unbound methods, class methods,\nstatic methods, and properties. Further examples appear in Chapter 7.\nSequence and Mapping Methods\nThe methods in Table 3.18 are used by objects that want to emulate sequence and map-\nping objects.\nTable 3.18\nMethods for Sequences and Mappings\nMethod\nDescription\n__len__(self)\nReturns the length of self\n__getitem__(self, key)\nReturns self[key]\n__setitem__(self, key, value) Sets self[key] = value\n__delitem__(self, key)\nDeletes self[key]\n__contains__(self,obj)\nReturns True if obj is in self; otherwise,\nreturns False\nHere’s an example:\na = [1,2,3,4,5,6]\nlen(a)               # a.__len__()\nx = a[2]             # x = a.__getitem__(2)\na[1] = 7             # a.__setitem__(1,7)\ndel a[2]             # a.__delitem__(2)\n5 in a               # a.__contains__(5)\nThe __len__ method is called by the built-in len() function to return a nonnegative\nlength.This function also determines truth values unless the _ _bool_ _() method has\nalso been defined.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2317,
      "extraction_method": "Direct"
    },
    {
      "page_number": 84,
      "chapter": null,
      "content": "59\nObject Behavior and Special Methods\nFor manipulating individual items, the _ _getitem_ _() method can return an item\nby key value.The key can be any Python object but is typically an integer for\nsequences.The _ _setitem_ _() method assigns a value to an element.The\n_ _delitem_ _() method is invoked whenever the del operation is applied to a single\nelement.The _ _contains_ _() method is used to implement the in operator.\nThe slicing operations such as x = s[i:j] are also implemented using\n_ _getitem_ _(), _ _setitem_ _(), and _ _delitem_ _(). However, for slices, a special\nslice object is passed as the key.This object has attributes that describe the range of\nthe slice being requested. For example:\na = [1,2,3,4,5,6]\nx = a[1:5]           # x = a.__getitem__(slice(1,5,None))\na[1:3] = [10,11,12]  # a.__setitem__(slice(1,3,None), [10,11,12])\ndel a[1:4]           # a.__delitem__(slice(1,4,None))\nThe slicing features of Python are actually more powerful than many programmers\nrealize. For example, the following variations of extended slicing are all supported and\nmight be useful for working with multidimensional data structures such as matrices and\narrays:\na = m[0:100:10]          # Strided slice (stride=10)\nb = m[1:10, 3:20]        # Multidimensional slice\nc = m[0:100:10, 50:75:5] # Multiple dimensions with strides\nm[0:5, 5:10] = n         # extended slice assignment\ndel m[:10, 15:]          # extended slice deletion\nThe general format for each dimension of an extended slice is i:j[:stride], where\nstride is optional.As with ordinary slices, you can omit the starting or ending values\nfor each part of a slice. In addition, the ellipsis (written as ...) is available to denote any\nnumber of trailing or leading dimensions in an extended slice:\na = m[..., 10:20]    # extended slice access with Ellipsis\nm[10:20, ...] = n\nWhen using extended slices, the __getitem_ _(), _ _setitem_ _(), and\n_ _delitem_ _() methods implement access, modification, and deletion, respectively.\nHowever, instead of an integer, the value passed to these methods is a tuple containing a\ncombination of slice or Ellipsis objects. For example,\na = m[0:10, 0:100:5, ...]\ninvokes _ _getitem_ _() as follows:\na = m.__getitem__((slice(0,10,None), slice(0,100,5), Ellipsis))\nPython strings, tuples, and lists currently provide some support for extended slices,\nwhich is described in Chapter 4. Special-purpose extensions to Python, especially those\nwith a scientific flavor, may provide new types and objects with advanced support for\nextended slicing operations.\nIteration\nIf an object, obj, supports iteration, it must provide a method, obj._ _iter_ _(), that\nreturns an iterator object.The iterator object iter, in turn, must implement a single\nmethod, iter.next() (or iter._ _next_ _() in Python 3), that returns the next\nobject or raises StopIteration to signal the end of iteration. Both of these methods\nare used by the implementation of the for statement as well as other operations that\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3009,
      "extraction_method": "Direct"
    },
    {
      "page_number": 85,
      "chapter": null,
      "content": "60\nChapter 3 Types and Objects\nimplicitly perform iteration. For example, the statement for x in s is carried out by\nperforming steps equivalent to the following:\n_iter = s.__iter__()\nwhile 1:\ntry:\nx = _iter.next()(#_iter._ _next_ _() in Python 3)\nexcept StopIteration:\nbreak\n# Do statements in body of for loop\n...\nMathematical Operations\nTable 3.19 lists special methods that objects must implement to emulate numbers.\nMathematical operations are always evaluated from left to right according the prece-\ndence rules described in Chapter 4; when an expression such as x + y appears, the\ninterpreter tries to invoke the method x._ _add_ _(y).The special methods beginning\nwith r support operations with reversed operands.These are invoked only if the left\noperand doesn’t implement the specified operation. For example, if x in x + y doesn’t\nsupport the _ _add_ _() method, the interpreter tries to invoke the method\ny._ _radd_ _(x).\nTable 3.19\nMethods for Mathematical Operations\nMethod\nResult\n__add__(self,other)\nself + other\n__sub__(self,other)\nself - other\n__mul__(self,other)\nself * other\n__div__(self,other)\nself / other (Python 2 only)\n__truediv__(self,other)\nself / other (Python 3)\n__floordiv__(self,other)\nself // other\n__mod__(self,other)\nself % other\n__divmod__(self,other)\ndivmod(self,other)\n__pow__(self,other [,modulo])\nself ** other, pow(self, other,\nmodulo)\n__lshift__(self,other)\nself << other\n__rshift__(self,other)\nself >> other\n__and__(self,other)\nself & other\n__or__(self,other)\nself | other\n__xor__(self,other)\nself ^ other\n__radd__(self,other)\nother + self\n__rsub__(self,other)\nother - self\n__rmul__(self,other)\nother * self\n__rdiv__(self,other)\nother / self (Python 2 only)\n__rtruediv__(self,other)\nother / self (Python 3)\n__rfloordiv__(self,other)\nother // self\n__rmod__(self,other)\nother % self\n__rdivmod__(self,other)\ndivmod(other,self)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1887,
      "extraction_method": "Direct"
    },
    {
      "page_number": 86,
      "chapter": null,
      "content": "61\nObject Behavior and Special Methods\nTable 3.19\nContinued\nMethod\nResult\n__rpow__(self,other)\nother ** self\n__rlshift__(self,other)\nother << self\n__rrshift__(self,other)\nother >> self\n__rand__(self,other)\nother & self\n__ror__(self,other)\nother | self\n__rxor__(self,other)\nother ^ self\n__iadd__(self,other)\nself += other\n__isub__(self,other)\nself -= other\n__imul__(self,other)\nself *= other\n__idiv__(self,other)\nself /= other (Python 2 only)\n__itruediv__(self,other)\nself /= other (Python 3)\n__ifloordiv__(self,other)\nself //= other\n__imod__(self,other)\nself %= other\n__ipow__(self,other)\nself **= other\n__iand__(self,other)\nself &= other\n__ior__(self,other)\nself |= other\n__ixor__(self,other)\nself ^= other\n__ilshift__(self,other)\nself <<= other\n__irshift__(self,other)\nself >>= other\n__neg__(self)\n–self\n__pos__(self)\n+self\n__abs__(self)\nabs(self)\n__invert__(self)\n~self\n__int__(self)\nint(self)\n__long__(self)\nlong(self)\n(Python 2 only)\n__float__(self)\nfloat(self)\n__complex__(self)\ncomplex(self)\nThe methods _ _iadd_ _(), _ _isub_ _(), and so forth are used to support in-place\narithmetic operators such as a+=b and a-=b (also known as augmented assignment).A dis-\ntinction is made between these operators and the standard arithmetic methods because\nthe implementation of the in-place operators might be able to provide certain cus-\ntomizations such as performance optimizations. For instance, if the self parameter is\nnot shared, the value of an object could be modified in place without having to allocate\na newly created object for the result.\nThe three flavors of division operators—_ _div_ _(), _ _truediv_ _(), and \n_ _floordiv_ _()—are used to implement true division (/) and truncating division (//)\noperations.The reasons why there are three operations deal with a change in the\nsemantics of integer division that started in Python 2.2 but became the default behavior\nin Python 3. In Python 2, the default behavior of Python is to map the / operator to\n_ _div_ _(). For integers, this operation truncates the result to an integer. In Python 3,\ndivision is mapped to _ _truediv_ _() and for integers, a float is returned.This latter\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2166,
      "extraction_method": "Direct"
    },
    {
      "page_number": 87,
      "chapter": null,
      "content": "62\nChapter 3 Types and Objects\nbehavior can be enabled in Python 2 as an optional feature by including the statement\nfrom _ _future_ _ import division in a program.\nThe conversion methods _ _int_ _(), _ _long_ _(), _ _float_ _(), and\n_ _complex_ _() convert an object into one of the four built-in numerical types.These\nmethods are invoked by explicit type conversions such as int() and float().\nHowever, these methods are not used to implicitly coerce types in mathematical opera-\ntions. For example, the expression 3 + x produces a TypeError even if x is a user-\ndefined object that defines _ _int_ _() for integer conversion.\nCallable Interface\nAn object can emulate a function by providing the _ _call_ _(self [,*args [,\n**kwargs]]) method. If an object, x, provides this method, it can be invoked like a\nfunction.That is, x(arg1, arg2, ...) invokes x._ _call_ _(self, arg1, arg2,\n...). Objects that emulate functions can be useful for creating functors or proxies.\nHere is a simple example:\nclass DistanceFrom(object):\ndef __init__(self,origin):\nself.origin = origin\ndef __call__(self, x):\nreturn abs(x - self.origin)\nnums = [1, 37, 42, 101, 13, 9, -20]\nnums.sort(key=DistanceFrom(10))         # Sort by distance from 10\nIn this example, the DistanceFrom class creates instances that emulate a single-\nargument function.These can be used in place of a normal function—for instance, in\nthe call to sort() in the example.\nContext Management Protocol\nThe with statement allows a sequence of statements to execute under the control of\nanother object known as a context manager.The general syntax is as follows:\nwith context [ as var]:\nstatements\nThe context object shown here is expected to implement the methods shown in Table\n3.20.The _ _enter_ _() method is invoked when the with statement executes.The\nvalue returned by this method is placed into the variable specified with the optional as\nvar specifier.The _ _exit_ _() method is called as soon as control-flow leaves from the\nblock of statements associated with the with statement.As arguments, _ _exit_ _()\nreceives the current exception type, value, and traceback if an exception has been raised.\nIf no errors are being handled, all three values are set to None.\nTable 3.20\nSpecial Methods for Context Managers\nMethod\nDescription\n__enter__(self)\nCalled when entering a new context. The\nreturn value is placed in the variable listed\nwith the as specifier to the with state-\nment.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2461,
      "extraction_method": "Direct"
    },
    {
      "page_number": 88,
      "chapter": null,
      "content": "63\nObject Behavior and Special Methods\nTable 3.20\nContinued\nMethod\nDescription\n__exit__(self, type, value, tb)\nCalled when leaving a context. If an excep-\ntion occurred, type, value, and tb have\nthe exception type, value, and traceback\ninformation. The primary use of the context\nmanagement interface is to allow for simpli-\nfied resource control on objects involving\nsystem state such as open files, network\nconnections, and locks. By implementing\nthis interface, an object can safely clean up\nresources when execution leaves a context\nin which an object is being used. Further\ndetails are found in Chapter 5, “Program\nStructure and Control Flow.”\nObject Inspection and dir()\nThe dir() function is commonly used to inspect objects.An object can supply the list\nof names returned by dir() by implementing _ _dir_ _(self). Defining this makes it\neasier to hide the internal details of objects that you don’t want a user to directly access.\nHowever, keep in mind that a user can still inspect the underlying _ _dict_ _ attribute\nof instances and classes to see everything that is defined.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1109,
      "extraction_method": "Direct"
    },
    {
      "page_number": 89,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 90,
      "chapter": null,
      "content": "4\nOperators and Expressions\nThis chapter describes Python’s built-in operators, expressions, and evaluation rules.\nAlthough much of this chapter describes Python’s built-in types, user-defined objects\ncan easily redefine any of the operators to provide their own behavior.\nOperations on Numbers\nThe following operations can be applied to all numeric types:\nOperation\nDescription\nx + y\nAddition\nx - y\nSubtraction\nx * y\nMultiplication\nx / y\nDivision\nx // y\nTruncating division\nx ** y\nPower (xy)\nx % y\nModulo (x mod y)\n–x\nUnary minus\n+x\nUnary plus\nThe truncating division operator (//, also known as floor division) truncates the result to\nan integer and works with both integers and floating-point numbers. In Python 2, the\ntrue division operator (/) also truncates the result to an integer if the operands are inte-\ngers.Therefore, 7/4 is 1, not 1.75. However, this behavior changes in Python 3, where\ndivision produces a floating-point result.The modulo operator returns the remainder of\nthe division x // y. For example, 7 % 4 is 3. For floating-point numbers, the modulo\noperator returns the floating-point remainder of x // y, which is x – (x // y) *\ny. For complex numbers, the modulo (%) and truncating division operators (//) are\ninvalid.\nThe following shifting and bitwise logical operators can be applied only to integers:\nOperation\nDescription\nx << y\nLeft shift\nx >> y\nRight shift\nx & y\nBitwise and\nx | y\nBitwise or\nx ^ y\nBitwise xor (exclusive or)\n~x\nBitwise negation\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1500,
      "extraction_method": "Direct"
    },
    {
      "page_number": 91,
      "chapter": null,
      "content": "66\nChapter 4 Operators and Expressions\nThe bitwise operators assume that integers are represented in a 2’s complement binary\nrepresentation and that the sign bit is infinitely extended to the left. Some care is\nrequired if you are working with raw bit-patterns that are intended to map to native\nintegers on the hardware.This is because Python does not truncate the bits or allow val-\nues to overflow—instead, the result will grow arbitrarily large in magnitude.\nIn addition, you can apply the following built-in functions to all the numerical\ntypes:\nFunction\nDescription\nabs(x)\nAbsolute value\ndivmod(x,y)\nReturns (x // y, x % y)\npow(x,y [,modulo])\nReturns (x ** y) % modulo\nround(x,[n])\nRounds to the nearest multiple of 10-n (floating-point numbers\nonly)\nThe abs() function returns the absolute value of a number.The divmod() function\nreturns the quotient and remainder of a division operation and is only valid on non-\ncomplex numbers.The pow() function can be used in place of the ** operator but also\nsupports the ternary power-modulo function (often used in cryptographic algorithms).\nThe round() function rounds a floating-point number, x, to the nearest multiple of 10\nto the power minus n. If n is omitted, it’s set to 0. If x is equally close to two multiples,\nPython 2 rounds to the nearest multiple away from zero (for example, 0.5 is rounded\nto 1.0 and -0.5 is rounded to -1.0). One caution here is that Python 3 rounds equally\nclose values to the nearest even multiple (for example, 0.5 is rounded to 0.0, and 1.5 is\nrounded to 2.0).This is a subtle portability issue for mathematical programs being port-\ned to Python 3.\nThe following comparison operators have the standard mathematical interpretation\nand return a Boolean value of True for true, False for false:\nOperation\nDescription\nx < y\nLess than\nx > y\nGreater than\nx == y\nEqual to\nx != y\nNot equal to \nx >= y\nGreater than or equal to\nx <= y\nLess than or equal to\nComparisons can be chained together, such as in w < x < y < z. Such expressions are\nevaluated as w < x and x < y and y < z. Expressions such as x < y > z are legal\nbut are likely to confuse anyone reading the code (it’s important to note that no com-\nparison is made between x and z in such an expression). Comparisons involving com-\nplex numbers are undefined and result in a TypeError.\nOperations involving numbers are valid only if the operands are of the same type.\nFor built-in numbers, a coercion operation is performed to convert one of the types to\nthe other, as follows:\n1. If either operand is a complex number, the other operand is converted to a com-\nplex number.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2632,
      "extraction_method": "Direct"
    },
    {
      "page_number": 92,
      "chapter": null,
      "content": "67\nOperations on Sequences\n2. If either operand is a floating-point number, the other is converted to a float.\n3. Otherwise, both numbers must be integers and no conversion is performed.\nFor user-defined objects, the behavior of expressions involving mixed operands depends\non the implementation of the object.As a general rule, the interpreter does not try to\nperform any kind of implicit type conversion.\nOperations on Sequences\nThe following operators can be applied to sequence types, including strings, lists, and\ntuples:\nOperation\nDescription\ns + r\nConcatenation\ns * n, n * s\nMakes n copies of s, where n is an integer\nv1,v2…, vn = s\nVariable unpacking\ns[i]\nIndexing\ns[i:j]\nSlicing\ns[i:j:stride]\nExtended slicing\nx in s, x not in s\nMembership\nfor x in s:\nIteration\nall(s)\nReturns True if all items in s are true.\nany(s)\nReturns True if any item in s is true.\nlen(s)\nLength\nmin(s)\nMinimum item in s\nmax(s)\nMaximum item in s\nsum(s [, initial])\nSum of items with an optional initial value\nThe + operator concatenates two sequences of the same type.The s * n operator\nmakes n copies of a sequence. However, these are shallow copies that replicate elements\nby reference only. For example, consider the following code:\n>>> a = [3,4,5]\n>>> b = [a]\n>>> c = 4*b\n>>> c\n[[3, 4, 5], [3, 4, 5], [3, 4, 5], [3, 4, 5]]\n>>> a[0] = -7\n>>> c\n[[-7, 4, 5], [-7, 4, 5], [-7, 4, 5], [-7, 4, 5]]\n>>>\nNotice how the change to a modified every element of the list c. In this case, a reference\nto the list a was placed in the list b.When b was replicated, four additional references to\na were created. Finally, when a was modified, this change was propagated to all the other\n“copies” of a.This behavior of sequence multiplication is often unexpected and not the\nintent of the programmer. One way to work around the problem is to manually construct\nthe replicated sequence by duplicating the contents of a. Here’s an example:\na = [ 3, 4, 5 ]\nc = [list(a) for j in range(4)]  # list() makes a copy of a list\nThe copy module in the standard library can also be used to make copies of objects.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2093,
      "extraction_method": "Direct"
    },
    {
      "page_number": 93,
      "chapter": null,
      "content": "68\nChapter 4 Operators and Expressions\nAll sequences can be unpacked into a sequence of variable names. For example:\nitems = [ 3, 4, 5 ]\nx,y,z = items       # x = 3, y = 4, z = 5\nletters = \"abc\"\nx,y,z = letters       # x = 'a', y = 'b', z = 'c'\ndatetime = ((5, 19, 2008), (10, 30, \"am\"))\n(month,day,year),(hour,minute,am_pm) = datetime\nWhen unpacking values into variables, the number of variables must exactly match the\nnumber of items in the sequence. In addition, the structure of the variables must match\nthat of the sequence. For example, the last line of the example unpacks values into six\nvariables, organized into two 3-tuples, which is the structure of the sequence on the\nright. Unpacking sequences into variables works with any kind of sequence, including\nthose created by iterators and generators.\nThe indexing operator s[n] returns the nth object from a sequence in which s[0]\nis the first object. Negative indices can be used to fetch characters from the end of a\nsequence. For example, s[-1] returns the last item. Otherwise, attempts to access ele-\nments that are out of range result in an IndexError exception.\nThe slicing operator s[i:j] extracts a subsequence from s consisting of the ele-\nments with index k, where i <= k < j. Both i and j must be integers or long inte-\ngers. If the starting or ending index is omitted, the beginning or end of the sequence is\nassumed, respectively. Negative indices are allowed and assumed to be relative to the end\nof the sequence. If i or j is out of range, they’re assumed to refer to the beginning or\nend of a sequence, depending on whether their value refers to an element before the\nfirst item or after the last item, respectively.\nThe slicing operator may be given an optional stride, s[i:j:stride], that causes\nthe slice to skip elements. However, the behavior is somewhat more subtle. If a stride is\nsupplied, i is the starting index; j is the ending index; and the produced subsequence is\nthe elements s[i], s[i+stride], s[i+2*stride], and so forth until index j is\nreached (which is not included).The stride may also be negative. If the starting index i\nis omitted, it is set to the beginning of the sequence if stride is positive or the end of\nthe sequence if stride is negative. If the ending index j is omitted, it is set to the end\nof the sequence if stride is positive or the beginning of the sequence if stride is\nnegative. Here are some examples:\na = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\nb = a[::2]        # b = [0, 2, 4, 6, 8 ]\nc = a[::-2]       # c = [9, 7, 5, 3, 1 ]\nd = a[0:5:2]      # d = [0,2]\ne = a[5:0:-2]     # e = [5,3,1]\nf = a[:5:1]       # f = [0,1,2,3,4]\ng = a[:5:-1]      # g = [9,8,7,6]\nh = a[5::1]       # h = [5,6,7,8,9]\ni = a[5::-1]      # i = [5,4,3,2,1,0]\nj = a[5:0:-1]     # j = [5,4,3,2,1]\nThe x in s operator tests to see whether the object x is in the sequence s and returns\nTrue or False. Similarly, the x not in s operator tests whether x is not in the\nsequence s. For strings, the in and not in operators accept subtrings. For example,\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3053,
      "extraction_method": "Direct"
    },
    {
      "page_number": 94,
      "chapter": null,
      "content": "69\nOperations on Sequences\n'hello' in 'hello world' produces True. It is important to note that the in oper-\nator does not support wildcards or any kind of pattern matching. For this, you need to\nuse a library module such as the re module for regular expression patterns.\nThe for x in s operator iterates over all the elements of a sequence and is\ndescribed further in Chapter 5, “Program Structure and Control Flow.” len(s) returns\nthe number of elements in a sequence. min(s) and max(s) return the minimum and\nmaximum values of a sequence, respectively, although the result may only make sense if\nthe elements can be ordered with respect to the < operator (for example, it would make\nlittle sense to find the maximum value of a list of file objects). sum(s) sums all of the\nitems in s but usually works only if the items represent numbers.An optional initial\nvalue can be given to sum().The type of this value usually determines the result. For\nexample, if you used sum(items, decimal.Decimal(0)), the result would be a\nDecimal object (see more about the decimal module in Chapter 14,“Mathematics”).\nStrings and tuples are immutable and cannot be modified after creation. Lists can be\nmodified with the following operators:\nOperation\nDescription\ns[i] = x\nIndex assignment\ns[i:j] = r\nSlice assignment\ns[i:j:stride] = r\nExtended slice assignment\ndel s[i]\nDeletes an element\ndel s[i:j]\nDeletes a slice\ndel s[i:j:stride]\nDeletes an extended slice\nThe s[i] = x operator changes element i of a list to refer to object x, increasing the\nreference count of x. Negative indices are relative to the end of the list, and attempts to\nassign a value to an out-of-range index result in an IndexError exception.The slicing\nassignment operator s[i:j] = r replaces element k, where i <= k < j, with ele-\nments from sequence r. Indices may have the same values as for slicing and are adjusted\nto the beginning or end of the list if they’re out of range. If necessary, the sequence s is\nexpanded or reduced to accommodate all the elements in r. Here’s an example:\na = [1,2,3,4,5]\na[1] = 6            # a = [1,6,3,4,5]\na[2:4] = [10,11]    # a = [1,6,10,11,5]\na[3:4] = [-1,-2,-3] # a = [1,6,10,-1,-2,-3,5]\na[2:] = [0]         # a = [1,6,0]\nSlicing assignment may be supplied with an optional stride argument. However, the\nbehavior is somewhat more restricted in that the argument on the right side must have\nexactly the same number of elements as the slice that’s being replaced. Here’s an \nexample:\na = [1,2,3,4,5]\na[1::2] = [10,11]     # a = [1,10,3,11,5]\na[1::2] = [30,40,50]  # ValueError.  Only two elements in slice on left\nThe del s[i] operator removes element i from a list and decrements its reference\ncount. del s[i:j] removes all the elements in a slice.A stride may also be supplied, as\nin del s[i:j:stride].\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2824,
      "extraction_method": "Direct"
    },
    {
      "page_number": 95,
      "chapter": null,
      "content": "70\nChapter 4 Operators and Expressions\nSequences are compared using the operators <, >, <=, >=, ==, and !=.When compar-\ning two sequences, the first elements of each sequence are compared. If they differ, this\ndetermines the result. If they’re the same, the comparison moves to the second element\nof each sequence.This process continues until two different elements are found or no\nmore elements exist in either of the sequences. If the end of both sequences is reached,\nthe sequences are considered equal. If a is a subsequence of b, then a < b.\nStrings are compared using lexicographical ordering. Each character is assigned a\nunique numerical index determined by the character set (such as ASCII or Unicode).A\ncharacter is less than another character if its index is less. One caution concerning char-\nacter ordering is that the preceding simple comparison operators are not related to the\ncharacter ordering rules associated with locale or language settings.Thus, you would not\nuse these operations to order strings according to the standard conventions of a foreign\nlanguage (see the unicodedata and locale modules for more information).\nAnother caution, this time involving strings. Python has two types of string data:\nbyte strings and Unicode strings. Byte strings differ from their Unicode counterpart in\nthat they are usually assumed to be encoded, whereas Unicode strings represent raw\nunencoded character values. Because of this, you should never mix byte strings and\nUnicode together in expressions or comparisons (such as using + to concatenate a byte\nstring and Unicode string or using == to compare mixed strings). In Python 3, mixing\nstring types results in a TypeError exception, but Python 2 attempts to perform an\nimplicit promotion of byte strings to Unicode.This aspect of Python 2 is widely con-\nsidered to be a design mistake and is often a source of unanticipated exceptions and\ninexplicable program behavior. So, to keep your head from exploding, don’t mix string\ntypes in sequence operations.\nString Formatting\nThe modulo operator (s % d) produces a formatted string, given a format string, s, and\na collection of objects in a tuple or mapping object (dictionary) d.The behavior of this\noperator is similar to the C sprintf() function.The format string contains two types\nof objects: ordinary characters (which are left unmodified) and conversion specifiers,\neach of which is replaced with a formatted string representing an element of the associ-\nated tuple or mapping. If d is a tuple, the number of conversion specifiers must exactly\nmatch the number of objects in d. If d is a mapping, each conversion specifier must be\nassociated with a valid key name in the mapping (using parentheses, as described short-\nly). Each conversion specifier starts with the % character and ends with one of the con-\nversion characters shown in Table 4.1.\nTable 4.1\nString Formatting Conversions\nCharacter\nOutput Format\nd,i\nDecimal integer or long integer.\nu\nUnsigned integer or long integer.\no\nOctal integer or long integer.\nx\nHexadecimal integer or long integer.\nX\nHexadecimal integer (uppercase letters).\nf\nFloating point as [-]m.dddddd.\ne\nFloating point as [-]m.dddddde±xx.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3211,
      "extraction_method": "Direct"
    },
    {
      "page_number": 96,
      "chapter": null,
      "content": "71\nString Formatting\nTable 4.1\nContinued\nCharacter\nOutput Format\nE\nFloating point as [-]m.ddddddE±xx.\ng,G\nUse %e or %E for exponents less than –4 or greater than the precision; oth-\nerwise, use %f.\ns\nString or any object. The formatting code uses str() to generate strings.\nr\nProduces the same string as produced by repr().\nc\nSingle character.\n%\nLiteral %.\nBetween the % character and the conversion character, the following modifiers may\nappear, in this order:\n1. A key name in parentheses, which selects a specific item out of the mapping\nobject. If no such element exists, a KeyError exception is raised.\n2. One or more of the following:\nn - sign, indicating left alignment. By default, values are right-aligned.\nn + sign, indicating that the numeric sign should be included (even if posi-\ntive).\nn 0, indicating a zero fill.\n3. A number specifying the minimum field width.The converted value will be\nprinted in a field at least this wide and padded on the left (or right if the – flag is\ngiven) to make up the field width.\n4. A period separating the field width from a precision.\n5. A number specifying the maximum number of characters to be printed from a\nstring, the number of digits following the decimal point in a floating-point num-\nber, or the minimum number of digits for an integer.\nIn addition, the asterisk (*) character may be used in place of a number in any width\nfield. If present, the width will be read from the next item in the tuple.\nThe following code illustrates a few examples:\na = 42\nb = 13.142783\nc = \"hello\"\nd = {'x':13, 'y':1.54321, 'z':'world'}\ne = 5628398123741234\nr = \"a is %d\" % a             # r = \"a is 42\"\nr = \"%10d %f\" % (a,b)         # r = \"        42 13.142783\"\nr = \"%+010d %E\" % (a,b)       # r = \"+000000042 1.314278E+01\"\nr = \"%(x)-10d  %(y)0.3g\" % d  # r = \"13         1.54\"\nr = \"%0.4s %s\" % (c, d['z'])  # r = \"hell world\"\nr = \"%*.*f\" % (5,3,b)         # r = \"13.143\"\nr = \"e = %d\" % e              # r = \"e = 5628398123741234\"\nWhen used with a dictionary, the string formatting operator % is often used to mimic\nthe string interpolation feature often found in scripting languages (e.g., expansion of\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2166,
      "extraction_method": "Direct"
    },
    {
      "page_number": 97,
      "chapter": null,
      "content": "72\nChapter 4 Operators and Expressions\n$var symbols in strings). For example, if you have a dictionary of values, you can\nexpand those values into fields within a formatted string as follows:\nstock = {\n'name' : 'GOOG',\n'shares' : 100,\n'price' : 490.10 }\nr = \"%(shares)d of %(name)s at %(price)0.2f\" % stock\n# r = \"100 shares of GOOG at 490.10\"\nThe following code shows how to expand the values of currently defined variables\nwithin a string.The vars() function returns a dictionary containing all of the variables\ndefined at the point at which vars() is called.\nname = \"Elwood\"\nage  = 41\nr = \"%(name)s is %(age)s years old\" % vars()\nAdvanced String Formatting\nA more advanced form of string formatting is available using the s.format(*args,\n*kwargs) method on strings.This method collects an arbitrary collection of positional\nand keyword arguments and substitutes their values into placeholders embedded in s.A\nplaceholder of the form '{n}', where n is a number, gets replaced by positional argu-\nment n supplied to format().A placeholder of the form '{name}' gets replaced by\nkeyword argument name supplied to format. Use '{{' to output a single '{' and '}}'\nto output a single '}'. For example:\nr = \"{0} {1} {2}\".format('GOOG',100,490.10)\nr = \"{name} {shares} {price}\".format(name='GOOG',shares=100,price=490.10)\nr = \"Hello {0}, your age is {age}\".format(\"Elwood\",age=47)\nr = \"Use {{ and }} to output single curly braces\".format()\nWith each placeholder, you can additionally perform both indexing and attribute\nlookups. For example, in '{name[n]}' where n is an integer, a sequence lookup is per-\nformed and in '{name[key]}' where key is a non-numeric string, a dictionary lookup\nof the form name['key'] is performed. In '{name.attr}', an attribute lookup is per-\nformed. Here are some examples:\nstock = { 'name' : 'GOOG',\n'shares' : 100,\n'price' : 490.10 }\nr = \"{0[name]} {0[shares]} {0[price]}\".format(stock)\nx = 3 + 4j\nr = \"{0.real} {0.imag}\".format(x)\nIn these expansions, you are only allowed to use names.Arbitrary expressions, method\ncalls, and other operations are not supported.\nYou can optionally specify a format specifier that gives more precise control over the\noutput.This is supplied by adding an optional format specifier to each placeholder using\na colon (:), as in '{place:format_spec}'. By using this specifier, you can specify col-\numn widths, decimal places, and alignment. Here is an example:\nr = \"{name:8} {shares:8d} {price:8.2f}\".format\n(name=\"GOOG\",shares=100,price=490.10)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2525,
      "extraction_method": "Direct"
    },
    {
      "page_number": 98,
      "chapter": null,
      "content": "73\nAdvanced String Formatting\nThe general format of a specifier is [[fill[align]][sign][0][width]\n[.precision][type] where each part enclosed in [] is optional.The width specifier\nspecifies the minimum field width to use, and the align specifier is one of '<', '>’, or\n'^' for left, right, and centered alignment within the field.An optional fill character\nfill is used to pad the space. For example:\nname = \"Elwood\"\nr = \"{0:<10}\".format(name)     # r = 'Elwood    '\nr = \"{0:>10}\".format(name)     # r = '    Elwood'\nr = \"{0:^10}\".format(name)     # r = '  Elwood  '\nr = \"{0:=^10}\".format(name)    # r = '==Elwood=='\nThe type specifier indicates the type of data.Table 4.2 lists the supported format codes.\nIf not supplied, the default format code is 's' for strings, 'd' for integers, and 'f' for\nfloats.\nTable 4.2\nAdvanced String Formatting Type Specifier Codes\nCharacter\nOutput Format\nd\nDecimal integer or long integer.\nb\nBinary integer or long integer.\no\nOctal integer or long integer.\nx\nHexadecimal integer or long integer.\nX\nHexadecimal integer (uppercase letters).\nf,F\nFloating point as [-]m.dddddd.\ne\nFloating point as [-]m.dddddde±xx.\nE\nFloating point as [-]m.ddddddE±xx.\ng,G\nUse e or E for exponents less than –4 or greater than the precision; other-\nwise, use f.\nn\nSame as g except that the current locale setting determines the decimal\npoint character.\n%\nMultiplies a number by 100 and displays it using f format followed by a %\nsign.\ns\nString or any object. The formatting code uses str() to generate strings.\nc\nSingle character.\nThe sign part of a format specifier is one of '+', '-', or ' '.A '+' indicates that a\nleading sign should be used on all numbers. '-' is the default and only adds a sign\ncharacter for negative numbers.A ' ' adds a leading space to positive numbers.The\nprecision part of the specifier supplies the number of digits of accuracy to use for\ndecimals. If a leading '0' is added to the field width for numbers, numeric values are\npadded with leading 0s to fill the space. Here are some examples of formatting different\nkinds of numbers:\nx = 42\nr = '{0:10d}'.format(x)        # r = '        42'\nr = '{0:10x}'.format(x)        # r = '        2a'\nr = '{0:10b}'.format(x)        # r = '    101010'\nr = '{0:010b}'.format(x)       # r = '0000101010'\ny = 3.1415926\nr = '{0:10.2f}'.format(y)      # r = '      3.14'\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2367,
      "extraction_method": "Direct"
    },
    {
      "page_number": 99,
      "chapter": null,
      "content": "74\nChapter 4 Operators and Expressions\nr = '{0:10.2e}'.format(y)      # r = '  3.14e+00'\nr = '{0:+10.2f}'.format(y)     # r = '     +3.14'\nr = '{0:+010.2f}'.format(y)    # r = '+000003.14'\nr = '{0:+10.2%}'.format(y)     # r = '  +314.16%'\nParts of a format specifier can optionally be supplied by other fields supplied to the for-\nmat function.They are accessed using the same syntax as normal fields in a format\nstring. For example:\ny = 3.1415926\nr = '{0:{width}.{precision}f}'.format(y,width=10,precision=3) \nr = '{0:{1}.{2}f}'.format(y,10,3)\nThis nesting of fields can only be one level deep and can only occur in the format\nspecifier portion. In addition, the nested values cannot have any additional format speci-\nfiers of their own.\nOne caution on format specifiers is that objects can define their own custom set of\nspecifiers. Underneath the covers, advanced string formatting invokes the special\nmethod _ _format_ _(self, format_spec) on each field value.Thus, the capabilities\nof the format() operation are open-ended and depend on the objects to which it is\napplied. For example, dates, times, and other kinds of objects may define their own for-\nmat codes.\nIn certain cases, you may want to simply format the str() or repr() representation\nof an object, bypassing the functionality implemented by its _ _format_ _() method.\nTo do this, you can add the '!s' or '!r' modifier before the format specifier. For\nexample:\nname = \"Guido\"\nr = '{0!r:^20}'.format(name)     # r = \"      'Guido'       \"\nOperations on Dictionaries\nDictionaries provide a mapping between names and objects.You can apply the following\noperations to dictionaries:\nOperation\nDescription\nx = d[k]\nIndexing by key\nd[k] = x\nAssignment by key\ndel d[k]\nDeletes an item by key\nk in d\nTests for the existence of a key\nlen(d)\nNumber of items in the dictionary\nKey values can be any immutable object, such as strings, numbers, and tuples. In addi-\ntion, dictionary keys can be specified as a comma-separated list of values, like this:\nd = { }\nd[1,2,3] = \"foo\"\nd[1,0,3] = \"bar\"\nIn this case, the key values represent a tuple, making the preceding assignments identical\nto the following:\nd[(1,2,3)] = \"foo\"\nd[(1,0,3)] = \"bar\"\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2217,
      "extraction_method": "Direct"
    },
    {
      "page_number": 100,
      "chapter": null,
      "content": "75\nAugmented Assignment\nOperations on Sets\nThe set and frozenset type support a number of common set operations:\nOperation\nDescription\ns | t\nUnion of s and t\ns & t\nIntersection of s and t\ns – t\nSet difference\ns ^ t\nSymmetric difference\nlen(s)\nNumber of items in the set\nmax(s)\nMaximum value\nmin(s)\nMinimum value\nThe result of union, intersection, and difference operations will have the same type as\nthe left-most operand. For example, if s is a frozenset, the result will be a frozenset\neven if t is a set.\nAugmented Assignment\nPython provides the following set of augmented assignment operators:\nOperation\nDescription\nx += y\nx = x + y\nx -= y\nx = x - y\nx *= y\nx = x * y\nx /= y\nx = x / y\nx //= y\nx = x // y\nx **= y\nx = x ** y\nx %= y\nx = x % y\nx &= y\nx = x & y\nx |= y\nx = x | y\nx ^= y\nx = x ^ y\nx >>= y\nx = x >> y\nx <<= y\nx = x << y\nThese operators can be used anywhere that ordinary assignment is used. Here’s an\nexample:\na = 3\nb = [1,2]\nc = \"Hello %s %s\"\na += 1                      # a = 4\nb[1] += 10                  # b = [1, 12]\nc %= (\"Monty\", \"Python\")    # c = \"Hello Monty Python\"\nAugmented assignment doesn’t violate mutability or perform in-place modification of\nobjects.Therefore, writing x += y creates an entirely new object x with the value x +\ny. User-defined classes can redefine the augmented assignment operators using the spe-\ncial methods described in Chapter 3,“Types and Objects.”\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1425,
      "extraction_method": "Direct"
    },
    {
      "page_number": 101,
      "chapter": null,
      "content": "76\nChapter 4 Operators and Expressions\nThe Attribute (.) Operator\nThe dot (.) operator is used to access the attributes of an object. Here’s an example:\nfoo.x = 3\nprint foo.y\na = foo.bar(3,4,5)\nMore than one dot operator can appear in a single expression, such as in foo.y.a.b.\nThe dot operator can also be applied to the intermediate results of functions, as in a =\nfoo.bar(3,4,5).spam.\nUser-defined classes can redefine or customize the behavior of (.). More details are\nfound in Chapter 3 and Chapter 7,“Classes and Object-Oriented Programming.”\nThe Function Call () Operator\nThe f(args) operator is used to make a function call on f. Each argument to a func-\ntion is an expression. Prior to calling the function, all of the argument expressions are\nfully evaluated from left to right.This is sometimes known as applicative order evaluation.\nIt is possible to partially evaluate function arguments using the partial() function\nin the functools module. For example:\ndef foo(x,y,z):\nreturn x + y + z\nfrom functools import partial\nf = partial(foo,1,2)  # Supply values to x and y arguments of foo\nf(3)                  # Calls foo(1,2,3), result is 6\nThe partial() function evaluates some of the arguments to a function and returns an\nobject that you can call to supply the remaining arguments at a later point. In the previ-\nous example, the variable f represents a partially evaluated function where the first two\narguments have already been calculated.You merely need to supply the last remaining\nargument value for the function to execute. Partial evaluation of function arguments is\nclosely related to a process known as currying, a mechanism by which a function taking\nmultiple arguments such as f(x,y) is decomposed into a series of functions each taking\nonly one argument (for example, you partially evaluate f by fixing x to get a new func-\ntion to which you give values of y to produce a result).\nConversion Functions\nSometimes it’s necessary to perform conversions between the built-in types.To convert\nbetween types, you simply use the type name as a function. In addition, several built-in\nfunctions are supplied to perform special kinds of conversions.All of these functions\nreturn a new object representing the converted value.\nFunction\nDescription\nint(x [,base])\nConverts x to an integer. base specifies the base if x\nis a string.\nfloat(x)\nConverts x to a floating-point number.\ncomplex(real [,imag])\nCreates a complex number.\nstr(x)\nConverts object x to a string representation.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2518,
      "extraction_method": "Direct"
    },
    {
      "page_number": 102,
      "chapter": null,
      "content": "77\nBoolean Expressions and Truth Values\nFunction\nDescription\nrepr(x)\nConverts object x to an expression string.\nformat(x [,format_spec])\nConverts object x to a formatted string.\neval(str)\nEvaluates a string and returns an object.\ntuple(s)\nConverts s to a tuple.\nlist(s)\nConverts s to a list.\nset(s)\nConverts s to a set.\ndict(d)\nCreates a dictionary. d must be a sequence of\n(key,value) tuples.\nfrozenset(s)\nConverts s to a frozen set.\nchr(x)\nConverts an integer to a character.\nunichr(x)\nConverts an integer to a Unicode character (Python 2\nonly).\nord(x)\nConverts a single character to its integer value.\nhex(x)\nConverts an integer to a hexadecimal string.\nbin(x)\nConverts an integer to a binary string.\noct(x)\nConverts an integer to an octal string.\nNote that the str() and repr() functions may return different results. repr() typically\ncreates an expression string that can be evaluated with eval() to re-create the object.\nOn the other hand, str() produces a concise or nicely formatted representation of the\nobject (and is used by the print statement).The format(x, [format_spec]) function\nproduces the same output as that produced by the advanced string formatting operations\nbut applied to a single object x.As input, it accepts an optional format_spec, which is a\nstring containing the formatting code.The ord() function returns the integer ordinal\nvalue of a character. For Unicode, this value will be the integer code point.The chr()\nand unichr() functions convert integers back into characters.\nTo convert strings back into numbers, use the int(), float(), and complex()\nfunctions.The eval() function can also convert a string containing a valid expression\nto an object. Here’s an example:\na = int(\"34\")             # a = 34\nb = long(\"0xfe76214\", 16) # b = 266822164L (0xfe76214L)\nb = float(\"3.1415926\")    # b = 3.1415926\nc = eval(\"3, 5, 6\")       # c = (3,5,6)\nIn functions that create containers (list(), tuple(), set(), and so on), the argument\nmay be any object that supports iteration used to generate all the items used to populate\nthe object that’s being created.\nBoolean Expressions and Truth Values\nThe and, or, and not keywords can form Boolean expressions.The behavior of these\noperators is as follows:\nOperator\nDescription\nx or y\nIf x is false, return y; otherwise, return x.\nx and y\nIf x is false, return x; otherwise, return y.\nnot x\nIf x is false, return 1; otherwise, return 0.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2428,
      "extraction_method": "Direct"
    },
    {
      "page_number": 103,
      "chapter": null,
      "content": "78\nChapter 4 Operators and Expressions\nWhen you use an expression to determine a true or false value, True, any nonzero\nnumber, nonempty string, list, tuple, or dictionary is taken to be true. False; zero; None;\nand empty lists, tuples, and dictionaries evaluate as false. Boolean expressions are evaluat-\ned from left to right and consume the right operand only if it’s needed to determine\nthe final value. For example, a and b evaluates b only if a is true.This is sometimes\nknown as “short-circuit” evaluation.\nObject Equality and Identity\nThe equality operator (x == y) tests the values of x and y for equality. In the case of\nlists and tuples, all the elements are compared and evaluated as true if they’re of equal\nvalue. For dictionaries, a true value is returned only if x and y have the same set of keys\nand all the objects with the same key have equal values.Two sets are equal if they have\nthe same elements, which are compared using equality (==).\nThe identity operators (x is y and x is not y) test two objects to see whether\nthey refer to the same object in memory. In general, it may be the case that x == y,\nbut x is not y.\nComparison between objects of noncompatible types, such as a file and a floating-\npoint number, may be allowed, but the outcome is arbitrary and may not make any\nsense. It may also result in an exception depending on the type.\nOrder of Evaluation\nTable 4.3 lists the order of operation (precedence rules) for Python operators.All opera-\ntors except the power (**) operator are evaluated from left to right and are listed in the\ntable from highest to lowest precedence.That is, operators listed first in the table are\nevaluated before operators listed later. (Note that operators included together within\nsubsections, such as x * y, x / y, x / y, and x % y, have equal precedence.)\nTable 4.3\nOrder of Evaluation (Highest to Lowest)\nOperator\nName\n(...), [...], {...}\nTuple, list, and dictionary creation\ns[i], s[i:j]\nIndexing and slicing\ns.attr\nAttributes\nf(...)\nFunction calls\n+x, -x, ~x\nUnary operators\nx ** y\nPower (right associative)\nx * y, x / y, x // y, x % y\nMultiplication, division, floor division, modulo\nx + y, x - y\nAddition, subtraction\nx << y, x >> y\nBit-shifting\nx & y\nBitwise and\nx ^ y\nBitwise exclusive or\nx | y\nBitwise or\nx < y, x <= y,\nComparison, identity, and sequence member-\nship tests\nx > y, x >= y,\nx == y, x != y\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2399,
      "extraction_method": "Direct"
    },
    {
      "page_number": 104,
      "chapter": null,
      "content": "79\nOrder of Evaluation\nTable 4.3\nContinued\nOperator\nName\nx is y, x is not y\nx in s, x not in s\nnot x\nLogical negation\nx and y\nLogical and\nx or y\nLogical or\nlambda args: expr\nAnonymous function\nThe order of evaluation is not determined by the types of x and y in Table 4.3. So, even\nthough user-defined objects can redefine individual operators, it is not possible to cus-\ntomize the underlying evaluation order, precedence, and associativity rules.\nConditional Expressions\nA common programming pattern is that of conditionally assigning a value based on the\nresult of an expression. For example:\nif a <= b:\nminvalue = a\nelse:\nminvalue = b\nThis code can be shortened using a conditional expression. For example:\nminvalue = a if a <=b else b\nIn such expressions, the condition in the middle is evaluated first.The expression to the\nleft of the if is then evaluated if the result is True. Otherwise, the expression after the\nelse is evaluated.\nConditional expressions should probably be used sparingly because they can lead to\nconfusion (especially if they are nested or mixed with other complicated expressions).\nHowever, one particularly useful application is in list comprehensions and generator\nexpressions. For example:\nvalues = [1, 100, 45, 23, 73, 37, 69 ]\nclamped = [x if x < 50 else 50 for x in values]\nprint(clamped)      # [1, 50, 45, 23, 50, 37, 50]\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1381,
      "extraction_method": "Direct"
    },
    {
      "page_number": 105,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 106,
      "chapter": null,
      "content": "5\nProgram Structure and\nControl Flow\nThis chapter covers the details of program structure and control flow.Topics include\nconditionals, iteration, exceptions, and context managers.\nProgram Structure and Execution\nPython programs are structured as a sequence of statements.All language features,\nincluding variable assignment, function definitions, classes, and module imports, are\nstatements that have equal status with all other statements. In fact, there are no “special”\nstatements, and every statement can be placed anywhere in a program. For example, this\ncode defines two different versions of a function:\nif debug:\ndef square(x):\nif not isinstance(x,float):\nraise TypeError(\"Expected a float\")\nreturn x * x\nelse:\ndef square(x):\nreturn x * x\nWhen loading source files, the interpreter always executes every statement in order until\nthere are no more statements to execute.This execution model applies both to files you\nsimply run as the main program and to library files that are loaded via import.\nConditional Execution\nThe if, else, and elif statements control conditional code execution.The general\nformat of a conditional statement is as follows:\nif expression:\nstatements\nelif expression:\nstatements\nelif expression:\nstatements\n...\nelse:\nstatements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1282,
      "extraction_method": "Direct"
    },
    {
      "page_number": 107,
      "chapter": null,
      "content": "82\nChapter 5 Program Structure and Control Flow\nIf no action is to be taken, you can omit both the else and elif clauses of a condi-\ntional. Use the pass statement if no statements exist for a particular clause:\nif expression:\npass            # Do nothing\nelse:\nstatements\nLoops and Iteration\nYou implement loops using the for and while statements. Here’s an example:\nwhile expression:\nstatements\nfor i in s:\nstatements\nThe while statement executes statements until the associated expression evaluates to\nfalse.The for statement iterates over all the elements of s until no more elements are\navailable.The for statement works with any object that supports iteration.This obvi-\nously includes the built-in sequence types such as lists, tuples, and strings, but also any\nobject that implements the iterator protocol.\nAn object, s, supports iteration if it can be used with the following code, which mir-\nrors the implementation of the for statement:\nit = s.__iter__()              # Get an iterator for s\nwhile 1:\ntry:\ni = it.next()          # Get next item (Use _ _next_ _ in Python 3)\nexcept StopIteration:      # No more items\nbreak\n# Perform operations on i\n...\nIn the statement for i in s, the variable i is known as the iteration variable. On each\niteration of the loop, it receives a new value from s.The scope of the iteration variable\nis not private to the for statement. If a previously defined variable has the same name,\nthat value will be overwritten. Moreover, the iteration variable retains the last value after\nthe loop has completed.\nIf the elements used in iteration are sequences of identical size, you can unpack their\nvalues into individual iteration variables using a statement such as the following:\nfor x,y,z in s:\nstatements\nIn this example, s must contain or produce sequences, each with three elements. On\neach iteration, the contents of the variables x, y, and z are assigned the items of the cor-\nresponding sequence.Although it is most common to see this used when s is a\nsequence of tuples, unpacking works if the items in s are any kind of sequence includ-\ning lists, generators, and strings.\nWhen looping, it is sometimes useful to keep track of a numerical index in addition\nto the data values. Here’s an example:\ni = 0\nfor x in s:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2286,
      "extraction_method": "Direct"
    },
    {
      "page_number": 108,
      "chapter": null,
      "content": "83\nLoops and Iteration\nstatements\ni += 1\nPython provides a built-in function, enumerate(), that can be used to simplify this\ncode:\nfor i,x in enumerate(s):\nstatements\nenumerate(s) creates an iterator that simply returns a sequence of tuples (0, s[0]),\n(1, s[1]), (2, s[2]), and so on.\nAnother common looping problem concerns iterating in parallel over two or more\nsequences—for example, writing a loop where you want to take items from different\nsequences on each iteration as follows:\n# s and t are two sequences\ni = 0\nwhile i < len(s) and i < len(t):\nx = s[i]     # Take an item from s\ny = t[i]     # Take an item from t\nstatements\ni += 1\nThis code can be simplified using the zip() function. For example:\n# s and t are two sequences\nfor x,y in zip(s,t):\nstatements\nzip(s,t) combines sequences s and t into a sequence of tuples (s[0],t[0]),\n(s[1],t[1]), (s[2], t[2]), and so forth, stopping with the shortest of the sequences\ns and t should they be of unequal length. One caution with zip() is that in Python 2,\nit fully consumes both s and t, creating a list of tuples. For generators and sequences\ncontaining a large amount of data, this may not be what you want.The function \nitertools.izip() achieves the same effect as zip() but generates the zipped values\none at a time rather than creating a large list of tuples. In Python 3, the zip() function\nalso generates values in this manner.\nTo break out of a loop, use the break statement. For example, this code reads lines\nof text from a file until an empty line of text is encountered:\nfor line in open(\"foo.txt\"):\nstripped = line.strip()\nif not stripped:\nbreak          # A blank line, stop reading\n# process the stripped line\n...\nTo jump to the next iteration of a loop (skipping the remainder of the loop body), use\nthe continue statement.This statement tends to be used less often but is sometimes\nuseful when the process of reversing a test and indenting another level would make the\nprogram too deeply nested or unnecessarily complicated.As an example, the following\nloop skips all of the blank lines in a file:\nfor line in open(\"foo.txt\"):\nstripped = line.strip()\nif not stripped:\ncontinue      # Skip the blank line\n# process the stripped line\n...\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2233,
      "extraction_method": "Direct"
    },
    {
      "page_number": 109,
      "chapter": null,
      "content": "84\nChapter 5 Program Structure and Control Flow\nThe break and continue statements apply only to the innermost loop being executed.\nIf it’s necessary to break out of a deeply nested loop structure, you can use an excep-\ntion. Python doesn’t provide a “goto” statement.\nYou can also attach the else statement to loop constructs, as in the following \nexample:\n# for-else\nfor line in open(\"foo.txt\"):\nstripped = line.strip()\nif not stripped:\nbreak\n# process the stripped line\n...\nelse:\nraise RuntimeError(\"Missing section separator\")\nThe else clause of a loop executes only if the loop runs to completion.This either\noccurs immediately (if the loop wouldn’t execute at all) or after the last iteration. On\nthe other hand, if the loop is terminated early using the break statement, the else\nclause is skipped.\nThe primary use case for the looping else clause is in code that iterates over data\nbut which needs to set or check some kind of flag or condition if the loop breaks pre-\nmaturely. For example, if you didn’t use else, the previous code might have to be\nrewritten with a flag variable as follows:\nfound_separator = False\nfor line in open(\"foo.txt\"):\nstripped = line.strip()\nif not stripped:\nfound_separator = True\nbreak\n# process the stripped line\n...\nif not found_separator:\nraise RuntimeError(\"Missing section separator\")\nExceptions\nExceptions indicate errors and break out of the normal control flow of a program.An\nexception is raised using the raise statement.The general format of the raise state-\nment is raise Exception([value]), where Exception is the exception type and\nvalue is an optional value giving specific details about the exception. Here’s an \nexample:\nraise RuntimeError(\"Unrecoverable Error\")\nIf the raise statement is used by itself, the last exception generated is raised again\n(although this works only while handling a previously raised exception).\nTo catch an exception, use the try and except statements, as shown here:\ntry:\nf = open('foo')\nexcept IOError as e:\nstatements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2026,
      "extraction_method": "Direct"
    },
    {
      "page_number": 110,
      "chapter": null,
      "content": "85\nExceptions\nWhen an exception occurs, the interpreter stops executing statements in the try block\nand looks for an except clause that matches the exception that has occurred. If one is\nfound, control is passed to the first statement in the except clause.After the except\nclause is executed, control continues with the first statement that appears after the \ntry-except block. Otherwise, the exception is propagated up to the block of code in\nwhich the try statement appeared.This code may itself be enclosed in a try-except\nthat can handle the exception. If an exception works its way up to the top level of a\nprogram without being caught, the interpreter aborts with an error message. If desired,\nuncaught exceptions can also be passed to a user-defined function, sys.excepthook(),\nas described in Chapter 13,“Python Runtime Services.”\nThe optional as var modifier to the except statement supplies the name of a vari-\nable in which an instance of the exception type supplied to the raise statement is\nplaced if an exception occurs. Exception handlers can examine this value to find out\nmore about the cause of the exception. For example, you can use isinstance() to\ncheck the exception type. One caution on the syntax: In previous versions of Python,\nthe except statement was written as except ExcType, var where the exception type\nand variable were separated by a comma (,). In Python 2.6, this syntax still works, but it\nis deprecated. In new code, use the as var syntax because it is required in Python 3.\nMultiple exception-handling blocks are specified using multiple except clauses, as in\nthe following example:\ntry:\ndo something\nexcept IOError as e:\n# Handle I/O error\n...\nexcept TypeError as e:\n# Handle Type error\n...\nexcept NameError as e:\n# Handle Name error\n...\nA single handler can catch multiple exception types like this:\ntry:\ndo something\nexcept (IOError, TypeError, NameError) as e:\n# Handle I/O, Type, or Name errors\n...\nTo ignore an exception, use the pass statement as follows:\ntry:\ndo something\nexcept IOError:\npass              # Do nothing (oh well).\nTo catch all exceptions except those related to program exit, use Exception like this:\ntry:\ndo something\nexcept Exception as e:\nerror_log.write('An error occurred : %s\\n' % e)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2275,
      "extraction_method": "Direct"
    },
    {
      "page_number": 111,
      "chapter": null,
      "content": "86\nChapter 5 Program Structure and Control Flow\nWhen catching all exceptions, you should take care to report accurate error information\nto the user. For example, in the previous code, an error message and the associated\nexception value is being logged. If you don’t include any information about the excep-\ntion value, it can make it very difficult to debug code that is failing for reasons that you\ndon’t expect.\nAll exceptions can be caught using except with no exception type as follows:\ntry:\ndo something\nexcept:\nerror_log.write('An error occurred\\n')\nCorrect use of this form of except is a lot trickier than it looks and should probably be\navoided. For instance, this code would also catch keyboard interrupts and requests for\nprogram exit—things that you may not want to catch.\nThe try statement also supports an else clause, which must follow the last except\nclause.This code is executed if the code in the try block doesn’t raise an exception.\nHere’s an example:\ntry:\nf = open('foo', 'r')\nexcept IOError as e:\nerror_log.write('Unable to open foo : %s\\n' % e)\nelse:\ndata = f.read()\nf.close()\nThe finally statement defines a cleanup action for code contained in a try block.\nHere’s an example:\nf = open('foo','r')\ntry:\n# Do some stuff\n...\nfinally:\nf.close()\n# File closed regardless of what happened\nThe finally clause isn’t used to catch errors. Rather, it’s used to provide code that\nmust always be executed, regardless of whether an error occurs. If no exception is\nraised, the code in the finally clause is executed immediately after the code in the\ntry block. If an exception occurs, control is first passed to the first statement of the\nfinally clause.After this code has executed, the exception is re-raised to be caught by\nanother exception handler.\nBuilt-in Exceptions\nPython defines the built-in exceptions listed in Table 5.1.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1867,
      "extraction_method": "Direct"
    },
    {
      "page_number": 112,
      "chapter": null,
      "content": "87\nExceptions\nTable 5.1\nBuilt-in Exceptions\nException\nDescription\nBaseException\nThe root of all exceptions.\nGeneratorExit\nRaised by .close() method on a generator.\nKeyboardInterrupt\nGenerated by the interrupt key (usually Ctrl+C).\nSystemExit\nProgram exit/termination.\nException\nBase class for all non-exiting exceptions.\nStopIteration\nRaised to stop iteration.\nStandardError\nBase for all built-in exceptions (Python 2\nonly). In Python 3, all exceptions below are\ngrouped under Exception.\nArithmeticError\nBase for arithmetic exceptions.\nFloatingPointError\nFailure of a floating-point operation.\nZeroDivisionError\nDivision or modulus operation with 0.\nAssertionError\nRaised by the assert statement.\nAttributeError\nRaised when an attribute name is invalid.\nEnvironmentError\nErrors that occur externally to Python.\nIOError\nI/O or file-related error.\nOSError\nOperating system error.\nEOFError\nRaised when the end of the file is reached.\nImportError\nFailure of the import statement.\nLookupError\nIndexing and key errors.\nIndexError\nOut-of-range sequence index.\nKeyError\nNonexistent dictionary key.\nMemoryError\nOut of memory.\nNameError\nFailure to find a local or global name.\nUnboundLocalError\nUnbound local variable.\nReferenceError\nWeak reference used after referent destroyed.\nRuntimeError\nA generic catchall error.\nNotImplementedError\nUnimplemented feature.\nSyntaxError\nParsing error.\nIndentationError\nIndentation error.\nTabError\nInconsistent tab usage (generated with -tt\noption).\nSystemError\nNonfatal system error in the interpreter.\nTypeError\nPassing an inappropriate type to an operation.\nValueError\nInvalid type.\nUnicodeError\nUnicode error.\nUnicodeDecodeError\nUnicode decoding error.\nUnicodeEncodeError\nUnicode encoding error.\nUnicodeTranslateError\nUnicode translation error.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1797,
      "extraction_method": "Direct"
    },
    {
      "page_number": 113,
      "chapter": null,
      "content": "88\nChapter 5 Program Structure and Control Flow\nExceptions are organized into a hierarchy as shown in the table.All the exceptions in a\nparticular group can be caught by specifying the group name in an except clause.\nHere’s an example:\ntry:\nstatements\nexcept LookupError:     # Catch IndexError or KeyError\nstatements\nor\ntry:\nstatements\nexcept Exception:   # Catch any program-related exception\nstatements\nAt the top of the exception hierarchy, the exceptions are grouped according to whether\nor not the exceptions are related to program exit. For example, the SystemExit and\nKeyboardInterrupt exceptions are not grouped under Exception because programs\nthat want to catch all program-related errors usually don’t want to also capture program\ntermination by accident.\nDefining New Exceptions\nAll the built-in exceptions are defined in terms of classes.To create a new exception,\ncreate a new class definition that inherits from Exception, such as the following:\nclass NetworkError(Exception): pass\nTo use your new exception, use it with the raise statement as follows:\nraise NetworkError(\"Cannot find host.\")\nWhen raising an exception, the optional values supplied with the raise statement are\nused as the arguments to the exception’s class constructor. Most of the time, this is sim-\nply a string indicating some kind of error message. However, user-defined exceptions\ncan be written to take one or more exception values as shown in this example:\nclass DeviceError(Exception):\ndef __init__(self,errno,msg):\nself.args = (errno, msg)\nself.errno = errno\nself.errmsg = msg\n# Raises an exception (multiple arguments)\nraise DeviceError(1, 'Not Responding')\nWhen you create a custom exception class that redefines __init_ _(), it is important to\nassign a tuple containing the arguments to _ _init_ _() to the attribute self.args as\nshown.This attribute is used when printing exception traceback messages. If you leave\nit undefined, users won’t be able to see any useful information about the exception\nwhen an error occurs.\nExceptions can be organized into a hierarchy using inheritance. For instance, the\nNetworkError exception defined earlier could serve as a base class for a variety of\nmore specific errors. Here’s an example:\nclass HostnameError(NetworkError): pass\nclass TimeoutError(NetworkError): pass\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2326,
      "extraction_method": "Direct"
    },
    {
      "page_number": 114,
      "chapter": null,
      "content": "89\nContext Managers and the with Statement\ndef error1():\nraise HostnameError(\"Unknown host\")\ndef error2():\nraise TimeoutError(\"Timed out\")\ntry:\nerror1()\nexcept NetworkError as e:\nif type(e) is HostnameError:\n# Perform special actions for this kind of error\n...\nIn this case, the except NetworkError statement catches any exception derived from\nNetworkError.To find the specific type of error that was raised, examine the type of\nthe execution value with type().Alternatively, the sys.exc_info() function can be\nused to retrieve information about the last raised exception.\nContext Managers and the with Statement\nProper management of system resources such as files, locks, and connections is often a\ntricky problem when combined with exceptions. For example, a raised exception can\ncause control flow to bypass statements responsible for releasing critical resources such\nas a lock.\nThe with statement allows a series of statements to execute inside a runtime context\nthat is controlled by an object that serves as a context manager. Here is an example:\nwith open(\"debuglog\",\"a\") as f:\nf.write(\"Debugging\\n\")\nstatements\nf.write(\"Done\\n\")\nimport threading\nlock = threading.Lock()\nwith lock:\n# Critical section\nstatements\n# End critical section\nIn the first example, the with statement automatically causes the opened file to be\nclosed when control-flow leaves the block of statements that follows. In the second\nexample, the with statement automatically acquires and releases a lock when control\nenters and leaves the block of statements that follows.\nThe with obj statement allows the object obj to manage what happens when \ncontrol-flow enters and exits the associated block of statements that follows.When the\nwith obj statement executes, it executes the method obj._ _enter_ _() to signal that\na new context is being entered.When control flow leaves the context, the method\nobj._ _exit_ _(type,value,traceback) executes. If no exception has been raised,\nthe three arguments to _ _exit_ _() are all set to None. Otherwise, they contain the\ntype, value, and traceback associated with the exception that has caused control-flow to\nleave the context.The _ _exit_ _() method returns True or False to indicate whether\nthe raised exception was handled or not (if False is returned, any exceptions raised are\npropagated out of the context).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2358,
      "extraction_method": "Direct"
    },
    {
      "page_number": 115,
      "chapter": null,
      "content": "90\nChapter 5 Program Structure and Control Flow\nThe with obj statement accepts an optional as var specifier. If given, the value\nreturned by obj._ _enter_ _() is placed into var. It is important to emphasize that\nobj is not necessarily the value assigned to var.\nThe with statement only works with objects that support the context management\nprotocol (the _ _enter_ _() and _ _exit__() methods). User-defined classes can imple-\nment these methods to define their own customized context-management. Here is a\nsimple example:\nclass ListTransaction(object):\ndef __init__(self,thelist):\nself.thelist = thelist\ndef __enter__(self):\nself.workingcopy = list(self.thelist)\nreturn self.workingcopy\ndef __exit__(self,type,value,tb):\nif type is None:\nself.thelist[:] = self.workingcopy\nreturn False\nThis class allows one to make a sequence of modifications to an existing list. However,\nthe modifications only take effect if no exceptions occur. Otherwise, the original list is\nleft unmodified. For example:\nitems = [1,2,3]\nwith ListTransaction(items) as working:\nworking.append(4)\nworking.append(5)\nprint(items)       # Produces [1,2,3,4,5]\ntry:\nwith ListTransaction(items) as working:\nworking.append(6)\nworking.append(7)\nraise RuntimeError(\"We're hosed!\")\nexcept RuntimeError:\npass\nprint(items)   # Produces [1,2,3,4,5]\nThe contextlib module allows custom context managers to be more easily imple-\nmented by placing a wrapper around a generator function. Here is an example:\nfrom contextlib import contextmanager\n@contextmanager\ndef ListTransaction(thelist):\nworkingcopy = list(thelist)\nyield workingcopy\n# Modify the original list only if no errors\nthelist[:] = workingcopy\nIn this example, the value passed to yield is used as the return value from\n__enter_ _().When the _ _exit_ _() method gets invoked, execution resumes after\nthe yield. If an exception gets raised in the context, it shows up as an exception in the\ngenerator function. If desired, an exception could be caught, but in this case, exceptions\nwill simply propagate out of the generator to be handled elsewhere.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2093,
      "extraction_method": "Direct"
    },
    {
      "page_number": 116,
      "chapter": null,
      "content": "91\nAssertions and __debug__\nAssertions and __debug__\nThe assert statement can introduce debugging code into a program.The general form\nof assert is\nassert test [, msg]\nwhere test is an expression that should evaluate to True or False. If test evaluates to\nFalse, assert raises an AssertionError exception with the optional message msg\nsupplied to the assert statement. Here’s an example:\ndef write_data(file,data):\nassert file, \"write_data: file not defined!\"\n...\nThe assert statement should not be used for code that must be executed to make the\nprogram correct because it won’t be executed if Python is run in optimized mode\n(specified with the -O option to the interpreter). In particular, it’s an error to use\nassert to check user input. Instead, assert statements are used to check things that\nshould always be true; if one is violated, it represents a bug in the program, not an error\nby the user.\nFor example, if the function write_data(), shown previously, were intended for use\nby an end user, the assert statement should be replaced by a conventional if state-\nment and the desired error-handling.\nIn addition to assert, Python provides the built-in read-only variable _ _debug_ _,\nwhich is set to True unless the interpreter is running in optimized mode (specified\nwith the -O option). Programs can examine this variable as needed—possibly running\nextra error-checking procedures if set.The underlying implementation of the\n_ _debug_ _ variable is optimized in the interpreter so that the extra control-flow logic\nof the if statement itself is not actually included. If Python is running in its normal\nmode, the statements under the if _ _debug_ _ statement are just inlined into the pro-\ngram without the if statement itself. In optimized mode, the if _ _debug_ _ statement\nand all associated statements are completely removed from the program.\nThe use of assert and _ _debug_ _ allow for efficient dual-mode development of a\nprogram. For example, in debug mode, you can liberally instrument your code with\nassertions and debug checks to verify correct operation. In optimized mode, all of these\nextra checks get stripped, resulting in no extra performance penalty.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2200,
      "extraction_method": "Direct"
    },
    {
      "page_number": 117,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 118,
      "chapter": null,
      "content": "6\nFunctions and Functional\nProgramming\nSubstantial programs are broken up into functions for better modularity and ease of\nmaintenance. Python makes it easy to define functions but also incorporates a surprising\nnumber of features from functional programming languages.This chapter describes\nfunctions, scoping rules, closures, decorators, generators, coroutines, and other functional\nprogramming features. In addition, list comprehensions and generator expressions are\ndescribed—both of which are powerful tools for declarative-style programming and\ndata processing.\nFunctions\nFunctions are defined with the def statement:\ndef add(x,y):\nreturn x + y\nThe body of a function is simply a sequence of statements that execute when the func-\ntion is called.You invoke a function by writing the function name followed by a tuple\nof function arguments, such as a = add(3,4).The order and number of arguments\nmust match those given in the function definition. If a mismatch exists, a TypeError\nexception is raised.\nYou can attach default arguments to function parameters by assigning values in the\nfunction definition. For example:\ndef split(line,delimiter=','):\nstatements\nWhen a function defines a parameter with a default value, that parameter and all the\nparameters that follow are optional. If values are not assigned to all the optional parame-\nters in the function definition, a SyntaxError exception is raised.\nDefault parameter values are always set to the objects that were supplied as values\nwhen the function was defined. Here’s an example:\na = 10\ndef foo(x=a):\nreturn x\na = 5               # Reassign 'a'.\nfoo()               # returns 10 (default value not changed)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1694,
      "extraction_method": "Direct"
    },
    {
      "page_number": 119,
      "chapter": null,
      "content": "94\nChapter 6 Functions and Functional Programming\nIn addition, the use of mutable objects as default values may lead to unintended \nbehavior:\ndef foo(x, items=[]):\nitems.append(x)\nreturn items\nfoo(1)       # returns [1]\nfoo(2)       # returns [1, 2]\nfoo(3)       # returns [1, 2, 3]\nNotice how the default argument retains modifications made from previous invocations.\nTo prevent this, it is better to use None and add a check as follows:\ndef foo(x, items=None):\nif items is None:\nitems = []\nitems.append(x)\nreturn items\nA function can accept a variable number of parameters if an asterisk (*) is added to the\nlast parameter name:\ndef fprintf(file, fmt, *args):\nfile.write(fmt % args)\n# Use fprintf. args gets (42,\"hello world\", 3.45)\nfprintf(out,\"%d %s %f\", 42, \"hello world\", 3.45)\nIn this case, all the remaining arguments are placed into the args variable as a tuple.To\npass a tuple args to a function as if they were parameters, the *args syntax can be used\nin a function call as follows:\ndef printf(fmt, *args):\n# Call another function and pass along args\nfprintf(sys.stdout, fmt, *args)\nFunction arguments can also be supplied by explicitly naming each parameter and spec-\nifying a value.These are known as keyword arguments. Here is an example:\ndef foo(w,x,y,z):\nstatements\n# Keyword argument invocation\nfoo(x=3, y=22, w='hello', z=[1,2])\nWith keyword arguments, the order of the parameters doesn’t matter. However, unless\nthere are default values, you must explicitly name all of the required function parame-\nters. If you omit any of the required parameters or if the name of a keyword doesn’t\nmatch any of the parameter names in the function definition, a TypeError exception is\nraised.Also, since any Python function can be called using the keyword calling style, it is\ngenerally a good idea to define functions with descriptive argument names.\nPositional arguments and keyword arguments can appear in the same function call,\nprovided that all the positional arguments appear first, values are provided for all non-\noptional arguments, and no argument value is defined more than once. Here’s an \nexample:\nfoo('hello', 3, z=[1,2], y=22)\nfoo(3, 22, w='hello', z=[1,2])   # TypeError. Multiple values for w\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2238,
      "extraction_method": "Direct"
    },
    {
      "page_number": 120,
      "chapter": null,
      "content": "95\nParameter Passing and Return Values\nIf the last argument of a function definition begins with **, all the additional keyword\narguments (those that don’t match any of the other parameter names) are placed in a\ndictionary and passed to the function.This can be a useful way to write functions that\naccept a large number of potentially open-ended configuration options that would be\ntoo unwieldy to list as parameters. Here’s an example:\ndef make_table(data, **parms):\n# Get configuration parameters from parms (a dict)\nfgcolor = parms.pop(\"fgcolor\",\"black\")\nbgcolor = parms.pop(\"bgcolor\",\"white\")\nwidth = parms.pop(\"width\",None)\n...\n# No more options\nif parms:\nraise TypeError(\"Unsupported configuration options %s\" % list(parms))\nmake_table(items, fgcolor=\"black\", bgcolor=\"white\", border=1,\nborderstyle=\"grooved\", cellpadding=10,\nwidth=400)\nYou can combine extra keyword arguments with variable-length argument lists, as long\nas the ** parameter appears last:\n# Accept variable number of positional or keyword arguments\ndef spam(*args, **kwargs):\n# args is a tuple of positional args\n# kwargs is dictionary of keyword args\n...\nKeyword arguments can also be passed to another function using the **kwargs syntax:\ndef callfunc(*args, **kwargs):\nfunc(*args,**kwargs)\nThis use of *args and **kwargs is commonly used to write wrappers and proxies for\nother functions. For example, the callfunc() accepts any combination of arguments\nand simply passes them through to func().\nParameter Passing and Return Values\nWhen a function is invoked, the function parameters are simply names that refer to the\npassed input objects.The underlying semantics of parameter passing doesn’t neatly fit\ninto any single style, such as “pass by value” or “pass by reference,” that you might know\nabout from other programming languages. For example, if you pass an immutable value,\nthe argument effectively looks like it was passed by value. However, if a mutable object\n(such as a list or dictionary) is passed to a function where it’s then modified, those\nchanges will be reflected in the original object. Here’s an example:\na = [1, 2, 3, 4, 5]\ndef square(items):\nfor i,x in enumerate(items):\nitems[i] = x * x     # Modify items in-place\nsquare(a)      # Changes a to [1, 4, 9, 16, 25]\nFunctions that mutate their input values or change the state of other parts of the pro-\ngram behind the scenes like this are said to have side effects.As a general rule, this is a\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2465,
      "extraction_method": "Direct"
    },
    {
      "page_number": 121,
      "chapter": null,
      "content": "96\nChapter 6 Functions and Functional Programming\nprogramming style that is best avoided because such functions can become a source of\nsubtle programming errors as programs grow in size and complexity (for example, it’s\nnot obvious from reading a function call if a function has side effects). Such functions\ninteract poorly with programs involving threads and concurrency because side effects\ntypically need to be protected by locks.\nThe return statement returns a value from a function. If no value is specified or\nyou omit the return statement, the None object is returned.To return multiple values,\nplace them in a tuple:\ndef factor(a):\nd = 2\nwhile (d <= (a / 2)):\nif ((a / d) * d == a):\nreturn ((a / d), d)\nd = d + 1\nreturn (a, 1)\nMultiple return values returned in a tuple can be assigned to individual variables:\nx, y = factor(1243)    # Return values placed in x and y.\nor\n(x, y) = factor(1243)  # Alternate version. Same behavior.\nScoping Rules\nEach time a function executes, a new local namespace is created.This namespace repre-\nsents a local environment that contains the names of the function parameters, as well as\nthe names of variables that are assigned inside the function body.When resolving names,\nthe interpreter first searches the local namespace. If no match exists, it searches the glob-\nal namespace.The global namespace for a function is always the module in which the\nfunction was defined. If the interpreter finds no match in the global namespace, it\nmakes a final check in the built-in namespace. If this fails, a NameError exception is\nraised.\nOne peculiarity of namespaces is the manipulation of global variables within a func-\ntion. For example, consider the following code:\na = 42\ndef foo():\na = 13\nfoo()\n# a is still 42\nWhen this code executes, a returns its value of 42, despite the appearance that we\nmight be modifying the variable a inside the function foo.When variables are assigned\ninside a function, they’re always bound to the function’s local namespace; as a result, the\nvariable a in the function body refers to an entirely new object containing the value\n13, not the outer variable.To alter this behavior, use the global statement. global sim-\nply declares names as belonging to the global namespace, and it’s necessary only when\nglobal variables will be modified. It can be placed anywhere in a function body and\nused repeatedly. Here’s an example:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2417,
      "extraction_method": "Direct"
    },
    {
      "page_number": 122,
      "chapter": null,
      "content": "97\nScoping Rules\na = 42\nb = 37\ndef foo():\nglobal a       # 'a' is in global namespace\na = 13\nb = 0\nfoo()\n# a is now 13. b is still 37.\nPython supports nested function definitions. Here’s an example:\ndef countdown(start):\nn = start\ndef display():            # Nested function definition\nprint('T-minus %d' % n)\nwhile n > 0:\ndisplay()\nn -= 1\nVariables in nested functions are bound using lexical scoping.That is, names are resolved\nby first checking the local scope and then all enclosing scopes of outer function defini-\ntions from the innermost scope to the outermost scope. If no match is found, the global\nand built-in namespaces are checked as before.Although names in enclosing scopes are\naccessible, Python 2 only allows variables to be reassigned in the innermost scope (local\nvariables) and the global namespace (using global).Therefore, an inner function can’t\nreassign the value of a local variable defined in an outer function. For example, this\ncode does not work:\ndef countdown(start):\nn = start\ndef display():\nprint('T-minus %d' % n)\ndef decrement():\nn -= 1              # Fails in Python 2\nwhile n > 0:\ndisplay()\ndecrement()\nIn Python 2, you can work around this by placing values you want to change in a list or\ndictionary. In Python 3, you can declare n as nonlocal as follows:\ndef countdown(start):\nn = start\ndef display():\nprint('T-minus %d' % n)\ndef decrement():\nnonlocal n    # Bind to outer n (Python 3 only)\nn -= 1\nwhile n > 0:\ndisplay()\ndecrement()\nThe nonlocal declaration does not bind a name to local variables defined inside arbi-\ntrary functions further down on the current call-stack (that is, dynamic scope). So, if\nyou’re coming to Python from Perl, nonlocal is not the same as declaring a Perl local\nvariable.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1764,
      "extraction_method": "Direct"
    },
    {
      "page_number": 123,
      "chapter": null,
      "content": "98\nChapter 6 Functions and Functional Programming\nIf a local variable is used before it’s assigned a value, an UnboundLocalError excep-\ntion is raised. Here’s an example that illustrates one scenario of how this might occur:\ni = 0\ndef foo():\ni = i + 1      # Results in UnboundLocalError exception\nprint(i)\nIn this function, the variable i is defined as a local variable (because it is being assigned\ninside the function and there is no global statement). However, the assignment i = i\n+ 1 tries to read the value of i before its local value has been first assigned. Even\nthough there is a global variable i in this example, it is not used to supply a value here.\nVariables are determined to be either local or global at the time of function definition\nand cannot suddenly change scope in the middle of a function. For example, in the pre-\nceding code, it is not the case that the i in the expression i + 1 refers to the global\nvariable i, whereas the i in print(i) refers to the local variable i created in the previ-\nous statement.\nFunctions as Objects and Closures\nFunctions are first-class objects in Python.This means that they can be passed as argu-\nments to other functions, placed in data structures, and returned by a function as a\nresult. Here is an example of a function that accepts another function as input and \ncalls it:\n# foo.py\ndef callf(func):\nreturn func()\nHere is an example of using the above function:\n>>> import foo\n>>> def helloworld():\n...\nreturn 'Hello World'\n...\n>>> foo.callf(helloworld)\n# Pass a function as an argument\n'Hello World'\n>>>\nWhen a function is handled as data, it implicitly carries information related to the sur-\nrounding environment where the function was defined.This affects how free variables\nin the function are bound.As an example, consider this modified version foo.py that\nnow contains a variable definition:\n# foo.py\nx = 42\ndef callf(func):\nreturn func()\nNow, observe the behavior of this example:\n>>> import foo\n>>> x = 37\n>>> def helloworld():\n...\nreturn \"Hello World. x is %d\" % x\n...\n>>> foo.callf(helloworld)\n# Pass a function as an argument\n'Hello World. x is 37'\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2149,
      "extraction_method": "Direct"
    },
    {
      "page_number": 124,
      "chapter": null,
      "content": "99\nFunctions as Objects and Closures\nIn this example, notice how the function helloworld() uses the value of x that’s\ndefined in the same environment as where helloworld() was defined.Thus, even\nthough there is also an x defined in foo.py and that’s where helloworld() is actually\nbeing called, that value of x is not the one that’s used when helloworld() executes.\nWhen the statements that make up a function are packaged together with the envi-\nronment in which they execute, the resulting object is known as a closure.The behavior\nof the previous example is explained by the fact that all functions have a _ _globals_ _\nattribute that points to the global namespace in which the function was defined.This\nalways corresponds to the enclosing module in which a function was defined. For the\nprevious example, you get the following:\n>>> helloworld.__globals__\n{'__builtins__': <module '__builtin__' (built-in)>, \n'helloworld': <function helloworld at 0x7bb30>, \n'x': 37, '__name__': '__main__', '__doc__': None\n'foo': <module 'foo' from 'foo.py'>}\n>>>\nWhen nested functions are used, closures capture the entire environment needed for the\ninner function to execute. Here is an example:\nimport foo\ndef bar():\nx = 13\ndef helloworld():\nreturn \"Hello World. x is %d\" % x\nfoo.callf(helloworld)        # returns 'Hello World, x is 13'\nClosures and nested functions are especially useful if you want to write code based on\nthe concept of lazy or delayed evaluation. Here is another example:\nfrom urllib import urlopen\n# from urllib.request import urlopen (Python 3)\ndef page(url):\ndef get():\nreturn urlopen(url).read()\nreturn get\nIn this example, the page() function doesn’t actually carry out any interesting compu-\ntation. Instead, it merely creates and returns a function get() that will fetch the con-\ntents of a web page when it is called.Thus, the computation carried out in get() is\nactually delayed until some later point in a program when get() is evaluated. For\nexample:\n>>> python = page(\"http://www.python.org\")\n>>> jython = page(\"http://www.jython.org\")\n>>> python\n<function get at 0x95d5f0>\n>>> jython\n<function get at 0x9735f0>\n>>> pydata = python()\n# Fetches http://www.python.org\n>>> jydata = jython()\n# Fetches http://www.jython.org\n>>>\nIn this example, the two variables python and jython are actually two different ver-\nsions of the get() function. Even though the page() function that created these values\nis no longer executing, both get() functions implicitly carry the values of the outer\nvariables that were defined when the get() function was created.Thus, when get()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2609,
      "extraction_method": "Direct"
    },
    {
      "page_number": 125,
      "chapter": null,
      "content": "100\nChapter 6 Functions and Functional Programming\nexecutes, it calls urlopen(url) with the value of url that was originally supplied to\npage().With a little inspection, you can view the contents of variables that are carried\nalong in a closure. For example:\n>>> python._ _closure_ _\n(<cell at 0x67f50: str object at 0x69230>,)\n>>> python._ _closure_ _[0].cell_contents\n'http://www.python.org'\n>>> jython._ _closure_ _[0].cell_contents\n'http://www.jython.org'\n>>>\nA closure can be a highly efficient way to preserve state across a series of function calls.\nFor example, consider this code that runs a simple counter:\ndef countdown(n):\ndef next():\nnonlocal n\nr = n\nn -= 1\nreturn r\nreturn next\n# Example use\nnext = countdown(10)\nwhile True:\nv = next()         # Get the next value\nif not v: break\nIn this code, a closure is being used to store the internal counter value n.The inner\nfunction next() updates and returns the previous value of this counter variable each\ntime it is called. Programmers not familiar with closures might be inclined to imple-\nment similar functionality using a class such as this:\nclass Countdown(object):\ndef __init__(self,n):\nself.n = n\ndef next(self):\nr = self.n\nself.n -= 1\nreturn r\n# Example use\nc = Countdown(10)\nwhile True:\nv = c.next()         # Get the next value\nif not v: break\nHowever, if you increase the starting value of the countdown and perform a simple\ntiming benchmark, you will find that that the version using closures runs much faster\n(almost a 50% speedup when tested on the author’s machine).\nThe fact that closures capture the environment of inner functions also make them\nuseful for applications where you want to wrap existing functions in order to add extra\ncapabilities.This is described next.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1771,
      "extraction_method": "Direct"
    },
    {
      "page_number": 126,
      "chapter": null,
      "content": "101\nDecorators\nDecorators\nA decorator is a function whose primary purpose is to wrap another function or class.\nThe primary purpose of this wrapping is to transparently alter or enhance the behavior\nof the object being wrapped. Syntactically, decorators are denoted using the special @\nsymbol as follows:\n@trace\ndef square(x):\nreturn x*x\nThe preceding code is shorthand for the following:\ndef square(x):\nreturn x*x\nsquare = trace(square)\nIn the example, a function square() is defined. However, immediately after its defini-\ntion, the function object itself is passed to the function trace(), which returns an\nobject that replaces the original square. Now, let’s consider an implementation of\ntrace that will clarify how this might be useful:\nenable_tracing = True\nif enable_tracing:\ndebug_log = open(\"debug.log\",\"w\")\ndef trace(func):\nif enable_tracing:\ndef callf(*args,**kwargs):\ndebug_log.write(\"Calling %s: %s, %s\\n\" % \n(func.__name__, args, kwargs))\nr = func(*args,**kwargs)\ndebug_log.write(\"%s returned %s\\n\" % (func.__name, r))\nreturn r\nreturn callf\nelse:\nreturn func\nIn this code, trace() creates a wrapper function that writes some debugging output\nand then calls the original function object.Thus, if you call square(), you will see the\noutput of the write() methods in the wrapper.The function callf that is returned\nfrom trace() is a closure that serves as a replacement for the original function.A final\ninteresting aspect of the implementation is that the tracing feature itself is only enabled\nthrough the use of a global variable enable_tracing as shown. If set to False, the\ntrace() decorator simply returns the original function unmodified.Thus, when tracing\nis disabled, there is no added performance penalty associated with using the decorator.\nWhen decorators are used, they must appear on their own line immediately prior to\na function or class definition. More than one decorator can also be applied. Here’s an\nexample:\n@foo\n@bar\n@spam\ndef grok(x):\npass\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1998,
      "extraction_method": "Direct"
    },
    {
      "page_number": 127,
      "chapter": null,
      "content": "102\nChapter 6 Functions and Functional Programming\nIn this case, the decorators are applied in the order listed.The result is the same as this:\ndef grok(x):\npass\ngrok = foo(bar(spam(grok)))\nA decorator can also accept arguments. Here’s an example:\n@eventhandler('BUTTON')\ndef handle_button(msg):\n...\n@eventhandler('RESET')\ndef handle_reset(msg):\n...\nIf arguments are supplied, the semantics of the decorator are as follows:\ndef handle_button(msg):\n...\ntemp = eventhandler('BUTTON')        # Call decorator with supplied arguments\nhandle_button = temp(handle_button)  # Call the function returned by the decorator\nIn this case, the decorator function only accepts the arguments supplied with the @\nspecifier. It then returns a function that is called with the function as an argument.\nHere’s an example:\n# Event handler decorator\nevent_handlers = { }\ndef eventhandler(event):\ndef register_function(f):\nevent_handlers[event] = f\nreturn f\nreturn register_function\nDecorators can also be applied to class definitions. For example:\n@foo\nclass Bar(object):\ndef __init__(self,x):\nself.x = x\ndef spam(self):\nstatements\nFor class decorators, you should always have the decorator function return a class object\nas a result. Code that expects to work with the original class definition may want to ref-\nerence members of the class directly such as Bar.spam.This won’t work correctly if the\ndecorator function foo() returns a function.\nDecorators can interact strangely with other aspects of functions such as recursion,\ndocumentation strings, and function attributes.These issues are described later in this\nchapter.\nGenerators and yield\nIf a function uses the yield keyword, it defines an object known as a generator.A gener-\nator is a function that produces a sequence of values for use in iteration. Here’s an\nexample:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1833,
      "extraction_method": "Direct"
    },
    {
      "page_number": 128,
      "chapter": null,
      "content": "103\nGenerators and yield\ndef countdown(n):\nprint(\"Counting down from %d\" % n)\nwhile n > 0:\nyield n\nn -= 1\nreturn\nIf you call this function, you will find that none of its code starts executing. For \nexample:\n>>> c = countdown(10)\n>>>\nInstead, a generator object is returned.The generator object, in turn, executes the func-\ntion whenever next() is called (or __next__() in Python 3). Here’s an example:\n>>> c.next()\n# Use c.__next__() in Python 3\nCounting down from 10\n10\n>>> c.next()\n9\nWhen next() is invoked, the generator function executes statements until it reaches a\nyield statement.The yield statement produces a result at which point execution of\nthe function stops until next() is invoked again. Execution then resumes with the\nstatement following yield.\nYou normally don’t call next() directly on a generator but use it with the for\nstatement, sum(), or some other operation that consumes a sequence. For example:\nfor n in countdown(10):\nstatements\na = sum(countdown(10))\nA generator function signals completion by returning or raising StopIteration, at\nwhich point iteration stops. It is never legal for a generator to return a value other than\nNone upon completion.\nA subtle problem with generators concerns the case where a generator function is\nonly partially consumed. For example, consider this code:\nfor n in countdown(10):\nif n == 2: break\nstatements\nIn this example, the for loop aborts by calling break, and the associated generator\nnever runs to full completion.To handle this case, generator objects have a method\nclose() that is used to signal a shutdown.When a generator is no longer used or\ndeleted, close() is called. Normally it is not necessary to call close(), but you can\nalso call it manually as shown here:\n>>> c = countdown(10)\n>>> c.next()\nCounting down from 10\n10\n>>> c.next()\n9\n>>> c.close()\n>>> c.next()\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nStopIteration\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1952,
      "extraction_method": "Direct"
    },
    {
      "page_number": 129,
      "chapter": null,
      "content": "104\nChapter 6 Functions and Functional Programming\nInside the generator function, close() is signaled by a GeneratorExit exception\noccurring on the yield statement.You can optionally catch this exception to perform\ncleanup actions.\ndef countdown(n):\nprint(\"Counting down from %d\" % n)\ntry:\nwhile n > 0:\nyield n\nn = n - 1\nexcept GeneratorExit:\nprint(\"Only made it to %d\" % n)\nAlthough it is possible to catch GeneratorExit, it is illegal for a generator function to\nhandle the exception and produce another output value using yield. Moreover, if a\nprogram is currently iterating on generator, you should not call close() asynchronous-\nly on that generator from a separate thread of execution or from a signal handler.\nCoroutines and yield Expressions\nInside a function, the yield statement can also be used as an expression that appears on\nthe right side of an assignment operator. For example:\ndef receiver():\nprint(\"Ready to receive\")\nwhile True:\nn = (yield)\nprint(\"Got %s\" % n)\nA function that uses yield in this manner is known as a coroutine, and it executes in\nresponse to values being sent to it. Its behavior is also very similar to a generator. For\nexample:\n>>> r = receiver()\n>>> r.next()\n# Advance to first yield (r._ _next_ _() in Python 3)\nReady to receive\n>>> r.send(1)\nGot 1\n>>> r.send(2)\nGot 2\n>>> r.send(\"Hello\")\nGot Hello\n>>>\nIn this example, the initial call to next() is necessary so that the coroutine executes\nstatements leading to the first yield expression.At this point, the coroutine suspends,\nwaiting for a value to be sent to it using the send() method of the associated generator\nobject r.The value passed to send() is returned by the (yield) expression in the\ncoroutine. Upon receiving a value, a coroutine executes statements until the next yield\nstatement is encountered.\nThe requirement of first calling next() on a coroutine is easily overlooked and a\ncommon source of errors.Therefore, it is recommended that coroutines be wrapped\nwith a decorator that automatically takes care of this step.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2048,
      "extraction_method": "Direct"
    },
    {
      "page_number": 130,
      "chapter": null,
      "content": "105\nCoroutines and yield Expressions\ndef coroutine(func):\ndef start(*args,**kwargs):\ng = func(*args,**kwargs)\ng.next()\nreturn g\nreturn start\nUsing this decorator, you would write and use coroutines using:\n@coroutine\ndef receiver():\nprint(\"Ready to receive\")\nwhile True:\nn = (yield)\nprint(\"Got %s\" % n)\n# Example use\nr = receiver()\nr.send(\"Hello World\")       # Note : No initial .next() needed\nA coroutine will typically run indefinitely unless it is explicitly shut down or it exits on\nits own.To close the stream of input values, use the close() method like this:\n>>> r.close()\n>>> r.send(4)\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nStopIteration\nOnce closed, a StopIteration exception will be raised if further values are sent to a\ncoroutine.The close() operation raises GeneratorExit inside the coroutine as\ndescribed in the previous section on generators. For example:\ndef receiver():\nprint(\"Ready to receive\")\ntry:\nwhile True:\nn = (yield)\nprint(\"Got %s\" % n)\nexcept GeneratorExit:\nprint(\"Receiver done\")\nExceptions can be raised inside a coroutine using the throw(exctype [, value [,\ntb]]) method where exctype is an exception type, value is the exception value, and\ntb is a traceback object. For example:\n>>> r.throw(RuntimeError,\"You're hosed!\")\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nFile \"<stdin>\", line 4, in receiver\nRuntimeError: You're hosed!\nExceptions raised in this manner will originate at the currently executing yield state-\nment in the coroutine.A coroutine can elect to catch exceptions and handle them as\nappropriate. It is not safe to use throw() as an asynchronous signal to a coroutine—it\nshould never be invoked from a separate execution thread or in a signal handler.\nA coroutine may simultaneously receive and emit return values using yield if values\nare supplied in the yield expression. Here is an example that illustrates this:\ndef line_splitter(delimiter=None):\nprint(\"Ready to split\")\nresult = None\nwhile True:\nline = (yield result)\nresult = line.split(delimiter)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2082,
      "extraction_method": "Direct"
    },
    {
      "page_number": 131,
      "chapter": null,
      "content": "106\nChapter 6 Functions and Functional Programming\nIn this case, we use the coroutine in the same way as before. However, now calls to\nsend() also produce a result. For example:\n>>> s = line_splitter(\",\")\n>>> s.next()\nReady to split\n>>> s.send(\"A,B,C\")\n['A', 'B', 'C' ]\n>>> s.send(\"100,200,300\")\n['100', '200', '300']\n>>>\nUnderstanding the sequencing of this example is critical.The first next() call advances\nthe coroutine to (yield result), which returns None, the initial value of result. On\nsubsequent send() calls, the received value is placed in line and split into result.The\nvalue returned by send() is the value passed to the next yield statement encountered.\nIn other words, the value returned by send() comes from the next yield expression,\nnot the one responsible for receiving the value passed by send().\nIf a coroutine returns values, some care is required if exceptions raised with throw()\nare being handled. If you raise an exception in a coroutine using throw(), the value\npassed to the next yield in the coroutine will be returned as the result of throw(). If\nyou need this value and forget to save it, it will be lost.\nUsing Generators and Coroutines\nAt first glance, it might not be obvious how to use generators and coroutines for practi-\ncal problems. However, generators and coroutines can be particularly effective when\napplied to certain kinds of programming problems in systems, networking, and distrib-\nuted computation. For example, generator functions are useful if you want to set up a\nprocessing pipeline, similar in nature to using a pipe in the UNIX shell. One example of\nthis appeared in the Introduction. Here is another example involving a set of generator\nfunctions related to finding, opening, reading, and processing files:\nimport os\nimport fnmatch\ndef find_files(topdir, pattern):\nfor path, dirname, filelist in os.walk(topdir):\nfor name in filelist:\nif fnmatch.fnmatch(name, pattern):\nyield os.path.join(path,name)\nimport gzip, bz2\ndef opener(filenames):\nfor name in filenames:\nif name.endswith(\".gz\"):  f = gzip.open(name)\nelif name.endswith(\".bz2\"): f = bz2.BZ2File(name)\nelse: f = open(name)\nyield f\ndef cat(filelist):\nfor f in filelist:\nfor line in f:\nyield line\ndef grep(pattern, lines):\nfor line in lines:\nif pattern in line:\nyield line\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2306,
      "extraction_method": "Direct"
    },
    {
      "page_number": 132,
      "chapter": null,
      "content": "107\nUsing Generators and Coroutines\nHere is an example of using these functions to set up a processing pipeline:\nwwwlogs = find(\"www\",\"access-log*\")\nfiles   = opener(wwwlogs)\nlines   = cat(files)\npylines = grep(\"python\", lines)\nfor line in pylines:\nsys.stdout.write(line)\nIn this example, the program is processing all lines in all \"access-log*\" files found\nwithin all subdirectories of a top-level directory \"www\". Each \"access-log\" is tested\nfor file compression and opened using an appropriate file opener. Lines are concatenat-\ned together and processed through a filter that is looking for a substring \"python\".The\nentire program is being driven by the for statement at the end. Each iteration of this\nloop pulls a new value through the pipeline and consumes it. Moreover, the implemen-\ntation is highly memory-efficient because no temporary lists or other large data struc-\ntures are ever created.\nCoroutines can be used to write programs based on data-flow processing. Programs\norganized in this way look like inverted pipelines. Instead of pulling values through a\nsequence of generator functions using a for loop, you send values into a collection of\nlinked coroutines. Here is an example of coroutine functions written to mimic the gen-\nerator functions shown previously:\nimport os\nimport fnmatch\n@coroutine\ndef find_files(target):\nwhile True:\ntopdir, pattern = (yield)\nfor path, dirname, filelist in os.walk(topdir):\nfor name in filelist:\nif fnmatch.fnmatch(name,pattern):\ntarget.send(os.path.join(path,name))\nimport gzip, bz2\n@coroutine\ndef opener(target):\nwhile True:\nname = (yield)\nif name.endswith(\".gz\"):  f = gzip.open(name)\nelif name.endswith(\".bz2\"): f = bz2.BZ2File(name)\nelse: f = open(name)\ntarget.send(f)\n@coroutine\ndef cat(target):\nwhile True:\nf = (yield)\nfor line in f:\ntarget.send(line)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1835,
      "extraction_method": "Direct"
    },
    {
      "page_number": 133,
      "chapter": null,
      "content": "108\nChapter 6 Functions and Functional Programming\n@coroutine\ndef grep(pattern, target):\nwhile True:\nline = (yield)\nif pattern in line:\ntarget.send(line)\n@coroutine\ndef printer():\nwhile True:\nline = (yield)\nsys.stdout.write(line)\nHere is how you would link these coroutines to create a dataflow processing pipeline:\nfinder = find_files(opener(cat(grep(\"python\",printer()))))\n# Now, send a value\nfinder.send((\"www\",\"access-log*\"))\nfinder.send((\"otherwww\",\"access-log*\"))\nIn this example, each coroutine sends data to another coroutine specified in the target\nargument to each coroutine. Unlike the generator example, execution is entirely driven\nby pushing data into the first coroutine find_files().This coroutine, in turn, pushes\ndata to the next stage.A critical aspect of this example is that the coroutine pipeline\nremains active indefinitely or until close() is explicitly called on it. Because of this, a\nprogram can continue to feed data into a coroutine for as long as necessary—for exam-\nple, the two repeated calls to send() shown in the example.\nCoroutines can be used to implement a form of concurrency. For example, a central-\nized task manager or event loop can schedule and send data into a large collection of\nhundreds or even thousands of coroutines that carry out various processing tasks.The\nfact that input data is “sent” to a coroutine also means that coroutines can often be easi-\nly mixed with programs that use message queues and message passing to communicate\nbetween program components. Further information on this can be found in Chapter\n20,“Threads.”\nList Comprehensions\nA common operation involving functions is that of applying a function to all of the\nitems of a list, creating a new list with the results. For example:\nnums = [1, 2, 3, 4, 5]\nsquares = []\nfor n in nums:\nsquares.append(n * n)\nBecause this type of operation is so common, it is has been turned into an operator\nknown as a list comprehension. Here is a simple example:\nnums = [1, 2, 3, 4, 5]\nsquares = [n * n for n in nums]\nThe general syntax for a list comprehension is as follows:\n[expression for item1 in iterable1 if condition1\nfor item2 in iterable2 if condition2\n...\nfor itemN in iterableN if conditionN ]\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2230,
      "extraction_method": "Direct"
    },
    {
      "page_number": 134,
      "chapter": null,
      "content": "109\nGenerator Expressions\nThis syntax is roughly equivalent to the following code:\ns = []\nfor item1 in iterable1:\nif condition1:\nfor item2 in iterable2:\nif condition2:\n...\nfor itemN in iterableN:\nif conditionN: s.append(expression)\nTo illustrate, here are some more examples:\na = [-3,5,2,-10,7,8]\nb = 'abc'\nc = [2*s for s in a]          # c = [-6,10,4,-20,14,16]\nd = [s for s in a if s >= 0]  # d = [5,2,7,8]\ne = [(x,y) for x in a         # e = [(5,'a'),(5,'b'),(5,'c'),\nfor y in b         #      (2,'a'),(2,'b'),(2,'c'),\nif x > 0 ]         #      (7,'a'),(7,'b'),(7,'c'),\n#      (8,'a'),(8,'b'),(8,'c')]\nf = [(1,2), (3,4), (5,6)]\ng = [math.sqrt(x*x+y*y)       # f = [2.23606, 5.0, 7.81024]\nfor x,y in f]\nThe sequences supplied to a list comprehension don’t have to be the same length\nbecause they’re iterated over their contents using a nested set of for loops, as previously\nshown.The resulting list contains successive values of expressions.The if clause is\noptional; however, if it’s used, expression is evaluated and added to the result only if\ncondition is true.\nIf a list comprehension is used to construct a list of tuples, the tuple values must be\nenclosed in parentheses. For example, [(x,y) for x in a for y in b] is legal syn-\ntax, whereas [x,y for x in a for y in b] is not.\nFinally, it is important to note that in Python 2, the iteration variables defined within\na list comprehension are evaluated within the current scope and remain defined after\nthe list comprehension has executed. For example, in [x for x in a], the iteration\nvariable x overwrites any previously defined value of x and is set to the value of the last\nitem in a after the resulting list is created. Fortunately, this is not the case in Python 3\nwhere the iteration variable remains private.\nGenerator Expressions\nA generator expression is an object that carries out the same computation as a list compre-\nhension, but which iteratively produces the result.The syntax is the same as for list\ncomprehensions except that you use parentheses instead of square brackets. Here’s an\nexample:\n(expression for item1 in iterable1 if condition1\nfor item2 in iterable2 if condition2\n...\nfor itemN in iterableN if conditionN)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2221,
      "extraction_method": "Direct"
    },
    {
      "page_number": 135,
      "chapter": null,
      "content": "110\nChapter 6 Functions and Functional Programming\nUnlike a list comprehension, a generator expression does not actually create a list or\nimmediately evaluate the expression inside the parentheses. Instead, it creates a generator\nobject that produces the values on demand via iteration. Here’s an example:\n>>> a = [1, 2, 3, 4]\n>>> b = (10*i for i in a)\n>>> b\n<generator object at 0x590a8>\n>>> b.next()\n10\n>>> b.next()\n20\n...\nThe difference between list and generator expressions is important, but subtle.With a\nlist comprehension, Python actually creates a list that contains the resulting data.With a\ngenerator expression, Python creates a generator that merely knows how to produce\ndata on demand. In certain applications, this can greatly improve performance and\nmemory use. Here’s an example:\n# Read a file\nf = open(\"data.txt\")                         # Open a file\nlines = (t.strip() for t in f)               # Read lines, strip\n# trailing/leading whitespace\ncomments = (t for t in lines if t[0] == '#') # All comments\nfor c in comments:\nprint(c)\nIn this example, the generator expression that extracts lines and strips whitespace does\nnot actually read the entire file into memory.The same is true of the expression that\nextracts comments. Instead, the lines of the file are actually read when the program\nstarts iterating in the for loop that follows. During this iteration, the lines of the file are\nproduced upon demand and filtered accordingly. In fact, at no time will the entire file\nbe loaded into memory during this process.Therefore, this would be a highly efficient\nway to extract comments from a gigabyte-sized Python source file.\nUnlike a list comprehension, a generator expression does not create an object that\nworks like a sequence. It can’t be indexed, and none of the usual list operations will\nwork (for example, append()). However, a generator expression can be converted into\na list using the built-in list() function:\nclist = list(comments)\nDeclarative Programming\nList comprehensions and generator expressions are strongly tied to operations found in\ndeclarative languages. In fact, the origin of these features is loosely derived from ideas in\nmathematical set theory. For example, when you write a statement such as [x*x for x\nin a if x > 0], it’s somewhat similar to specifying a set such as { x2 |  x Œa, x > 0 }.\nInstead of writing programs that manually iterate over data, you can use these declar-\native features to structure programs as a series of computations that simply operate on\nall of the data all at once. For example, suppose you had a file “portfolio.txt” containing\nstock portfolio data like this:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2668,
      "extraction_method": "Direct"
    },
    {
      "page_number": 136,
      "chapter": null,
      "content": "111\nDeclarative Programming\nAA 100 32.20\nIBM 50 91.10\nCAT 150 83.44\nMSFT 200 51.23\nGE 95 40.37\nMSFT 50 65.10\nIBM 100 70.44\nHere is a declarative-style program that calculates the total cost by summing up the sec-\nond column multiplied by the third column:\nlines  = open(\"portfolio.txt\")\nfields = (line.split() for line in lines)\nprint(sum(float(f[1]) * float(f[2]) for f in fields))\nIn this program, we really aren’t concerned with the mechanics of looping line-by-line\nover the file. Instead, we just declare a sequence of calculations to perform on all of the\ndata. Not only does this approach result in highly compact code, but it also tends to run\nfaster than this more traditional version:\ntotal = 0\nfor line in open(\"portfolio.txt\"):\nfields = line.split()\ntotal += float(fields[1]) * float(fields[2])\nprint(total)\nThe declarative programming style is somewhat tied to the kinds of operations a pro-\ngrammer might perform in a UNIX shell. For instance, the preceding example using\ngenerator expressions is similar to the following one-line awk command:\n% awk '{ total += $2 * $3} END { print total }' portfolio.txt\n44671.2\n%\nThe declarative style of list comprehensions and generator expressions can also be used\nto mimic the behavior of SQL select statements, commonly used when processing\ndatabases. For example, consider these examples that work on data that has been read in\na list of dictionaries:\nfields = (line.split() for line in open(\"portfolio.txt\"))\nportfolio = [ {'name'   : f[0],\n'shares' : int(f[1]),\n'price'  : float(f[2]) }\nfor f in fields]\n# Some queries \nmsft = [s for s in portfolio if s['name'] == 'MSFT']\nlarge_holdings = [s for s in portfolio\nif s['shares']*s['price'] >= 10000]\nIn fact, if you are using a module related to database access (see Chapter 17), you can\noften use list comprehensions and database queries together all at once. For example:\nsum(shares*cost for shares,cost in\ncursor.execute(\"select shares, cost from portfolio\")\nif shares*cost >= 10000)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2015,
      "extraction_method": "Direct"
    },
    {
      "page_number": 137,
      "chapter": null,
      "content": "112\nChapter 6 Functions and Functional Programming\nThe lambda Operator\nAnonymous functions in the form of an expression can be created using the lambda\nstatement:\nlambda args : expression\nargs is a comma-separated list of arguments, and expression is an expression involv-\ning those arguments. Here’s an example:\na = lambda x,y : x+y\nr = a(2,3)              # r gets 5\nThe code defined with lambda must be a valid expression. Multiple statements and\nother non-expression statements, such as for and while, cannot appear in a lambda\nstatement. lambda expressions follow the same scoping rules as functions.\nThe primary use of lambda is in specifying short callback functions. For example, if\nyou wanted to sort a list of names with case-insensitivity, you might write this:\nnames.sort(key=lambda n: n.lower())\nRecursion\nRecursive functions are easily defined. For example:\ndef factorial(n):\nif n <= 1: return 1\nelse: return n * factorial(n - 1)\nHowever, be aware that there is a limit on the depth of recursive function calls.The\nfunction sys.getrecursionlimit() returns the current maximum recursion depth,\nand the function sys.setrecursionlimit() can be used to change the value.The\ndefault value is 1000.Although it is possible to increase the value, programs are still lim-\nited by the stack size limits enforced by the host operating system.When the recursion\ndepth is exceeded, a RuntimeError exception is raised. Python does not perform tail-\nrecursion optimization that you often find in functional languages such as Scheme.\nRecursion does not work as you might expect in generator functions and corou-\ntines. For example, this code prints all items in a nested collection of lists:\ndef flatten(lists):\nfor s in lists:\nif isinstance(s,list): \nflatten(s)\nelse:\nprint(s)\nitems = [[1,2,3],[4,5,[5,6]],[7,8,9]]\nflatten(items)     # Prints 1 2 3 4 5 6 7 8 9 \nHowever, if you change the print operation to a yield, it no longer works.This is\nbecause the recursive call to flatten() merely creates a new generator object without\nactually iterating over it. Here’s a recursive generator version that works:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2128,
      "extraction_method": "Direct"
    },
    {
      "page_number": 138,
      "chapter": null,
      "content": "113\nDocumentation Strings\ndef genflatten(lists):\nfor s in lists:\nif isinstance(s,list): \nfor item in genflatten(s):\nyield item\nelse:\nyield item \nCare should also be taken when mixing recursive functions and decorators. If a decora-\ntor is applied to a recursive function, all inner recursive calls now get routed through\nthe decorated version. For example:\n@locked\ndef factorial(n):\nif n <= 1: return 1\nelse: return n * factorial(n - 1)  # Calls the wrapped version of factorial\nIf the purpose of the decorator was related to some kind of system management such as\nsynchronization or locking, recursion is something probably best avoided.\nDocumentation Strings\nIt is common practice for the first statement of function to be a documentation string\ndescribing its usage. For example:\ndef factorial(n):\n\"\"\"Computes n factorial. For example:\n>>> factorial(6)\n120\n>>>\n\"\"\"\nif n <= 1: return 1\nelse: return n*factorial(n-1)\nThe documentation string is stored in the _ _doc_ _ attribute of the function that is\ncommonly used by IDEs to provide interactive help.\nIf you are using decorators, be aware that wrapping a function with a decorator can\nbreak the help features associated with documentation strings. For example, consider\nthis code:\ndef wrap(func):\ncall(*args,**kwargs):\nreturn func(*args,**kwargs)\nreturn call\n@wrap\ndef factorial(n):\n\"\"\"Computes n factorial.\"\"\"\n...\nIf a user requests help on this version of factorial(), he will get a rather cryptic\nexplanation:\n>>> help(factorial)\nHelp on function call in module __main__:\ncall(*args, **kwargs)\n(END)\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1583,
      "extraction_method": "Direct"
    },
    {
      "page_number": 139,
      "chapter": null,
      "content": "114\nChapter 6 Functions and Functional Programming\nTo fix this, write decorator functions so that they propagate the function name and\ndocumentation string. For example:\ndef wrap(func):\ncall(*args,**kwargs):\nreturn func(*args,**kwargs)\ncall.__doc__ = func.__doc__\ncall.__name__ = func.__name__\nreturn call\nBecause this is a common problem, the functools module provides a function wraps\nthat can automatically copy these attributes. Not surprisingly, it is also a decorator:\nfrom functools import wraps\ndef wrap(func):\n@wraps(func)\ncall(*args,**kwargs):\nreturn func(*args,**kwargs)\nreturn call\nThe @wraps(func) decorator, defined in functools, propagates attributes from func\nto the wrapper function that is being defined.\nFunction Attributes\nFunctions can have arbitrary attributes attached to them. Here’s an example:\ndef foo():\nstatements\nfoo.secure = 1\nfoo.private = 1\nFunction attributes are stored in a dictionary that is available as the __dict__ attribute\nof a function.\nThe primary use of function attributes is in highly specialized applications such as\nparser generators and application frameworks that would like to attach additional infor-\nmation to function objects.\nAs with documentation strings, care should be given if mixing function attributes\nwith decorators. If a function is wrapped by a decorator, access to the attributes will\nactually take place on the decorator function, not the original implementation.This may\nor may not be what you want depending on the application.To propagate already\ndefined function attributes to a decorator function, use the following template or the\nfunctools.wraps() decorator as shown in the previous section:\ndef wrap(func):\ncall(*args,**kwargs):\nreturn func(*args,**kwargs)\ncall.__doc__ = func.__doc__\ncall.__name__ = func.__name__\ncall.__dict__.update(func.__dict__)\nreturn call\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1860,
      "extraction_method": "Direct"
    },
    {
      "page_number": 140,
      "chapter": null,
      "content": "115\neval(), exec(), and compile()\neval(), exec(), and compile()\nThe eval(str [,globals [,locals]]) function executes an expression string and\nreturns the result. Here’s an example:\na = eval('3*math.sin(3.5+x) + 7.2')\nSimilarly, the exec(str [, globals [, locals]]) function executes a string con-\ntaining arbitrary Python code.The code supplied to exec() is executed as if the code\nactually appeared in place of the exec operation. Here’s an example:\na = [3, 5, 10, 13]\nexec(\"for i in a: print(i)\")\nOne caution with exec is that in Python 2, exec is actually defined as a statement.\nThus, in legacy code, you might see statements invoking exec without the surrounding\nparentheses, such as exec \"for i in a: print i\".Although this still works in\nPython 2.6, it breaks in Python 3. Modern programs should use exec() as a function.\nBoth of these functions execute within the namespace of the caller (which is used to\nresolve any symbols that appear within a string or file). Optionally, eval() and exec()\ncan accept one or two mapping objects that serve as the global and local namespaces for\nthe code to be executed, respectively. Here’s an example:\nglobals = {'x': 7,\n'y': 10,\n'birds': ['Parrot', 'Swallow', 'Albatross']\n}\nlocals = { }\n# Execute using the above dictionaries as the global and local namespace\na = eval(\"3 * x + 4 * y\", globals, locals)\nexec(\"for b in birds: print(b)\", globals, locals) \nIf you omit one or both namespaces, the current values of the global and local name-\nspaces are used.Also, due to issues related to nested scopes, the use of exec() inside of\na function body may result in a SyntaxError exception if that function also contains\nnested function definitions or uses the lambda operator.\nWhen a string is passed to exec() or eval() the parser first compiles it into byte-\ncode. Because this process is expensive, it may be better to precompile the code and\nreuse the bytecode on subsequent calls if the code will be executed multiple times.\nThe compile(str,filename,kind) function compiles a string into bytecode in\nwhich str is a string containing the code to be compiled and filename is the file in\nwhich the string is defined (for use in traceback generation).The kind argument speci-\nfies the type of code being compiled—'single' for a single statement, 'exec' for a\nset of statements, or 'eval' for an expression.The code object returned by the \ncompile() function can also be passed to the eval() function and exec() statement.\nHere’s an example:\ns = \"for i in range(0,10): print(i)\"\nc = compile(s,'','exec')      # Compile into a code object\nexec(c)                       # Execute it\ns2 = \"3 * x + 4 * y\"\nc2 = compile(s2, '', 'eval')  # Compile into an expression\nresult = eval(c2)             # Execute it\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2768,
      "extraction_method": "Direct"
    },
    {
      "page_number": 141,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 142,
      "chapter": null,
      "content": "7\nClasses and Object-Oriented\nProgramming\nClasses are the mechanism used to create new kinds of objects.This chapter covers\nthe details of classes, but is not intended to be an in-depth reference on object-oriented\nprogramming and design. It’s assumed that the reader has some prior experience with\ndata structures and object-oriented programming in other languages such as C or Java.\n(Chapter 3,“Types and Objects,” contains additional information about the terminology\nand internal implementation of objects.)\nThe class Statement\nA class defines a set of attributes that are associated with, and shared by, a collection of\nobjects known as instances.A class is most commonly a collection of functions (known\nas methods), variables (which are known as class variables), and computed attributes\n(which are known as properties).\nA class is defined using the class statement.The body of a class contains a series of\nstatements that execute during class definition. Here’s an example:\nclass Account(object):\nnum_accounts = 0\ndef __init__(self,name,balance):\nself.name = name\nself.balance = balance\nAccount.num_accounts += 1\ndef __del__(self):\nAccount.num_accounts -= 1\ndef deposit(self,amt):\nself.balance = self.balance + amt\ndef withdraw(self,amt):\nself.balance = self.balance - amt\ndef inquiry(self):\nreturn self.balance\nThe values created during the execution of the class body are placed into a class object\nthat serves as a namespace much like a module. For example, the members of the\nAccount class are accessed as follows:\nAccount.num_accounts\nAccount.__init__\nAccount.__del__\nAccount.deposit\nAccount.withdraw\nAccount.inquiry\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1652,
      "extraction_method": "Direct"
    },
    {
      "page_number": 143,
      "chapter": null,
      "content": "118\nChapter 7 Classes and Object-Oriented Programming\nIt’s important to note that a class statement by itself doesn’t create any instances of the\nclass (for example, no accounts are actually created in the preceding example). Rather, a\nclass merely sets up the attributes that will be common to all the instances that will be\ncreated later. In this sense, you might think of it as a blueprint.\nThe functions defined inside a class are known as instance methods.An instance\nmethod is a function that operates on an instance of the class, which is passed as the first\nargument. By convention, this argument is called self, although any legal identifier\nname can be used. In the preceding example, deposit(), withdraw(), and inquiry()\nare examples of instance methods.\nClass variables such as num_accounts are values that are shared among all instances\nof a class (that is, they’re not individually assigned to each instance). In this case, it’s a\nvariable that’s keeping track of how many Account instances are in existence.\nClass Instances\nInstances of a class are created by calling a class object as a function.This creates a new\ninstance that is then passed to the __init__() method of the class.The arguments to\n__init__() consist of the newly created instance self along with the arguments sup-\nplied when calling the class object. For example:\n# Create a few accounts\na = Account(\"Guido\", 1000.00)  # Invokes Account.__init__(a,\"Guido\",1000.00)\nb = Account(\"Bill\", 10.00)\nInside __init__(), attributes are saved in the instance by assigning to self. For\nexample, self.name = name is saving a name attribute in the instance. Once the\nnewly created instance has been returned to the user, these attributes as well as attrib-\nutes of the class are accessed using the dot (.) operator as follows:\na.deposit(100.00)        # Calls Account.deposit(a,100.00)\nb.withdraw(50.00)        # Calls Account.withdraw(b,50.00)\nname = a.name            # Get account name\nThe dot (.) operator is responsible for attribute binding.When you access an attribute,\nthe resulting value may come from several different places. For example, a.name in the\nprevious example returns the name attribute of the instance a. However, a.deposit\nreturns the deposit attribute (a method) of the Account class.When you access an\nattribute, the instance is checked first and if nothing is known, the search moves to the\ninstance’s class instead.This is the underlying mechanism by which a class shares its\nattributes with all of its instances.\nScoping Rules\nAlthough classes define a namespace, classes do not create a scope for names used inside\nthe bodies of methods.Therefore, when you’re implementing a class, references to\nattributes and methods must be fully qualified. For example, in methods you always ref-\nerence attributes of the instance through self. Thus, in the example you use\nself.balance, not balance. This also applies if you want to call a method from\nanother method, as shown in the following example:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3013,
      "extraction_method": "Direct"
    },
    {
      "page_number": 144,
      "chapter": null,
      "content": "119\nInheritance\nclass Foo(object):\ndef bar(self):\nprint(\"bar!\")\ndef spam(self):\nbar(self)     # Incorrect! 'bar' generates a NameError\nself.bar()    # This works\nFoo.bar(self) # This also works\nThe lack of scoping in classes is one area where Python differs from C++ or Java. If\nyou have used those languages, the self parameter in Python is the same as the this\npointer.The explicit use of self is required because Python does not provide a means\nto explicitly declare variables (that is, a declaration such as int x or float y in C).\nWithout this, there is no way to know whether an assignment to a variable in a method\nis supposed to be a local variable or if it’s supposed to be saved as an instance attribute.\nThe explicit use of self fixes this—all values stored on self are part of the instance\nand all other assignments are just local variables.\nInheritance\nInheritance is a mechanism for creating a new class that specializes or modifies the\nbehavior of an existing class.The original class is called a base class or a superclass.The\nnew class is called a derived class or a subclass.When a class is created via inheritance, it\n“inherits” the attributes defined by its base classes. However, a derived class may redefine\nany of these attributes and add new attributes of its own.\nInheritance is specified with a comma-separated list of base-class names in the class\nstatement. If there is no logical base class, a class inherits from object, as has been\nshown in prior examples. object is a class which is the root of all Python objects and\nwhich provides the default implementation of some common methods such as\n__str__(), which creates a string for use in printing.\nInheritance is often used to redefine the behavior of existing methods.As an exam-\nple, here’s a specialized version of Account that redefines the inquiry() method to\nperiodically overstate the current balance with the hope that someone not paying close\nattention will overdraw his account and incur a big penalty when making a payment on\ntheir subprime mortgage:\nimport random\nclass EvilAccount(Account):\ndef inquiry(self):\nif random.randint(0,4) == 1:\nreturn self.balance * 1.10   # Note: Patent pending idea\nelse:\nreturn self.balance\nc = EvilAccount(\"George\", 1000.00)\nc.deposit(10.0)          # Calls Account.deposit(c,10.0)\navailable = c.inquiry()  # Calls EvilAccount.inquiry(c)\nIn this example, instances of EvilAccount are identical to instances of Account except\nfor the redefined inquiry() method.\nInheritance is implemented with only a slight enhancement of the dot (.) operator.\nSpecifically, if the search for an attribute doesn’t find a match in the instance or the\ninstance’s class, the search moves on to the base class.This process continues until there\nare no more base classes to search. In the previous example, this explains why\nc.deposit() calls the implementation of deposit() defined in the Account class.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2930,
      "extraction_method": "Direct"
    },
    {
      "page_number": 145,
      "chapter": null,
      "content": "120\nChapter 7 Classes and Object-Oriented Programming\nA subclass can add new attributes to the instances by defining its own version of\n__init__(). For example, this version of EvilAccount adds a new attribute \nevilfactor:\nclass EvilAccount(Account):\ndef __init__(self,name,balance,evilfactor):\nAccount.__init__(self,name,balance)    # Initialize Account\nself.evilfactor = evilfactor\ndef inquiry(self):\nif random.randint(0,4) == 1:\nreturn self.balance * self.evilfactor\nelse:\nreturn self.balance\nWhen a derived class defines __init__(), the __init__() methods of base classes are\nnot automatically invoked.Therefore, it’s up to a derived class to perform the proper\ninitialization of the base classes by calling their __init__() methods. In the previous\nexample, this is shown in the statement that calls Account.__init__(). If a base class\ndoes not define __init__(), this step can be omitted. If you don’t know whether the\nbase class defines __init__(), it is always safe to call it without any arguments because\nthere is always a default implementation that simply does nothing.\nOccasionally, a derived class will reimplement a method but also want to call the\noriginal implementation.To do this, a method can explicitly call the original method in\nthe base class, passing the instance self as the first parameter as shown here:\nclass MoreEvilAccount(EvilAccount):\ndef deposit(self,amount):\nself.withdraw(5.00)              # Subtract the \"convenience\" fee\nEvilAccount.deposit(self,amount) # Now, make deposit\nA subtlety in this example is that the class EvilAccount doesn’t actually implement the\ndeposit() method. Instead, it is implemented in the Account class.Although this code\nworks, it might be confusing to someone reading the code (e.g., was EvilAccount sup-\nposed to implement deposit()?).Therefore, an alternative solution is to use the\nsuper() function as follows:\nclass MoreEvilAccount(EvilAccount):\ndef deposit(self,amount):\nself.withdraw(5.00)                         # Subtract convenience fee\nsuper(MoreEvilAccount,self).deposit(amount) # Now, make deposit\nsuper(cls, instance) returns a special object that lets you perform attribute\nlookups on the base classes. If you use this, Python will search for an attribute using the\nnormal search rules that would have been used on the base classes.This frees you from\nhard-coding the exact location of a method and more clearly states your intentions (that\nis, you want to call the previous implementation without regard for which base class\ndefines it). Unfortunately, the syntax of super() leaves much to be desired. If you are\nusing Python 3, you can use the simplified statement super().deposit(amount) to\ncarry out the calculation shown in the example. In Python 2, however, you have to use\nthe more verbose version.\nPython supports multiple inheritance.This is specified by having a class list multiple\nbase classes. For example, here are a collection of classes:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2957,
      "extraction_method": "Direct"
    },
    {
      "page_number": 146,
      "chapter": null,
      "content": "121\nInheritance\nclass DepositCharge(object):\nfee = 5.00\ndef deposit_fee(self):\nself.withdraw(self.fee)\nclass WithdrawCharge(object):\nfee = 2.50\ndef withdraw_fee(self):\nself.withdraw(self.fee)\n# Class using multiple inheritance\nclass MostEvilAccount(EvilAccount, DepositCharge, WithdrawCharge):\ndef deposit(self,amt):\nself.deposit_fee()\nsuper(MostEvilAccount,self).deposit(amt)\ndef withdraw(self,amt):\nself.withdraw_fee()\nsuper(MostEvilAcount,self).withdraw(amt)\nWhen multiple inheritance is used, attribute resolution becomes considerably more\ncomplicated because there are many possible search paths that could be used to bind\nattributes.To illustrate the possible complexity, consider the following statements:\nd = MostEvilAccount(\"Dave\",500.00,1.10)\nd.deposit_fee()    # Calls DepositCharge.deposit_fee().   Fee is 5.00\nd.withdraw_fee()   # Calls WithdrawCharge.withdraw_fee(). Fee is 5.00 ??\nIn this example, methods such as deposit_fee() and withdraw_fee() are uniquely\nnamed and found in their respective base classes. However, the withdraw_fee() func-\ntion doesn’t seem to work right because it doesn’t actually use the value of fee that was\ninitialized in its own class.What has happened is that the attribute fee is a class variable\ndefined in two different base classes. One of those values is used, but which one? (Hint:\nit’s DepositCharge.fee.)\nTo find attributes with multiple inheritance, all base classes are ordered in a list from\nthe “most specialized” class to the “least specialized” class.Then, when searching for an\nattribute, this list is searched in order until the first definition of the attribute is found.\nIn the example, the class EvilAccount is more specialized than Account because it\ninherits from Account. Similarly, within MostEvilAccount, DepositCharge is con-\nsidered to be more specialized than WithdrawCharge because it is listed first in the list\nof base classes. For any given class, the ordering of base classes can be viewed by print-\ning its __mro__ attribute. Here’s an example:\n>>> MostEvilAccount.__mro__\n(<class '__main__.MostEvilAccount'>, \n<class '__main__.EvilAccount'>,\n<class '__main__.Account'>,\n<class '__main__.DepositCharge'>,\n<class '__main__.WithdrawCharge'>,\n<type 'object'>)\n>>>\nIn most cases, this list is based on rules that “make sense.”That is, a derived class is\nalways checked before its base classes and if a class has more than one parent, the parents\nare always checked in the same order as listed in the class definition. However, the pre-\ncise ordering of base classes is actually quite complex and not based on any sort of\n“simple” algorithm such as depth-first or breadth-first search. Instead, the ordering is\ndetermined according to the C3 linearization algorithm, which is described in the\npaper “A Monotonic Superclass Linearization for Dylan” (K. Barrett, et al, presented at\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2875,
      "extraction_method": "Direct"
    },
    {
      "page_number": 147,
      "chapter": null,
      "content": "122\nChapter 7 Classes and Object-Oriented Programming\nOOPSLA’96).A subtle aspect of this algorithm is that certain class hierarchies will be\nrejected by Python with a TypeError. Here’s an example:\nclass X(object): pass\nclass Y(X): pass\nclass Z(X,Y): pass  # TypeError.\n# Can't create consistent method resolution order__\nIn this case, the method resolution algorithm rejects class Z because it can’t determine\nan ordering of the base classes that makes sense. For example, the class X appears before\nclass Y in the inheritance list, so it must be checked first. However, class Y is more spe-\ncialized because it inherits from X.Therefore, if X is checked first, it would not be possi-\nble to resolve specialized methods in Y. In practice, these issues should rarely arise—and\nif they do, it usually indicates a more serious design problem with a program.\nAs a general rule, multiple inheritance is something best avoided in most programs.\nHowever, it is sometimes used to define what are known as mixin classes.A mixin class\ntypically defines a set of methods that are meant to be “mixed in” to other classes in\norder to add extra functionality (almost like a macro).Typically, the methods in a \nmixin will assume that other methods are present and will build upon them.The\nDepositCharge and WithdrawCharge classes in the earlier example illustrate this.\nThese classes add new methods such as deposit_fee() to classes that include them as\none of the base classes. However, you would never instantiate DepositCharge by itself.\nIn fact, if you did, it wouldn’t create an instance that could be used for anything useful\n(that is, the one defined method wouldn’t even execute correctly).\nJust as a final note, if you wanted to fix the problematic references to fee in this\nexample, the implementation of deposit_fee() and withdraw_fee() should be\nchanged to refer to the attribute directly using the class name instead of self (for\nexample, DepositChange.fee).\nPolymorphism Dynamic Binding and Duck\nTyping\nDynamic binding (also sometimes referred to as polymorphism when used in the context of\ninheritance) is the capability to use an instance without regard for its type. It is handled\nentirely through the attribute lookup process described for inheritance in the preceding\nsection.Whenever an attribute is accessed as obj.attr, attr is located by searching\nwithin the instance itself, the instance’s class definition, and then base classes, in that\norder.The first match found is returned.\nA critical aspect of this binding process is that it is independent of what kind of\nobject obj is.Thus, if you make a lookup such as obj.name, it will work on any obj\nthat happens to have a name attribute.This behavior is sometimes referred to as duck\ntyping in reference to the adage “if it looks like, quacks like, and walks like a duck, then\nit’s a duck.”\nPython programmers often write programs that rely on this behavior. For example, if\nyou want to make a customized version of an existing object, you can either inherit\nfrom it or you can simply create a completely new object that looks and acts like it but\nis otherwise unrelated.This latter approach is often used to maintain a loose coupling of\nprogram components. For example, code may be written to work with any kind of\nobject whatsoever as long as it has a certain set of methods. One of the most common\nexamples is with various “file-like” objects defined in the standard library.Although\nthese objects work like files, they don’t inherit from the built-in file object.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3547,
      "extraction_method": "Direct"
    },
    {
      "page_number": 148,
      "chapter": null,
      "content": "123\nStatic Methods and Class Methods\nStatic Methods and Class Methods\nIn a class definition, all functions are assumed to operate on an instance, which is always\npassed as the first parameter self. However, there are two other common kinds of\nmethods that can be defined.\nA static method is an ordinary function that just happens to live in the namespace\ndefined by a class. It does not operate on any kind of instance.To define a static\nmethod, use the @staticmethod decorator as shown here:\nclass Foo(object):\n@staticmethod\ndef add(x,y):\nreturn x + y\nTo call a static method, you just prefix it by the class name.You do not pass it any addi-\ntional information. For example:\nx = Foo.add(3,4)       # x  = 7\nA common use of static methods is in writing classes where you might have many dif-\nferent ways to create new instances. Because there can only be one __init__() func-\ntion, alternative creation functions are often defined as shown here:\nclass Date(object):\ndef __init__(self,year,month,day):\nself.year = year\nself.month = month\nself.day = day\n@staticmethod\ndef now():\nt = time.localtime()\nreturn Date(t.tm_year, t.tm_mon, t.tm_day)\n@staticmethod\ndef tomorrow():\nt = time.localtime(time.time()+86400)\nreturn Date(t.tm_year, t.tm_mon, t.tm_day)\n# Example of creating some dates\na = Date(1967, 4, 9)\nb = Date.now()       # Calls static method now()\nc = Date.tomorrow()  # Calls static method tomorrow()\nClass methods are methods that operate on the class itself as an object. Defined using the\n@classmethod decorator, a class method is different than an instance method in that\nthe class is passed as the first argument which is named cls by convention. For \nexample:\nclass Times(object):\nfactor = 1\n@classmethod\ndef mul(cls,x):\nreturn cls.factor*x\nclass TwoTimes(Times):\nfactor = 2\nx = TwoTimes.mul(4)      # Calls Times.mul(TwoTimes, 4) -> 8\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1873,
      "extraction_method": "Direct"
    },
    {
      "page_number": 149,
      "chapter": null,
      "content": "124\nChapter 7 Classes and Object-Oriented Programming\nIn this example, notice how the class TwoTimes is passed to mul() as an object.\nAlthough this example is esoteric, there are practical, but subtle, uses of class methods.\nAs an example, suppose that you defined a class that inherited from the Date class\nshown previously and customized it slightly:\nclass EuroDate(Date):\n# Modify string conversion to use European dates\ndef __str__(self):\nreturn \"%02d/%02d/%4d\" % (self.day, self.month, self.year)\nBecause the class inherits from Date, it has all of the same features. However, the now()\nand tomorrow() methods are slightly broken. For example, if someone calls\nEuroDate.now(), a Date object is returned instead of a EuroDate object.A class\nmethod can fix this:\nclass Date(object):\n...\n@classmethod\ndef now(cls):\nt = time.localtime()\n# Create an object of the appropriate type\nreturn cls(t.tm_year, t.tm_month, t.tm_day)\nclass EuroDate(Date):\n...\na = Date.now()       # Calls Date.now(Date) and returns a Date\nb = EuroDate.now()   # Calls Date.now(EuroDate) and returns a EuroDate\nOne caution about static and class methods is that Python does not manage these meth-\nods in a separate namespace than the instance methods.As a result, they can be invoked\non an instance. For example:\na = Date(1967,4,9)\nb = d.now()          # Calls Date.now(Date)\nThis is potentially quite confusing because a call to d.now() doesn’t really have any-\nthing to do with the instance d.This behavior is one area where the Python object sys-\ntem differs from that found in other OO languages such as Smalltalk and Ruby. In\nthose languages, class methods are strictly separate from instance methods.\nProperties\nNormally, when you access an attribute of an instance or a class, the associated value\nthat is stored is returned.A property is a special kind of attribute that computes its value\nwhen accessed. Here is a simple example:\nclass Circle(object):\ndef __init__(self,radius):\nself.radius = radius\n# Some additional properties of Circles\n@property\ndef area(self):\nreturn math.pi*self.radius**2\n@property\ndef perimeter(self):\nreturn 2*math.pi*self.radius\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2161,
      "extraction_method": "Direct"
    },
    {
      "page_number": 150,
      "chapter": null,
      "content": "125\nProperties\nThe resulting Circle object behaves as follows:\n>>> c = Circle(4.0)\n>>> c.radius\n4.0\n>>> c.area\n50.26548245743669\n>>> c.perimeter\n25.132741228718345\n>>> c.area = 2\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nAttributeError: can't set attribute\n>>>\nIn this example, Circle instances have an instance variable c.radius that is stored.\nc.area and c.perimeter are simply computed from that value.The @property deco-\nrator makes it possible for the method that follows to be accessed as a simple attribute,\nwithout the extra () that you would normally have to add to call the method.To the\nuser of the object, there is no obvious indication that an attribute is being computed\nother than the fact that an error message is generated if an attempt is made to redefine\nthe attribute (as shown in the AttributeError exception above).\nUsing properties in this way is related to something known as the Uniform Access\nPrinciple. Essentially, if you’re defining a class, it is always a good idea to make the pro-\ngramming interface to it as uniform as possible.Without properties, certain attributes of\nan object would be accessed as a simple attribute such as c.radius whereas other\nattributes would be accessed as methods such as c.area(). Keeping track of when to\nadd the extra () adds unnecessary confusion.A property can fix this.\nPython programmers don’t often realize that methods themselves are implicitly han-\ndled as a kind of property. Consider this class:\nclass Foo(object):\ndef __init__(self,name):\nself.name = name\ndef spam(self,x):\nprint(\"%s, %s\" % (self.name, x)\nWhen a user creates an instance such as f = Foo(\"Guido\") and then accesses f.spam,\nthe original function object spam is not returned. Instead, you get something known as\na bound method, which is an object that represents the method call that will execute\nwhen the () operator is invoked on it.A bound method is like a partially evaluated\nfunction where the self parameter has already been filled in, but the additional argu-\nments still need to be supplied by you when you call it using ().The creation of this\nbound method object is silently handled through a property function that executes\nbehind the scenes.When you define static and class methods using @staticmethod and\n@classmethod, you are actually specifying the use of a different property function \nthat will handle the access to those methods in a different way. For example,\n@staticmethod simply returns the method function back “as is” without any special\nwrapping or processing.\nProperties can also intercept operations to set and delete an attribute.This is done by\nattaching additional setter and deleter methods to a property. Here is an example:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2745,
      "extraction_method": "Direct"
    },
    {
      "page_number": 151,
      "chapter": null,
      "content": "126\nChapter 7 Classes and Object-Oriented Programming\nclass Foo(object):\ndef __init__(self,name):\nself._ _name = name\n@property\ndef name(self):\nreturn self.__name\n@name.setter\ndef name(self,value):\nif not isinstance(value,str):\nraise TypeError(\"Must be a string!\")\nself.__name = value\n@name.deleter\ndef name(self):\nraise TypeError(\"Can't delete name\")\nf = Foo(\"Guido\")\nn = f.name         # calls f.name() - get function\nf.name = \"Monty\"   # calls setter name(f,\"Monty\")\nf.name = 45        # calls setter name(f,45) -> TypeError\ndel f.name         # Calls deleter name(f) -> TypeError\nIn this example, the attribute name is first defined as a read-only property using the\n@property decorator and associated method.The @name.setter and @name.deleter\ndecorators that follow are associating additional methods with the set and deletion\noperations on the name attribute.The names of these methods must exactly match the\nname of the original property. In these methods, notice that the actual value of the\nname is stored in an attribute __name.The name of the stored attribute does not have\nto follow any convention, but it has to be different than the property in order to distin-\nguish it from the name of the property itself.\nIn older code, you will often see properties defined using the property(getf=None,\nsetf=None, delf=None, doc=None) function with a set of uniquely named methods\nfor carrying out each operation. For example:\nclass Foo(object):\ndef getname(self):\nreturn self.__name\ndef setname(self,value):\nif not isinstance(value,str):\nraise TypeError(\"Must be a string!\")\nself.__name = value\ndef delname(self):\nraise TypeError(\"Can't delete name\")\nname = property(getname,setname,delname)\nThis older approach is still supported, but the decorator version tends to lead to classes\nthat are a little more polished. For example, if you use decorators, the get, set, and\ndelete functions aren’t also visible as methods.\nDescriptors\nWith properties, access to an attribute is controlled by a series of user-defined get, set,\nand delete functions.This sort of attribute control can be further generalized through\nthe use of a descriptor object.A descriptor is simply an object that represents the value of\nan attribute. By implementing one or more of the special methods __get__(),\n__set__(), and __delete__(), it can hook into the attribute access mechanism and\ncan customize those operations. Here is an example:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2438,
      "extraction_method": "Direct"
    },
    {
      "page_number": 152,
      "chapter": null,
      "content": "127\nData Encapsulation and Private Attributes\nclass TypedProperty(object):\ndef __init__(self,name,type,default=None):\nself.name = \"_\" + name\nself.type = type \nself.default = default if default else type()\ndef __get__(self,instance,cls):\nreturn getattr(instance,self.name,self.default)\ndef __set__(self,instance,value):\nif not isinstance(value,self.type):\nraise TypeError(\"Must be a %s\" % self.type)\nsetattr(instance,self.name,value)\ndef __delete__(self,instance):\nraise AttributeError(\"Can't delete attribute\")\nclass Foo(object):\nname = TypedProperty(\"name\",str)\nnum  = TypedProperty(\"num\",int,42)\nIn this example, the class TypedProperty defines a descriptor where type checking is\nperformed when the attribute is assigned and an error is produced if an attempt is made\nto delete the attribute. For example:\nf = Foo()\na = f.name           # Implicitly calls Foo.name.__get__(f,Foo)\nf.name = \"Guido\"     # Calls Foo.name.__set__(f,\"Guido\")\ndel f.name           # Calls Foo.name.__delete__(f)\nDescriptors can only be instantiated at the class level. It is not legal to create descriptors\non a per-instance basis by creating descriptor objects inside __init__() and other\nmethods.Also, the attribute name used by the class to hold a descriptor takes prece-\ndence over attributes stored on instances. In the previous example, this is why the\ndescriptor object takes a name parameter and why the name is changed slightly by\ninserting a leading underscore. In order for the descriptor to store a value on the\ninstance, it has to pick a name that is different than that being used by the descriptor\nitself.\nData Encapsulation and Private Attributes\nBy default, all attributes and methods of a class are “public.”This means that they are all\naccessible without any restrictions. It also implies that everything defined in a base class\nis inherited and accessible within a derived class.This behavior is often undesirable in\nobject-oriented applications because it exposes the internal implementation of an object\nand can lead to namespace conflicts between objects defined in a derived class and those\ndefined in a base class.\nTo fix this problem, all names in a class that start with a double underscore, such as\n__Foo, are automatically mangled to form a new name of the form _Classname__Foo.\nThis effectively provides a way for a class to have private attributes and methods because\nprivate names used in a derived class won’t collide with the same private names used in\na base class. Here’s an example:\nclass A(object):\ndef __init__(self):\nself.__X = 3        # Mangled to self._A__X\ndef __spam(self):       # Mangled to _A__spam()\npass\ndef bar(self):\nself.__spam()       # Only calls A.__spam()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2715,
      "extraction_method": "Direct"
    },
    {
      "page_number": 153,
      "chapter": null,
      "content": "128\nChapter 7 Classes and Object-Oriented Programming\nclass B(A):\ndef __init__(self):\nA.__init__(self)\nself.__X = 37       # Mangled to self._B__X\ndef __spam(self):       # Mangled to _B__spam()\npass\nAlthough this scheme provides the illusion of data hiding, there’s no strict mechanism in\nplace to actually prevent access to the “private” attributes of a class. In particular, if the\nname of the class and corresponding private attribute are known, they can be accessed\nusing the mangled name.A class can make these attributes less visible by redefining the\n__dir__() method, which supplies the list of names returned by the dir() function\nthat’s used to inspect objects.\nAlthough this name mangling might look like an extra processing step, the mangling\nprocess actually only occurs once at the time a class is defined. It does not occur during\nexecution of the methods, nor does it add extra overhead to program execution.Also,\nbe aware that name mangling does not occur in functions such as getattr(),\nhasattr(), setattr(), or delattr() where the attribute name is specified as a\nstring. For these functions, you need to explicitly use the mangled name such as\n_Classname__name to access the attribute.\nIt is recommended that private attributes be used when defining mutable attributes\nvia properties. By doing so, you will encourage users to use the property name rather\nthan accessing the underlying instance data directly (which is probably not what you\nintended if you wrapped it with a property to begin with).An example of this appeared\nin the previous section.\nGiving a method a private name is a technique that a superclass can use to prevent a\nderived class from redefining and changing the implementation of a method. For exam-\nple, the A.bar() method in the example only calls A.__spam(), regardless of the type\nof self or the presence of a different __spam() method in a derived class.\nFinally, don’t confuse the naming of private class attributes with the naming of “pri-\nvate” definitions in a module.A common mistake is to define a class where a single\nleading underscore is used on attribute names in an effort to hide their values (e.g.,\n_name). In modules, this naming convention prevents names from being exported by\nthe from module import * statement. However, in classes, this naming convention\ndoes not hide the attribute nor does it prevent name clashes that arise if someone\ninherits from the class and defines a new attribute or method with the same name.\nObject Memory Management\nWhen a class is defined, the resulting class is a factory for creating new instances. For\nexample:\nclass Circle(object):\ndef __init__(self,radius):\nself.radius = radius\n# Create some Circle instances\nc = Circle(4.0)\nd = Circle(5.0)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2764,
      "extraction_method": "Direct"
    },
    {
      "page_number": 154,
      "chapter": null,
      "content": "129\nObject Memory Management\nThe creation of an instance is carried out in two steps using the special method\n__new__(), which creates a new instance, and __init__(), which initializes it. For\nexample, the operation c = Circle(4.0) performs these steps:\nc = Circle.__new__(Circle, 4.0)\nif isinstance(c,Circle):\nCircle.__init__(c,4.0)\nThe __new__() method of a class is something that is rarely defined by user code. If it\nis defined, it is typically written with the prototype __new__(cls, *args,\n**kwargs) where args and kwargs are the same arguments that will be passed to\n__init__(). __new__() is always a class method that receives the class object as the\nfirst parameter.Although __new__() creates an instance, it does not automatically call\n__init__().\nIf you see __new__() defined in a class, it usually means the class is doing one of\ntwo things. First, the class might be inheriting from a base class whose instances are\nimmutable.This is common if defining objects that inherit from an immutable built-in\ntype such as an integer, string, or tuple because __new__() is the only method that\nexecutes prior to the instance being created and is the only place where the value could\nbe modified (in __init__(), it would be too late). For example:\nclass Upperstr(str):\ndef __new__(cls,value=\"\"):\nreturn str.__new__(cls, value.upper())\nu = Upperstr(\"hello\")     # value is \"HELLO\"\nThe other major use of __new__() is when defining metaclasses.This is described at\nthe end of this chapter.\nOnce created, instances are managed by reference counting. If the reference count\nreaches zero, the instance is immediately destroyed.When the instance is about to be\ndestroyed, the interpreter first looks for a __del__() method associated with the\nobject and calls it. In practice, it’s rarely necessary for a class to define a __del__()\nmethod.The only exception is when the destruction of an object requires a cleanup\naction such as closing a file, shutting down a network connection, or releasing other\nsystem resources. Even in these cases, it’s dangerous to rely on __del__() for a clean\nshutdown because there’s no guarantee that this method will be called when the inter-\npreter exits.A better approach may be to define a method such as close() that a pro-\ngram can use to explicitly perform a shutdown.\nOccasionally, a program will use the del statement to delete a reference to an\nobject. If this causes the reference count of the object to reach zero, the __del__()\nmethod is called. However, in general, the del statement doesn’t directly call\n__del__().\nA subtle danger involving object destruction is that instances for which __del__()\nis defined cannot be collected by Python’s cyclic garbage collector (which is a strong\nreason not to define __del__ unless you need to). Programmers coming from lan-\nguages without automatic garbage collection (e.g., C++) should take care not to adopt\na programming style where __del__() is unnecessarily defined.Although it is rare to\nbreak the garbage collector by defining __del__(), there are certain types of program-\nming patterns, especially those involving parent-child relationships or graphs, where this\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3178,
      "extraction_method": "Direct"
    },
    {
      "page_number": 155,
      "chapter": null,
      "content": "130\nChapter 7 Classes and Object-Oriented Programming\ncan be a problem. For example, suppose you had an object that was implementing a\nvariant of the “Observer Pattern.”\nclass Account(object):\ndef __init__(self,name,balance):\nself.name = name\nself.balance = balance\nself.observers = set()\ndef __del__(self):\nfor ob in self.observers:\nob.close()\ndel self.observers\ndef register(self,observer):\nself.observers.add(observer)\ndef unregister(self,observer):\nself.observers.remove(observer)\ndef notify(self):\nfor ob in self.observers:\nob.update()\ndef withdraw(self,amt):\nself.balance -= amt\nself.notify()\nclass AccountObserver(object):\ndef __init__(self, theaccount):\nself.theaccount = theaccount\ntheaccount.register(self)\ndef __del__(self):\nself.theaccount.unregister(self)\ndel self.theaccount\ndef update(self):\nprint(\"Balance is %0.2f\" % self.theaccount.balance)\ndef close(self):\nprint(\"Account no longer in use\")\n# Example setup\na = Account('Dave',1000.00)\na_ob = AccountObserver(a)\nIn this code, the Account class allows a set of AccountObserver objects to monitor an\nAccount instance by receiving an update whenever the balance changes.To do this,\neach Account keeps a set of the observers and each AccountObserver keeps a refer-\nence back to the account. Each class has defined __del__() in an attempt to provide\nsome sort of cleanup (such as unregistering and so on). However, it just doesn’t work.\nInstead, the classes have created a reference cycle in which the reference count never\ndrops to 0 and there is no cleanup. Not only that, the garbage collector (the gc module)\nwon’t even clean it up, resulting in a permanent memory leak.\nOne way to fix the problem shown in this example is for one of the classes to create\na weak reference to the other using the weakref module.A weak reference is a way of\ncreating a reference to an object without increasing its reference count.To work with a\nweak reference, you have to add an extra bit of functionality to check whether the\nobject being referred to still exists. Here is an example of a modified observer class:\nimport weakref\nclass AccountObserver(object):\ndef __init__(self, theaccount):\nself.accountref = weakref.ref(theaccount)  # Create a weakref\ntheaccount.register(self)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2254,
      "extraction_method": "Direct"
    },
    {
      "page_number": 156,
      "chapter": null,
      "content": "131\nObject Representation and Attribute Binding\ndef __del__(self):\nacc = self.accountref()        # Get account\nif acc:                        # Unregister if still exists\nacc.unregister(self)\ndef update(self):\nprint(\"Balance is %0.2f\" % self.accountref().balance)\ndef close(self):\nprint(\"Account no longer in use\")\n# Example setup\na = Account('Dave',1000.00)\na_ob = AccountObserver(a)\nIn this example, a weak reference accountref is created.To access the underlying\nAccount, you call it like a function.This either returns the Account or None if it’s no\nlonger around.With this modification, there is no longer a reference cycle. If the\nAccount object is destroyed, its __del__ method runs and observers receive notifica-\ntion.The gc module also works properly. More information about the weakref module\ncan be found in Chapter 13,“Python Runtime Services.”\nObject Representation and Attribute Binding\nInternally, instances are implemented using a dictionary that’s accessible as the instance’s\n__dict__ attribute.This dictionary contains the data that’s unique to each instance.\nHere’s an example:\n>>> a = Account('Guido', 1100.0)\n>>> a.__dict__\n{'balance': 1100.0, 'name': 'Guido'}\nNew attributes can be added to an instance at any time, like this:\na.number = 123456    # Add attribute 'number' to a.__dict__\nModifications to an instance are always reflected in the local __dict__ attribute.\nLikewise, if you make modifications to __dict__ directly, those modifications are\nreflected in the attributes.\nInstances are linked back to their class by a special attribute __class__.The class\nitself is also just a thin layer over a dictionary which can be found in its own __dict__\nattribute.The class dictionary is where you find the methods. For example:\n>>> a.__class__\n<class '__main__.Account'>\n>>> Account.__dict__.keys()\n['__dict__', '__module__', 'inquiry', 'deposit', 'withdraw', \n'__del__', 'num_accounts', '__weakref__', '__doc__', '__init__']\n>>>\nFinally, classes are linked to their base classes in a special attribute __bases__, which is\na tuple of the base classes.This underlying structure is the basis for all of the operations\nthat get, set, and delete the attributes of objects.\nWhenever an attribute is set using obj.name = value, the special method\nobj.__setattr__(\"name\", value) is invoked. If an attribute is deleted using del\nobj.name, the special method obj.__delattr__(\"name\") is invoked.The default\nbehavior of these methods is to modify or remove values from the local __dict__ of\nobj unless the requested attribute happens to correspond to a property or descriptor. In\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2618,
      "extraction_method": "Direct"
    },
    {
      "page_number": 157,
      "chapter": null,
      "content": "132\nChapter 7 Classes and Object-Oriented Programming\nthat case, the set and delete operation will be carried out by the set and delete functions\nassociated with the property.\nFor attribute lookup such as obj.name, the special method \nobj.__getattrribute__(\"name\") is invoked.This method carries out the search\nprocess for finding the attribute, which normally includes checking for properties, look-\ning in the local __dict__ attribute, checking the class dictionary, and searching the\nbase classes. If this search process fails, a final attempt to find the attribute is made by\ntrying to invoke the __getattr__() method of the class (if defined). If this fails, an\nAttributeError exception is raised.\nUser-defined classes can implement their own versions of the attribute access func-\ntions, if desired. For example:\nclass Circle(object):\ndef __init__(self,radius):\nself.radius = radius\ndef __getattr__(self,name):\nif name == 'area':\nreturn math.pi*self.radius**2\nelif name == 'perimeter':\nreturn 2*math.pi*self.radius\nelse:\nreturn object.__getattr__(self,name)\ndef __setattr__(self,name,value):\nif name in ['area','perimeter']:\nraise TypeError(\"%s is readonly\" % name)\nobject.__setattr__(self,name,value)\nA class that reimplements these methods should probably rely upon the default imple-\nmentation in object to carry out the actual work.This is because the default imple-\nmentation takes care of the more advanced features of classes such as descriptors and\nproperties.\nAs a general rule, it is relatively uncommon for classes to redefine the attribute access\noperators. However, one application where they are often used is in writing general-\npurpose wrappers and proxies to existing objects. By redefining __getattr__(),\n__setattr__(), and __delattr__(), a proxy can capture attribute access and trans-\nparently forward those operations on to another object.\n__slots__\nA class can restrict the set of legal instance attribute names by defining a special variable\ncalled __slots__. Here’s an example:\nclass Account(object):\n__slots__ = ('name','balance')\n...\nWhen __slots__ is defined, the attribute names that can be assigned on instances are\nrestricted to the names specified. Otherwise, an AttributeError exception is raised.\nThis restriction prevents someone from adding new attributes to existing instances and\nsolves the problem that arises if someone assigns a value to an attribute that they can’t\nspell correctly.\nIn reality, __slots__ was never implemented to be a safety feature. Instead, it is\nactually a performance optimization for both memory and execution speed. Instances of\na class that uses __slots__ no longer use a dictionary for storing instance data.\nInstead, a much more compact data structure based on an array is used. In programs that\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2791,
      "extraction_method": "Direct"
    },
    {
      "page_number": 158,
      "chapter": null,
      "content": "133\nOperator Overloading\ncreate a large number of objects, using __slots__ can result in a substantial reduction\nin memory use and execution time.\nBe aware that the use of __slots__ has a tricky interaction with inheritance. If a\nclass inherits from a base class that uses __slots__, it also needs to define __slots__\nfor storing its own attributes (even if it doesn’t add any) to take advantage of the bene-\nfits __slots__ provides. If you forget this, the derived class will run slower and use\neven more memory than what would have been used if __slots__ had not been used\non any of the classes! \nThe use of __slots__ can also break code that expects instances to have an under-\nlying __dict__ attribute.Although this often does not apply to user code, utility\nlibraries and other tools for supporting objects may be programmed to look at\n__dict__ for debugging, serializing objects, and other operations.\nFinally, the presence of __slots__ has no effect on the invocation of methods such\nas __getattribute__(), __getattr__(), and __setattr__() should they be rede-\nfined in a class. However, the default behavior of these methods will take __slots__\ninto account. In addition, it should be stressed that it is not necessary to add method or\nproperty names to __slots__, as they are stored in the class, not on a per-instance\nbasis.\nOperator Overloading\nUser-defined objects can be made to work with all of Python’s built-in operators by\nadding implementations of the special methods described in Chapter 3 to a class. For\nexample, if you wanted to add a new kind of number to Python, you could define a\nclass in which special methods such as __add__() were defined to make instances\nwork with the standard mathematical operators.\nThe following example shows how this works by defining a class that implements\nthe complex numbers with some of the standard mathematical operators.\nNote\nBecause Python already provides a complex number type, this class is only provided for\nthe purpose of illustration.\nclass Complex(object):\ndef __init__(self,real,imag=0):\nself.real = float(real)\nself.imag = float(imag)\ndef __repr__(self):\nreturn \"Complex(%s,%s)\" % (self.real, self.imag)\ndef __str__(self):\nreturn \"(%g+%gj)\" % (self.real, self.imag)\n# self + other\ndef __add__(self,other):\nreturn Complex(self.real + other.real, self.imag + other.imag)\n# self - other\ndef __sub__(self,other):\nreturn Complex(self.real - other.real, self.imag - other.imag)\nIn the example, the __repr__() method creates a string that can be evaluated to re-\ncreate the object (that is, \"Complex(real,imag)\").This convention should be followed\nfor all user-defined objects as applicable. On the other hand, the __str__() method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2718,
      "extraction_method": "Direct"
    },
    {
      "page_number": 159,
      "chapter": null,
      "content": "134\nChapter 7 Classes and Object-Oriented Programming\ncreates a string that’s intended for nice output formatting (this is the string that would\nbe produced by the print statement).\nThe other operators, such as __add__() and __sub__(), implement mathematical\noperations.A delicate matter with these operators concerns the order of operands and\ntype coercion.As implemented in the previous example, the __add__() and\n__sub__() operators are applied only if a complex number appears on the left side of\nthe operator.They do not work if they appear on the right side of the operator and the\nleft-most operand is not a Complex. For example:\n>>> c = Complex(2,3)\n>>> c + 4.0\nComplex(6.0,3.0)\n>>> 4.0 + c\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: unsupported operand type(s) for +: 'int' and 'Complex'\n>>>\nThe operation c + 4.0 works partly by accident.All of Python’s built-in numbers\nalready have .real and .imag attributes, so they were used in the calculation. If the\nother object did not have these attributes, the implementation would break. If you\nwant your implementation of Complex to work with objects missing these attributes,\nyou have to add extra conversion code to extract the needed information (which might\ndepend on the type of the other object).\nThe operation 4.0 + c does not work at all because the built-in floating point type\ndoesn’t know anything about the Complex class.To fix this, you can add reversed-\noperand methods to Complex:\nclass Complex(object):\n...\ndef __radd__(self,other):\nreturn Complex(other.real + self.real, other.imag + self.imag)\ndef __rsub__(self,other):\nreturn Complex(other.real - self.real, other.imag - self.img)\n...\nThese methods serve as a fallback. If the operation 4.0 + c fails, Python tries to exe-\ncute c.__radd__(4.0) first before issuing a TypeError.\nOlder versions of Python have tried various approaches to coerce types in mixed-\ntype operations. For example, you might encounter legacy Python classes that imple-\nment a __coerce__() method.This is no longer used by Python 2.6 or Python 3.\nAlso, don’t be fooled  by special methods such as __int__(), __float__(), or\n__complex__().Although these methods are called by explicit conversions such as\nint(x) or float(x), they are never called implicitly to perform type conversion in\nmixed-type arithmetic. So, if you are writing classes where operators must work with\nmixed types, you have to explicitly handle the type conversion in the implementation of\neach operator.\nTypes and Class Membership Tests\nWhen you create an instance of a class, the type of that instance is the class itself.To test\nfor membership in a class, use the built-in function isinstance(obj,cname).This\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2741,
      "extraction_method": "Direct"
    },
    {
      "page_number": 160,
      "chapter": null,
      "content": "135\nTypes and Class Membership Tests\nfunction returns True if an object, obj, belongs to the class cname or any class derived\nfrom cname. Here’s an example:\nclass A(object): pass\nclass B(A): pass\nclass C(object): pass\na = A()          # Instance of 'A'\nb = B()          # Instance of 'B'\nc = C()          # Instance of 'C'\ntype(a)          # Returns the class object A\nisinstance(a,A)  # Returns True\nisinstance(b,A)  # Returns True, B derives from A\nisinstance(b,C)  # Returns False, C not derived from A\nSimilarly, the built-in function issubclass(A,B) returns True if the class A is a sub-\nclass of class B. Here’s an example:\nissubclass(B,A)   # Returns True\nissubclass(C,A)   # Returns False\nA subtle problem with type-checking of objects is that programmers often bypass inher-\nitance and simply create objects that mimic the behavior of another object.As an exam-\nple, consider these two classes:\nclass Foo(object):\ndef spam(self,a,b):\npass\nclass FooProxy(object):\ndef __init__(self,f):\nself.f = f\ndef spam(self,a,b):\nreturn self.f.spam(a,b)\nIn this example, FooProxy is functionally identical to Foo. It implements the same\nmethods, and it even uses Foo underneath the covers.Yet, in the type system, FooProxy\nis different than Foo. For example:\nf = Foo()           # Create a Foo\ng = FooProxy(f)     # Create a FooProxy\nisinstance(g, Foo)  # Returns False\nIf a program has been written to explicitly check for a Foo using isinstance(), then\nit certainly won’t work with a FooProxy object. However, this degree of strictness is\noften not exactly what you want. Instead, it might make more sense to assert that an\nobject can simply be used as Foo because it has the same interface.To do this, it \nis possible to define an object that redefines the behavior of isinstance() and\nissubclass() for the purpose of grouping objects together and type-checking. Here is\nan example:\nclass IClass(object):\ndef __init__(self):\nself.implementors = set()\ndef register(self,C):\nself.implementors.add(C)\ndef __instancecheck__(self,x):\nreturn self.__subclasscheck__(type(x))\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2088,
      "extraction_method": "Direct"
    },
    {
      "page_number": 161,
      "chapter": null,
      "content": "136\nChapter 7 Classes and Object-Oriented Programming\ndef __subclasscheck__(self,sub):\nreturn any(c in self.implementors for c in sub.mro())\n# Now, use the above object\nIFoo = IClass()\nIFoo.register(Foo)\nIFoo.register(FooProxy)\nIn this example, the class IClass creates an object that merely groups a collection of\nother classes together in a set.The register() method adds a new class to the set.The\nspecial method __instancecheck__() is called if anyone performs the operation\nisinstance(x, IClass).The special method __subclasscheck__() is called if the\noperation issubclass(C,IClass) is called.\nBy using the IFoo object and registered implementers, one can now perform type\nchecks such as the following:\nf = Foo()           # Create a Foo\ng = FooProxy(f)     # Create a FooProxy\nisinstance(f, IFoo)        # Returns True\nisinstance(g, IFoo)        # Returns True\nissubclass(FooProxy, IFoo) # Returns True\nIn this example, it’s important to emphasize that no strong type-checking is occurring.\nThe IFoo object has overloaded the instance checking operations in a way that allows a\nyou to assert that a class belongs to a group. It doesn’t assert any information on the\nactual programming interface, and no other verification actually occurs. In fact, you can\nsimply register any collection of objects you want to group together without regard to\nhow those classes are related to each other.Typically, the grouping of classes is based on\nsome criteria such as all classes implementing the same programming interface.\nHowever, no such meaning should be inferred when overloading\n__instancecheck__() or __subclasscheck__().The actual interpretation is left \nup to the application.\nPython provides a more formal mechanism for grouping objects, defining interfaces,\nand type-checking.This is done by defining an abstract base class, which is defined in\nthe next section.\nAbstract Base Classes\nIn the last section, it was shown that the isinstance() and issubclass() operations\ncan be overloaded.This can be used to create objects that group similar classes together\nand to perform various forms of type-checking. Abstract base classes build upon this con-\ncept and provide a means for organizing objects into a hierarchy, making assertions\nabout required methods, and so forth.\nTo define an abstract base class, you use the abc module.This module defines \na metaclass (ABCMeta) and a set of decorators (@abstractmethod and\n@abstractproperty) that are used as follows:\nfrom abc import ABCMeta, abstractmethod, abstractproperty\nclass Foo:                    # In Python 3, you use the syntax\n_ _metaclass_ _ = ABCMeta   # class Foo(metaclass=ABCMeta)\n@abstractmethod\ndef spam(self,a,b):\npass\n@abstractproperty\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2728,
      "extraction_method": "Direct"
    },
    {
      "page_number": 162,
      "chapter": null,
      "content": "137\nAbstract Base Classes\ndef name(self):\npass\nThe definition of an abstract class needs to set its metaclass to ABCMeta as shown (also,\nbe aware that the syntax differs between Python 2 and 3).This is required because the\nimplementation of abstract classes relies on a metaclass (described in the next section).\nWithin the abstract class, the @abstractmethod and @abstractproperty decorators\nspecify that a method or property must be implemented by subclasses of Foo.\nAn abstract class is not meant to be instantiated directly. If you try to create a Foo for\nthe previous class, you will get the following error:\n>>> f = Foo()\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: Can't instantiate abstract class Foo with abstract methods spam\n>>>\nThis restriction carries over to derived classes as well. For instance, if you have a class\nBar that inherits from Foo but it doesn’t implement one or more of the abstract meth-\nods, attempts to create a Bar will fail with a similar error. Because of this added check-\ning, abstract classes are useful to programmers who want to make assertions on the\nmethods and properties that must be implemented on subclasses.\nAlthough an abstract class enforces rules about methods and properties that must be\nimplemented, it does not perform conformance checking on arguments or return val-\nues.Thus, an abstract class will not check a subclass to see whether a method has used\nthe same arguments as an abstract method. Likewise, an abstract class that requires the\ndefinition of a property does not check to see whether the property in a subclass sup-\nports the same set of operations (get, set, and delete) of the property specified in a\nbase.\nAlthough an abstract class can not be instantiated, it can define methods and proper-\nties for use in subclasses. Moreover, an abstract method in the base can still be called\nfrom a subclass. For example, calling Foo.spam(a,b) from the subclass is allowed.\nAbstract base classes allow preexisting classes to be registered as belonging to that\nbase.This is done using the register() method as follows:\nclass Grok(object):\ndef spam(self,a,b):\nprint(\"Grok.spam\")\nFoo.register(Grok)       # Register with Foo abstract base class\nWhen a class is registered with an abstract base, type-checking operations involving the\nabstract base (such as isinstance() and issubclass()) will return True for instances\nof the registered class.When a class is registered with an abstract class, no checks are\nmade to see whether the class actually implements any of the abstract methods or prop-\nerties.This registration process only affects type-checking. It does not add extra error\nchecking to the class that is registered.\nUnlike many other object-oriented languages, Python’s built-in types are organized\ninto a relatively flat hierarchy. For example, if you look at the built-in types such as int\nor float, they directly inherit from object, the root of all objects, instead of an inter-\nmediate base class representing numbers.This makes it clumsy to write programs that\nwant to inspect and manipulate objects based on a generic category such as simply\nbeing an instance of a number.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3206,
      "extraction_method": "Direct"
    },
    {
      "page_number": 163,
      "chapter": null,
      "content": "138\nChapter 7 Classes and Object-Oriented Programming\nThe abstract class mechanism addresses this issue by allowing preexisting objects to\nbe organized into user-definable type hierarchies. Moreover, some library modules aim\nto organize the built-in types according to different capabilities that they possess.The\ncollections module contains abstract base classes for various kinds of operations\ninvolving sequences, sets, and dictionaries.The numbers module contains abstract base\nclasses related to organizing a hierarchy of numbers. Further details can be found in\nChapter 14,“Mathematics,” and Chapter 15,“Data Structures,Algorithms, and Utilities.”\nMetaclasses\nWhen you define a class in Python, the class definition itself becomes an object. Here’s\nan example:\nclass Foo(object): pass\nisinstance(Foo,object)        # Returns True\nIf you think about this long enough, you will realize that something had to create the\nFoo object.This creation of the class object is controlled by a special kind of object\ncalled a metaclass. Simply stated, a metaclass is an object that knows how to create and\nmanage classes.\nIn the preceding example, the metaclass that is controlling the creation of Foo is a\nclass called type. In fact, if you display the type of Foo, you will find out that it is a\ntype:\n>>> type(Foo)\n<type 'type'>\nWhen a new class is defined with the class statement, a number of things happen.\nFirst, the body of the class is executed as a series of statements within its own private\ndictionary.The execution of statements is exactly the same as in normal code with the\naddition of the name mangling that occurs on private members (names that start with\n_ _). Finally, the name of the class, the list of base classes, and the dictionary are passed\nto the constructor of a metaclass to create the corresponding class object. Here is an\nexample of how it works:\nclass_name = \"Foo\"                 # Name of class\nclass_parents = (object,)          # Base classes\nclass_body = \"\"\"                   # Class body\ndef __init__(self,x):\nself.x = x\ndef blah(self):\nprint(\"Hello World\")\n\"\"\"\nclass_dict = { }\n# Execute the body in the local dictionary class_dict\nexec(class_body,globals(),class_dict)\n# Create the class object Foo\nFoo = type(class_name,class_parents,class_dict)\nThe final step of class creation where the metaclass type() is invoked can be cus-\ntomized.The choice of what happens in the final step of class definition is controlled in\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2477,
      "extraction_method": "Direct"
    },
    {
      "page_number": 164,
      "chapter": null,
      "content": "139\nMetaclasses\na number of ways. First, the class can explicitly specify its metaclass by either setting a\n_ _metaclass_ _ class variable (Python 2), or supplying the metaclass keyword argu-\nment in the tuple of base classes (Python 3).\nclass Foo:                  # In Python 3, use the syntax\n__metaclass__ = type    # class Foo(metaclass=type)\n...\nIf no metaclass is explicitly specified, the class statement examines the first entry in\nthe tuple of base classes (if any). In this case, the metaclass is the same as the type of the\nfirst base class.Therefore, when you write\nclass Foo(object): pass\nFoo will be the same type of class as object.\nIf no base classes are specified, the class statement checks for the existence of a\nglobal variable called __metaclass__. If this variable is found, it will be used to create\nclasses. If you set this variable, it will control how classes are created when a simple class\nstatement is used. Here’s an example:\n__metaclass__ = type\nclass Foo:\npass\nFinally, if no __metaclass__ value can be found anywhere, Python uses the default\nmetaclass. In Python 2, this defaults to types.ClassType, which is known as an old-\nstyle class.This kind of class, deprecated since Python 2.2, corresponds to the original\nimplementation of classes in Python.Although these classes are still supported, they\nshould be avoided in new code and are not covered further here. In Python 3, the\ndefault metaclass is simply type().\nThe primary use of metaclasses is in frameworks that want to assert more control\nover the definition of user-defined objects.When a custom metaclass is defined, it typi-\ncally inherits from type() and reimplements methods such as __init__() or\n__new__(). Here is an example of a metaclass that forces all methods to have a \ndocumentation string:\nclass DocMeta(type):\ndef __init__(self,name,bases,dict):\nfor key, value in dict.items():\n# Skip special and private methods\nif key.startswith(\"__\"): continue  \n# Skip anything not callable\nif not hasattr(value,\"__call__\"): continue\n# Check for a doc-string\nif not getattr(value,\"__doc__\"):\nraise TypeError(\"%s must have a docstring\" % key)\ntype.__init__(self,name,bases,dict)\nIn this metaclass, the __init__() method has been written to inspect the contents of\nthe class dictionary. It scans the dictionary looking for methods and checking to see\nwhether they all have documentation strings. If not, a TypeError exception is generat-\ned. Otherwise, the default implementation of type.__init__() is called to initialize\nthe class.\nTo use this metaclass, a class needs to explicitly select it.The most common tech-\nnique for doing this is to first define a base class such as the following:\nclass Documented:              # In Python 3, use the syntax\n_ _metaclass_ _ = DocMeta    # class Documented(metaclass=DocMeta)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2836,
      "extraction_method": "Direct"
    },
    {
      "page_number": 165,
      "chapter": null,
      "content": "140\nChapter 7 Classes and Object-Oriented Programming\nThis base class is then used as the parent for all objects that are to be documented. For\nexample:\nclass Foo(Documented):\nspam(self,a,b):\n\"spam does something\"\npass\nThis example illustrates one of the major uses of metaclasses, which is that of inspecting\nand gathering information about class definitions.The metaclass isn’t changing anything\nabout the class that actually gets created but is merely adding some additional checks.\nIn more advanced metaclass applications, a metaclass can both inspect and alter the\ncontents of a class definition prior to the creation of the class. If alterations are going to\nbe made, you should redefine the __new__() method that runs prior to the creation of\nthe class itself.This technique is commonly combined with techniques that wrap attrib-\nutes with descriptors or properties because it is one way to capture the names being\nused in the class.As an example, here is a modified version of the TypedProperty\ndescriptor that was used in the “Descriptors” section:\nclass TypedProperty(object):\ndef __init__(self,type,default=None):\nself.name = None\nself.type = type \nif default: self.default = default\nelse:       self.default = type()\ndef __get__(self,instance,cls):\nreturn getattr(instance,self.name,self.default)\ndef __set__(self,instance,value):\nif not isinstance(value,self.type):\nraise TypeError(\"Must be a %s\" % self.type)\nsetattr(instance,self.name,value)\ndef __delete__(self,instance):\nraise AttributeError(\"Can't delete attribute\")\nIn this example, the name attribute of the descriptor is simply set to None.To fill this in,\nwe’ll rely on a meta class. For example:\nclass TypedMeta(type):\ndef __new__(cls,name,bases,dict):\nslots = []\nfor key,value in dict.items():\nif isinstance(value,TypedProperty):\nvalue.name = \"_\" + key\nslots.append(value.name)\ndict['__slots__'] = slots\nreturn type.__new__(cls,name,bases,dict)\n# Base class for user-defined objects to use\nclass Typed:                     # In Python 3, use the syntax\n_ _metaclass_ _ = TypedMeta    # class Typed(metaclass=TypedMeta)\nIn this example, the metaclass scans the class dictionary and looks for instances of\nTypedProperty. If found, it sets the name attribute and builds a list of names in slots.\nAfter this is done, a __slots__ attribute is added to the class dictionary, and the class is\nconstructed by calling the __new__() method of the type() metaclass. Here is an\nexample of using this new metaclass:\nclass Foo(Typed):\nname = TypedProperty(str)\nnum  = TypedProperty(int,42)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2572,
      "extraction_method": "Direct"
    },
    {
      "page_number": 166,
      "chapter": null,
      "content": "141\nClass Decorators\nAlthough metaclasses make it possible to drastically alter the behavior and semantics of\nuser-defined classes, you should probably resist the urge to use metaclasses in a way that\nmakes classes work wildly different from what is described in the standard Python doc-\numentation. Users will be confused if the classes they must write don’t adhere to any of\nthe normal coding rules expected for classes.\nClass Decorators\nIn the previous section, it was shown how the process of creating a class can be cus-\ntomized by defining a metaclass. However, sometimes all you want to do is perform\nsome kind of extra processing after a class is defined, such as adding a class to a registry\nor database.An alternative approach for such problems is to use a class decorator.A class\ndecorator is a function that takes a class as input and returns a class as output. For \nexample:\nregistry = { }\ndef register(cls):\nregistry[cls.__clsid__] = cls\nreturn cls\nIn this example, the register function looks inside a class for a __clsid__ attribute. If\nfound, it’s used to add the class to a dictionary mapping class identifiers to class objects.\nTo use this function, you can use it as a decorator right before the class definition. For\nexample:\n@register\nclass Foo(object):\n__clsid__ = \"123-456\"\ndef bar(self):\npass\nHere, the use of the decorator syntax is mainly one of convenience.An alternative way\nto accomplish the same thing would have been this:\nclass Foo(object):\n__clsid__ = \"123-456\"\ndef bar(self):\npass\nregister(Foo)       # Register the class\nAlthough it’s possible to think of endless diabolical things one might do to a class in a\nclass decorator function, it’s probably best to avoid excessive magic such as putting a\nwrapper around the class or rewriting the class contents.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1815,
      "extraction_method": "Direct"
    },
    {
      "page_number": 167,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 168,
      "chapter": null,
      "content": "8\nModules, Packages, and\nDistribution\nLarge Python programs are organized into modules and packages. In addition, a large\nnumber of modules are included in the Python standard library.This chapter describes\nthe module and package system in more detail. In addition, it provides information on\nhow to install third-party modules and distribute source code.\nModules and the import Statement\nAny Python source file can be used as a module. For example, consider the following\ncode:\n# spam.py\na = 37\ndef foo():\nprint(\"I'm foo and a is %s\" % a)\ndef bar():\nprint(\"I'm bar and I'm calling foo\")\nfoo()\nclass Spam(object):\ndef grok(self):\nprint(\"I'm Spam.grok\")\nTo load this code as a module, use the statement import spam.The first time import\nis used to load a module, it does three things:\n1. It creates a new namespace that serves as a container for all the objects defined in\nthe corresponding source file.This is the namespace accessed when functions and\nmethods defined within the module use the global statement.\n2. It executes the code contained in the module within the newly created name-\nspace.\n3. It creates a name within the caller that refers to the module namespace.This\nname matches the name of the module and is used as follows:\nimport spam           # Loads and executes the module 'spam'\nx = spam.a            # Accesses a member of module 'spam'\nspam.foo()            # Call a function in module 'spam'\ns = spam.Spam()       # Create an instance of spam.Spam()\ns.grok()\n...\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1508,
      "extraction_method": "Direct"
    },
    {
      "page_number": 169,
      "chapter": null,
      "content": "144\nChapter 8 Modules, Packages, and Distribution\nIt is important to emphasize that import executes all of the statements in the loaded\nsource file. If a module carries out a computation or produces output in addition to\ndefining variables, functions, and classes, you will see the result.Also, a common confu-\nsion with modules concerns the access to classes. Keep in mind that if a file spam.py\ndefines a class Spam, you must use the name spam.Spam to refer to the class.\nTo import multiple modules, you can supply import with a comma-separated list of\nmodule names, like this:\nimport socket, os, re\nThe name used to refer to a module can be changed using the as qualifier. Here’s an\nexample:\nimport spam as sp\nimport socket as net\nsp.foo()\nsp.bar()\nnet.gethostname()\nWhen a module is loaded using a different name like this, the new name only applies to\nthe source file or context where the import statement appeared. Other program mod-\nules can still load the module using its original name.\nChanging the name of the imported module can be a useful tool for writing \nextensible code. For example, suppose you have two modules, xmlreader.py and\ncsvreader.py, that both define a function read_data(filename) for reading some\ndata from a file, but in different input formats.You can write code that selectively picks\nthe reader module like this:\nif format == 'xml':\nimport xmlreader as reader\nelif format == 'csv':\nimport csvreader as reader\ndata = reader.read_data(filename)\nModules are first class objects in Python.This means that they can be assigned to\nvariables, placed in data structures such as a list, and passed around in a program as a\ndata. For instance, the reader variable in the previous example simply refers to the cor-\nresponding module object. Underneath the covers, a module object is a layer over a dic-\ntionary that is used to hold the contents of the module namespace.This dictionary is\navailable as the __dict__ of a module, and whenever you look up or change a value in\na module, you’re working with this dictionary.\nThe import statement can appear at any point in a program. However, the code in\neach module is loaded and executed only once, regardless of how often you use the\nimport statement. Subsequent import statements simply bind the module name to the\nmodule object already created by the previous import.You can find a dictionary con-\ntaining all currently loaded modules in the variable sys.modules.This dictionary maps\nmodule names to module objects.The contents of this dictionary are used to determine\nwhether import loads a fresh copy of a module.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2611,
      "extraction_method": "Direct"
    },
    {
      "page_number": 170,
      "chapter": null,
      "content": "145\nImporting Selected Symbols from a Module\nImporting Selected Symbols from a Module\nThe from statement is used to load specific definitions within a module into the cur-\nrent namespace.The from statement is identical to import except that instead of creat-\ning a name referring to the newly created module namespace, it places references to\none or more of the objects defined in the module into the current namespace:\nfrom spam import foo   # Imports spam and puts 'foo' in current namespace\nfoo()                  # Calls spam.foo()\nspam.foo()             # NameError: spam\nThe from statement also accepts a comma-separated list of object names. For example:\nfrom spam import foo, bar\nIf you have a very long list of names to import, the names can be enclosed in parenthe-\nses.This makes it easier to break the import statement across multiple lines. Here’s an\nexample:\nfrom spam import (foo,\nbar,\nSpam)\nIn addition, the as qualifier can be used to rename specific objects imported with from.\nHere’s an example:\nfrom spam import Spam as Sp\ns = Sp()\nThe asterisk (*) wildcard character can also be used to load all the definitions in a mod-\nule, except those that start with an underscore. Here’s an example:\nfrom spam import *   # Load all definitions into current namespace\nThe from module import * statement may only be used at the top level of a mod-\nule. In particular, it is illegal to use this form of import inside function bodies due to\nthe way in which it interacts with function scoping rules (e.g., when functions are com-\npiled into internal bytecode, all of the symbols used within the function need to be\nfully specified).\nModules can more precisely control the set of names imported by from module\nimport * by defining the list __all__. Here’s an example:\n# module: spam.py\n__all__ = [ 'bar', 'Spam' ]  # Names I will export with from spam import *\nImporting definitions with the from form of import does not change their scoping\nrules. For example, consider this code:\nfrom spam import foo\na = 42\nfoo()      # Prints \"I'm foo and a is 37\"\nIn this example, the definition of foo() in spam.py refers to a global variable a.When\na reference to foo is placed into a different namespace, it doesn’t change the binding\nrules for variables within that function.Thus, the global namespace for a function is\nalways the module in which the function was defined, not the namespace into which a\nfunction is imported and called.This also applies to function calls. For example, in the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2513,
      "extraction_method": "Direct"
    },
    {
      "page_number": 171,
      "chapter": null,
      "content": "146\nChapter 8 Modules, Packages, and Distribution\nfollowing code, the call to bar() results in a call to spam.foo(), not the redefined\nfoo() that appears in the previous code example:\nfrom spam import bar\ndef foo():\nprint(\"I'm a different foo\")\nbar()      # When bar calls foo(), it calls spam.foo(), not\n# the definition of foo() above\nAnother common confusion with the from form of import concerns the behavior of\nglobal variables. For example, consider this code:\nfrom spam import a, foo      # Import a global variable\na = 42                       # Modify the variable\nfoo()                        # Prints \"I'm foo and a is 37\"\nprint(a)                     # Prints \"42\"\nHere, it is important to understand that variable assignment in Python is not a storage\noperation.That is, the assignment to a in the earlier example is not storing a new value\nin a, overwriting the previous value. Instead, a new object containing the value 42 is\ncreated and the name a is made to refer to it.At this point, a is no longer bound to the\nvalue in the imported module but to some other object. Because of this behavior, it is\nnot possible to use the from statement in a way that makes variables behave similarly as\nglobal variables or common blocks in languages such as C or Fortran. If you want to\nhave mutable global program parameters in your program, put them in a module and\nuse the module name explicitly using the import statement (that is, use spam.a explic-\nitly).\nExecution as the Main Program\nThere are two ways in which a Python source file can execute.The import statement\nexecutes code in its own namespace as a library module. However, code might also exe-\ncute as the main program or script.This occurs when you supply the program as the\nscript name to the interpreter:\n% python spam.py\nEach module defines a variable, __name__, that contains the module name. Programs\ncan examine this variable to determine the module in which they’re executing.The\ntop-level module of the interpreter is named __main__. Programs specified on the\ncommand line or entered interactively run inside the __main__ module. Sometimes a\nprogram may alter its behavior, depending on whether it has been imported as a mod-\nule or is running in __main__. For example, a module may include some testing code\nthat is executed if the module is used as the main program but which is not executed if\nthe module is simply imported by another module.This can be done as follows:\n# Check if running as a program\nif __name__ == '__main__':\n# Yes\nstatements\nelse:\n# No, I must have been imported as a module\nstatements\nIt is common practice for source files intended for use as libraries to use this technique\nfor including optional testing or example code. For example, if you’re developing a\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2786,
      "extraction_method": "Direct"
    },
    {
      "page_number": 172,
      "chapter": null,
      "content": "147\nModule Loading and Compilation\nmodule, you can put code for testing the features of your library inside an if statement\nas shown and simply run Python on your module as the main program to run it.That\ncode won’t run for users who import your library.\nThe Module Search Path\nWhen loading modules, the interpreter searches the list of directories in sys.path.The\nfirst entry in sys.path is typically an empty string '', which refers to the current\nworking directory. Other entries in sys.path may consist of directory names, .zip\narchive files, and .egg files.The order in which entries are listed in sys.path deter-\nmines the search order used when modules are loaded.To add new entries to the search\npath, simply add them to this list.\nAlthough the path usually contains directory names, zip archive files containing\nPython modules can also be added to the search path.This can be a convenient way to\npackage a collection of modules as a single file. For example, suppose you created two\nmodules, foo.py and bar.py, and placed them in a zip file called mymodules.zip.The\nfile could be added to the Python search path as follows:\nimport sys\nsys.path.append(\"mymodules.zip\")\nimport foo, bar\nSpecific locations within the directory structure of a zip file can also be used. In addi-\ntion, zip files can be mixed with regular pathname components. Here’s an example:\nsys.path.append(\"/tmp/modules.zip/lib/python\")\nIn addition to .zip files, you can also add .egg files to the search path. .egg files are\npackages created by the setuptools library.This is a common format encountered\nwhen installing third-party Python libraries and extensions.An .egg file is actually just\na .zip file with some extra metadata (e.g., version number, dependencies, etc.) added to\nit.Thus, you can examine and extract data from an .egg file using standard tools for\nworking with .zip files.\nDespite support for zip file imports, there are some restrictions to be aware of. First,\nit is only possible import .py, .pyw, .pyc, and .pyo files from an archive. Shared\nlibraries and extension modules written in C cannot be loaded directly from archives,\nalthough packaging systems such as setuptools are sometimes able to provide a\nworkaround (typically by extracting C extensions to a temporary directory and loading\nmodules from it). Moreover, Python will not create .pyc and .pyo files when .py files\nare loaded from an archive (described next).Thus, it is important to make sure these\nfiles are created in advance and placed in the archive in order to avoid poor perform-\nance when loading modules.\nModule Loading and Compilation\nSo far, this chapter has presented modules as files containing pure Python code.\nHowever, modules loaded with import really fall into four general categories:\nn Code written in Python (.py files)\nn C or C++ extensions that have been compiled into shared libraries or DLLs\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2903,
      "extraction_method": "Direct"
    },
    {
      "page_number": 173,
      "chapter": null,
      "content": "148\nChapter 8 Modules, Packages, and Distribution\nn Packages containing a collection of modules\nn Built-in modules written in C and linked into the Python interpreter\nWhen looking for a module (for example, foo), the interpreter searches each of the\ndirectories in sys.path for the following files (listed in search order):\n1. A directory, foo, defining a package\n2. foo.pyd, foo.so, foomodule.so, or foomodule.dll (compiled extensions)\n3. foo.pyo (only if the -O or -OO option has been used)\n4. foo.pyc\n5. foo.py (on Windows, Python also checks for .pyw files.)\nPackages are described shortly; compiled extensions are described in Chapter 26,\n“Extending and Embedding Python.” For .py files, when a module is first imported, it’s\ncompiled into bytecode and written back to disk as a .pyc file. On subsequent imports,\nthe interpreter loads this precompiled bytecode unless the modification date of the .py\nfile is more recent (in which case, the .pyc file is regenerated). .pyo files are used in\nconjunction with the interpreter’s -O option.These files contain bytecode stripped of\nline numbers, assertions, and other debugging information.As a result, they’re somewhat\nsmaller and allow the interpreter to run slightly faster. If the -OO option is specified\ninstead of -O, documentation strings are also stripped from the file.This removal of doc-\numentation strings occurs only when .pyo files are created—not when they’re loaded.\nIf none of these files exists in any of the directories in sys.path, the interpreter checks\nwhether the name corresponds to a built-in module name. If no match exists, an\nImportError exception is raised.\nThe automatic compilation of files into .pyc and .pyo files occurs only in conjunc-\ntion with the import statement. Programs specified on the command line or standard\ninput don’t produce such files. In addition, these files aren’t created if the directory con-\ntaining a module’s .py file doesn’t allow writing (e.g., either due to insufficient permis-\nsion or if it’s part of a zip archive).The -B option to the interpreter also disables the\ngeneration of these files.\nIf .pyc and .pyo files are available, it is not necessary for a corresponding .py file to\nexist.Thus, if you are packaging code and don’t wish to include source, you can merely\nbundle a set of .pyc files together. However, be aware that Python has extensive sup-\nport for introspection and disassembly. Knowledgeable users will still be able to inspect\nand find out a lot of details about your program even if the source hasn’t been provid-\ned.Also, be aware that .pyc files tend to be version-specific.Thus, a .pyc file generated\nfor one version of Python might not work in a future release.\nWhen import searches for files, it matches filenames in a case-sensitive manner—\neven on machines where the underlying file system is case-insensitive, such as on\nWindows and OS X (such systems are case-preserving, however).Therefore, import\nfoo will only import the file foo.py and not the file FOO.PY. However, as a general\nrule, you should avoid the use of module names that differ in case only.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3121,
      "extraction_method": "Direct"
    },
    {
      "page_number": 174,
      "chapter": null,
      "content": "149\nPackages\nModule Reloading and Unloading\nPython provides no real support for reloading or unloading of previously imported\nmodules.Although you can remove a module from sys.modules, this does not gener-\nally unload a module from memory.This is because references to the module object\nmay still exist in other program components that used import to load that module.\nMoreover, if there are instances of classes defined in the module, those instances contain\nreferences back to their class object, which in turn holds references to the module in\nwhich it was defined.\nThe fact that module references exist in many places makes it generally impractical\nto reload a module after making changes to its implementation. For example, if you\nremove a module from sys.modules and use import to reload it, this will not retroac-\ntively change all of the previous references to the module used in a program. Instead,\nyou’ll have one reference to the new module created by the most recent import state-\nment and a set of references to the old module created by imports in other parts of the\ncode.This is rarely what you want and never safe to use in any kind of sane production\ncode unless you are able to carefully control the entire execution environment.\nOlder versions of Python provided a reload() function for reloading a module.\nHowever, use of this function was never really safe (for all of the aforementioned rea-\nsons), and its use was actively discouraged except as a possible debugging aid. Python 3\nremoves this feature entirely. So, it’s best not to rely upon it.\nFinally, it should be noted that C/C++ extensions to Python cannot be safely\nunloaded or reloaded in any way. No support is provided for this, and the underlying\noperating system may prohibit it anyways.Thus, your only recourse is to restart the\nPython interpreter process.\nPackages\nPackages allow a collection of modules to be grouped under a common package name.\nThis technique helps resolve namespace conflicts between module names used in differ-\nent applications.A package is defined by creating a directory with the same name as the\npackage and creating the file __init__.py in that directory.You can then place addi-\ntional source files, compiled extensions, and subpackages in this directory, as needed. For\nexample, a package might be organized as follows:\nGraphics/\n__init__.py\nPrimitive/\n__init__.py\nlines.py\nfill.py\ntext.py\n...\nGraph2d/\n__init__.py\nplot2d.py\n...\nGraph3d/\n__init__.py\nplot3d.py\n...\nFormats/\n__init__.py\ngif.py\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2529,
      "extraction_method": "Direct"
    },
    {
      "page_number": 175,
      "chapter": null,
      "content": "150\nChapter 8 Modules, Packages, and Distribution\npng.py\ntiff.py\njpeg.py\nThe import statement is used to load modules from a package in a number of ways:\nn import Graphics.Primitive.fill\nThis loads the submodule Graphics.Primitive.fill.The contents of this\nmodule have to be explicitly named, such as\nGraphics.Primitive.fill.floodfill(img,x,y,color).\nn from Graphics.Primitive import fill\nThis loads the submodule fill but makes it available without the package prefix;\nfor example, fill.floodfill(img,x,y,color).\nn from Graphics.Primitive.fill import floodfill\nThis loads the submodule fill but makes the floodfill function directly\naccessible; for example, floodfill(img,x,y,color).\nWhenever any part of a package is first imported, the code in the file __init__.py is\nexecuted. Minimally, this file may be empty, but it can also contain code to perform\npackage-specific initializations.All the __init__.py files encountered during an\nimport are executed.Therefore, the statement import Graphics.Primitive.fill,\nshown earlier, would first execute the __init__.py file in the Graphics directory and\nthen the __init__.py file in the Primitive directory.\nOne peculiar problem with packages is the handling of this statement:\nfrom Graphics.Primitive import *\nA programmer who uses this statement usually wants to import all the submodules asso-\nciated with a package into the current namespace. However, because filename conven-\ntions vary from system to system (especially with regard to case sensitivity), Python \ncannot accurately determine what modules those might be.As a result, this statement\njust imports all the names that are defined in the __init__.py file in the Primitive\ndirectory.This behavior can be modified by defining a list, __all__, that contains all\nthe module names associated with the package.This list should be defined in the pack-\nage __init__.py file, like this:\n# Graphics/Primitive/__init__.py\n__all__ = [\"lines\",\"text\",\"fill\"]\nNow when the user issues a from Graphics.Primitive import * statement, all the\nlisted submodules are loaded as expected.\nAnother subtle problem with packages concerns submodules that want to \nimport other submodules within the same package. For example, suppose the\nGraphics.Primitive.fill module wants to import the\nGraphics.Primitive.lines module.To do this, you can simply use the fully specified\nnamed (e.g., from Graphics.Primitives import lines) or use a package relative\nimport like this:\n# fill.py\nfrom . import lines\nIn this example, the . used in the statement from . import lines refers to the same\ndirectory of the calling module.Thus, this statement looks for a module lines in the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2673,
      "extraction_method": "Direct"
    },
    {
      "page_number": 176,
      "chapter": null,
      "content": "151\nPackages\nsame directory as the file fill.py. Great care should be taken to avoid using a state-\nment such as import module to import a package submodule. In older versions of\nPython, it was unclear whether the import module statement was referring to a stan-\ndard library module or a submodule of a package. Older versions of Python would first\ntry to load the module from the same package directory as the submodule where the\nimport statement appeared and then move on to standard library modules if no match\nwas found. However, in Python 3, import assumes an absolute path and will simply try\nto load module from the standard library.A relative import more clearly states your\nintentions.\nRelative imports can also be used to load submodules contained in different directo-\nries of the same package. For example, if the module Graphics.Graph2D.plot2d\nwanted to import Graphics.Primitives.lines, it could use a statement like this:\n# plot2d.py\nfrom ..Primitives import lines\nHere, the .. moves out one directory level and Primitives drops down into a differ-\nent package directory.\nRelative imports can only be specified using the from module import symbol\nform of the import statement.Thus, statements such as import ..Primitives.lines\nor import .lines are a syntax error.Also, symbol has to be a valid identifier. So, a\nstatement such as from .. import Primitives.lines is also illegal. Finally, relative\nimports can only be used within a package; it is illegal to use a relative import to refer\nto modules that are simply located in a different directory on the filesystem.\nImporting a package name alone doesn’t import all the submodules contained in the\npackage. For example, the following code doesn’t work:\nimport Graphics\nGraphics.Primitive.fill.floodfill(img,x,y,color)  # Fails!\nHowever, because the import Graphics statement executes the __init__.py file in\nthe Graphics directory, relative imports can be used to load all the submodules auto-\nmatically, as follows:\n# Graphics/__init__.py\nfrom . import Primitive, Graph2d, Graph3d\n# Graphics/Primitive/__init__.py\nfrom . import lines, fill, text, ...\nNow the import Graphics statement imports all the submodules and makes them\navailable using their fully qualified names.Again, it is important to stress that a package\nrelative import should be used as shown. If you use a simple statement such as import\nmodule, standard library modules may be loaded instead.\nFinally, when Python imports a package, it defines a special variable, __path__,\nwhich contains a list of directories that are searched when looking for package submod-\nules (__path__ is a package-specific version of the sys.path variable). __path__ is\naccessible to the code contained in __init__.py files and initially contains a single item\nwith the directory name of the package. If necessary, a package can supply additional\ndirectories to the __path__ list to alter the search path used for finding submodules.\nThis might be useful if the organization of a package on the file system is complicated\nand doesn’t neatly match up with the package hierarchy.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3111,
      "extraction_method": "Direct"
    },
    {
      "page_number": 177,
      "chapter": null,
      "content": "152\nChapter 8 Modules, Packages, and Distribution\nDistributing Python Programs and Libraries\nTo distribute Python programs to others, you should use the distutils module.As\npreparation, you should first cleanly organize your work into a directory that has a\nREADME file, supporting documentation, and your source code.Typically, this directory\nwill contain a mix of library modules, packages, and scripts. Modules and packages refer\nto source files that will be loaded with import statements. Scripts are programs that will\nrun as the main program to the interpreter (e.g., running as python scriptname).\nHere is an example of a directory containing Python code:\nspam/\nREADME.txt\nDocumentation.txt\nlibspam.py          # A single library module\nspampkg/            # A package of support modules\n__init__.py\nfoo.py\nbar.py\nrunspam.py          # A script to run as: python runspam.py\nYou should organize your code so that it works normally when running the Python\ninterpreter in the top-level directory. For example, if you start Python in the spam\ndirectory, you should be able to import modules, import package components, and run\nscripts without having to alter any of Python’s settings such as the module search path.\nAfter you have organized your code, create a file setup.py in the top most directo-\nry (spam in the previous examples). In this file, put the following code:\n# setup.py\nfrom distutils.core import setup\nsetup(name = \"spam\",\nversion = \"1.0\",\npy_modules = ['libspam'],\npackages = ['spampkg'],\nscripts = ['runspam.py'],\n)\nIn the setup() call, the py_modules argument is a list of all of the single-file Python\nmodules, packages is a list of all package directories, and scripts is a list of script\nfiles.Any of these arguments may be omitted if your software does not have any match-\ning components (i.e., there are no scripts). name is the name of your package, and \nversion is the version number as a string.\nThe call to setup() supports a variety of other parameters that supply various\nmetadata about your package.Table 8.1 shows the most common parameters that can be\nspecified.All values are strings except for the classifiers parameter, which is a list of\nstrings such as ['Development Status :: 4 - Beta', 'Programming Language\n:: Python'] (a full list can be found at http://pypi.python.org).\nTable 8.1\nParameters to setup()\nParameter\nDescription\nname\nName of the package (required)\nversion\nVersion number (required)\nauthor\nAuthor’s name\nauthor_email\nAuthor’s email address\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2520,
      "extraction_method": "Direct"
    },
    {
      "page_number": 178,
      "chapter": null,
      "content": "153\nDistributing Python Programs and Libraries\nTable 8.1\nContinued\nParameter\nDescription\nmaintainer\nMaintainer’s name\nmaintainer_email\nMaintainer’s email\nurl\nHome page for the package\ndescription\nShort description of the package\nlong_description\nLong description of the package\ndownload_url\nLocation where package can be downloaded\nclassifiers\nList of string classifiers\nCreating a setup.py file is enough to create a source distribution of your software.\nType the following shell command to make a source distribution:\n% python setup.py sdist\n...\n%\nThis creates an archive file such as spam-1.0.tar.gz or spam-1.0.zip in the directo-\nry spam/dist.This is the file you would give to others to install your software.To\ninstall, a user simply unpacks the archive and performs these steps:\n% unzip spam-1.0.zip\n...\n% cd spam-1.0\n% python setup.py install\n...\n%\nThis installs the software into the local Python distribution and makes it available for\ngeneral use. Modules and packages are normally installed into a directory called \n\"site-packages\" in the Python library.To find the exact location of this directory,\ninspect the value of sys.path. Scripts are normally installed into the same directory as\nthe Python interpreter on UNIX-based systems or into a \"Scripts\" directory on\nWindows (found in \"C:\\Python26\\Scripts\" in a typical installation).\nOn UNIX, if the first line of a script starts with #! and contains the text \"python\",\nthe installer will rewrite the line to point to the local installation of Python.Thus, if you\nhave written scripts that have been hard-coded to a specific Python location such as\n/usr/local/bin/python, they should still work when installed on other systems\nwhere Python is in a different location.\nThe setup.py file has a number of other commands concerning the distribution of\nsoftware. If you type 'python setup.py bdist', a binary distribution is created in\nwhich all of the .py files have already been precompiled into .pyc files and placed into\na directory structure that mimics that of the local platform.This kind of distribution is\nneeded only if parts of your application have platform dependencies (for example, if you\nalso have C extensions that need to be compiled). If you run 'python setup.py\nbdist_wininst' on a Windows machine, an .exe file will be created.When opened, a\nWindows installer dialog will start, prompting the user for information about where the\nsoftware should be installed.This kind of distribution also adds entries to the registry,\nmaking it easy to uninstall your package at a later date.\nThe distutils module assumes that users already have a Python installation on\ntheir machine (downloaded separately).Although it is possible to create software pack-\nages where the Python runtime and your software are bundled together into a single\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2828,
      "extraction_method": "Direct"
    },
    {
      "page_number": 179,
      "chapter": null,
      "content": "154\nChapter 8 Modules, Packages, and Distribution\nbinary executable, that is beyond the scope of what can be covered here (look at a\nthird-party module such as py2exe or py2app for further details). If all you are doing is\ndistributing libraries or simple scripts to people, it is usually unnecessary to package\nyour code with the Python interpreter and runtime as well.\nFinally, it should be noted that there are many more options to distutils than\nthose covered here. Chapter 26 describes how distutils can be used to compile C\nand C++ extensions.\nAlthough not part of the standard Python distribution, Python software is often dis-\ntributed in the form of an .egg file.This format is created by the popular setuptools\nextension (http://pypi.python.org/pypi/setuptools).To support setuptools, you can\nsimply change the first part of your setup.py file as follows:\n# setup.py\ntry:\nfrom setuptools import setup\nexcept ImportError:\nfrom distutils.core import setup\nsetup(name = \"spam\", \n...\n)\nInstalling Third-Party Libraries\nThe definitive resource for locating third-party libraries and extensions to Python is the\nPython Package Index (PyPI), which is located at http://pypi.python.org. Installing third-\nparty modules is usually straightforward but can become quite involved for very large\npackages that also depend on other third-party modules. For the more major exten-\nsions, you will often find a platform-native installer that simply steps you through the\nprocess using a series of dialog screens. For other modules, you typically unpack the\ndownload, look for the setup.py file, and type python setup.py install to install\nthe software.\nBy default, third-party modules are installed in the site-packages directory of the\nPython standard library.Access to this directory typically requires root or administrator\naccess. If this is not the case, you can type python setup.py install --user to\nhave the module installed in a per-user library directory.This installs the package in a\nper-user directory such as \"/Users/beazley/.local/lib/python2.6/site-pack-\nages\" on UNIX.\nIf you want to install the software somewhere else entirely, use the --prefix option\nto setup.py. For example, typing python setup.py install --prefix=/home/\nbeazley/pypackages installs a module under the directory /home/beazley/\npypackages.When installing in a nonstandard location, you will probably have to\nadjust the setting of sys.path in order for Python to locate your newly installed \nmodules.\nBe aware that many extensions to Python involve C or C++ code. If you have\ndownloaded a source distribution, your system will have to have a C++ compiler\ninstalled in order to run the installer. On UNIX, Linux, and OS X, this is usually not an\nissue. On Windows, it has traditionally been necessary to have a version of Microsoft\nVisual Studio installed. If you’re working on that platform, you’re probably better off\nlooking for a precompiled version of your extension.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2974,
      "extraction_method": "Direct"
    },
    {
      "page_number": 180,
      "chapter": null,
      "content": "155\nInstalling Third-Party Libraries\nIf you have installed setuptools, a script easy_install is available to install pack-\nages. Simply type easy_install pkgname to install a specific package. If configured\ncorrectly, this will download the appropriate software from PyPI along with any\ndependencies and install it for you. Of course, your mileage might vary.\nIf you would like to add your own software to PyPI, simply type python setup.py\nregister.This will upload metadata about the latest version of your software to the\nindex (note that you will have to register a username and password first).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 621,
      "extraction_method": "Direct"
    },
    {
      "page_number": 181,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 182,
      "chapter": null,
      "content": "9\nInput and Output\nThis chapter describes the basics of Python input and output (I/O), including \ncommand-line options, environment variables, file I/O, Unicode, and how to serialize\nobjects using the pickle module.\nReading Command-Line Options\nWhen Python starts, command-line options are placed in the list sys.argv.The first\nelement is the name of the program. Subsequent items are the options presented on the\ncommand line after the program name.The following program shows a minimal proto-\ntype of manually processing simple command-line arguments:\nimport sys\nif len(sys.argv) != 3:\nsys.stderr.write(\"Usage : python %s inputfile outputfile\\n\" % sys.argv[0])\nraise SystemExit(1)\ninputfile  = sys.argv[1]\noutputfile = sys.argv[2]\nIn this program, sys.argv[0] contains the name of the script being executed.Writing\nan error message to sys.stderr and raising SystemExit with a non-zero exit code as\nshown is standard practice for reporting usage errors in command-line tools.\nAlthough you can manually process command options for simple scripts, use the\noptparse module for more complicated command-line handling. Here is a simple\nexample:\nimport optparse\np = optparse.OptionParser()\n# An option taking an argument\np.add_option(\"-o\",action=\"store\",dest=\"outfile\")\np.add_option(\"--output\",action=\"store\",dest=\"outfile\")\n# An option that sets a boolean flag\np.add_option(\"-d\",action=\"store_true\",dest=\"debug\")\np.add_option(\"--debug\",action=\"store_true\",dest=\"debug\")\n# Set default values for selected options\np.set_defaults(debug=False)\n# Parse the command line\nopts, args = p.parse_args()\n# Retrieve the option settings\noutfile   = opts.outfile\ndebugmode = opts.debug\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1690,
      "extraction_method": "Direct"
    },
    {
      "page_number": 183,
      "chapter": null,
      "content": "158\nChapter 9 Input and Output\nIn this example, two types of options are added.The first option, -o or --output, has a\nrequired argument.This behavior is selected by specifying action='store' in the call\nto p.add_option().The second option, -d or --debug, is merely setting a Boolean\nflag.This is enabled by specifying action='store_true' in p.add_option().The\ndest argument to p.add_option() selects an attribute name where the argument\nvalue will be stored after parsing.The p.set_defaults() method sets default values\nfor one or more of the options.The argument names used with this method should\nmatch the destination names selected for each option. If no default value is selected, the\ndefault value is set to None.\nThe previous program recognizes all of the following command-line styles:\n% python prog.py -o outfile -d infile1 ... infileN\n% python prog.py --output=outfile --debug infile1 ... infileN\n% python prog.py -h\n% python prog.py --help\nParsing is performed using the p.parse_args() method.This method returns a \n2-tuple (opts, args) where opts is an object containing the parsed option values\nand args is a list of items on the command line not parsed as options. Option values\nare retrieved using opts.dest where dest is the destination name used when adding\nan option. For example, the argument to the -o or --output argument is placed in\nopts.outfile, whereas args is a list of the remaining arguments such as\n['infile1', ..., 'infileN'].The optparse module automatically provides a -h\nor --help option that lists the available options if requested by the user. Bad options\nalso result in an error message.\nThis example only shows the simplest use of the optparse module. Further details\non some of the more advanced options can be found in Chapter 19,“Operating System\nServices.”\nEnvironment Variables\nEnvironment variables are accessed in the dictionary os.environ. Here’s an example:\nimport os\npath   = os.environ[\"PATH\"]\nuser   = os.environ[\"USER\"]\neditor = os.environ[\"EDITOR\"]\n... etc ...\nTo modify the environment variables, set the os.environ variable. For example:\nos.environ[\"FOO\"] = \"BAR\"\nModifications to os.environ affect both the running program and subprocesses created\nby Python.\nFiles and File Objects\nThe built-in function open(name [,mode [,bufsize]]) opens and creates a file\nobject, as shown here:\nf = open(\"foo\")        # Opens \"foo\" for reading\nf = open(\"foo\",'r')    # Opens \"foo\" for reading (same as above)\nf = open(\"foo\",'w')    # Open for writing\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2516,
      "extraction_method": "Direct"
    },
    {
      "page_number": 184,
      "chapter": null,
      "content": "159\nFiles and File Objects\nThe file mode is 'r' for read, 'w' for write, or 'a' for append.These file modes\nassume text-mode and may implicitly perform translation of the newline character\n'\\n'. For example, on Windows, writing the character '\\n' actually outputs the two-\ncharacter sequence '\\r\\n' (and when reading the file back, '\\r\\n' is translated back\ninto a single '\\n' character). If you are working with binary data, append a 'b' to the\nfile mode such as 'rb' or 'wb'.This disables newline translation and should be includ-\ned if you are concerned about portability of code that processes binary data (on UNIX,\nit is a common mistake to omit the 'b' because there is no distinction between text\nand binary files).Also, because of the distinction in modes, you might see text-mode\nspecified as 'rt', 'wt', or 'at', which more clearly expresses your intent.\nA file can be opened for in-place updates by supplying a plus (+) character, such as\n'r+' or 'w+'.When a file is opened for update, you can perform both input and out-\nput, as long as all output operations flush their data before any subsequent input opera-\ntions. If a file is opened using 'w+' mode, its length is first truncated to zero.\nIf a file is opened with mode 'U' or 'rU', it provides universal newline support for\nreading.This feature simplifies cross-platform work by translating different newline\nencodings (such as '\\n', '\\r', and '\\r\\n') to a standard '\\n' character in the strings\nreturned by various file I/O functions.This can be useful if, for example, you are writ-\ning scripts on UNIX systems that must process text files generated by programs on\nWindows.\nThe optional bufsize parameter controls the buffering behavior of the file, where 0\nis unbuffered, 1 is line buffered, and a negative number requests the system default.Any\nother positive number indicates the approximate buffer size in bytes that will be used.\nPython 3 adds four additional parameters to the open() function, which is called as\nopen(name [,mode [,bufsize [, encoding [, errors [, newline [,\nclosefd]]]]]]). encoding is an encoding name such as 'utf-8' or 'ascii'.\nerrors is the error-handling policy to use for encoding errors (see the later sections in\nthis chapter on Unicode for more information). newline controls the behavior of uni-\nversal newline mode and is set to None, '', '\\n', '\\r', or '\\r\\n'. If set to None, any\nline ending of the form '\\n', '\\r', or '\\r\\n' is translated into '\\n'. If set to '' (the\nempty string), any of these line endings are recognized as newlines, but left untranslated\nin the input text. If newline has any other legal value, that value is what is used to ter-\nminate lines. closefd controls whether the underlying file descriptor is actually closed\nwhen the close() method is invoked. By default, this is set to True.\nTable 9.1 shows the methods supported by file objects.\nTable 9.1\nFile Methods\nMethod\nDescription\nf.read([n])\nReads at most n bytes.\nf.readline([n])\nReads a single line of input up to n characters. If n is\nomitted, this method reads the entire line.\nf.readlines([size])\nReads all the lines and returns a list. size optionally\nspecifies the approximate number of characters to\nread on the file before stopping.\nf.write(s)\nWrites string s.\nf.writelines(lines)\nWrites all strings in sequence lines.\nf.close()\nCloses the file.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3360,
      "extraction_method": "Direct"
    },
    {
      "page_number": 185,
      "chapter": null,
      "content": "160\nChapter 9 Input and Output\nTable 9.1\nContinued\nMethod\nDescription\nf.tell()\nReturns the current file pointer.\nf.seek(offset [, whence]) Seeks to a new file position.\nf.isatty()\nReturns 1 if f is an interactive terminal.\nf.flush()\nFlushes the output buffers.\nf.truncate([size])\nTruncates the file to at most size bytes.\nf.fileno()\nReturns an integer file descriptor.\nf.next()\nReturns the next line or raises StopIteration. In\nPython 3, it is called f.__next__().\nThe read() method returns the entire file as a string unless an optional length param-\neter is given specifying the maximum number of characters.The readline() method\nreturns the next line of input, including the terminating newline; the readlines()\nmethod returns all the input lines as a list of strings.The readline() method optional-\nly accepts a maximum line length, n. If a line longer than n characters is read, the first n\ncharacters are returned.The remaining line data is not discarded and will be returned\non subsequent read operations.The readlines() method accepts a size parameter that\nspecifies the approximate number of characters to read before stopping.The actual\nnumber of characters read may be larger than this depending on how much data has\nbeen buffered.\nBoth the readline() and readlines() methods are platform-aware and handle\ndifferent representations of newlines properly (for example, '\\n' versus '\\r\\n'). If the\nfile is opened in universal newline mode ('U' or 'rU'), newlines are converted to\n'\\n'.\nread() and readline() indicate end-of-file (EOF) by returning an empty string.\nThus, the following code shows how you can detect an EOF condition:\nwhile True:\nline = f.readline()\nif not line:        # EOF\nbreak\nA convenient way to read all lines in a file is to use iteration with a for loop. For\nexample:\nfor line in f:        # Iterate over all lines in the file\n# Do something with line\n...\nBe aware that in Python 2, the various read operations always return 8-bit strings,\nregardless of the file mode that was specified (text or binary). In Python 3, these opera-\ntions return Unicode strings if a file has been opened in text mode and byte strings if\nthe file is opened in binary mode.\nThe write() method writes a string to the file, and the writelines() method\nwrites a list of strings to the file. write() and writelines() do not add newline\ncharacters to the output, so all output that you produce should already include all nec-\nessary formatting.These methods can write raw-byte strings to a file, but only if the file\nhas been opened in binary mode.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2578,
      "extraction_method": "Direct"
    },
    {
      "page_number": 186,
      "chapter": null,
      "content": "161\nStandard Input, Output, and Error\nInternally, each file object keeps a file pointer that stores the byte offset at which the\nnext read or write operation will occur.The tell() method returns the current value\nof the file pointer as a long integer.The seek() method is used to randomly access\nparts of a file given an offset and a placement rule in whence. If whence is 0 (the\ndefault), seek() assumes that offset is relative to the start of the file; if whence is 1,\nthe position is moved relative to the current position; and if whence is 2, the offset is\ntaken from the end of the file. seek() returns the new value of the file pointer as an\ninteger. It should be noted that the file pointer is associated with the file object\nreturned by open() and not the file itself.The same file can be opened more than once\nin the same program (or in different programs). Each instance of the open file has its\nown file pointer that can be manipulated independently.\nThe fileno() method returns the integer file descriptor for a file and is sometimes\nused in low-level I/O operations in certain library modules. For example, the fcntl\nmodule uses the file descriptor to provide low-level file control operations on UNIX\nsystems.\nFile objects also have the read-only data attributes shown in Table 9.2.\nTable 9.2\nFile Object Attributes\nAttribute\nDescription\nf.closed\nBoolean value indicates the file state: False if the file is open, True\nif closed.\nf.mode\nThe I/O mode for the file.\nf.name\nName of the file if created using open(). Otherwise, it will be a string\nindicating the source of the file.\nf.softspace\nBoolean value indicating whether a space character needs to be print-\ned before another value when using the print statement. Classes\nthat emulate files must provide a writable attribute of this name that’s\ninitially initialized to zero (Python 2 only).\nf.newlines\nWhen a file is opened in universal newline mode, this attribute con-\ntains the newline representation actually found in the file. The value is\nNone if no newlines have been encountered, a string containing '\\n',\n'\\r', or '\\r\\n', or a tuple containing all the different newline encod-\nings seen.\nf.encoding\nA string that indicates file encoding, if any (for example, 'latin-1' or\n'utf-8'). The value is None if no encoding is being used.\nStandard Input, Output, and Error\nThe interpreter provides three standard file objects, known as standard input, standard out-\nput, and standard error, which are available in the sys module as sys.stdin,\nsys.stdout, and sys.stderr, respectively. stdin is a file object corresponding to the\nstream of input characters supplied to the interpreter. stdout is the file object that\nreceives output produced by print. stderr is a file that receives error messages. More\noften than not, stdin is mapped to the user’s keyboard, whereas stdout and stderr\nproduce text onscreen.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2898,
      "extraction_method": "Direct"
    },
    {
      "page_number": 187,
      "chapter": null,
      "content": "162\nChapter 9 Input and Output\nThe methods described in the preceding section can be used to perform raw I/O\nwith the user. For example, the following code writes to standard output and reads a\nline of input from standard input:\nimport sys\nsys.stdout.write(\"Enter your name : \")\nname = sys.stdin.readline()\nAlternatively, the built-in function raw_input(prompt) can read a line of text from\nstdin and optionally print a prompt:\nname = raw_input(\"Enter your name : \")\nLines read by raw_input() do not include the trailing newline.This is different than\nreading directly from sys.stdin where newlines are included in the input text. In\nPython 3, raw_input() has been renamed to input().\nKeyboard interrupts (typically generated by Ctrl+C) result in a\nKeyboardInterrupt exception that can be caught using an exception handler.\nIf necessary, the values of sys.stdout, sys.stdin, and sys.stderr can be\nreplaced with other file objects, in which case the print statement and input functions\nuse the new values. Should it ever be necessary to restore the original value of\nsys.stdout, it should be saved first.The original values of sys.stdout, sys.stdin,\nand sys.stderr at interpreter startup are also available in sys.__stdout__,\nsys.__stdin__, and sys.__stderr__, respectively.\nNote that in some cases sys.stdin, sys.stdout, and sys.stderr may be altered\nby the use of an integrated development environment (IDE). For example, when\nPython is run under IDLE, sys.stdin is replaced with an object that behaves like a\nfile but is really an object in the development environment. In this case, certain low-\nlevel methods, such as read() and seek(), may be unavailable.\nThe print Statement\nPython 2 uses a special print statement to produce output on the file contained in\nsys.stdout. print accepts a comma-separated list of objects such as the following:\nprint \"The values are\", x, y, z\nFor each object, the str() function is invoked to produce an output string.These out-\nput strings are then joined and separated by a single space to produce the final output\nstring.The output is terminated by a newline unless a trailing comma is supplied to the\nprint statement. In this case, the next print statement will insert a space before print-\ning more items.The output of this space is controlled by the softspace attribute of\nthe file being used for output.\nprint \"The values are \", x, y, z, w\n# Print the same text, using two print statements\nprint \"The values are \", x, y,   # Omits trailing newline\nprint z, w                       # A space is printed before z\nTo produce formatted output, use the string-formatting operator (%) or the .format()\nmethod as described in Chapter 4,“Operators and Expressions.” Here’s an example:\nprint \"The values are %d %7.5f %s\" % (x,y,z) # Formatted I/O\nprint \"The values are {0:d} {1:7.5f} {2}\".format(x,y,z)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2859,
      "extraction_method": "Direct"
    },
    {
      "page_number": 188,
      "chapter": null,
      "content": "163\nVariable Interpolation in Text Output\nYou can change the destination of the print statement by adding the special >>file\nmodifier followed by a comma, where file is a file object that allows writes. Here’s an\nexample:\nf = open(\"output\",\"w\")\nprint >>f, \"hello world\"\n...\nf.close()\nThe print() Function\nOne of the most significant changes in Python 3 is that print is turned into a func-\ntion. In Python 2.6, it is also possible to use print as a function if you include the\nstatement from __future__ import print_function in each module where used.\nThe print() function works almost exactly the same as the print statement described\nin the previous section.\nTo print a series of values separated by spaces, just supply them all to print() like\nthis:\nprint(\"The values are\", x, y, z)\nTo suppress or change the line ending, use the end=ending keyword argument. For\nexample:\nprint(\"The values are\", x, y, z, end='')   # Suppress the newline\nTo redirect the output to a file, use the file=outfile keyword argument. For \nexample:\nprint(\"The values are\", x, y, z, file=f)   # Redirect to file object f\nTo change the separator character between items, use the sep=sepchr keyword argu-\nment. For example:\nprint(\"The values are\", x, y, z, sep=',')   # Put commas between the values\nVariable Interpolation in Text Output\nA common problem when generating output is that of producing large text fragments\ncontaining embedded variable substitutions. Many scripting languages such as Perl and\nPHP allow variables to be inserted into strings using dollar-variable substitutions (that\nis, $name, $address, and so on). Python provides no direct equivalent of this feature,\nbut it can be emulated using formatted I/O combined with triple-quoted strings. For\nexample, you could write a short form letter, filling in a name, an item name, and an\namount, as shown in the following example:\n# Note: trailing slash right after \"\"\" prevents \n# a blank line from appearing as the first line \nform = \"\"\"\\\nDear  %(name)s,\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2020,
      "extraction_method": "Direct"
    },
    {
      "page_number": 189,
      "chapter": null,
      "content": "164\nChapter 9 Input and Output\nPlease send back my %(item)s or pay me $%(amount)0.2f.\nSincerely yours,\nJoe Python User\n\"\"\"\nprint form % { 'name': 'Mr. Bush',\n'item': 'blender',\n'amount': 50.00,\n}\nThis produces the following output:\nDear Mr. Bush,\nPlease send back my blender or pay me $50.00.\nSincerely yours,\nJoe Python User\nThe format() method is a more modern alternative that cleans up some of the previ-\nous code. For example:\nform = \"\"\"\\\nDear {name},\nPlease send back my {item} or pay me {amount:0.2f}.\nSincerely yours,\nJoe Python User\n\"\"\"\nprint form.format(name='Mr. Bush', item='blender', amount=50.0)\nFor certain kinds of forms, you can also use Template strings, as follows:\nimport string\nform = string.Template(\"\"\"\\\nDear  $name,\nPlease send back my $item or pay me $amount.\nSincerely yours,\nJoe Python User\n\"\"\")\nprint form.substitute({'name': 'Mr. Bush',\n'item': 'blender',\n'amount': \"%0.2f\" % 50.0})\nIn this case, special $ variables in the string indicate substitutions.The \nform.substitute() method takes a dictionary of replacements and returns a new\nstring.Although the previous approaches are simple, they aren’t always the most power-\nful solutions to text generation.Web frameworks and other large application frameworks\ntend to provide their own template string engines that support embedded control-flow,\nvariable substitutions, file inclusion, and other advanced features.\nGenerating Output\nWorking directly with files is the I/O model most familiar to programmers. However,\ngenerator functions can also be used to emit an I/O stream as a sequence of data frag-\nments.To do this, simply use the yield statement like you would use a write() or\nprint statement. Here is an example:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1724,
      "extraction_method": "Direct"
    },
    {
      "page_number": 190,
      "chapter": null,
      "content": "165\nUnicode String Handling\ndef countdown(n):\nwhile n > 0:\nyield \"T-minus %d\\n\" % n\nn -= 1\nyield \"Kaboom!\\n\"\nProducing an output stream in this manner provides great flexibility because the pro-\nduction of the output stream is decoupled from the code that actually directs the stream\nto its intended destination. For example, if you wanted to route the above output to a\nfile f, you could do this:\ncount = countdown(5)\nf.writelines(count)\nIf, instead, you wanted to redirect the output across a socket s, you could do this:\nfor chunk in count:\ns.sendall(chunk)\nOr, if you simply wanted to capture all of the output in a string, you could do this:\nout = \"\".join(count)\nMore advanced applications can use this approach to implement their own I/O buffer-\ning. For example, a generator could be emitting small text fragments, but another func-\ntion could be collecting the fragments into large buffers to create a larger, more efficient\nI/O operation:\nchunks = []\nbuffered_size = 0\nfor chunk in count:\nchunks.append(chunk)\nbuffered_size += len(chunk)\nif buffered_size >= MAXBUFFERSIZE:\noutf.write(\"\".join(chunks))\nchunks.clear()\nbuffered_size = 0\noutf.write(\"\".join(chunks)\nFor programs that are routing output to files or network connections, a generator\napproach can also result in a significant reduction in memory use because the entire\noutput stream can often be generated and processed in small fragments as opposed to\nbeing first collected into one large output string or list of strings.This approach to out-\nput is sometimes seen when writing programs that interact with the Python Web\nServices Gateway Interface (WSGI) that’s used to communicate between components in\ncertain web frameworks.\nUnicode String Handling\nA common problem associated with I/O handling is that of dealing with international\ncharacters represented as Unicode. If you have a string s of raw bytes containing an\nencoded representation of a Unicode string, use the s.decode([encoding\n[,errors]]) method to convert it into a proper Unicode string.To convert a Unicode\nstring, u, to an encoded byte string, use the string method u.encode([encoding [,\nerrors]]). Both of these conversion operators require the use of a special encoding\nname that specifies how Unicode character values are mapped to a sequence of 8-bit\ncharacters in byte strings, and vice versa.The encoding parameter is specified as a string\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2407,
      "extraction_method": "Direct"
    },
    {
      "page_number": 191,
      "chapter": null,
      "content": "166\nChapter 9 Input and Output\nand is one of more than a hundred different character encodings.The following values,\nhowever, are most common:\nValue\nDescription\n'ascii'\n7-bit ASCII\n'latin-1' or 'iso-8859-1'\nISO 8859-1 Latin-1\n'cp1252'\nWindows 1252 encoding\n'utf-8'\n8-bit variable-length encoding\n'utf-16'\n16-bit variable-length encoding (may be little or big\nendian)\n'utf-16-le'\nUTF-16, little endian encoding\n'utf-16-be'\nUTF-16, big endian encoding\n'unicode-escape'\nSame format as Unicode literals u\"string\"\n'raw-unicode-escape'\nSame format as raw Unicode literals ur\"string\"\nThe default encoding is set in the site module and can be queried using \nsys.getdefaultencoding(). In many cases, the default encoding is 'ascii', which\nmeans that ASCII characters with values in the range [0x00,0x7f] are directly mapped\nto Unicode characters in the range [U+0000, U+007F]. However, 'utf-8' is also a\nvery common setting.Technical details concerning common encodings appears in a\nlater section.\nWhen using the s.decode() method, it is always assumed that s is a string of bytes.\nIn Python 2, this means that s is a standard string, but in Python 3, s must be a special\nbytes type. Similarly, the result of t.encode() is always a byte sequence. One caution\nif you care about portability is that these methods are a little muddled in Python 2. For\ninstance, Python 2 strings have both decode() and encode() methods, whereas in\nPython 3, strings only have an encode() method and the bytes type only has a\ndecode() method.To simplify code in Python 2, make sure you only use encode() on\nUnicode strings and decode() on byte strings.\nWhen string values are being converted, a UnicodeError exception might be raised\nif a character that can’t be converted is encountered. For instance, if you are trying to\nencode a string into 'ascii' and it contains a Unicode character such as U+1F28, you\nwill get an encoding error because this character value is too large to be represented in\nthe ASCII character set.The errors parameter of the encode() and decode() meth-\nods determines how encoding errors are handled. It’s a string with one of the following\nvalues:\nValue\nDescription\n'strict'\nRaises a UnicodeError exception for encoding and decod-\ning errors.\n'ignore'\nIgnores invalid characters.\n'replace'\nReplaces invalid characters with a replacement character\n(U+FFFD in Unicode, '?' in standard strings).\n'backslashreplace'\nReplaces invalid characters with a Python character escape\nsequence. For example, the character U+1234 is replaced\nby '\\u1234'.\n'xmlcharrefreplace'\nReplaces invalid characters with an XML character reference.\nFor example, the character U+1234 is replaced by\n'&#4660;'.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2700,
      "extraction_method": "Direct"
    },
    {
      "page_number": 192,
      "chapter": null,
      "content": "167\nUnicode I/O\nThe default error handling is 'strict'.\nThe 'xmlcharrefreplace’ error handling policy is often a useful way to embed\ninternational characters into ASCII-encoded text on web pages. For example, if you\noutput the Unicode string 'Jalape\\u00f1o' by encoding it to ASCII with\n'xmlcharrefreplace' handling, browsers will almost always correctly render the out-\nput text as “Jalapeño” and not some garbled alternative.\nTo keep your brain from exploding, encoded byte strings and unencoded strings\nshould never be mixed together in expressions (for example, using + to concatenate).\nPython 3 prohibits this altogether, but Python 2 will silently go ahead with such opera-\ntions by automatically promoting byte strings to Unicode according to the default\nencoding setting.This behavior is often a source of surprising results or inexplicable\nerror messages.Thus, you should carefully try to maintain a strict separation between\nencoded and unencoded character data in your program.\nUnicode I/O\nWhen working with Unicode strings, it is never possible to directly write raw Unicode\ndata to a file.This is due to the fact that Unicode characters are internally represented as\nmultibyte integers and that writing such integers directly to an output stream causes\nproblems related to byte ordering. For example, you would have to arbitrarily decide if\nthe Unicode character U+HHLL is to be written in “little endian” format as the byte\nsequence LL HH or in “big endian” format as the byte sequence HH LL. Moreover, other\ntools that process Unicode would have to know which encoding you used.\nBecause of this problem, the external representation of Unicode strings is always\ndone according to a specific encoding rule that precisely defines how Unicode charac-\nters are to be represented as a byte sequence.Thus, to support Unicode I/O, the encod-\ning and decoding concepts described in the previous section are extended to files.The\nbuilt-in codecs module contains a collection of functions for converting byte-oriented\ndata to and from Unicode strings according to a variety of different data-encoding\nschemes.\nPerhaps the most straightforward way to handle Unicode files is to use the\ncodecs.open(filename [, mode [, encoding [, errors]]]) function, as \nfollows:\nf = codecs.open('foo.txt','r','utf-8','strict')     # Reading\ng = codecs.open('bar.txt','w','utf-8')              # Writing\nThis creates a file object that reads or writes Unicode strings.The encoding parameter\nspecifies the underlying character encoding that will be used to translate data as it is\nread or written to the file.The errors parameter determines how errors are handled\nand is one of 'strict', 'ignore', 'replace', 'backslashreplace', or \n'xmlcharrefreplace' as described in the previous section.\nIf you already have a file object, the codecs.EncodedFile(file, inputenc [,\noutputenc [, errors]]) function can be used to place an encoding wrapper around\nit. Here’s an example:\nf = open(\"foo.txt\",\"rb\")\n...\nfenc = codecs.EncodedFile(f,'utf-8')\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3044,
      "extraction_method": "Direct"
    },
    {
      "page_number": 193,
      "chapter": null,
      "content": "168\nChapter 9 Input and Output\nIn this case, data read from the file will be interpreted according to the encoding sup-\nplied in inputenc. Data written to the file will be interpreted according to the encod-\ning in inputenc and written according to the encoding in outputenc. If outputenc\nis omitted, it defaults to the same as inputenc. errors has the same meaning as\ndescribed earlier.When putting an EncodedFile wrapper around an existing file, make\nsure that file is in binary mode. Otherwise, newline translation might break the encod-\ning.\nWhen you’re working with Unicode files, the data encoding is often embedded in\nthe file itself. For example, XML parsers may look at the first few bytes of the string\n'<?xml ...>' to determine the document encoding. If the first four values are 3C 3F\n78 6D ('<?xm'), the encoding is assumed to be UTF-8. If the first four values are 00\n3C 00 3F or 3C 00 3F 00, the encoding is assumed to be UTF-16 big endian or\nUTF-16 little endian, respectively.Alternatively, a document encoding may appear in\nMIME headers or as an attribute of other document elements. Here’s an example:\n<?xml ... encoding=\"ISO-8859-1\" ... ?>\nSimilarly, Unicode files may also include special byte-order markers (BOM) that indi-\ncate properties of the character encoding.The Unicode character U+FEFF is reserved for\nthis purpose.Typically, the marker is written as the first character in the file. Programs\nthen read this character and look at the arrangement of the bytes to determine encod-\ning (for example, '\\xff\\xfe' for UTF-16-LE or '\\xfe\\xff' UTF-16-BE). Once the\nencoding is determined, the BOM character is discarded and the remainder of the file is\nprocessed. Unfortunately, all of this extra handling of the BOM is not something that\nhappens behind the scenes.You often have to take care of this yourself if your applica-\ntion warrants it.\nWhen the encoding is read from a document, code similar to the following can be\nused to turn the input file into an encoded stream:\nf = open(\"somefile\",\"rb\")\n# Determine encoding of the file\n...\n# Put an appropriate encoding wrapper on the file.\n# Assumes that the BOM (if any) has already been discarded\n# by earlier statements.\nfenc = codecs.EncodedFile(f,encoding)\ndata = fenc.read()\nUnicode Data Encodings\nTable 9.3 lists some of the most commonly used encoders in the codecs module.\nTable 9.3\nEncoders in the codecs Module\nEncoder\nDescription\n'ascii'\nASCII encoding\n'latin-1', 'iso-8859-1'\nLatin-1 or ISO-8859-1 encoding\n'cp437'\nCP437 encoding\n'cp1252'\nCP1252 encoding\n'utf-8'\n8-bit variable-length encoding\n'utf-16'\n16-bit variable-length encoding\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2644,
      "extraction_method": "Direct"
    },
    {
      "page_number": 194,
      "chapter": null,
      "content": "169\nUnicode I/O\nTable 9.3\nContinued\nEncoder\nDescription\n'utf-16-le'\nUTF-16, but with explicit little endian encoding\n'utf-16-be'\nUTF-16, but with explicit big endian encoding\n'unicode-escape'\nSame format as u\"string\"\n'raw-unicode-escape'\nSame format as ur\"string\"\nThe following sections describe each of the encoders in more detail.\n'ascii' Encoding\nIn 'ascii' encoding, character values are confined to the ranges [0x00,0x7f] and\n[U+0000, U+007F].Any character outside this range is invalid.\n'iso-8859-1', 'latin-1' Encoding\nCharacters can be any 8-bit value in the ranges [0x00,0xff] and [U+0000, U+00FF].\nValues in the range [0x00,0x7f] correspond to characters from the ASCII character\nset.Values in the range [0x80,0xff] correspond to characters from the ISO-8859-1 \nor extended ASCII character set.Any characters with values outside the range\n[0x00,0xff] result in an error.\n'cp437' Encoding\nThis encoding is similar to 'iso-8859-1' but is the default encoding used by Python\nwhen it runs as a console application on Windows. Certain characters in the range\n[x80,0xff] correspond to special symbols used for rendering menus, windows, and\nframes in legacy DOS applications.\n'cp1252' Encoding\nThis is an encoding that is very similar to 'iso-8859-1' used on Windows. However,\nthis encoding defines characters in the range [0x80-0x9f] that are undefined in \n'iso-8859-1' and which have different code points in Unicode.\n'utf-8' Encoding\nUTF-8 is a variable-length encoding that allows all Unicode characters to be represent-\ned.A single byte is used to represent ASCII characters in the range 0–127.All other\ncharacters are represented by multibyte sequences of 2 or 3 bytes.The encoding of these\nbytes is shown here:\nUnicode Characters\nByte 0\nByte 1\nByte 2\nU+0000 - U+007F\n0nnnnnnn\nU+007F - U+07FF\n110nnnnn\n10nnnnnn\nU+0800 - U+FFFF\n1110nnnn\n10nnnnnn\n10nnnnnn\nFor 2-byte sequences, the first byte always starts with the bit sequence 110. For 3-byte\nsequences, the first byte starts with the bit sequence 1110.All subsequent data bytes in\nmultibyte sequences start with the bit sequence 10.\nIn full generality, the UTF-8 format allows for multibyte sequences of up to 6 bytes.\nIn Python, 4-byte UTF-8 sequences are used to encode a pair of Unicode characters\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2283,
      "extraction_method": "Direct"
    },
    {
      "page_number": 195,
      "chapter": null,
      "content": "170\nChapter 9 Input and Output\nknown as a surrogate pair. Both characters have values in the range [U+D800, U+DFFF]\nand are combined to encode a 20-bit character value.The surrogate encoding is as \nfollows:The 4-byte sequence 11110nnn 10nnnnnn 10nmmmm 10mmmmm is encoded as\nthe pair U+D800 + N, U+DC00 + M, where N is the upper 10 bits and M is the lower 10\nbits of the 20-bit character encoded in the 4-byte UTF-8 sequence. Five- and 6-byte\nUTF-8 sequences (denoted by starting bit sequences of 111110 and 1111110, respec-\ntively) are used to encode character values up to 32 bits in length.These values are not\nsupported by Python and currently result in a UnicodeError exception if they appear\nin an encoded data stream.\nUTF-8 encoding has a number of useful properties that allow it to be used by older\nsoftware. First, the standard ASCII characters are represented in their standard encoding.\nThis means that a UTF-8–encoded ASCII string is indistinguishable from a traditional\nASCII string. Second, UTF-8 doesn’t introduce embedded NULL bytes for multibyte\ncharacter sequences.Therefore, existing software based on the C library and programs\nthat expect NULL-terminated 8-bit strings will work with UTF-8 strings. Finally,\nUTF-8 encoding preserves the lexicographic ordering of strings.That is, if a and b are\nUnicode strings and a < b, then a < b also holds when a and b are converted to\nUTF-8.Therefore, sorting algorithms and other ordering algorithms written for 8-bit\nstrings will also work for UTF-8.\n'utf-16', 'utf-16-be', and 'utf-16-le' Encoding\nUTF-16 is a variable-length 16-bit encoding in which Unicode characters are written\nas 16-bit values. Unless a byte ordering is specified, big endian encoding is assumed. In\naddition, a byte-order marker of U+FEFF can be used to explicitly specify the byte\nordering in a UTF-16 data stream. In big endian encoding, U+FEFF is the Unicode\ncharacter for a zero-width nonbreaking space, whereas the reversed value U+FFFE is an\nillegal Unicode character.Thus, the encoder can use the byte sequence FE FF or FF FE\nto determine the byte ordering of a data stream.When reading Unicode data, Python\nremoves the byte-order markers from the final Unicode string.\n'utf-16-be' encoding explicitly selects UTF-16 big endian encoding.\n'utf-16-le' encoding explicitly selects UTF-16 little ending encoding.\nAlthough there are extensions to UTF-16 to support character values greater than\n16 bits, none of these extensions are currently supported.\n'unicode-escape' and 'raw-unicode-escape' Encoding\nThese encoding methods are used to convert Unicode strings to the same format as\nused in Python Unicode string literals and Unicode raw string literals. Here’s an \nexample:\ns = u'\\u14a8\\u0345\\u2a34'\nt = s.encode('unicode-escape')   #t = '\\u14a8\\u0345\\u2a34'\nUnicode Character Properties\nIn addition to performing I/O, programs that use Unicode may need to test Unicode\ncharacters for various properties such as capitalization, numbers, and whitespace.The\nunicodedata module provides access to a database of character properties. General\ncharacter properties can be obtained with the unicodedata.category(c) function.\nFor example, unicodedata.category(u\"A\") returns 'Lu', signifying that the charac-\nter is an uppercase letter.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3292,
      "extraction_method": "Direct"
    },
    {
      "page_number": 196,
      "chapter": null,
      "content": "171\nObject Persistence and the pickle Module\nAnother tricky problem with Unicode strings is that there might be multiple repre-\nsentations of the same Unicode string. For example, the character U+00F1 (ñ), might be\nfully composed as a single character U+00F1 or decomposed into a multicharacter\nsequence U+006e U+0303 (n, ˜). If consistent processing of Unicode strings is an issue,\nuse the unicodedata.normalize() function to ensure a consistent character represen-\ntation. For example, unicodedata.normalize('NFC', s) will make sure that all\ncharacters in s are fully composed and not represented as a sequence of combining\ncharacters.\nFurther details about the Unicode character database and the unicodedata module\ncan be found in Chapter 16,“Strings and Text Handling.”\nObject Persistence and the pickle Module\nFinally, it’s often necessary to save and restore the contents of an object to a file. One\napproach to this problem is to write a pair of functions that simply read and write data\nfrom a file in a special format.An alternative approach is to use the pickle and shelve\nmodules.\nThe pickle module serializes an object into a stream of bytes that can be written to\na file and later restored.The interface to pickle is simple, consisting of a dump() and\nload() operation. For example, the following code writes an object to a file:\nimport pickle\nobj = SomeObject()\nf = open(filename,'wb')\npickle.dump(obj, f)      # Save object on f\nf.close()\nTo restore the object, you can use the following code:\nimport pickle\nf = open(filename,'rb')\nobj = pickle.load(f)   # Restore the object\nf.close()\nA sequence of objects can be saved by issuing a series of dump() operations one after\nthe other.To restore these objects, simply use a similar sequence of load() operations.\nThe shelve module is similar to pickle but saves objects in a dictionary-like \ndatabase:\nimport shelve\nobj = SomeObject()\ndb = shelve.open(\"filename\")     # Open a shelve\ndb['key'] = obj                  # Save object in the shelve\n...\nobj = db['key']                   # Retrieve it\ndb.close()                        # Close the shelve\nAlthough the object created by shelve looks like a dictionary, it also has restrictions.\nFirst, the keys must be strings. Second, the values stored in a shelf must be compatible\nwith pickle. Most Python objects will work, but special-purpose objects such as files\nand network connections maintain an internal state that cannot be saved and restored in\nthis manner.\nThe data format used by pickle is specific to Python. However, the format has\nevolved several times over Python versions.The choice of protocol can be selected using\nan optional protocol parameter to the pickle dump(obj, file, protocol) operation.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2747,
      "extraction_method": "Direct"
    },
    {
      "page_number": 197,
      "chapter": null,
      "content": "172\nChapter 9 Input and Output\nBy default, protocol 0 is used.This is the oldest pickle data format that stores objects in\na format understood by virtually all Python versions. However, this format is also\nincompatible with many of Python’s more modern features of user-defined classes such\nas slots. Protocol 1 and 2 use a more efficient binary data representation.To use these\nalternative protocols, you would perform operations such as the following:\nimport pickle\nobj = SomeObject()\nf = open(filename,'wb')\npickle.dump(obj,f,2)                         # Save using protocol 2\npickle.dump(obj,f,pickle.HIGHEST_PROTOCOL)   # Use the most modern protocol\nf.close()\nIt is not necessary to specify the protocol when restoring an object using load().The\nunderlying protocol is encoded into the file itself.\nSimilarly, a shelve can be opened to save Python objects using an alternative pickle\nprotocol like this:\nimport shelve\ndb = shelve.open(filename,protocol=2)\n...\nIt is not normally necessary for user-defined objects to do anything extra to work with\npickle or shelve. However, the special methods __getstate__() and\n__setstate__() can be used to assist the pickling process.The __getstate__()\nmethod, if defined, will be called to create a value representing the state of an object.\nThe value returned by __getstate_ _() should typically be a string, tuple, list, or dic-\ntionary.The __setstate__() method receives this value during unpickling and should\nrestore the state of an object from it. Here is an example that shows how these methods\ncould be used with an object involving an underlying network connection.Although\nthe actual connection can’t be pickled, the object saves enough information to reestab-\nlish it when it’s unpickled later:\nimport socket\nclass Client(object):\ndef __init__(self,addr):\nself.server_addr = addr\nself.sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\nself.sock.connect(addr)\ndef __getstate__(self):\nreturn self.server_addr\ndef __setstate__(self,value):\nself.server_addr = value\nself.sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\nself.sock.connect(self.server_addr)\nBecause the data format used by pickle is Python-specific, you would not use this \nfeature as a means for exchanging data between applications written in different pro-\ngramming languages. Moreover, due to security concerns, programs should not process\npickled data from untrusted sources (a knowledgeable attacker can manipulate the pick-\nle data format to execute arbitrary system commands during unpickling).\nThe pickle and shelve modules have many more customization features and\nadvanced usage options. For more details, consult Chapter 13,“Python Runtime\nServices.”\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2715,
      "extraction_method": "Direct"
    },
    {
      "page_number": 198,
      "chapter": null,
      "content": "10\nExecution Environment\nThis chapter describes the environment in which Python programs are executed.The\ngoal is to describe the runtime behavior of the interpreter, including program startup,\nconfiguration, and program termination.\nInterpreter Options and Environment\nThe interpreter has a number of options that control its runtime behavior and environ-\nment. Options are given to the interpreter on the command line as follows:\npython [options] [-c cmd | filename | - ] [args]\nHere’s a list of the most common command-line options:\nTable 10.1\nInterpreter Command-Line Arguments\nOption\nDescription\n-3\nEnables warnings about features that are being removed or changed in\nPython 3.\n-B\nPrevents the creation of .pyc or .pyo files on import.\n-E\nIgnores environment variables.\n-h\nPrints a list of all available command-line options.\n-i\nEnters interactive mode after program execution.\n-m module Runs library module module as a script.\n-O\nOptimized mode.\n-OO\nOptimized mode plus removal of documentation strings when creating\n.pyo files.\n-Q arg\nSpecifies the behavior of the division operator in Python 2. One of -Qold\n(the default), -Qnew, -Qwarn, or -Qwarnall.\n-s\nPrevents the addition of the user site directory to sys.path.\n-S\nPrevents inclusion of the site initialization module.\n-t\nReports warnings about inconsistent tab usage.\n-tt\nInconsistent tab usage results in a TabError exception.\n-u\nUnbuffered binary stdout and stdin.\n-U\nUnicode literals. All string literals are handled as Unicode (Python 2 only).\n-v\nVerbose mode. Traces import statements.\n-V\nPrints the version number and exits.\n-x\nSkips the first line of the source program.\n-c cmd\nExecutes cmd as a string.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1697,
      "extraction_method": "Direct"
    },
    {
      "page_number": 199,
      "chapter": null,
      "content": "174\nChapter 10 Execution Environment\nThe -i option starts an interactive session immediately after a program has finished exe-\ncution and is useful for debugging.The -m option runs a library module as a script\nwhich executes inside the __main__ module prior to the execution of the main script.\nThe -O and -OO options apply some optimization to byte-compiled files and are\ndescribed in Chapter 8,“Modules, Packages, and Distribution.”The -S option omits\nthe site initialization module described in the later section “Site Configuration Files.”\nThe -t, -tt, and -v options report additional warnings and debugging information. -x\nignores the first line of a program in the event that it’s not a valid Python statement (for\nexample, when the first line starts the Python interpreter in a script).\nThe program name appears after all the interpreter options. If no name is given, or\nthe hyphen (-) character is used as a filename, the interpreter reads the program from\nstandard input. If standard input is an interactive terminal, a banner and prompt are pre-\nsented. Otherwise, the interpreter opens the specified file and executes its statements\nuntil an end-of-file marker is reached.The -c cmd option can be used to execute short\nprograms in the form of a command-line option—for example, python -c\n\"print('hello world')\".\nCommand-line options appearing after the program name or hyphen (-) are passed\nto the program in sys.argv, as described in the section “Reading Options and\nEnvironment Variables” in Chapter 9,“Input and Output.”\nAdditionally, the interpreter reads the following environment variables:\nTable 10.2\nInterpreter Environment Variables\nEnvironment Variable\nDescription\nPYTHONPATH\nColon-separated module search path.\nPYTHONSTARTUP\nFile executed on interactive startup.\nPYTHONHOME\nLocation of the Python installation.\nPYTHONINSPECT\nImplies the -i option.\nPYTHONUNBUFFERED\nImplies the -u option.\nPYTHONIOENCODING\nEncoding and error handling for stdin, stdout, and\nstderr. This is a string of the form\n\"encoding[:errors]\" such as \"utf-8\" or \"utf-\n8:ignore\".\nPYTHONDONTWRITEBYTECODE\nImplies the -B option\nPYTHONOPTIMIZE\nImplies the -O option.\nPYTHONNOUSERSITE\nImplies the -s option.\nPYTHONVERBOSE\nImplies the -v option.\nPYTHONUSERBASE\nRoot directory for per-user site packages.\nPYTHONCASEOK\nIndicates to use case-insensitive matching for module\nnames used by import.\nPYTHONPATH specifies a module search path that is inserted into the beginning of\nsys.path, which is described in Chapter 9. PYTHONSTARTUP specifies a file to execute\nwhen the interpreter runs in interactive mode.The PYTHONHOME variable is used to set\nthe location of the Python installation but is rarely needed because Python knows how\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2739,
      "extraction_method": "Direct"
    },
    {
      "page_number": 200,
      "chapter": null,
      "content": "175\nInteractive Sessions\nto find its own libraries and the site-packages directory where extensions are nor-\nmally installed. If a single directory such as /usr/local is given, the interpreter expects\nto find all files in that location. If two directories are given, such as /usr/local:/usr/\nlocal/sparc-solaris-2.6, the interpreter searches for platform-independent files in\nthe first directory and platform-dependent files in the second. PYTHONHOME has no\neffect if no valid Python installation exists at the specified location.\nThe PYTHONIOENCODING environment setting might be of interest to users of\nPython 3 because it sets both the encoding and error handling of the standard I/O\nstreams.This might be important because Python 3 directly outputs Unicode while\nrunning the interactive interpreter prompt.This, in turn, can cause unexpected excep-\ntions merely while inspecting data. For example:\n>>> a = 'Jalape\\xf1o'\n>>> a\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nFile \"/tmp/lib/python3.0/io.py\", line 1486, in write\nb = encoder.encode(s)\nFile \"/tmp/lib/python3.0/encodings/ascii.py\", line 22, in encode\nreturn codecs.ascii_encode(input, self.errors)[0]\nUnicodeEncodeError: 'ascii' codec can't encode character '\\xf1' in position 7:\nordinal not in range(128)\n>>>\nTo fix this, you can set the environment variable PYTHONIOENCODING to something\nsuch as 'ascii:backslashreplace' or 'utf-8'. Now, you will get this:\n>>> a = 'Jalape\\xf1o'\n>>> a\n'Jalape\\xf1o'\n>>>\nOn Windows, some of the environment variables such as PYTHONPATH are addition-\nally read from registry entries found in HKEY_LOCAL_MACHINE/Software/Python.\nInteractive Sessions\nIf no program name is given and the standard input to the interpreter is an interactive\nterminal, Python starts in interactive mode. In this mode, a banner message is printed\nand the user is presented with a prompt. In addition, the interpreter evaluates the script\ncontained in the PYTHONSTARTUP environment variable (if set).This script is evaluated\nas if it’s part of the input program (that is, it isn’t loaded using an import statement).\nOne application of this script might be to read a user configuration file such as\n.pythonrc.\nWhen interactive input is being accepted, two user prompts appear.The >>> prompt\nappears at the beginning of a new statement; the ... prompt indicates a statement con-\ntinuation. Here’s an example:\n>>> for i in range(0,4):\n...\nprint i,\n...\n0 1 2 3 \n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2483,
      "extraction_method": "Direct"
    },
    {
      "page_number": 201,
      "chapter": null,
      "content": "176\nChapter 10 Execution Environment\nIn customized applications, you can change the prompts by modifying the values of\nsys.ps1 and sys.ps2.\nOn some systems, Python may be compiled to use the GNU readline library. If\nenabled, this library provides command histories, completion, and other additions to\nPython’s interactive mode.\nBy default, the output of commands issued in interactive mode is generated by\nprinting the output of the built-in repr() function on the result.This can be changed\nby setting the variable sys.displayhook to a function responsible for displaying\nresults. Here’s an example that truncates long results:\n>>> def my_display(x):\n...\nr = repr(x)\n...\nif len(r) > 40: print(r[:40]+\"...\"+r[-1])\n...\nelse: print(r)\n>>> sys.displayhook = my_display\n>>> 3+4\n7\n>>> range(100000)\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 1...]\n>>>\nFinally, in interactive mode, it is useful to know that the result of the last operation is\nstored in a special variable (_).This variable can be used to retrieve the result should\nyou need to use it in subsequent operations. Here’s an example:\n>>> 7 + 3\n10\n>>> _ + 2\n12\n>>>\nThe setting of the _ variable occurs in the displayhook() function shown previously.\nIf you redefine displayhook(), your replacement function should also set _ if you\nwant to retain that functionality.\nLaunching Python Applications\nIn most cases, you’ll want programs to start the interpreter automatically, rather than\nfirst having to start the interpreter manually. On UNIX, this is done by giving the pro-\ngram execute permission and setting the first line of a program to something like this:\n#!/usr/bin/env python\n# Python code from this point on...\nprint \"Hello world\"\n...\nOn Windows, double-clicking a .py, .pyw, .wpy, .pyc, or .pyo file automatically\nlaunches the interpreter. Normally, programs run in a console window unless they’re\nrenamed with a .pyw suffix (in which case the program runs silently). If it’s necessary to\nsupply options to the interpreter, Python can also be started from a .bat file. For exam-\nple, this .bat file simply runs Python on a script and passes any options supplied on the\ncommand prompt along to the interpreter:\n:: foo.bat\n:: Runs foo.py script and passes supplied command line options along (if any)\nc:\\python26\\python.exe c:\\pythonscripts\\foo.py %*\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2334,
      "extraction_method": "Direct"
    },
    {
      "page_number": 202,
      "chapter": null,
      "content": "177\nPer-user Site Packages\nSite Configuration Files\nA typical Python installation may include a number of third-party modules and pack-\nages.To configure these packages, the interpreter first imports the module site.The\nrole of site is to search for package files and to add additional directories to the mod-\nule search path sys.path. In addition, the site module sets the default encoding for\nUnicode string conversions.\nThe site module works by first creating a list of directory names constructed from\nthe values of sys.prefix and sys.exec_prefix as follows:\n[ sys.prefix,              # Windows only\nsys.exec_prefix,         # Windows only\nsys.prefix + 'lib/pythonvers/site-packages',\nsys.prefix + 'lib/site-python',\nsys.exec_prefix + 'lib/pythonvers/site-packages',\nsys.exec_prefix + 'lib/site-python' ]\nIn addition, if enabled, a user-specific site packages directory may be added to this list\n(described in the next section).\nFor each directory in the list, a check is made to see whether the directory exists. If\nso, it’s added to the sys.path variable. Next, a check is made to see whether it contains\nany path configuration files (files with a .pth suffix).A path configuration file contains\na list of directories, zip files, or .egg files relative to the location of the path file that\nshould be added to sys.path. For example:\n# foo package configuration file 'foo.pth'\nfoo\nbar\nEach directory in the path configuration file must be listed on a separate line.\nComments and blank lines are ignored.When the site module loads the file, it checks\nto see whether each directory exists. If so, the directory is added to sys.path.\nDuplicated items are added to the path only once.\nAfter all paths have been added to sys.path, an attempt is made to import a mod-\nule named sitecustomize.The purpose of this module is to perform any additional\n(and arbitrary) site customization. If the import of sitecustomize fails with an\nImportError, the error is silently ignored.The import of sitecustomize occurs prior\nto adding any user directories to sys.path.Thus, placing this file in your own directo-\nry has no effect.\nThe site module is also responsible for setting the default Unicode encoding. By\ndefault, the encoding is set to 'ascii'. However, the encoding can be changed by\nplacing code in sitecustomize.py that calls sys.setdefaultencoding() with a\nnew encoding such as 'utf-8'. If you’re willing to experiment, the source code of\nsite can also be modified to automatically set the encoding based on the machine’s\nlocale settings.\nPer-user Site Packages\nNormally, third-party modules are installed in a way that makes them accessible to all\nusers. However, individual users can install modules and packages in a per-user site\ndirectory. On UNIX and Macintosh systems, this directory is found under ~/.local\nand is named something such as ~/.local/lib/python2.6/site-packages. On\nWindows systems, this directory is determined by the %APPDATA% environment variable,\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2994,
      "extraction_method": "Direct"
    },
    {
      "page_number": 203,
      "chapter": null,
      "content": "178\nChapter 10 Execution Environment\nwhich is usually something similar to C:\\Documents and Settings\\David\nBeazley\\Application Data.Within that folder, you will find a \"Python\\Python26\\\nsite-packages\" directory.\nIf you are writing your own Python modules and packages that you want to use in a\nlibrary, they can be placed in the per-user site directory. If you are installing third-party\nmodules, you can manually install them in this directory by supplying the --user\noption to setup.py. For example: python setup.py install --user.\nEnabling Future Features\nNew language features that affect compatibility with older versions of Python are often\ndisabled when they first appear in a release.To enable these features, the statement from\n__future__ import feature can be used. Here’s an example:\n# Enable new division semantics\nfrom __future__ import division\nWhen used, this statement should appear as the first statement of a module or program.\nMoreover, the scope of a __future__ import is restricted only to the module in which\nit is used.Thus, importing a future feature does not affect the behavior of Python’s\nlibrary modules or older code that requires the previous behavior of the interpreter to\noperate correctly.\nCurrently, the following features have been defined:\nTable 10.3\nFeature Names in the __future__ Module\nFeature Name\nDescription\nnested_scopes\nSupport for nested scopes in functions. First introduced in\nPython 2.1 and made the default behavior in Python 2.2.\ngenerators\nSupport for generators. First introduced in Python 2.2 and made\nthe default behavior in Python 2.3.\ndivision\nModified division semantics where integer division returns a frac-\ntional result. For example, 1/4 yields 0.25 instead of 0. First\nintroduced in Python 2.2 and is still an optional feature as of\nPython 2.6. This is the default behavior in Python 3.0.\nabsolute_import\nModified behavior of package-relative imports. Currently, when a\nsubmodule of a package makes an import statement such as\nimport string, it first looks in the current directory of the package\nand then directories in sys.path. However, this makes it impos-\nsible to load modules in the standard library if a package hap-\npens to use conflicting names. When this feature is enabled, the\nstatement import module is an absolute import. Thus, a state-\nment such as import string will always load the string mod-\nule from the standard library. First introduced in Python 2.5 and\nstill disabled in Python 2.6. It is enabled in Python 3.0.\nwith_statement\nSupport for context managers and the with statement. First\nintroduced in Python 2.5 and enabled by default in Python 2.6.\nprint_function\nUse Python 3.0 print() function instead of the print state-\nment. First introduced in Python 2.6 and enabled by default in\nPython 3.0.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2809,
      "extraction_method": "Direct"
    },
    {
      "page_number": 204,
      "chapter": null,
      "content": "179\nProgram Termination\nIt should be noted that no feature name is ever deleted from __future__. Thus, even\nif a feature is turned on by default in a later Python version, no existing code that uses\nthat feature name will break.\nProgram Termination\nA program terminates when no more statements exist to execute in the input program,\nwhen an uncaught SystemExit exception is raised (as generated by sys.exit()), or\nwhen the interpreter receives a SIGTERM or SIGHUP signal (on UNIX). On exit, the\ninterpreter decrements the reference count of all objects in all the currently known\nnamespaces (and destroys each namespace as well). If the reference count of an object\nreaches zero, the object is destroyed and its __del__() method is invoked.\nIt’s important to note that in some cases the __del__() method might not be\ninvoked at program termination.This can occur if circular references exist between\nobjects (in which case objects may be allocated but accessible from no known name-\nspace).Although Python’s garbage collector can reclaim unused circular references dur-\ning execution, it isn’t normally invoked on program termination.\nBecause there’s no guarantee that __del__() will be invoked at termination, it may\nbe a good idea to explicitly clean up certain objects, such as open files and network\nconnections.To accomplish this, add specialized cleanup methods (for example,\nclose()) to user-defined objects.Another possibility is to write a termination function\nand register it with the atexit module, as follows:\nimport atexit\nconnection = open_connection(\"deaddot.com\")\ndef cleanup():\nprint \"Going away...\"\nclose_connection(connection)\natexit.register(cleanup)\nThe garbage collector can also be invoked in this manner:\nimport atexit, gc\natexit.register(gc.collect)\nOne final peculiarity about program termination is that the __del__ method for some\nobjects may try to access global data or methods defined in other modules. Because\nthese objects may already have been destroyed, a NameError exception occurs in\n__del__, and you may get an error such as the following:\nException exceptions.NameError: 'c' in <method Bar.__del__\nof Bar instance at c0310> ignored\nIf this occurs, it means that __del__ has aborted prematurely. It also implies that it may\nhave failed in an attempt to perform an important operation (such as cleanly shutting\ndown a server connection). If this is a concern, it’s probably a good idea to perform an\nexplicit shutdown step in your code, rather than rely on the interpreter to destroy\nobjects cleanly at program termination.The peculiar NameError exception can also be\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2627,
      "extraction_method": "Direct"
    },
    {
      "page_number": 205,
      "chapter": null,
      "content": "180\nChapter 10 Execution Environment\neliminated by declaring default arguments in the declaration of the __del__()\nmethod:\nimport foo\nclass Bar(object):\ndef __del__(self, foo=foo):\nfoo.bar()        # Use something in module foo\nIn some cases, it may be useful to terminate program execution without performing any\ncleanup actions.This can be accomplished by calling os._exit(status).This function\nprovides an interface to the low-level exit() system call responsible for killing the\nPython interpreter process.When it’s invoked, the program immediately terminates\nwithout any further processing or cleanup.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 629,
      "extraction_method": "Direct"
    },
    {
      "page_number": 206,
      "chapter": null,
      "content": "11\nTesting, Debugging, Profiling,\nand Tuning\nUnlike programs in languages such as C or Java, Python programs are not processed\nby a compiler that produces an executable program. In those languages, the compiler is\nthe first line of defense against programming errors—catching mistakes such as calling\nfunctions with the wrong number of arguments or assigning improper values to vari-\nables (that is, type checking). In Python, however, these kinds of checks do not occur\nuntil a program runs. Because of this, you will never really know if your program is cor-\nrect until you run and test it. Not only that, unless you are able to run your program in\na way that executes every possible branch of its internal control-flow, there is always\nsome chance of a hidden error just waiting to strike (fortunately, this usually only hap-\npens a few days after shipping, however).\nTo address these kinds of problems, this chapter covers techniques and library mod-\nules used to test, debug, and profile Python code.At the end, some strategies for opti-\nmizing Python code are discussed.\nDocumentation Strings and the doctest\nModule\nIf the first line of a function, class, or module is a string, that string is known as a docu-\nmentation string.The inclusion of documentation strings is considered good style because\nthese strings are used to supply information to Python software development tools. For\nexample, the help() command inspects documentation strings, and Python IDEs look\nat the strings as well. Because programmers tend to view documentation strings while\nexperimenting in the interactive shell, it is common for the strings to include short\ninteractive examples. For example:\n# splitter.py\ndef split(line, types=None, delimiter=None):\n\"\"\"Splits a line of text and optionally performs type conversion.\nFor example:\n>>> split('GOOG 100 490.50')\n['GOOG', '100', '490.50']\n>>> split('GOOG 100 490.50',[str, int, float])\n['GOOG', 100, 490.5]\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1967,
      "extraction_method": "Direct"
    },
    {
      "page_number": 207,
      "chapter": null,
      "content": "182\nChapter 11 Testing, Debugging, Profiling, and Tuning\nBy default, splitting is performed on whitespace, but a different\ndelimiter can be selected with the delimiter keyword argument:\n>>> split('GOOG,100,490.50',delimiter=',')\n['GOOG', '100', '490.50']\n>>>\n\"\"\"\nfields = line.split(delimiter)\nif types:\nfields = [ ty(val) for ty,val in zip(types,fields) ]\nreturn fields\nA common problem with writing documentation is keeping the documentation syn-\nchronized with the actual implementation of a function. For example, a programmer\nmight modify a function but forget to update the documentation.\nTo address this problem, use the doctest module. doctest collects documentation\nstrings, scans them for interactive sessions, and executes them as a series of tests.To use\ndoctest, you typically create a separate module for testing. For example, if the previous\nfunction is in a file splitter.py, you would create a file testsplitter.py for test-\ning, as follows:\n# testsplitter.py\nimport splitter\nimport doctest\nnfail, ntests = doctest.testmod(splitter)\nIn this code, the call to doctest.testmod(module) runs tests on the specified module\nand returns the number of failures and total number of tests executed. No output is\nproduced if all of the tests pass. Otherwise, you will get a failure report that shows the\ndifference between the expected and received output. If you want to see verbose output\nof the tests, you can use testmod(module, verbose=True).\nAs an alternative to creating a separate testing file, library modules can test them-\nselves by including code such as this at the end of the file:\n...\nif _ _name_ _ == '_ _main_ _':\n# test myself\nimport doctest\ndoctest.testmod()\nWith this code, documentation tests will run if the file is run as the main program to\nthe interpreter. Otherwise, the tests are ignored if the file is loaded with import.\ndoctest expects the output of functions to literally match the exact output you get\nin the interactive interpreter.As a result, it is quite sensitive to issues of white space and\nnumerical precision. For example, consider this function:\ndef half(x):\n\"\"\"Halves x.  For example:\n>>> half(6.8)\n3.4\n>>>\n\"\"\"\nreturn x/2\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2192,
      "extraction_method": "Direct"
    },
    {
      "page_number": 208,
      "chapter": null,
      "content": "183\nUnit Testing and the unittest Module\nIf you run doctest on this function, you will get a failure report such as this:\n**********************************************************************\nFile \"half.py\", line 4, in _ _main_ _.half\nFailed example:\nhalf(6.8)\nExpected:\n3.4\nGot:\n3.3999999999999999\n**********************************************************************\nTo fix this, you either need to make the documentation exactly match the output or\nneed to pick a better example in the documentation.\nBecause using doctest is almost trivial, there is almost no excuse for not using it\nwith your own programs. However, keep in mind that doctest is not a module you\nwould typically use for exhaustive program testing. Doing so tends to result in exces-\nsively long and complicated documentation strings—which defeats the point of produc-\ning useful documentation (e.g., a user will probably be annoyed if he asks for help and\nthe documentation lists 50 examples covering all sorts of tricky corner cases). For this\nkind of testing, you want to use the unittest module.\nLast, the doctest module has a large number of configuration options that concerns\nvarious aspects of how testing is performed and how results are reported. Because these\noptions are not required for the most common use of the module, they are not covered\nhere. Consult http://docs.python.org/library/doctest.html for more details.\nUnit Testing and the unittest Module\nFor more exhaustive program testing, use the unittest module.With unit testing, a\ndeveloper writes a collection of isolated test cases for each element that makes up a pro-\ngram (for example, individual functions, methods, classes, and modules).These tests are\nthen run to verify correct behavior of the basic building blocks that make up larger\nprograms.As programs grow in size, unit tests for various components can be combined\nto create large testing frameworks and testing tools.This can greatly simplify the task of\nverifying correct behavior as well as isolating and fixing problems when they do occur.\nUse of this module can be illustrated by the code listing in the previous section:\n# splitter.py\ndef split(line, types=None, delimiter=None):\n\"\"\"Splits a line of text and optionally performs type conversion.\n...\n\"\"\"\nfields = line.split(delimiter)\nif types:\nfields = [ ty(val) for ty,val in zip(types,fields) ]\nreturn fields\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2397,
      "extraction_method": "Direct"
    },
    {
      "page_number": 209,
      "chapter": null,
      "content": "184\nChapter 11 Testing, Debugging, Profiling, and Tuning\nIf you wanted to write unit tests for testing various aspects of the split() function,\nyou would create a separate module testsplitter.py, like this:\n# testsplitter.py\nimport splitter\nimport unittest\n# Unit tests\nclass TestSplitFunction(unittest.TestCase):\ndef setUp(self):\n# Perform set up actions (if any)\npass\ndef tearDown(self):\n# Perform clean-up actions (if any)\npass\ndef testsimplestring(self):\nr = splitter.split('GOOG 100 490.50')\nself.assertEqual(r,['GOOG','100','490.50'])\ndef testtypeconvert(self):\nr = splitter.split('GOOG 100 490.50',[str, int, float])\nself.assertEqual(r,['GOOG', 100, 490.5])\ndef testdelimiter(self):\nr = splitter.split('GOOG,100,490.50',delimiter=',')\nself.assertEqual(r,['GOOG','100','490.50'])\n# Run the unittests\nif _ _name_ _ == '_ _main_ _':\nunittest.main()\nTo run tests, simply run Python on the file testsplitter.py. Here’s an example:\n% python testsplitter.py\n...\n----------------------------------------------------------------------\nRan 3 tests in 0.014s\nOK\nBasic use of unittest involves defining a class that inherits from unittest.TestCase.\nWithin this class, individual tests are defined by methods starting with the name\n'test'—for example, 'testsimplestring', 'testtypeconvert', and so on. (It is\nimportant to emphasize that the names are entirely up to you as long as they start with\n'test'.) Within each test, various assertions are used to check for different conditions.\nAn instance, t, of unittest.TestCase has the following methods that are used\nwhen writing tests and for controlling the testing process:\nt.setUp()\nCalled to perform set-up steps prior to running any of the testing methods.\nt.tearDown()\nCalled to perform clean-up actions after running the tests.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1799,
      "extraction_method": "Direct"
    },
    {
      "page_number": 210,
      "chapter": null,
      "content": "185\nUnit Testing and the unittest Module\nt.assert_(expr [, msg])\nt.failUnless(expr [, msg])\nSignals a test failure if expr evaluates as False. msg is a message string giving an expla-\nnation for the failure (if any).\nt.assertEqual(x, y [,msg])\nt.failUnlessEqual(x, y [, msg])\nSignals a test failure if x and y are not equal to each other. msg is a message explaining\nthe failure (if any).\nt.assertNotEqual(x, y [, msg])\nt.failIfEqual(x, y, [, msg])\nSignals a test failure if x and y are equal to each other. msg is a message explaining the\nfailure (if any).\nt.assertAlmostEqual(x, y [, places [, msg]])\nt.failUnlessAlmostEqual(x, y, [, places [, msg]])\nSignals a test failure if numbers x and y are not within places decimal places of each\nother.This is checked by computing the difference of x and y and rounding the result\nto the given number of places. If the result is zero, x and y are almost equal. msg is a\nmessage explaining the failure (if any).\nt.assertNotAlmostEqual(x, y, [, places [, msg]])\nt.failIfAlmostEqual(x, y [, places [, msg]])\nSignals a test failure if x and y are not at least places decimal places apart. msg is a\nmessage explaining the failure (if any).\nt.assertRaises(exc, callable, ...)\nt.failUnlessRaises(exc, callable, ...)\nSignals a test failure if the callable object callable does not raise the exception exc.\nRemaining arguments are passed as arguments to callable. Multiple exceptions can be\nchecked by using a tuple of exceptions as exc.\nt.failIf(expr [, msg])\nSignals a test failure if expr evaluates as True. msg is a message explaining the failure (if\nany).\nt.fail([msg])\nSignals a test failure. msg is a message explaining the failure (if any).\nt.failureException\nThis attribute is set to the last exception value caught in a test.This may be useful if\nyou not only want to check that an exception was raised, but that the exception raises\nan appropriate value—for example, if you wanted to check the error message generated\nas part of raising an exception.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2019,
      "extraction_method": "Direct"
    },
    {
      "page_number": 211,
      "chapter": null,
      "content": "186\nChapter 11 Testing, Debugging, Profiling, and Tuning\nIt should be noted that the unittest module contains a large number of advanced\ncustomization options for grouping tests, creating test suites, and controlling the envi-\nronment in which tests run.These features are not directly related to the process of\nwriting tests for your code (you tend to write testing classes as shown independently of\nhow tests actually get executed). Consult the documentation at http://docs.python.org/\nlibrary/unittest.html for more information on how to organize tests for larger programs.\nThe Python Debugger and the pdb Module\nPython includes a simple command-based debugger which is found in the pdb module.\nThe pdb module supports post-mortem debugging, inspection of stack frames, break-\npoints, single-stepping of source lines, and code evaluation.\nThere are several functions for invoking the debugger from a program or from the\ninteractive Python shell.\nrun(statement [, globals [, locals]])\nExecutes the string statement under debugger control.The debugger prompt will\nappear immediately before any code executes.Typing 'continue' will force it to run.\nglobals and locals define the global and local namespaces, respectively, in which the\ncode runs.\nruneval(expression [, globals [, locals]])\nEvaluates the expression string under debugger control.The debugger prompt will\nappear before any code executes, so you will need to type 'continue' to force it to\nexecute as with run(). On success, the value of the expression is returned.\nruncall(function [, argument, ...])\nCalls a function within the debugger. function is a callable object.Additional argu-\nments are supplied as the arguments to function.The debugger prompt will appear\nbefore any code executes.The return value of the function is returned upon comple-\ntion.\nset_trace()\nStarts the debugger at the point at which this function is called.This can be used to\nhard-code a debugger breakpoint into a specific code location.\npost_mortem(traceback)\nStarts post-mortem debugging of a traceback object. traceback is typically obtained\nusing a function such as sys.exc_info().\npm()\nEnters post-mortem debugging using the traceback of the last exception.\nOf all of the functions for launching the debugger, the set_trace() function may\nbe the easiest to use in practice. If you are working on a complicated application but\nyou have detected a problem in one part of it, you can insert a set_trace() call into\nthe code and simply run the application.When encountered, this will suspend the pro-\ngram and go directly to the debugger where you can inspect the execution environ-\nment. Execution resumes after you leave the debugger.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2702,
      "extraction_method": "Direct"
    },
    {
      "page_number": 212,
      "chapter": null,
      "content": "187\nThe Python Debugger and the pdb Module\nDebugger Commands\nWhen the debugger starts, it presents a (Pdb) prompt such as the following:\n>>> import pdb\n>>> import buggymodule\n>>> pdb.run('buggymodule.start()')\n> <string>(0)?()\n(Pdb)\n(Pdb) is the debugger prompt at which the following commands are recognized. Note\nthat some commands have a short and a long form. In this case, parentheses are used to\nindicate both forms. For example, h(elp) means that either h or help is acceptable.\n[!]statement\nExecutes the (one-line) statement in the context of the current stack frame.The\nexclamation point may be omitted, but it must be used to avoid ambiguity if the first\nword of the statement resembles a debugger command.To set a global variable, you can\nprefix the assignment command with a “global” command on the same line:\n(Pdb) global list_options; list_options = ['-l']\n(Pdb)\na(rgs)\nPrints the argument list of the current function.\nalias [name [command]]\nCreates an alias called name that executes command.Within the command string, the sub-\nstrings '%1','%2', and so forth are replaced by parameters when the alias is typed. '%*'\nis replaced by all parameters. If no command is given, the current alias list is shown.\nAliases can be nested and can contain anything that can be legally typed at the Pdb\nprompt. Here’s an example:\n# Print instance variables (usage \"pi classInst\")\nalias pi for k in %1._ _dict_ _.keys(): print \"%1.\",k,\"=\",%1._ _dict_ _[k]\n# Print instance variables in self\nalias ps pi self\nb(reak) [loc [, condition]]\nSets a breakpoint at location loc. loc either specifies a specific filename and line num-\nber or is the name of a function within a module.The following syntax is used:\nSetting\nDescription\nn\nA line number in the current file\nfilename:n\nA line number in another file\nfunction\nA function name in the current module\nmodule.function\nA function name in a module\nIf loc is omitted, all the current breakpoints are printed. condition is an expression\nthat must evaluate to true before the breakpoint is honored.All breakpoints are assigned\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2092,
      "extraction_method": "Direct"
    },
    {
      "page_number": 213,
      "chapter": null,
      "content": "188\nChapter 11 Testing, Debugging, Profiling, and Tuning\nnumbers that are printed as output upon the completion of this command.These num-\nbers are used in several other debugger commands that follow.\ncl(ear) [bpnumber [bpnumber ...]]\nClears a list of breakpoint numbers. If breakpoints are specified, all breaks are cleared.\ncommands [bpnumber]\nSets a series of debugger commands to execute automatically when the breakpoint\nbpnumber is encountered.When listing the commands to execute, simply type them on\nthe subsequent lines and use end to mark the end of the command sequence. If you\ninclude the continue command, the execution of the program will resume automati-\ncally when the breakpoint is encountered. If bpnumber is omitted, the last breakpoint\nset is used.\ncondition bpnumber [condition]\nPlaces a condition on a breakpoint. condition is an expression that must evaluate to\ntrue before the breakpoint is recognized. Omitting the condition clears any previous\ncondition.\nc(ont(inue))\nContinues execution until the next breakpoint is encountered.\ndisable [bpnumber [bpnumber ...]]\nDisables the set of specified breakpoints. Unlike with clear, they can be reenabled\nlater.\nd(own)\nMoves the current frame one level down in the stack trace.\nenable [bpnumber [bpnumber ...]]\nEnables a specified set of breakpoints.\nh(elp) [command]\nShows the list of available commands. Specifying a command returns help for that com-\nmand.\nignore bpnumber [count]\nIgnores a breakpoint for count executions.\nj(ump) lineno\nSets the next line to execute.This can only be used to move between statements in the\nsame execution frame. Moreover, you can’t jump into certain statements, such as state-\nments in the middle of a loop.\nl(ist) [first [, last]]\nLists source code.Without arguments, this command lists 11 lines around the current\nline (5 lines before and 5 lines after).With one argument, it lists 11 lines around that\nline.With two arguments, it lists lines in a given range. If last is less than first, it’s\ninterpreted as a count.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2048,
      "extraction_method": "Direct"
    },
    {
      "page_number": 214,
      "chapter": null,
      "content": "189\nThe Python Debugger and the pdb Module\nn(ext)\nExecutes until the next line of the current function. Skips the code contained in func-\ntion calls.\np expression\nEvaluates the expression in the current context and prints its value.\npp expression\nThe same as the p command, but the result is formatted using the pretty-printing mod-\nule (pprint).\nq(uit)\nQuits from the debugger.\nr(eturn)\nRuns until the current function returns.\nrun [args]\nRestarts the program and uses the command-line arguments in args as the new setting\nof sys.argv.All breakpoints and other debugger settings are preserved.\ns(tep)\nExecutes a single source line and stops inside called functions.\ntbreak [loc [, condition]]\nSets a temporary breakpoint that’s removed after its first hit.\nu(p)\nMoves the current frame one level up in the stack trace.\nunalias name\nDeletes the specified alias.\nuntil\nResumes execution until control leaves the current execution frame or until a line\nnumber greater than the current line number is reached. For example, if the debugger\nwas stopped at the last line in a loop body, typing until will execute all of the state-\nments in the loop until the loop is finished.\nw(here)\nPrints a stack trace.\nDebugging from the Command Line\nAn alternative method for running the debugger is to invoke it on the command line.\nHere’s an example:\n% python -m pdb someprogram.py\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1389,
      "extraction_method": "Direct"
    },
    {
      "page_number": 215,
      "chapter": null,
      "content": "190\nChapter 11 Testing, Debugging, Profiling, and Tuning\nIn this case, the debugger is launched automatically at the beginning of program startup\nwhere you are free to set breakpoints and make other configuration changes.To make\nthe program run, simply use the continue command. For example, if you wanted to\ndebug the split() function from within a program that used it, you might do this:\n% python –m pdb someprogram.py\n> /Users/beazley/Code/someprogram.py(1)<module>()\n-> import splitter\n(Pdb) b splitter.split\nBreakpoint 1 at /Users/beazley/Code/splitter.py:1\n(Pdb) c\n> /Users/beazley/Code/splitter.py(18)split()\n-> fields = line.split(delimiter)\n(Pdb)\nConfiguring the Debugger\nIf a .pdbrc file exists in the user’s home directory or in the current directory, it’s read\nin and executed as if it had been typed at the debugger prompt.This can be useful for\nspecifying debugging commands that you want to execute each time the debugger is\nstarted (as opposed to having to interactively type the commands each time).\nProgram Profiling\nThe profile and cProfile modules are used to collect profiling information. Both\nmodules work in the same way, but cProfile is implemented as a C extension, is sig-\nnificantly faster, and is more modern. Either module is used to collect both coverage\ninformation (that is, what functions get executed) as well as performance statistics.The\neasiest way to profile a program is to execute it from the command line as follows:\n% python -m cProfile someprogram.py\nAlternatively, the following function in the profile module can be used:\nrun(command [, filename])\nExecutes the contents of command using the exec statement under the profiler.\nfilename is the name of a file in which raw profiling data is saved. If it’s omitted, a\nreport is printed to standard output.\nThe result of running the profiler is a report such as the following:\n126 function calls (6 primitive calls) in 5.130 CPU seconds\nOrdered by: standard name\nncalls  tottime  percall  cumtime  percall filename:lineno(function)\n1    0.030    0.030    5.070    5.070 <string>:1(?)\n121/1    5.020    0.041    5.020    5.020 book.py:11(process)\n1    0.020    0.020    5.040    5.040 book.py:5(?)\n2    0.000    0.000    0.000    0.000 exceptions.py:101(_ _init_ _)\n1    0.060    0.060    5.130    5.130 profile:0(execfile('book.py'))\n0    0.000             0.000          profile:0(profiler)\nDifferent parts of the report generated by run() are interpreted as follows:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2483,
      "extraction_method": "Direct"
    },
    {
      "page_number": 216,
      "chapter": null,
      "content": "191\nTuning and Optimization\nSection\nDescription\nprimitive calls\nNumber of nonrecursive function calls\nncalls\nTotal number of calls (including self-recursion)\ntottime\nTime spent in this function (not counting subfunctions)\npercall\ntottime/ncalls\ncumtime\nTotal time spent in the function\npercall\ncumtime/(primitive calls)\nfilename:lineno(function) Location and name of each function\nWhen there are two numbers in the first column (for example, \"121/1\"), the latter is\nthe number of primitive calls and the former is the actual number of calls.\nSimply inspecting the generated report of the profiler is often enough for most appli-\ncations of this module—for example, if you simply want to see how your program is\nspending its time. However, if you want to save the data and analyze it further, the\npstats module can be used. Consult http://docs.python.org/library/profile.html for\nmore details about saving and analyzing the profile data.\nTuning and Optimization\nThis section covers some general rules of thumb that can be used to make Python pro-\ngrams run faster and use less memory.The techniques described here are by no means\nexhaustive but should give programmers some ideas when looking at their own code.\nMaking Timing Measurements\nIf you simply want to time a long-running Python program, the easiest way to do it is\noften just to run it until the control of something like the UNIX time command.\nAlternatively, if you have a block of long-running statements you want to time, you can\ninsert calls to time.clock() to get a current reading of the elapsed CPU time or calls\nto time.time() to read the current wall-clock time. For example:\nstart_cpu = time.clock()\nstart_real= time.time()\nstatements\nstatements\nend_cpu = time.clock()\nend_real = time.time()\nprint(\"%f Real Seconds\" % (end_real – start_real))\nprint(\"%f CPU seconds\" % (end_cpu - start_cpu))\nKeep in the mind that this technique really works only if the code to be timed runs for\na reasonable period of time. If you have a fine-grained statement you want to bench-\nmark, you can use the timeit(code [, setup]) function in the timeit module. For\nexample:\n>>> from timeit import timeit\n>>> timeit('math.sqrt(2.0)','import math')\n0.20388007164001465\n>>> timeit('sqrt(2.0)','from math import sqrt')\n0.14494490623474121\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2305,
      "extraction_method": "Direct"
    },
    {
      "page_number": 217,
      "chapter": null,
      "content": "192\nChapter 11 Testing, Debugging, Profiling, and Tuning\nIn this example, the first argument to timeit() is the code you want to benchmark.\nThe second argument is a statement that gets executed once in order to set up the exe-\ncution environment.The timeit() function runs the supplied statement one million\ntimes and reports the execution time.The number of repetitions can be changed by\nsupplying a number=count keyword argument to timeit().\nThe timeit module also has a function repeat() that can be used to make meas-\nurements.This function works the same way as timeit() except that it repeats the tim-\ning measurement three times and returns a list of the results. For example:\n>>> from timeit import repeat\n>>> repeat('math.sqrt(2.0)','import math')\n[0.20306601524353027, 0.19715800285339355, 0.20907392501831055] \n>>>\nWhen making performance measurement, it is common to refer to the associated\nspeedup, which usually refers to the original execution time divided by the new execu-\ntion time. For example, in the previous timing measurements, using sqrt(2.0) instead\nof math.sqrt(2.0) represents a speedup of 0.20388/0.14494 or about 1.41.\nSometimes this gets reported as a percentage by saying the speedup is about 41 percent.\nMaking Memory Measurements\nThe sys module has a function getsizeof() that can be used to investigate the mem-\nory footprint (in bytes) of individual Python objects. For example:\n>>> import sys\n>>> sys.getsizeof(1)\n14\n>>> sys.getsizeof(\"Hello World\")\n52\n>>> sys.getsizeof([1,2,3,4])\n52\n>>> sum(sys.getsizeof(x) for x in [1,2,3,4])\n56\nFor containers such as lists, tuples, and dictionaries, the size that gets reported is just for\nthe container object itself, not the cumulative size of all objects contained inside of it.\nFor instance, in the previous example, the reported size of the list [1,2,3,4] is actually\nsmaller than the space required for four integers (which are 14 bytes each).This is\nbecause the contents of the list are not included in the total.You can use sum() as\nshown here to calculate the total size of the list contents.\nBe aware that the getsizeof() function is only going to give you a rough idea of\noverall memory use for various objects. Internally, the interpreter aggressively shares\nobjects via reference counting so the actual memory consumed by an object might be\nfar less than you first imagine.Also, given that C extensions to Python can allocate\nmemory outside of the interpreter, it may be difficult to precisely get a measurement of\noverall memory use.Thus, a secondary technique for measuring the actual memory\nfootprint is to inspect your running program from an operating system process viewer\nor task manager.\nFrankly, a better way to get a handle on memory use may be to sit down and be\nanalytical about it. If you know your program is going to allocate various kinds of data\nstructures and you know what kinds of data will be stored in those structures (that is,\nints, floats, strings, and so on), you can use the results of the getsizeof() function to\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3051,
      "extraction_method": "Direct"
    },
    {
      "page_number": 218,
      "chapter": null,
      "content": "193\nTuning and Optimization\nobtain figures for calculating an upper bound on your program’s memory footprint—or\nat the very least, you can get enough information to carry out a “back of the envelope”\nestimate.\nDisassembly\nThe dis module can be used to disassemble Python functions, methods, and classes into\nlow-level interpreter instructions.The module defines a function dis() that can be\nused like this:\n>>> from dis import dis\n>>> dis(split)\n2           0 LOAD_FAST                0 (line)\n3 LOAD_ATTR                0 (split)\n6 LOAD_FAST                1 (delimiter)\n9 CALL_FUNCTION            1\n12 STORE_FAST               2 (fields)\n3          15 LOAD_GLOBAL              1 (types)\n18 JUMP_IF_FALSE           58 (to 79)\n21 POP_TOP\n4          22 BUILD_LIST               0\n25 DUP_TOP\n26 STORE_FAST               3 (_[1])\n29 LOAD_GLOBAL              2 (zip)\n32 LOAD_GLOBAL              1 (types)\n35 LOAD_FAST                2 (fields)\n38 CALL_FUNCTION            2\n41 GET_ITER\n>>   42 FOR_ITER                25 (to 70)\n45 UNPACK_SEQUENCE          2\n48 STORE_FAST               4 (ty)\n51 STORE_FAST               5 (val)\n54 LOAD_FAST                3 (_[1])\n57 LOAD_FAST                4 (ty)\n60 LOAD_FAST                5 (val)\n63 CALL_FUNCTION            1\n66 LIST_APPEND\n67 JUMP_ABSOLUTE           42\n>>   70 DELETE_FAST              3 (_[1])\n73 STORE_FAST               2 (fields)\n76 JUMP_FORWARD             1 (to 80)\n>>   79 POP_TOP\n5     >>   80 LOAD_FAST                2 (fields)\n83 RETURN_VALUE\n>>>\nExpert programmers can use this information in two ways. First, a disassembly will\nshow you exactly what operations are involved in executing a function.With careful\nstudy, you might spot opportunities for making speedups. Second, if you are program-\nming with threads, each line printed in the disassembly represents a single interpreter\noperation—each of which has atomic execution.Thus, if you are trying to track down a\ntricky race condition, this information might be useful.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2017,
      "extraction_method": "Direct"
    },
    {
      "page_number": 219,
      "chapter": null,
      "content": "194\nChapter 11 Testing, Debugging, Profiling, and Tuning\nTuning Strategies\nThe following sections outline a few optimization strategies that, in the opinion of the\nauthor, have proven to be useful with Python code.\nUnderstand Your Program\nBefore you optimize anything, know that speedup obtained by optimizing part of a\nprogram is directly related to that part’s total contribution to the execution time. For\nexample, if you optimize a function by making it run 10 times as fast but that function\nonly contributes to 10 percent of the program’s total execution time, you’re only going\nto get an overall speedup of about 9%–10%. Depending on the effort involved in mak-\ning the optimization, this may or may not be worth it.\nIt is always a good idea to first use the profiling module on code you intend to opti-\nmize.You really only want to focus on functions and methods where your program\nspends most of its time, not obscure operations that are called only occasionally.\nUnderstand Algorithms\nA poorly implemented O(n log n) algorithm will outperform the most finely tuned\nO(n3) algorithm. Don’t optimize inefficient algorithms—look for a better algorithm\nfirst.\nUse the Built-In Types\nPython’s built-in tuple, list, set, and dictionary types are implemented entirely in C and\nare the most finely tuned data structures in the interpreter.You should actively use these\ntypes to store and manipulate data in your program and resist the urge to build your\nown custom data structures that mimic their functionality (that is, binary search trees,\nlinked lists, and so on).\nHaving said that, you should still look more closely at types in the standard library.\nSome library modules provide new types that outperform the built-ins at certain tasks.\nFor instance, the collection.deque type provides similar functionality to a list but has\nbeen highly optimized for the insertion of new items at both ends.A list, in contrast, is\nonly efficient when appending items at the end. If you insert items at the front, all of\nthe other elements need to be shifted in order to make room.The time required to do\nthis grows as the list gets larger and larger. Just to give you an idea of the difference,\nhere is a timing measurement of inserting one million items at the front of a list and a\ndeque:\n>>> from timeit import timeit\n>>> timeit('s.appendleft(37)',\n...        'import collections; s = collections.deque()',\n...        number=1000000)\n0.24434304237365723\n>>> timeit('s.insert(0,37)', 's = []', number=1000000)\n612.95199513435364\nDon’t Add Layers\nAny time you add an extra layer of abstraction or convenience to an object or a func-\ntion, you will slow down your program. However, there is also a trade-off between\nusability and performance. For instance, the whole point of adding an extra layer is\noften to simplify coding, which is also a good thing.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2869,
      "extraction_method": "Direct"
    },
    {
      "page_number": 220,
      "chapter": null,
      "content": "195\nTuning and Optimization\nTo illustrate with a simple example, consider a program that makes use of the\ndict() function to create dictionaries with string keys like this:\ns = dict(name='GOOG',shares=100,price=490.10)\n# s = {'name':'GOOG', 'shares':100, 'price':490.10 }\nA programmer might create dictionaries in this way to save typing (you don’t have to\nput quotes around the key names). However, this alternative way of creating a dictionary\nalso runs much more slowly because it adds an extra function call.\n>>> timeit(\"s = {'name':'GOOG','shares':100,'price':490.10}\")\n0.38917303085327148\n>>> timeit(\"s = dict(name='GOOG',shares=100,price=490.10)\")\n0.94420003890991211\nIf your program creates millions of dictionaries as it runs, then you should know that\nthe first approach is faster.With few exceptions, any feature that adds an enhancement\nor changes the way in which an existing Python object works will run more slowly.\nKnow How Classes and Instances Build Upon Dictionaries\nUser-defined classes and instances are built using dictionaries. Because of this, operations\nthat look up, set, or delete instance data are almost always going to run more slowly\nthan directly performing these operations on a dictionary. If all you are doing is build-\ning a simple data structure for storing data, a dictionary may be a more efficient choice\nthan defining a class.\nJust to illustrate the difference, here is a simple class that represents a holding of\nstock:\nclass Stock(object):\ndef _ _init_ _(self,name,shares,price):\nself.name = name\nself.shares = shares\nself.price = price\nIf you compare the performance of using this class against a dictionary, the results are\ninteresting. First, let’s compare the performance of simply creating instances:\n>>> from timeit import timeit\n>>> timeit(\"s = Stock('GOOG',100,490.10)\",\"from stock import Stock\")\n1.3166780471801758\n>>> timeit(\"s = {'name' : 'GOOG', 'shares' : 100, 'price' : 490.10 }\")\n0.37812089920043945\n>>>\nHere, the speedup of creating new objects is about 3.5. Next, let’s look at the perform-\nance of performing a simple calculation:\n>>> timeit(\"s.shares*s.price\",\n...\n\"from stock import Stock; s = Stock('GOOG',100,490.10)\")\n0.29100513458251953\n>>> timeit(\"s['shares']*s['price']\",\n...\n\"s = {'name' : 'GOOG', 'shares' : 100, 'price' : 490.10 }\")\n0.23622798919677734\n>>>\nHere, the speedup is about 1.2.The lesson here is that just because you can define a\nnew object using a class, it’s not the only way to work with data.Tuples and diction-\naries are often good enough. Using them will make your program run more quickly\nand use less memory.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2623,
      "extraction_method": "Direct"
    },
    {
      "page_number": 221,
      "chapter": null,
      "content": "196\nChapter 11 Testing, Debugging, Profiling, and Tuning\nUse _ _slots_ _\nIf your program creates a large number of instances of user-defined classes, you might\nconsider using the _ _slots_ _ attribute in a class definition. For example:\nclass Stock(object):\n_ _slots_ _ = ['name','shares','price']\ndef __init__(self,name,shares,price):\nself.name = name\nself.shares = shares\nself.price = price\n_ _slots_ _ is sometimes viewed as a safety feature because it restricts the set of attrib-\nute names. However, it is really more of a performance optimization. Classes that use\n_ _slots_ _ don’t use a dictionary for storing instance data (instead, a more efficient\ninternal data structure is used). So, not only will instances use far less memory, but\naccess to instance data is also more efficient. In some cases, simply adding _ _slots_ _\nwill make a program run noticeably faster without making any other changes.\nThere is one caution with using _ _slots_ _, however.Adding this feature to a class\nmay cause other code to break mysteriously. For example, it is generally well-known\nthat instances store their data in a dictionary that can be accessed as the _ _dict_ _\nattribute.When slots are defined, this attribute doesn’t exist so any code that relies on\n_ _dict_ _ will fail.\nAvoid the (.) Operator\nWhenever you use the (.) to look up an attribute on an object, it always involves a\nname lookup. For example, when you say x.name, there is a lookup for the variable\nname \"x\" in the environment and then a lookup for the attribute \"name\" on x. For\nuser-defined objects, attribute lookup may involve looking in the instance dictionary,\nthe class dictionary, and the dictionaries of base-classes.\nFor calculations involving heavy use of methods or module lookups, it is almost\nalways better to eliminate the attribute lookup by putting the operation you want to\nperform into a local variable first. For example, if you were performing a lot of square\nroot operations, it is faster to use 'from math import sqrt' and 'sqrt(x)' rather\nthan typing 'math.sqrt(x)'. In the first part of this section, we saw that this approach\nresulted in speedup of about 1.4.\nObviously you should not try to eliminate attribute lookups everywhere in \nyour program because it will make your code very difficult to read. However, for \nperformance-critical sections, this is a useful technique.\nUse Exceptions to Handle Uncommon Cases\nTo avoid errors, you might be inclined to add extra checks to a program. For example:\ndef parse_header(line):\nfields = line.split(\":\")\nif len(fields) != 2:\nraise RuntimeError(\"Malformed header\")\nheader, value = fields\nreturn header.lower(), value.strip()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2687,
      "extraction_method": "Direct"
    },
    {
      "page_number": 222,
      "chapter": null,
      "content": "197\nTuning and Optimization\nHowever, an alternative way to handle errors is to simply let the program generate an\nexception and to catch it. For example:\ndef parse_header(line):\nfields = line.split(\":\")\ntry:\nheader, value = fields\nreturn header.lower(), value.strip()\nexcept ValueError:\nraise RuntimeError(\"Malformed header\")\nIf you benchmark both versions on a properly formatted line, the second version of\ncode runs about 10 percent faster. Setting up a try block for code that normally\ndoesn’t raise an exceptions runs more quickly than executing an if statement.\nAvoid Exceptions for Common Cases\nDon’t write code that uses exception handling for the common case. For example, sup-\npose you had a program that performed a lot of dictionary lookups, but most of these\nlookups were for keys that didn’t exist. Now, consider two approaches to performing a\nlookup:\n# Approach 1 : Perform a lookup and catch an exception\ntry:\nvalue = items[key]\nexcept KeyError:\nvalue = None\n# Approach 2: Check if the key exists and perform a lookup\nif key in items:\nvalue = items[key]\nelse:\nvalue = None\nIn a simple performance measurement where the key is not found, the second approach\nruns more than 17 times faster! In case you were wondering, this latter approach also\nruns almost twice as fast as using items.get(key) because the in operator is faster to\nexecute than a method call.\nEmbrace Functional Programming and Iteration\nList comprehensions, generator expressions, generators, coroutines, and closures are\nmuch more efficient than most Python programmers realize. For data processing espe-\ncially, list comprehensions and generator expressions run significantly more quickly than\ncode that manually iterates over data and carries out similar operations.These operations\nalso run much more quickly than legacy Python code that uses functions such as map()\nand filter(). Generators can be used to write code that not only runs fast, but which\nmakes efficient use of memory.\nUse Decorators and Metaclasses\nDecorators and metaclasses are features that are used to modify functions and classes.\nHowever, because they operate at the time of function or class definition, they can be\nused in ways that lead to improved performance—especially if a program has many\noptional features that might be turned on or off. Chapter 6,“Functions and Functional\nProgramming,” has an example of using a decorator to enable logging of functions, but\nin a way that does not impact performance when logging is disabled.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2517,
      "extraction_method": "Direct"
    },
    {
      "page_number": 223,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 224,
      "chapter": null,
      "content": "II\nThe Python Library\n12\nBuilt-In Functions\n13\nPython Runtime Services\n14\nMathematics\n15\nData Structures, Algorithms, and Utilities\n16\nString and Text Handling\n17\nPython Database Access\n18\nFile and Directory Handling\n19\nOperating System Services\n20\nThreads and Concurrency\n21\nNetwork Programming and Sockets\n22\nInternet Application Programming\n23\nWeb Programming\n24\nInternet Data Handling and Encoding\n25\nMiscellaneous Library Modules\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 457,
      "extraction_method": "Direct"
    },
    {
      "page_number": 225,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 226,
      "chapter": null,
      "content": "12\nBuilt-In Functions and\nExceptions\nThis chapter describes Python’s built-in functions and exceptions. Much of this mate-\nrial is covered less formally in earlier chapters of this book.This chapter merely consoli-\ndates all this information into one section and expands upon some of the more subtle\nfeatures of certain functions.Also, Python 2 includes a number of built-in functions that\nare considered to be obsolete and which have been removed from Python 3.Those\nfunctions are not documented here—instead the focus is on modern functionality.\nBuilt-in Functions and Types\nCertain types, functions, and variables are always available to the interpreter and can be\nused in any source module.Although you don’t need to perform any extra imports to\naccess these functions, they are contained in a module _ _builtin_ _ in Python 2 and\nin a module builtins in Python 3.Within other modules that you import, the variable\n_ _builtins_ _ is also bound to this module.\nabs(x)\nReturns the absolute value of x.\nall(s)\nReturns True if all of the values in the iterable s evaluate as True.\nany(s)\nReturns True if any of the values in the iterable s evaluate as True.\nascii(x)\nCreates a printable representation of the object x just like the repr(), but only uses\nASCII characters in the result. Non-ASCII characters are turned into appropriate\nescape sequences.This can be used to view Unicode strings in a terminal or shell that\ndoesn’t support Unicode. Python 3 only.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1483,
      "extraction_method": "Direct"
    },
    {
      "page_number": 227,
      "chapter": null,
      "content": "202\nChapter 12 Built-In Functions and Exceptions\nbasestring\nThis is an abstract data type that is the superclass of all strings in Python 2 (str and\nunicode). It is only used for type testing of strings. For example,\nisinstance(s,basestring) returns True if s is either kind of string. Python 2 only.\nbin(x)\nReturns a string containing the binary representation of the integer x.\nbool([x])\nType representing Boolean values True and False. If used to convert x, it returns True\nif x evaluates to true using the usual truth-testing semantics (that is, nonzero number,\nnon-empty list, and so on). Otherwise, False is returned. False is also the default\nvalue returned if bool() is called without any arguments.The bool class inherits from\nint so the Boolean values True and False can be used as integers with values 1 and 0\nin mathematical calculations.\nbytearray([x])\nA type representing a mutable array of bytes.When creating an instance, x may be an\niterable sequence of integers in the range 0 to 255, an 8-bit string or bytes literal, or an\ninteger that specifies the size of the byte array (in which case every entry will be initial-\nized to 0).A bytearray object a looks like an array of integers. If you perform a\nlookup such as a[i], you will get an integer value representing the byte value at index\ni.Assignments such as a[i] = v also require v to be an integer byte value. However, a\nbytearray also provides all of the operations normally associated with strings (that is,\nslicing, find(), split(), replace(), and so on).When using these string operations,\nyou should be careful to preface all string literals with b in order to indicate that you’re\nworking with bytes. For example, if you wanted to split a byte array a into fields using a\ncomma character separator, you would use a.split(b',') not a.split(',').The\nresult of these operations is always new bytearray objects, not strings.To turn a\nbytearray a into a string, use the a.decode(encoding) method.An encoding of\n'latin-1' will directly turn a bytearray of 8-bit characters into a string without any\nmodification of the underlying character values.\nbytearray(s ,encoding)\nAn alternative calling convention for creating a bytearray instance from characters in\na string s where encoding specifies the character encoding to use in the conversion.\nbytes([x])\nA type representing an immutable array of bytes. In Python 2, this is an alias for str()\nwhich creates a standard 8-bit string of characters. In Python 3, bytes is a completely\nseparate type that is an immutable version of the bytearray type described earlier. In\nthat case, the argument x has the same interpretation and can be used in the same man-\nner. One portability caution is that even though bytes is defined in Python 2, the\nresulting object does not behave consistently with Python 3. For example, if a is an\ninstance created by bytes(), then a[i] returns a character string in Python 2, but\nreturns an integer in Python 3.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2982,
      "extraction_method": "Direct"
    },
    {
      "page_number": 228,
      "chapter": null,
      "content": "203\nBuilt-in Functions and Types\nbytes(s, encoding)\nAn alternative calling convention for creating a bytes instance from characters in a\nstring s where encoding specifies the character encoding to use. Python 3 only.\nchr(x)\nConverts an integer value, x, into a one-character string. In Python 2, x must be in the\nrange 0 <= x <= 255, and in Python 3, x must represent a valid Unicode code point.\nIf x is out of range, a ValueError exception is raised.\nclassmethod(func)\nThis function creates a class method for the function func. It is typically only used\ninside class definitions where it is implicitly invoked by the @classmethod decorator.\nUnlike a normal method, a class method receives the class as the first argument, not an\ninstance. For example, if you had an object, f, that is an instance of class Foo, invoking a\nclass method on f will pass the class Foo as the first argument to the method, not the\ninstance f.\ncmp(x, y)\nCompares x and y and returns a negative number if x < y, a positive number if x > y,\nor 0 if x == y.Any two objects can be compared, although the result may be meaning-\nless if the two objects have no meaningful comparison method defined (for example,\ncomparing a number with a file object). In certain circumstances, such comparisons\nmay also raise an exception.\ncompile(string, filename, kind [, flags [, dont_inherit]])\nCompiles string into a code object for use with exec() or eval(). string is a\nstring containing valid Python code. If this code spans multiple lines, the lines must be\nterminated by a single newline ('\\n') and not platform-specific variants (for example,\n'\\r\\n' on Windows). filename is a string containing the name of the file in which\nthe string was defined. kind is 'exec' for a sequence of statements, 'eval' for a single\nexpression, or 'single' for a single executable statement.The flags parameter deter-\nmines which optional features (associated with the _ _future_ _ module) are enabled.\nFeatures are specified using the bitwise OR of flags defined in the _ _future_ _ mod-\nule. For example, if you wanted to enable new division semantics, you would set flags\nto _ _future_ _.division.compiler_flag. If flags is omitted or set to 0, the code\nis compiled with whatever features are currently in effect. If flags is supplied, the fea-\ntures specified are added to those features already in effect. If dont_inherit is set, only\nthose features specified in flags are enabled—features currently enabled are ignored.\ncomplex([real [, imag]])\nType representing a complex number with real and imaginary components, real and\nimag, which can be supplied as any numeric type. If imag is omitted, the imaginary\ncomponent is set to zero. If real is passed as a string, the string is parsed and converted\nto a complex number. In this case, imag should be omitted. If no arguments are given,\n0j is returned.\ndelattr(object, attr)\nDeletes an attribute of an object. attr is a string. Same as del object.attr.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2979,
      "extraction_method": "Direct"
    },
    {
      "page_number": 229,
      "chapter": null,
      "content": "204\nChapter 12 Built-In Functions and Exceptions\ndict([m]) or dict(key1 = value1, key2 = value2, ...)\nType representing a dictionary. If no argument is given, an empty dictionary is returned.\nIf m is a mapping object (such as a dictionary), a new dictionary having the same keys\nand same values as m is returned. For example, if m is a dictionary, dict(m) simply\nmakes a shallow copy of it. If m is not a mapping, it must support iteration in which a\nsequence of (key,value) pairs is produced.These pairs are used to populate the dic-\ntionary. dict() can also be called with keyword arguments. For example, dict(foo=3,\nbar=7) creates the dictionary { 'foo' : 3, 'bar' : 7 }.\ndir([object])\nReturns a sorted list of attribute names. If object is a module, it contains the list of\nsymbols defined in that module. If object is a type or class object, it returns a list of\nattribute names.The names are typically obtained from the object’s _ _dict_ _ attribute\nif defined, but other sources may be used. If no argument is given, the names in the\ncurrent local symbol table are returned. It should be noted that this function is primari-\nly used for informational purposes (for example, used interactively at the command\nline). It should not be used for formal program analysis because the information\nobtained may be incomplete.Also, user-defined classes can define a special method\n_ _dir_ _() that alters the result of this function.\ndivmod(a, b)\nReturns the quotient and remainder of long division as a tuple. For integers, the value\n(a // b, a % b) is returned. For floats, (math.floor(a / b), a % b) is\nreturned.This function may not be called with complex numbers.\nenumerate(iter[, initial value)\nGiven an iterable object, iter, returns a new iterator (of type enumerate) that pro-\nduces tuples containing a count and the value produced from iter. For example, if\niter produces a, b, c, then enumerate(iter) produces (0,a), (1,b), (2,c).\neval(expr [, globals [, locals]])\nEvaluates an expression. expr is a string or a code object created by \ncompile(). globals and locals are mapping objects that define the global and local\nnamespaces, respectively, for the operation. If omitted, the expression is evaluated in the\nnamespace of the caller. It is most common for globals and locals to be specified as\ndictionaries, but advanced applications can supply custom mapping objects.\nexec(code [, global [, locals]])\nExecutes Python statements. code is a string, a file, or a code object created by \ncompile(). globals and locals define the global and local namespaces, respectively,\nfor the operation. If omitted, the code is executed in the namespace of the caller. If no\nglobal or local dictionaries are given, the behavior of this function is a little muddled\nbetween Python versions. In Python 2, exec is actually implemented as a special lan-\nguage statement, whereas Python 3 implements it as a standard library function.A subtle\nside effect of this implementation difference is that in Python 2, code evaluated by exec\ncan freely mutate local variables in the caller’s namespace. In Python 3, you can execute\ncode that makes such changes, but they don’t seem to have any lasting effect beyond the\nexec() call itself.This is because Python 3 uses locals() to obtain the local name-\nspace if one isn’t supplied.As you will note in the documentation for locals(), the\nreturned dictionary is only safe to inspect, not modify.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3447,
      "extraction_method": "Direct"
    },
    {
      "page_number": 230,
      "chapter": null,
      "content": "205\nBuilt-in Functions and Types\nfilter(function, iterable)\nIn Python 2, this creates a list consisting of the objects from iterable for which func-\ntion evaluates to true. In Python 3, the result is an iterator that produces this result. If\nfunction is None, the identity function is used and all the elements of iterable that\nare false are removed. iterable can be any object that supports iteration.As a general\nrule, it is significantly faster to use a generator expression or list comprehension to filter\ndata (refer to Chapter 6).\nfloat([x])\nType representing a floating-point number. If x is a number, it is converted to a float. If\nx is a string, it is parsed into a float. If no argument is supplied, 0.0 is returned.\nformat(value [, format_spec])\nConverts value to a formatted string according to the format specification string in\nformat_spec.This operation invokes value._ _format_ _(), which is free to inter-\npret the format specification as it sees fit. For simple types of data, the format specifier\ntypically includes an alignment character of '<', '>’, or '^'; a number (which indicates\nthe field width); and a character code of 'd', 'f', or 's' for integer, floating point, or\nstring values, respectively. For example, a format specification of 'd' formats an integer,\na specification of '8d' right aligns an integer in an 8-character field and '<8d' left\naligns an integer in an 8-character field. More details on format() and format speci-\nfiers can be found in Chapter 3,“Types and Objects,” and Chapter 4,“Operators and\nExpressions.”\nfrozenset([items])\nType representing an immutable set object populated with values taken from items that\nmust be an iterable.The values must also be immutable. If no argument is given, an\nempty set is returned.\ngetattr(object, name [,default])\nReturns the value of a named attribute of an object. name is a string containing the\nattribute name. default is an optional value to return if no such attribute exists.\nOtherwise, AttributeError is raised. Same as object.name.\nglobals()\nReturns the dictionary of the current module that represents the global namespace.\nWhen called inside another function or method, it returns the global namespace of the\nmodule in which the function or method was defined.\nhasattr(object, name)\nReturns True if name is the name of an attribute of object. False is returned other-\nwise. name is a string.\nhash(object)\nReturns an integer hash value for an object (if possible).The hash value is primarily\nused in the implementation of dictionaries, sets, and other mapping objects.The hash\nvalue is the same for any two objects that compare as equals. Mutable objects don’t\ndefine a hash value, although user-defined classes can define a method _ _hash_ _() to\nsupport this operation.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2791,
      "extraction_method": "Direct"
    },
    {
      "page_number": 231,
      "chapter": null,
      "content": "206\nChapter 12 Built-In Functions and Exceptions\nhelp([object])\nCalls the built-in help system during interactive sessions. object may be a string repre-\nsenting the name of a module, class, function, method, keyword, or documentation\ntopic. If it is any other kind of object, a help screen related to that object will be pro-\nduced. If no argument is supplied, an interactive help tool will start and provide more\ninformation.\nhex(x)\nCreates a hexadecimal string from an integer x.\nid(object)\nReturns the unique integer identity of object.You should not interpret the return\nvalue in any way (that is, as a memory location).\ninput([prompt])\nIn Python 2, this prints a prompt, reads a line of input, and processes it through eval()\n(that is, it’s the same as eval(raw_input(prompt)). In Python 3, a prompt is printed\nto standard output and a single line of input is read without any kind of evaluation or\nmodification.\nint(x [,base])\nType representing an integer. If x is a number, it is converted to an integer by truncat-\ning toward 0. If it is a string, it is parsed into an integer value. base optionally specifies\na base when converting from a string. In Python 2, a long integer is created if the value\nexceeds the 32-bit range of the int type.\nisinstance(object, classobj)\nReturns True if object is an instance of classobj, is a subclass of classobj, or\nbelongs to an abstract base class classobj.The classobj parameter can also be a tuple\nof possible types or classes. For example, isinstance(s, (list,tuple)) returns\nTrue if s is a tuple or a list.\nissubclass(class1, class2)\nReturns True if class1 is a subclass of (derived from) class2 or if class1 is regis-\ntered with an abstract base class class2. class2 can also be a tuple of possible classes,\nin which case each class will be checked. Note that issubclass(A, A) is true.\niter(object [,sentinel])\nReturns an iterator for producing items in object. If the sentinel parameter is omit-\nted, the object must either provide the method _ _iter_ _(), which creates an iterator,\nor implement _ _getitem_ _(), which accepts integer arguments starting at 0. If sen-\ntinel is specified, object is interpreted differently. Instead, object should be a callable\nobject that takes no parameters.The returned iterator object will call this function\nrepeatedly until the returned value is equal to sentinel, at which point iteration will\nstop.A TypeError will be generated if object does not support iteration.\nlen(s)\nReturns the number of items contained in s. s should be a list, tuple, string, set, or dic-\ntionary.A TypeError is generated if s is an iterable such as a generator.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2655,
      "extraction_method": "Direct"
    },
    {
      "page_number": 232,
      "chapter": null,
      "content": "207\nBuilt-in Functions and Types\nlist([items])\nType representing a list. items may be any iterable object, the values of which are used\nto populate the list. If items is already a list, a copy is made. If no argument is given, an\nempty list is returned.\nlocals()\nReturns a dictionary corresponding to the local namespace of the caller.This dictionary\nshould only be used to inspect the execution environment—it is not safe to modify the\ncontents of this dictionary.\nlong([x [, base]])\nType representing long integers in Python 2. If x is a number, it is converted to an inte-\nger by truncating toward 0. If x is a string, it is parsed into a long value. If no argument\nis given, this function returns 0L. For portability, you should avoid direct use of long.\nUsing int(x) will create a long as necessary. For type checking, use isinstance(x,\nnumbers.Integral) to check if x is any integer type.\nmap(function, items, ...)\nIn Python 2, this applies function to every item of items and returns a list of results.\nIn Python 3, an iterator producing the same results is created. If multiple input\nsequences are supplied, function is assumed to take that many arguments, with each\nargument taken from a different sequence.The behavior when processing multiple input\nsequences differs between Python 2 and Python 3. In Python 2, the result is the same\nlength as the longest input sequence with None used as a padding value when the\nshorter input sequences are exhausted. In Python 3, the result is only as long as the\nshortest sequence.The functionality provided by map() is almost always better expressed\nusing a generator expression or list comprehension (both of which provide better per-\nformance). For example, map(function, s) can usually be replaced by [function(x)\nfor x in s].\nmax(s [, args, ...])\nFor a single argument, s, this function returns the maximum value of the items in s,\nwhich may be any iterable object. For multiple arguments, it returns the largest of the\narguments.\nmin(s [, args, ...])\nFor a single argument, s, this function returns the minimum value of the items in s,\nwhich may be any iterable object. For multiple arguments, it returns the smallest of the\narguments.\nnext(s [, default])\nReturns the next item from the iterator s. If the iterator has no more items, a\nStopIteration exception is raised unless a value is supplied to the default argument.\nIn that case, default is returned instead. For portability, you should always use this\nfunction instead of calling s.next() directly on an iterator s. In Python 3, the name of\nthe underlying iterator method changed to s._ _next_ _(). If you write your code to\nuse the next() function, you won’t have to worry about this difference.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2730,
      "extraction_method": "Direct"
    },
    {
      "page_number": 233,
      "chapter": null,
      "content": "208\nChapter 12 Built-In Functions and Exceptions\nobject()\nThe base class for all objects in Python.You can call it to create an instance, but the\nresult isn’t especially interesting.\noct(x)\nConverts an integer, x, to an octal string.\nopen(filename [, mode [, bufsize]])\nIn Python 2, opens the file filename and returns a new file object (refer to Chapter 9,\n“Input and Output”). mode is a string that indicates how the file should be opened: 'r'\nfor reading, 'w' for writing, and 'a' for appending.A second character 't' or 'b' is\nused to indicate text-mode (the default) or binary mode. For example, 'r' or 'rt'\nopens a file in text mode, whereas 'rb' opens a file in binary mode.An optional '+'\ncan be added to the mode to open the file for updating (which allows both reading and\nwriting).A mode of 'w+' truncates the file to zero length if it already exists.A mode of\n'r+' or 'a+' opens the file for both reading and writing but leaves the original con-\ntents intact when the file is opened. If a mode of 'U' or 'rU' is specified, the file is\nopened in universal newline mode. In this mode, all variants of a newline ('\\n', '\\r',\n'\\r\\n') are converted to the standard '\\n' character. If the mode is omitted, a mode\nof 'rt' is assumed.The bufsize argument specifies the buffering behavior, where 0 is\nunbuffered, 1 is line buffered, and any other positive number indicates an approximate\nbuffer size in bytes.A negative number indicates that the system default buffering\nshould be used (this is the default behavior).\nopen(filename [, mode [, bufsize [, encoding [, errors [, newline [,\nclosefd]]]]]])\nIn Python 3, this opens the file filename and returns a file object.The first three argu-\nments have the same meaning as for the Python 2 version of open() described earlier.\nencoding is an encoding name such as 'utf-8'. errors is the error handling policy\nand is one of 'strict', 'ignore', 'replace', 'backslashreplace', or \n'xmlcharrefreplace'. newline controls the behavior of universal newline mode and\nis set to None, '', '\\n', '\\r', or '\\r\\n'. closefd is a Boolean flag that specifies\nwhether the underlying file descriptor is closed when the close() method executes.\nUnlike Python 2, different kinds of objects are returned depending on the selected I/O\nmode. For example, if you open a file in binary mode, you get an object where I/O\noperations such as read() and write() operate on byte arrays instead of strings. File\nI/O is one area where there are significant differences between Python 2 and 3. Consult\nAppendix A,“Python 3,” for more details.\nord(c)\nReturns the integer ordinal value of a single character, c. For ordinary characters, a\nvalue in the range [0,255] is returned. For single Unicode characters, a value in the\nrange [0,65535] is usually returned. In Python 3, c may also be a Unicode surrogate\npair, in which case it is converted into the appropriate Unicode code point.\npow(x, y [, z])\nReturns x ** y. If z is supplied, this function returns (x ** y) % z. If all three argu-\nments are given, they must be integers and y must be nonnegative.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3097,
      "extraction_method": "Direct"
    },
    {
      "page_number": 234,
      "chapter": null,
      "content": "209\nBuilt-in Functions and Types\nprint(value, ... [, sep=separator, end=ending, file=outfile])\nPython 3 function for printing a series of values.As input, you can supply any number\nof values, all of which are printed on the same line.The sep keyword argument is used\nto specify a different separator character (a space by default).The end keyword argu-\nment specifies a different line ending ('\\n' by default).The file keyword argument\nredirects the output to a file object.This function can be used in Python 2 if you add\nthe statement from _ _future_ _ import print_function to your code.\nproperty([fget [,fset [,fdel [,doc]]]])\nCreates a property attribute for classes. fget is a function that returns the attribute\nvalue, fset sets the attribute value, and fdel deletes an attribute. doc provides a docu-\nmentation string.These parameters may be supplied using keyword arguments—for\nexample, property(fget=getX, doc=\"some text\").\nrange([start,] stop [, step])\nIn Python 2, this creates a fully populated list of integers from start to stop. step\nindicates a stride and is set to 1 if omitted. If start is omitted (when range() is called\nwith one argument), it defaults to 0.A negative step creates a list of numbers in\ndescending order. In Python 3, range() creates a special range object that computes\nits values on demand (like xrange() in previous Python versions).\nraw_input([prompt])\nPython 2 function that reads a line of input from standard input (sys.stdin) and\nreturns it as a string. If prompt is supplied, it’s first printed to standard output\n(sys.stdout).Trailing newlines are stripped, and an EOFError exception is raised if an\nEOF is read. If the readline module is loaded, this function will use it to provide\nadvanced line-editing and command-completion features. Use input() to read input in\nPython 3.\nrepr(object)\nReturns a string representation of object. In most cases, the returned string is an\nexpression that can be passed to eval() to re-create the object. Be aware that in\nPython 3, the result of this function may be a Unicode string that can’t be displayed in\nthe terminal or shell window (resulting in an exception). Use the ascii() function to\ncreate an ASCII representation of object.\nreversed(s)\nCreates a reverse iterator for sequence s.This function only works if s implements the\nsequence methods _ _len_ _() and _ _getitem_ _(). In addition, s must index items\nstarting at 0. It does not work with generators or iterators.\nround(x [, n])\nRounds the result of rounding the floating-point number x to the closest multiple of 10\nto the power minus n. If n is omitted, it defaults to 0. If two multiples are equally close,\nPython 2 rounds away from 0 (for example, 0.5 is rounded to 1.0 and -0.5 is rounded\nto -1.0). Python 3 rounds toward 0 if the previous digit is even and away from 0 oth-\nerwise (for example, 0.5 is rounded to 0.0 and 1.5 is rounded to 2).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2920,
      "extraction_method": "Direct"
    },
    {
      "page_number": 235,
      "chapter": null,
      "content": "210\nChapter 12 Built-In Functions and Exceptions\nset([items])\nCreates a set populated with items taken from the iterable object items.The items must\nbe immutable. If items contains other sets, those sets must be of type frozenset. If\nitems is omitted, an empty set is returned.\nsetattr(object, name, value)\nSets an attribute of an object. name is a string. Same as object.name = value.\nslice([start,] stop [, step])\nReturns a slice object representing integers in the specified range. Slice objects are also\ngenerated by the extended slice syntax a[i:i:k]. Refer to the section “Sequence and\nMapping Methods” in Chapter 3 for details.\nsorted(iterable [, key=keyfunc [, reverse=reverseflag]])\nCreates a sorted list from items in iterable.The keyword argument key is a single-\nargument function that transforms values before they are passed to the compare func-\ntion.The keyword argument reverse is a Boolean flag that specifies whether or not\nthe resulting list is sorted in reverse order.The key and reverse arguments must be\nspecified using keywords—for example, sorted(a,key=get_name).\nstaticmethod(func)\nCreates a static method for use in classes.This function is implicitly invoked by the\n@staticmethod decorator.\nstr([object])\nType representing a string. In Python 2, a string contains 8-bit characters, whereas in\nPython 3 strings are Unicode. If object is supplied, a string representation of its value\nis created by calling its _ _str_ _() method.This is the same string that you see when\nyou print the object. If no argument is given, an empty string is created.\nsum(items [,initial])\nComputes the sum of a sequence of items taken from the iterable object \nitems. initial provides the starting value and defaults to 0.This function only works\nwith numbers.\nsuper(type [, object])\nReturns an object that represents the superclasses of type.The primary purpose of this\nobject is to invoke methods in base classes. Here’s an example:\nclass B(A):\ndef foo(self):\nsuper(B,self).foo()\nIf object is an object, then isinstance(object, type) must be true. If object is a\ntype, then it must be a subclass of type. Refer to Chapter 7,“Classes and Object-\nOriented Programming,” for more details. In Python 3, you can use super() in a\nmethod with no arguments. In this case, type is set to the class in which the method is\ndefined and object is set to the first argument of the method.Although this cleans up\nthe syntax, it’s not backwards-compatible with Python 2 so it should be avoided if\nyou’re concerned about portability.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2546,
      "extraction_method": "Direct"
    },
    {
      "page_number": 236,
      "chapter": null,
      "content": "211\nBuilt-in Functions and Types\ntuple([items])\nType representing a tuple. If supplied, items is an iterable object that is used to popu-\nlate the tuple. However, if items is already a tuple, it’s simply returned unmodified. If\nno argument is given, an empty tuple is returned.\ntype(object)\nThe base class of all types in Python.When called as a function, returns the type of\nobject.This type is the same as the object’s class. For common types such as integers,\nfloats, and lists, the type will refer to one of the other built-in classes such as int,\nfloat, list, and so forth. For user-defined objects, the type is the associated class. For\nobjects related to Python’s internals, you will typically get a reference to one of the\nclasses defined in the types module.\ntype(name,bases,dict)\nCreates a new type object (which is the same as defining a new class). name is the\nname of the type, bases is a tuple of base classes, and dict is a dictionary containing\ndefinitions corresponding to a class body.This function is most commonly used when\nworking with metaclasses.This is described further in Chapter 7.\nunichr(x)\nConverts the integer or long integer x, where 0 <= x <= 65535, to a single Unicode\ncharacter. Python 2 only. In Python 3, just use chr(x).\nunicode(string [,encoding [,errors]])\nIn Python 2, this converts string to a Unicode string. encoding specifies the data\nencoding of string. If omitted, the default encoding as returned by \nsys.getdefaultencoding() is used. errors specifies how encoding errors are han-\ndled and is one of 'strict', 'ignore', 'replace', 'backslashreplace', or\n'xmlcharrefreplace'. Refer to Chapter 9 and Chapter 3 for details. Not available in\nPython 3.\nvars([object])\nReturns the symbol table of object (usually found in its _ _dict_ _ attribute). If no\nargument is given, a dictionary corresponding to the local namespace is returned.The\ndictionary returned by this function should be assumed to be read-only. It’s not safe to\nmodify its contents.\nxrange([start,] stop [, step])\nA type representing a range of integer values from start to stop that is not included.\nstep provides an optional stride.The values are not actually stored but are computed\non demand when accessed. In Python 2, xrange() is the preferred function to use\nwhen you want to write loops over ranges of integer values. In Python 3, xrange() has\nbeen renamed to range() and xrange() is unavailable. start, stop, and step are\nlimited to the set of values supported by machine integers (typically 32 bits).\nzip([s1 [, s2 [,..]]])\nIn Python 2, returns a list of tuples where the nth tuple is (s1[n], s2[n], ...).The\nresulting list is truncated to the length of the shortest argument sequence. If no argu-\nments are given, an empty list is returned. In Python 3, the behavior is similar, but the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2828,
      "extraction_method": "Direct"
    },
    {
      "page_number": 237,
      "chapter": null,
      "content": "212\nChapter 12 Built-In Functions and Exceptions\nresult is an iterator that produces a sequence of tuples. In Python 2, be aware that using\nzip() with long input sequences is something that can unintentionally consume large\namounts of memory. Consider using itertools.izip() instead.\nBuilt-In Exceptions\nBuilt-in exceptions are contained in the exceptions module, which is always loaded\nprior to the execution of any program. Exceptions are defined as classes.\nException Base Classes\nThe following exceptions serve as base classes for all the other exceptions:\nBaseException\nThe root class for all exceptions.All built-in exceptions are derived from this class.\nException\nThe base class for all program-related exceptions that includes all built-in exceptions\nexcept for SystemExit, GeneratorExit, and KeyboardInterrupt. User-defined\nexceptions should be defined by inheriting from Exception.\nArithmeticError\nThe base class for arithmetic exceptions, including OverflowError,\nZeroDivisionError, and FloatingPointError.\nLookupError\nThe base class for indexing and key errors, including IndexError and KeyError.\nEnvironmentError\nThe base class for errors that occur outside Python, including IOError and OSError.\nThe preceding exceptions are never raised explicitly. However, they can be used to\ncatch certain classes of errors. For instance, the following code would catch any sort of\nnumerical error:\ntry:\n# Some operation\n...\nexcept ArithmeticError as e:\n# Math error\nException Instances\nWhen an exception is raised, an instance of an exception class is created.This instance is\nplaced in the optional variable supplied to the except statement. Here’s an example:\nexcept IOError as e:\n# Handle error\n# 'e' has an instance of IOError\nInstances of an exception e have a few standard attributes that can be useful to inspect\nand/or manipulate in certain applications.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1888,
      "extraction_method": "Direct"
    },
    {
      "page_number": 238,
      "chapter": null,
      "content": "213\nBuilt-In Exceptions\ne.args\nThe tuple of arguments supplied when raising the exception. In most cases, this is a\none-item tuple with a string describing the error. For EnvironmentError exceptions,\nthe value is a 2-tuple or 3-tuple containing an integer error number, a string error mes-\nsage, and an optional filename.The contents of this tuple might be useful if you need to\nre-create the exception in a different context; for example, to raise an exception in a\ndifferent Python interpreter process.\ne.message\nA string representing the error message that gets printed when the exception is dis-\nplayed (Python 2 only).\ne._ _cause_ _\nPrevious exception when using explicit chained exceptions (Python 3 only). See\nAppendix A.\ne._ _context_ _\nPrevious exception for implicitly chained exceptions (Python 3 only). See Appendix A.\ne._ _traceback_ _\nTraceback object associated with the exception (Python 3 only). See Appendix A.\nPredefined Exception Classes\nThe following exceptions are raised by programs:\nAssertionError\nFailed assert statement.\nAttributeError\nFailed attribute reference or assignment.\nEOFError\nEnd of file. Generated by the built-in functions input() and raw_input(). It should\nbe noted that most other I/O operations such as the read() and readline() methods\nof files return an empty string to signal EOF instead of raising an exception.\nFloatingPointError\nFailed floating-point operation. It should be noted that floating-point exception-\nhandling is a tricky problem and only that this exception only gets raised if Python has\nbeen configured and built in a way that enables it. It is more common for floating-point\nerrors to silently produce results such as float('nan') or float('inf').A subclass of\nArithmeticError.\nGeneratorExit\nRaised inside a generator function to signal termination.This happens when a generator\nis destroyed prematurely (before all generator values are consumed) or the close()\nmethod of a generator is called. If a generator ignores this exception, the generator is\nterminated and the exception is silently ignored.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2086,
      "extraction_method": "Direct"
    },
    {
      "page_number": 239,
      "chapter": null,
      "content": "214\nChapter 12 Built-In Functions and Exceptions\nIOError\nFailed I/O operation.The value is an IOError instance with the attributes errno,\nstrerror, and filename. errno is an integer error number, strerror is a string error\nmessage, and filename is an optional filename.A subclass of EnvironmentError.\nImportError\nRaised when an import statement can’t find a module or when from can’t find a name\nin a module.\nIndentationError\nIndentation error.A subclass of SyntaxError.\nIndexError\nSequence subscript out of range.A subclass of LookupError.\nKeyError\nKey not found in a mapping.A subclass of LookupError.\nKeyboardInterrupt\nRaised when the user hits the interrupt key (usually Ctrl+C).\nMemoryError\nRecoverable out-of-memory error.\nNameError\nName not found in local or global namespaces.\nNotImplementedError\nUnimplemented feature. Can be raised by base classes that require derived classes to\nimplement certain methods.A subclass of RuntimeError.\nOSError\nOperating system error. Primarily raised by functions in the os module.The value is the\nsame as for IOError.A subclass of EnvironmentError.\nOverflowError\nResult of an integer value being too large to be represented.This exception usually only\narises if large integer values are passed to objects that internally rely upon fixed-\nprecision machine integers in their implementation. For example, this error can arise\nwith range or xrange objects if you specify starting or ending values that exceed \n32 bits in size.A subclass of ArithmeticError.\nReferenceError\nResult of accessing a weak reference after the underlying object has been destroyed. See\nthe weakref module.\nRuntimeError\nA generic error not covered by any of the other categories.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1716,
      "extraction_method": "Direct"
    },
    {
      "page_number": 240,
      "chapter": null,
      "content": "215\nBuilt-In Exceptions\nStopIteration\nRaised to signal the end of iteration.This normally happens in the next() method of\nan object or in a generator function.\nSyntaxError\nParser syntax error. Instances have the attributes filename, lineno, offset, and text,\nwhich can be used to gather more information.\nSystemError\nInternal error in the interpreter.The value is a string indicating the problem.\nSystemExit\nRaised by the sys.exit() function.The value is an integer indicating the return code.\nIf it’s necessary to exit immediately, os._exit() can be used.\nTabError\nInconsistent tab usage. Generated when Python is run with the -tt option.A subclass\nof SyntaxError.\nTypeError\nOccurs when an operation or a function is applied to an object of an inappropriate\ntype.\nUnboundLocalError\nUnbound local variable referenced.This error occurs if a variable is referenced before\nit’s defined in a function.A subclass of NameError.\nUnicodeError\nUnicode encoding or decoding error.A subclass of ValueError.\nUnicodeEncodeError\nUnicode encoding error.A subclass of UnicodeError.\nUnicodeDecodeError\nUnicode decoding error.A subclass of UnicodeError.\nUnicodeTranslateError\nUnicode error occurred during translation.A subclass of UnicodeError.\nValueError\nGenerated when the argument to a function or an operation is the right type but an\ninappropriate value.\nWindowsError\nGenerated by failed system calls on Windows.A subclass of OSError.\nZeroDivisionError\nDividing by zero.A subclass of ArithmeticError.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1511,
      "extraction_method": "Direct"
    },
    {
      "page_number": 241,
      "chapter": null,
      "content": "216\nChapter 12 Built-In Functions and Exceptions\nBuilt-In Warnings\nPython has a warnings module that is typically used to notify programmers about dep-\nrecated features.Warnings are issued by including code such as the following:\nimport warnings\nwarnings.warn(\"The MONDO flag is no longer supported\", DeprecationWarning)\nAlthough warnings are issued by a library module, the names of the various warnings\nare built-in.Warnings are somewhat similar to exceptions.There is a hierarchy of built-\nin warnings that all inherit from Exception.\nWarning\nThe base class of all warnings.A subclass of Exception.\nUserWarning\nA generic user-defined warning.A subclass of Warning.\nDeprecationWarning\nA warning for deprecated features.A subclass of Warning.\nSyntaxWarning\nA warning for deprecated Python syntax.A subclass of Warning.\nRuntimeWarning\nA warning for potential runtime problems.A subclass of Warning.\nFutureWarning\nA warning that the behavior of a feature will change in the future.A subclass of\nWarning.\nWarnings are different than exceptions in that the issuing of a warning with the\nwarn() function may or may not cause a program to stop. For example, a warning may\njust print something to the output or it may raise an exception.The actual behavior can\nbe configured with the warnings module or with the -W option to the interpreter. If\nyou are using someone else’s code that generates a warning, but you would like to pro-\nceed anyways, you can catch warnings that have been turned into exceptions using try\nand except. For example:\ntry:\nimport md5\nexcept DeprecationWarning:\npass\nIt should be emphasized that code such as this is rare.Although it will catch a warning\nthat has been turned into an exception, it doesn’t suppress warning messages (you have\nto use the warnings module to control that). Plus, ignoring warnings is a good way to\nwrite code that doesn’t work correctly when new versions of Python are released.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1948,
      "extraction_method": "Direct"
    },
    {
      "page_number": 242,
      "chapter": null,
      "content": "217\nfuture_builtins\nfuture_builtins\nThe future_builtins module, only available in Python 2, provides implementations\nof the built-in functions whose behavior is changed in Python 3.The following func-\ntions are defined:\nascii(object)\nProduces the same output as repr(). Refer to the description in the “Built-In\nFunctions” section of this chapter.\nfilter(function, iterable)\nCreates an iterator instead of a list.The same as itertools.ifilter().\nhex(object)\nCreates a hexadecimal string, but uses the _ _index_ _() special method to get an inte-\nger value instead of calling _ _hex_ _().\nmap(function, iterable, ...)\nCreates an iterator instead of a list.The same as itertools.imap().\noct(object)\nCreates an octal string, but uses the _ _index_ _() special method to get an integer\nvalue instead of calling _ _oct_ _().\nzip(iterable, iterable, ... )\nCreates an iterator instead of a list.The same as itertools.izip().\nBe aware that the functions listed in this module are not a complete list of changes\nto the built-in module. For instance, Python 3 also renames raw_input() to input()\nand xrange() to range().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1133,
      "extraction_method": "Direct"
    },
    {
      "page_number": 243,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 244,
      "chapter": null,
      "content": "13\nPython Runtime Services\nThis chapter describes modules that are related to the Python interpreter runtime.\nTopics include garbage collection, basic management of objects (copying, marshalling,\nand so on), weak references, and interpreter environment.\natexit\nThe atexit module is used to register functions to execute when the Python inter-\npreter exits.A single function is provided:\nregister(func [,args [,kwargs]])\nAdds function func to a list of functions that will execute when the interpreter exits.\nargs is a tuple of arguments to pass to the function. kwargs is a dictionary of keyword\narguments.The function is invoked as func(*args,**kwargs). Upon exit, functions\nare invoked in reverse order of registration (the most recently added exit function is\ninvoked first). If an error occurs, an exception message will be printed to standard error\nbut will otherwise be ignored.\ncopy\nThe copy module provides functions for making shallow and deep copies of compound\nobjects, including lists, tuples, dictionaries, and instances of user-defined objects.\ncopy(x)\nMakes a shallow copy of x by creating a new compound object and duplicating the\nmembers of x by reference. For built-in types, it is somewhat uncommon to use this\nfunction. Instead, you use calls such as list(x), dict(x), set(x), and so forth to cre-\nate a shallow copy of x (it should be noted that using the type name directly like this is\nalso significantly faster than using copy()).\ndeepcopy(x [, visit])\nMakes a deep copy of x by creating a new compound object and recursively duplicating\nall the members of x. visit is an optional dictionary that’s used to keep track of visited\nobjects in order to detect and avoid cycles in recursively defined data structures.This\nargument is typically only supplied if deepcopy() is being called recursively as\ndescribed later in this chapter.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1877,
      "extraction_method": "Direct"
    },
    {
      "page_number": 245,
      "chapter": null,
      "content": "220\nChapter 13 Python Runtime Services\nAlthough it is not usually necessary, a class can implement customized copy methods\nby implementing the methods _ _copy_ _(self) and _ _deepcopy_ _(self, visit),\nwhich implement the shallow and deep copy operations respectively.The \n_ _deepcopy_ _() method must accept a dictionary, visit, which is used to keep track\nof previously encountered objects during the copy process. It’s not necessary for\n_ _deepcopy_ _() to do anything with visit other than pass it to other deepcopy()\noperations carried out in the implementation (if any).\nIf a class implements the methods _ _getstate_ _() and _ _setstate_ _() that\nare used by the pickle module, they will be used by the copy module to create copies.\nNotes\nn This module can be used with simple types such as integers and strings, but\nthere’s little need to do so.\nn The copy functions don’t work with modules, class objects, functions, methods,\ntracebacks, stack frames, files, sockets, and other similar types.When an object\ncan’t be copied, the copy.error exception is raised.\ngc\nThe gc module provides an interface for controlling the garbage collector used to col-\nlect cycles in objects such as lists, tuples, dictionaries, and instances.As various types of\ncontainer objects are created, they’re placed on a list that’s internal to the interpreter.\nWhenever container objects are deallocated, they’re removed from this list. If the num-\nber of allocations exceeds the number of deallocations by a user-definable threshold\nvalue, the garbage collector is invoked.The garbage collector works by scanning this list\nand identifying collections of objects that are no longer being used but haven’t been\ndeallocated due to circular dependencies. In addition, the garbage collector uses a three-\nlevel generational scheme in which objects that survive the initial garbage-collection\nstep are placed onto lists of objects that are checked less frequently.This provides better\nperformance for programs that have a large number of long-lived objects.\ncollect([generation])\nRuns a full garbage collection.This function checks all generations and returns the\nnumber of unreachable objects found. generation is an optional integer in the range 0\n- 2 that specifies the generation to collect.\ndisable()\nDisables garbage collection.\nenable()\nEnables garbage collection.\ngarbage\nA variable containing a read-only list of user-defined instances that are no longer in use,\nbut which cannot be garbage collected because they are involved in a reference cycle\nand they define a _ _del_ _() method. Such objects cannot be garbage-collected\nbecause in order to break the reference cycle, the interpreter must arbitrarily destroy\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2724,
      "extraction_method": "Direct"
    },
    {
      "page_number": 246,
      "chapter": null,
      "content": "221\ngc\none of the objects first. However, there is no way to know if the _ _del_ _() method\nof the remaining objects in the cycle needs to perform critical operations on the object\nthat was just destroyed.\nget_count()\nReturns a tuple (count0, count1, count2) containing the number of objects cur-\nrently in each generation.\nget_debug()\nReturns the debugging flags currently set.\nget_objects()\nReturns a list of all objects being tracked by the garbage collector. Does not include the\nreturned list.\nget_referrers(obj1, obj2, ...)\nReturns a list of all objects that directly refer to the objects obj1, obj2, and so on.The\nreturned list may include objects that have not yet been garbage-collected as well as\npartially constructed objects.\nget_referents(obj1, obj2, ...)\nReturns a list of objects that the objects obj1, obj2, and so on refer to. For example, if\nobj1 is a container, this would return a list of the objects in the container.\nget_threshold()\nReturns the current collection threshold as a tuple.\nisenabled()\nReturns True if garbage collection is enabled.\nset_debug(flags)\nSets the garbage-collection debugging flags, which can be used to debug the behavior\nof the garbage collector. flags is the bitwise OR of the constants DEBUG_STATS,\nDEBUG_COLLECTABLE, DEBUG_UNCOLLECTABLE, DEBUG_INSTANCES, DEBUG_OBJECTS,\nDEBUG_SAVEALL, and DEBUG_LEAK.The DEBUG_LEAK flag is probably the most useful\nbecause it will have the collector print information useful for debugging programs with\nmemory leaks.\nset_threshold(threshold0 [, threshold1[, threshold2]])\nSets the collection frequency of garbage collection. Objects are classified into three gen-\nerations, where generation 0 contains the youngest objects and generation 2 contains\nthe oldest objects. Objects that survive a garbage-collection step are moved to the next-\noldest generation. Once an object reaches generation 2, it stays in that generation.\nthreshold0 is the difference between the number of allocations and deallocations that\nmust be reached before garbage collection occurs in generation 0. threshold1 is the\nnumber of collections of generation 0 that must occur before generation 1 is scanned.\nthreshold2 is the number of collections that must occur in generation 1 before gener-\nation 2 is collected.The default threshold is currently set to (700,10,10). Setting\nthreshold0 to 0 disables garbage collection.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2401,
      "extraction_method": "Direct"
    },
    {
      "page_number": 247,
      "chapter": null,
      "content": "222\nChapter 13 Python Runtime Services\nNotes\nn Circular references involving objects with a _ _del_ _() method are not\ngarbage-collected and are placed on the list gc.garbage (uncollectable objects).\nThese objects are not collected due to difficulties related to object finalization.\nn The functions get_referrers() and get_referents() only apply to objects\nthat support garbage collection. In addition, these functions are only intended for\ndebugging.They should not be used for other purposes.\ninspect\nThe inspect module is used to gather information about live Python objects such as\nattributes, documentation strings, source code, stack frames, and so on.\ncleandoc(doc)\nCleans up a documentation string doc by changing all tabs into whitespace and remov-\ning indentation that might have been inserted to make the docstring line up with other\nstatements inside a function or method.\ncurrentframe()\nReturns the frame object corresponding to the caller’s stack frame.\nformatargspec(args [, varags [, varkw [, defaults]]])\nProduces a nicely formatted string representing the values returned by getargspec().\nformatargvalues(args [, varargs [, varkw [, locals]]])\nProduces a nicely formatted string representing the values returned by \ngetargvalues().\ngetargspec(func)\nGiven a function, func, returns a named tuple ArgSpec(args, varargs, varkw,\ndefaults). args is a list of argument names, and varargs is the name of the * argu-\nment (if any). varkw is the name of the ** argument (if any), and defaults is a tuple\nof default argument values or None if there are no default argument values. If there are\ndefault argument values, the defaults tuple represents the values of the last n argu-\nments in args, where n is the len(defaults).\ngetargvalues(frame)\nReturns the values of arguments supplied to a function with execution frame frame.\nReturns a tuple ArgInfo(args, varargs, varkw, locals). args is a list of argu-\nment names, varargs is the name of the * argument (if any), and varkw is the name of\nthe ** argument (if any). locals is the local dictionary of the frame.\ngetclasstree(classes [, unique])\nGiven a list of related classes, classes, this function organizes the classes into a hierar-\nchy based on inheritance.The hierarchy is represented as a collection of nested lists,\nwhere each entry in the list is a list of classes that inherit from the class that immediate-\nly precedes the list. Each entry in the list is a 2-tuple (cls, bases), where cls is the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2490,
      "extraction_method": "Direct"
    },
    {
      "page_number": 248,
      "chapter": null,
      "content": "223\ninspect\nclass object and bases is a tuple of base classes. If unique is True, each class only\nappears once in the returned list. Otherwise, a class may appear multiple times if multi-\nple inheritance is being used.\ngetcomments(object)\nReturns a string consisting of comments that immediately precede the definition of\nobject in Python source code. If object is a module, comments defined at the top of\nthe module are returned. Returns None if no comments are found.\ngetdoc(object)\nReturns the documentation string for object.The documentation string is first\nprocessed using the cleandoc() function before being returned.\ngetfile(object)\nReturns the name of the file in which object was defined. May return TypeError if\nthis information is not applicable or available (for example, for built-in functions).\ngetframeinfo(frame [, context])\nReturns a named tuple Traceback(filename, lineno, function,\ncode_context, index) containing information about the frame object frame.\nfilename and line specify a source code location.The context parameter specifies\nthe number of lines of context from the source code to retrieve.The contextlist\nfield in the returned tuple contains a list of source lines corresponding to this context.\nThe index field is a numerical index within this list for the line corresponding to\nframe.\ngetinnerframes(traceback [, context])\nReturns a list of frame records for the frame of a traceback and all inner frames. Each\nframe-record is a 6-tuple consisting of (frame, filename, line, funcname,\ncontextlist, index). filename, line, context, contextlist, and index have the\nsame meaning as with getframeinfo().\ngetmembers(object [, predicate])\nReturns all of the members of object.Typically, the members are obtained by looking\nin the _ _dict_ _ attribute of an object, but this function may return attributes of\nobject stored elsewhere (for example, docstrings in _ _doc_ _, objects’ names in\n_ _name_ _, and so on).The members are returned a list of (name, value) pairs.\npredicate is an optional function that accepts a member object as an argument and\nreturns True or False. Only members for which predicate returns True are\nreturned. Functions such as isfunction() and isclass() can be used as predicate\nfunctions.\ngetmodule(object)\nReturns the module in which object was defined (if possible).\ngetmoduleinfo(path)\nReturns information about how Python would interpret the file path. If path is not \na Python module, None is returned. Otherwise, a named tuple ModuleInfo(name,\nsuffix, mode, module_type) is returned where name is the name of the module,\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2603,
      "extraction_method": "Direct"
    },
    {
      "page_number": 249,
      "chapter": null,
      "content": "224\nChapter 13 Python Runtime Services\nsuffix is the filename suffix, mode is the file mode that would be used to open the\nmodule, and module_type is an integer code specifying the module type. Module type\ncodes are defined in the imp module as follows:\nModule Type\nDescription\nimp.PY_SOURCE\nPython source file\nimp.PY_COMPILED\nPython compiled object file (.pyc)\nimp.C_EXTENSION\nDynamically loadable C extension\nimp.PKG_DIRECTORY\nPackage directory\nimp.C_BUILTIN\nBuilt-in module\nimp.PY_FROZEN\nFrozen module\ngetmodulename(path)\nReturns the name of the module that would be used for the file path. If path does not\nlook like a Python module, None is returned.\ngetmro(cls)\nReturns a tuple of classes that represent the method-resolution ordering used to resolve\nmethods in class cls. Refer to Chapter 7,“Classes and Object-Oriented Programming,”\nfor further details.\ngetouterframes(frame [, context])\nReturns a list of frame records for frame and all outer frames.This list represents the\ncalling sequence where the first entry contains information for frame. Each frame\nrecord is a 6-tuple (frame, filename, line, funcname, contextlist, index)\nwhere the fields have the same meaning as for getinnerframes()The context argu-\nment has the same meaning as for getframeinfo().\ngetsourcefile(object)\nReturns the name of the Python source file in which object was defined.\ngetsourcelines(object)\nReturns a tuple (sourcelines, firstline) corresponding to the definition of\nobject. sourcelines is a list of source code lines, and firstline is the line number\nof the first source code line. Raises IOError if source code can’t be found.\ngetsource(object)\nReturns source code of object as a single string. Raises IOError if the source code\ncan’t be found.\nisabstract(object)\nReturns True if object is an abstract base class.\nisbuiltin(object)\nReturns True if object is a built-in function.\nisclass(object)\nReturns True if object is a class.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1949,
      "extraction_method": "Direct"
    },
    {
      "page_number": 250,
      "chapter": null,
      "content": "225\ninspect\niscode(object)\nReturns True if object is a code object.\nisdatadescriptor(object)\nReturns True if object is a data descriptor object.This is the case if object defines\nboth a _ _get_ _() and _ _set_ _() method.\nisframe(object)\nReturns True if object is a frame object.\nisfunction(object)\nReturns True if object is a function object.\nisgenerator(object)\nReturns True if object is a generator object.\nisgeneratorfunction(object)\nReturns True if object is a generator function.This is different than isgenerator()\nin that it tests if object is a function that creates a generator when called. It is not used\nto check if object is an actively running generator.\nismethod(object)\nReturns True if object is a method.\nismethoddescriptor(object)\nReturns True if object is a method descriptor object.This is the case if object is not\na method, class, or function and it defines a _ _get_ _() method but does not define\n_ _set_ _().\nismodule(object)\nReturns True if object is a module object.\nisroutine(object)\nReturns True if object is a user-defined or built-in function or method.\nistraceback(object)\nReturns True if object is a traceback object.\nstack([context])\nReturns a list of frame records corresponding to the stack of the caller. Each frame\nrecord is a 6-tuple (frame, filename, line, funcname, contextlist, index),\nwhich contains the same information as returned by getinnerframes(). context\nspecifies the number of lines of source context to return in each frame record.\ntrace([context])\nReturns a list of frame records for the stack between the current frame and the frame in\nwhich the current exception was raised.The first frame record is the caller, and the last\nframe record is the frame where the exception occurred. context specifies the number\nof lines of source context to return in each frame record.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1847,
      "extraction_method": "Direct"
    },
    {
      "page_number": 251,
      "chapter": null,
      "content": "226\nChapter 13 Python Runtime Services\nmarshal\nThe marshal module is used to serialize Python objects in an “undocumented”\nPython-specific data format. marshal is similar to the pickle and shelve modules,\nbut it is less powerful and intended for use only with simple objects. It shouldn’t be\nused to implement persistent objects in general (use pickle instead). However, for sim-\nple built-in types, the marshal module is a very fast approach for saving and loading\ndata.\ndump(value, file [, version])\nWrites the object value to the open file object file. If value is an unsupported type, a\nValueError exception is raised. version is an integer that specifies the data format to\nuse.The default output format is found in marshal.version and is currently set to 2.\nVersion 0 is an older format used by earlier versions of Python.\ndumps(value [,version])\nReturns the string written by the dump() function. If value is an unsupported type, a\nValueError exception is raised. version is the same as described previously.\nload(file)\nReads and returns the next value from the open file object file. If no valid value is\nread, an EOFError, ValueError, or TypeError exception will be raised.The format of\nthe input data is automatically detected.\nloads(string)\nReads and returns the next value from the string string.\nNotes\nn Data is stored in a binary architecture-independent format.\nn Only None, integers, long integers, floats, complex numbers, strings, Unicode\nstrings, tuples, lists, dictionaries, and code objects are supported. Lists, tuples, and\ndictionaries can only contain supported objects. Class instances and recursive ref-\nerences in lists, tuples, and dictionaries are not supported.\nn Integers may be promoted to long integers if the built-in integer type doesn’t\nhave enough precision—for example, if the marshalled data contains a 64-bit\ninteger, but the data is being read on a 32-bit machine.\nn marshal is not intended to be secure against erroneous or maliciously construct-\ned data and should not be used to unmarshal data from untrusted sources.\nn marshal is significantly faster than pickle, but it isn’t as flexible.\npickle\nThe pickle module is used to serialize Python objects into a stream of bytes suitable\nfor storing in a file, transferring across a network, or placing in a database.This process is\nvariously called pickling, serializing, marshalling, or flattening.The resulting byte stream can\nalso be converted back into a series of Python objects using an unpickling process.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2526,
      "extraction_method": "Direct"
    },
    {
      "page_number": 252,
      "chapter": null,
      "content": "227\npickle\nThe following functions are used to turn an object into a byte-stream.\ndump(object, file [, protocol ])\nDumps a pickled representation of object to the file object file. protocol specifies\nthe output format of the data. Protocol 0 (the default) is a text-based format that is\nbackwards-compatible with earlier versions of Python. Protocol 1 is a binary protocol\nthat is also compatible with most earlier Python versions. Protocol 2 is a newer protocol\nthat provides more efficient pickling of classes and instances. Protocol 3 is used by\nPython 3 and is not backwards-compatible. If protocol is negative, the most modern\nprotocol will be selected.The variable pickle.HIGHEST_PROTOCOL contains the high-\nest protocol available. If object doesn’t support pickling, a pickle.PicklingError\nexception is raised.\ndumps(object [, protocol])\nSame as dump(), but returns a string containing the pickled data.\nThe following example shows how you use these functions to save objects to a file:\nf = open('myfile', 'wb')\npickle.dump(x, f)\npickle.dump(y, f)\n... dump more objects ...\nf.close()\nThe following functions are used to restore a pickled object.\nload(file)\nLoads and returns a pickled representation of an object from the file object file. It is\nnot necessary to specify the input protocol as it is automatically detected.A\npickle.UnpicklingError exception is raised if the file contains corrupted data that\ncan’t be decoded. If an end-of-file is detected, an EOFError exception is raised.\nloads(string)\nSame as load(), but reads the pickled representation of an object from a string.\nThe following example shows how you use these functions to load data:\nf = open('myfile', 'rb')\nx = pickle.load(f)\ny = pickle.load(f)\n... load more objects ...\nf.close()\nWhen loading, it is not necessary to specify the protocol or any information about the\ntype of object being loaded.That information is saved as part of the pickle data format\nitself.\nIf you are pickling more than one Python object, you can simply make repeated calls\nto dump() and load() as shown in the previous examples.When making multiple calls,\nyou simply have to make sure the sequence of load() calls matches the sequence of\ndump() calls that were used to write the file.\nWhen working with complicated data structures involving cycles or shared refer-\nences, using dump() and load() can be problematic because they don’t maintain any\ninternal state about objects that have already been pickled or restored.This can result in\noutput files that are excessively large and that don’t properly restore the relationship\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2604,
      "extraction_method": "Direct"
    },
    {
      "page_number": 253,
      "chapter": null,
      "content": "228\nChapter 13 Python Runtime Services\nbetween objects when loaded.An alternative approach is to use Pickler and\nUnpickler objects.\nPickler(file [, protocol ])\nCreates a pickling object that writes data to the file object file with the specified\npickle protocol.An instance p of Pickler has a method p.dump(x) that dumps an\nobject x to file. Once x has been dumped, its identity is remembered. If a subsequent\np.dump() operation is used to write the same object, a reference to the previously\ndumped object is saved instead of writing a new copy.The method p.clear_memo()\nclears the internal dictionary used to track previously dumped objects.You would use\nthis if you wanted to write a fresh copy of a previously dumped object (that is, if its\nvalue changed since the last dump() operation).\nUnpickler(file)\nCreates an unpickling object that reads data from the file object file.An instance u of\nUnpickler has a method u.load() that loads and returns a new object from file.An\nUnpickler keeps track of objects it has returned because the input source might con-\ntain an object reference created by the Pickler object. In this case, u.load() returns a\nreference to the previously loaded object.\nThe pickle module works with most kinds of normal Python objects.This\nincludes:\nn None\nn Numbers and strings\nn Tuples, lists, and dictionaries containing only pickleable objects\nn Instances of user-defined classes defined at the top level of a module\nWhen instances of a user-defined class are pickled, the instance data is the only part that\ngets pickled.The corresponding class definition is not saved—instead, the pickled data\nmerely contains the name of the associated class and module.When instances are\nunpickled, the module in which the class is defined is automatically imported in order\nto access the class definition when re-creating instances. It should also be noted that\nwhen restoring an instance, the _ _init_ _() method of a class is not invoked. Instead,\nthe instance is re-created through other means and the instance data restored.\nOne restriction on instances is that the corresponding class definition must appear at\nthe top level of a module (that is, no nested classes). In addition, if the instance’s class\ndefinition was originally defined in _ _main_ _, that class definition must be manually\nreloaded prior to unpickling a saved object (because there’s no way for the interpreter\nto know how to automatically load the necessary class definitions back into _ _main_ _\nwhen unpickling).\nIt is not normally necessary to do anything to make a user-defined class work with\npickle. However, a class can define customized methods for saving and restoring its state\nby implementing the special methods _ _getstate_ _() and _ _setstate_ _().The\n_ _getstate_ _() method must return a pickleable object (such as a string or tuple)\nrepresenting the state of the object.The _ _setstate_ _() method accepts the pickled\nobject and restores its state. If these methods are undefined, the default behavior is to\npickle an instance’s underlying _ _dict_ _ attribute. It should be noted that if these\nmethods are defined, they will also be used by the copy module to implement the shal-\nlow and deep copy operations.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3242,
      "extraction_method": "Direct"
    },
    {
      "page_number": 254,
      "chapter": null,
      "content": "229\nsys\nNotes\nn In Python 2, a module called cPickle contains a C implementation of functions\nin the pickle module. It is significantly faster than pickle, but is restricted in\nthat it doesn’t allow subclassing of the Pickler and Unpickler objects. Python 3\nhas a support module that also contains C implementation, but it is used more\ntransparently (pickle takes advantage of it automatically as appropriate).\nn The data format used by pickle is Python-specific and shouldn’t be assumed to\nbe compatible with any external standards such as XML.\nn Whenever possible, the pickle module should be used instead of the marshal\nmodule because pickle is more flexible, the data encoding is documented, and\nadditional error-checking is performed.\nn Due to security concerns, programs should not unpickle data received from\nuntrusted sources.\nn Use of the pickle module with types defined in extension modules is much\nmore involved than what is described here. Implementers of extension types\nshould consult the online documentation for details concerning the low-level\nprotocol required to make these objects work with pickle—in particular, details\non how to implement the _ _reduce_ _() and _ _reduce_ex_ _() special\nmethods that pickle uses to create the serialized byte sequences.\nsys\nThe sys module contains variables and functions that pertain to the operation of the\ninterpreter and its environment.\nVariables\nThe following variables are defined.\napi_version\nAn integer representing the C API version of the Python interpreter. Used when work-\ning with extension modules.\nargv\nList of command-line options passed to a program. argv[0] is the name of the pro-\ngram.\nbuiltin_module_names\nTuple containing names of modules built into the Python executable.\nbyteorder\nNative byte-ordering of the machine—'little' for little-endian or 'big' for big-\nendian.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1874,
      "extraction_method": "Direct"
    },
    {
      "page_number": 255,
      "chapter": null,
      "content": "230\nChapter 13 Python Runtime Services\ncopyright\nString containing copyright message.\n_ _displayhook_ _\nOriginal value of the displayhook() function.\ndont_write_bytecode\nBoolean flag that determines whether or not Python writes bytecode (.pyc or .pyo\nfiles) when importing modules.The initial value is True unless the -B option to the\ninterpreter is given.The setting can be changed as needed in your own program.\ndllhandle\nInteger handle for the Python DLL (Windows).\n_ _excepthook_ _\nOriginal value of the excepthook() function.\nexec_prefix\nDirectory where platform-dependent Python files are installed.\nexecutable\nString containing the name of the interpreter executable.\nflags\nAn object representing the settings of different command-line options supplied to the\nPython interpreter itself.The following table lists the attributes of flags along with the\ncorresponding command-line option that turns the flag on.These attributes are read-\nonly.\nAttribute\nCommand-Line Option\nflags.debug\n-d\nflags.py3k_warning\n-3\nflags.division_warning\n-Q\nflags.division_new\n-Qnew\nflags.inspect\n-i\nflags.interactive\n-i\nflags.optimize\n-O or -OO\nflags.dont_write_bytecode\n-B\nflags.no_site\n-S\nflags.ignore_environment\n-E\nflags.tabcheck\n-t or -tt\nflags.verbose\n-v\nflags.unicode\n-U\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1284,
      "extraction_method": "Direct"
    },
    {
      "page_number": 256,
      "chapter": null,
      "content": "231\nsys\nfloat_info\nAn object that holds information about internal representation of floating-point num-\nbers.The values of these attributes are taken from the float.h C header file.\nAttribute\nDescription\nfloat_info.epsilon\nDifference between 1.0 and the next largest float.\nfloat_info.dig\nNumber of decimal digits that can be represented without\nany changes after rounding.\nfloat_info.mant_dig\nNumber of digits that can be represented using the numer-\nic base specified in float_info.radix.\nfloat_info.max\nMaximum floating-point number.\nfloat_info.max_exp\nMaximum exponent in the numeric base specified in\nfloat_info.radix.\nfloat_info.max_10_exp\nMaximum exponent in base 10.\nfloat_info.min\nMinimum positive floating-point value.\nfloat_info.min_exp\nMinimum exponent in the numeric base specified in\nfloat_info.radix.\nfloat_info.min_10_exp\nMinimum exponent in base 10.\nfloat_info.radix\nNumeric base used for exponents.\nfloat_info.rounds\nRounding behavior (-1 undetermined, 0 towards zero, 1\nnearest, 2 towards positive infinity, 3 towards negative\ninfinity).\nhexversion\nInteger whose hexadecimal representation encodes the version information contained in\nsys.version_info.The value of this integer is always guaranteed to increase with\nnewer versions of the interpreter.\nlast_type, last_value, last_traceback\nThese variables are set when an unhandled exception is encountered and the interpreter\nprints an error message. last_type is the last exception type, last_value is the last\nexception value, and last_traceback is a stack trace. Note that the use of these vari-\nables is not thread-safe. sys.exc_info() should be used instead.\nmaxint\nLargest integer supported by the integer type (Python 2 only).\nmaxsize\nLargest integer value supported by the C size_t datatype on the system.This value\ndetermines the largest possible length for strings, lists, dicts, and other built-in types.\nmaxunicode\nInteger that indicates the largest Unicode code point that can be represented.The\ndefault value is 65535 for the 16-bit UCS-2 encoding.A larger value will be found if\nPython has been configured to use UCS-4.\nmodules\nDictionary that maps module names to module objects.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2188,
      "extraction_method": "Direct"
    },
    {
      "page_number": 257,
      "chapter": null,
      "content": "232\nChapter 13 Python Runtime Services\npath\nList of strings specifying the search path for modules.The first entry is always set to the\ndirectory in which the script used to start Python is located (if available). Refer to\nChapter 8,“Iterators and Generators.”\nplatform\nPlatform identifier string, such as 'linux-i386'.\nprefix\nDirectory where platform-independent Python files are installed.\nps1, ps2\nStrings containing the text for the primary and secondary prompts of the interpreter.\nInitially, ps1 is set to '>>> ' and ps2 is set to '... '.The str() method of whatever\nobject is assigned to these values is evaluated to generate the prompt text.\npy3kwarning\nFlag set to True in Python 2 when the interpreter is run with the -3 option.\nstdin, stdout, stderr\nFile objects corresponding to standard input, standard output, and standard error. stdin\nis used for the raw_input() and input() functions. stdout is used for print and the\nprompts of raw_input() and input(). stderr is used for the interpreter’s prompts\nand error messages.These variables can be assigned to any object that supports a\nwrite() method operating on a single string argument.\n_ _stdin_ _, _ _stdout_ _, _ _stderr_ _\nFile objects containing the values of stdin, stdout, and stderr at the start of the\ninterpreter.\ntracebacklimit\nMaximum number of levels of traceback information printed when an unhandled\nexception occurs.The default value is 1000.A value of 0 suppresses all traceback infor-\nmation and causes only the exception type and value to be printed.\nversion\nVersion string.\nversion_info\nVersion information represented as a tuple (major, minor, micro, releaselevel,\nserial).All values are integers except releaselevel, which is the string 'alpha',\n'beta', 'candidate', or 'final'.\nwarnoptions\nList of warning options supplied to the interpreter with the –W command-line option.\nwinver\nThe version number used to form registry keys on Windows.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1948,
      "extraction_method": "Direct"
    },
    {
      "page_number": 258,
      "chapter": null,
      "content": "233\nsys\nFunctions\nThe following functions are available:\n_clear_type_cache()\nClears the internal type cache.To optimize method lookups, a small 1024-entry cache\nof recently used methods is maintained inside the interpreter.This cache speeds up\nrepeated method lookups—especially in code that has deep inheritance hierarchies.\nNormally, you don’t need to clear this cache, but you might do so if you are trying to\ntrack down a really tricky memory reference counting issue. For example, if a method\nin the cache was holding a reference to an object that you were expecting to be\ndestroyed.\n_current_frames()\nReturns a dictionary mapping thread identifiers to the topmost stack frame of the exe-\ncuting thread at the time of call.This information can be useful in writing tools related\nto thread debugging (that is, tracking down deadlock). Keep in mind that the values\nreturned by this function only represent a snapshot of the interpreter at the time of call.\nThreads may be executing elsewhere by the time you look at the returned data.\ndisplayhook([value])\nThis function is called to print the result of an expression when the interpreter is run-\nning in interactive mode. By default, the value of repr(value) is printed to standard\noutput and value is saved in the variable _ _builtin_ _._. displayhook can be rede-\nfined to provide different behavior if desired.\nexcepthook(type,value,traceback)\nThis function is called when an uncaught exception occurs. type is the exception class,\nvalue is the value supplied by the raise statement, and traceback is a traceback\nobject.The default behavior is to print the exception and traceback to standard error.\nHowever, this function can be redefined to provide alternative handling of uncaught\nexceptions (which may be useful in specialized applications such as debuggers or CGI\nscripts).\nexc_clear()\nClears all information related to the last exception that occurred. It only clears informa-\ntion specific to the calling thread.\nexc_info()\nReturns a tuple (type, value, traceback) containing information about the\nexception that’s currently being handled. type is the exception type, value is the\nexception parameter passed to raise, and traceback is a traceback object containing the\ncall stack at the point where the exception occurred. Returns None if no exception is\ncurrently being handled.\nexit([n])\nExits Python by raising the SystemExit exception. n is an integer exit code indicating\na status code.A value of 0 is considered normal (the default); nonzero values are consid-\nered abnormal. If a noninteger value is given to n, it’s printed to sys.stderr and an\nexit code of 1 is used.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2662,
      "extraction_method": "Direct"
    },
    {
      "page_number": 259,
      "chapter": null,
      "content": "234\nChapter 13 Python Runtime Services\ngetcheckinterval()\nReturns the value of the check interval, which specifies how often the interpreter\nchecks for signals, thread switches, and other periodic events.\ngetdefaultencoding()\nGets the default string encoding in Unicode conversions. Returns a value such as\n'ascii' or 'utf-8'.The default encoding is set by the site module.\ngetdlopenflags()\nReturns the flags parameter that is supplied to the C function dlopen() when loading\nextension modules on UNIX. See dl module.\ngetfilesystemencoding()\nReturns the character encoding used to map Unicode filenames to filenames used by\nthe underlying operating system. Returns 'mbcs' on Windows or 'utf-8' on\nMacintosh OS X. On UNIX systems, the encoding depends on locale settings and will\nreturn the value of the locale CODESET parameter. May return None, in which case the\nsystem default encoding is used.\n_getframe([depth])\nReturns a frame object from the call stack. If depth is omitted or zero, the topmost\nframe is returned. Otherwise, the frame for that many calls below the current frame is\nreturned. For example, _getframe(1) returns the caller’s frame. Raises ValueError if\ndepth is invalid.\ngetprofile()\nReturns the profile function set by the setprofile() function.\ngetrecursionlimit()\nReturns the recursion limit for functions.\ngetrefcount(object)\nReturns the reference count of object.\ngetsizeof(object [, default])\nReturns the size of object in bytes.This calculation is made by calling the \n_ _sizeof_ _() special method of object. If undefined, a TypeError will be generat-\ned unless a default value has been specified with the default argument. Because\nobjects are free to define _ _sizeof_ _() however they wish, there is no guarantee that\nthe result of this function is a true measure of memory use. However, for built-in types\nsuch as lists or string, it is correct.\ngettrace()\nReturns the trace function set by the settrace() function.\ngetwindowsversion()\nReturns a tuple (major,minor,build,platform,text) that describes the version of\nWindows being used. major is the major version number. For example, a value of 4\nindicates Windows NT 4.0, and a value of 5 indicates Windows 2000 and Windows XP\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2231,
      "extraction_method": "Direct"
    },
    {
      "page_number": 260,
      "chapter": null,
      "content": "235\ntraceback\nvariants. minor is the minor version number. For example, 0 indicates Windows 2000,\nwhereas 1 indicates Windows XP. build is the Windows build number. platform iden-\ntifies the platform and is an integer with one of the following common values: 0\n(Win32s on Windows 3.1), 1 (Windows 95,98, or Me), 2 (Windows NT, 2000, XP), or\n3 (Windows CE). text is a string containing additional information such as \"Service\nPack 3\".\nsetcheckinterval(n)\nSets the number of Python virtual machine instructions that must be executed by the\ninterpreter before it checks for periodic events such as signals and thread context\nswitches.The default value is 10.\nsetdefaultencoding(enc)\nSets the default encoding. enc is a string such as 'ascii' or 'utf-8'.This function \nis only defined inside the site module. It can be called from user-definable \nsitecustomize modules.\nsetdlopenflags(flags)\nSets the flags passed to the C dlopen() function, which is used to load extension mod-\nules on UNIX.This will affect the way in which symbols are resolved between libraries\nand other extension modules. flags is the bitwise OR of values that can be found in\nthe dl module (see Chapter 19,“Network Programming”)—for example,\nsys.setdlopenflags(dl.RTLD_NOW | dl.RTLD_GLOBAL).\nsetprofile(pfunc)\nSets the system profile function that can be used to implement a source code profiler.\nsetrecursionlimit(n)\nChanges the recursion limit for functions.The default value is 1000. Note that the\noperating system may impose a hard limit on the stack size, so setting this too high may\ncause the Python interpreter process to crash with a Segmentation Fault or Access\nViolation.\nsettrace(tfunc)\nSets the system trace function, which can be used to implement a debugger. Refer to\nChapter 11 for information about the Python debugger.\ntraceback\nThe traceback module is used to gather and print stack traces of a program after an\nexception has occurred.The functions in this module operate on traceback objects such\nas the third item returned by the sys.exc_info() function.The main use of this\nmodule is in code that needs to report errors in a non-standard way—for example, if\nyou were running Python programs deeply embedded within a network server and you\nwanted to redirect tracebacks to a log file.\nprint_tb(traceback [, limit [, file]])\nPrints up to limit stack trace entries from traceback to the file file. If limit is\nomitted, all the entries are printed. If file is omitted, the output is sent to\nsys.stderr.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2512,
      "extraction_method": "Direct"
    },
    {
      "page_number": 261,
      "chapter": null,
      "content": "236\nChapter 13 Python Runtime Services\nprint_exception(type, value, traceback [, limit [, file]])\nPrints exception information and a stack trace to file. type is the exception type, and\nvalue is the exception value. limit and file are the same as in print_tb().\nprint_exc([limit [, file]])\nSame as print_exception() applied to the information returned by the\nsys.exc_info() function.\nformat_exc([limit [, file]])\nReturns a string containing the same information printed by print_exc().\nprint_last([limit [, file]])\nSame as print_exception (sys.last_type, sys.last_value,\nsys.last_traceback, limit, file).\nprint_stack([frame [, limit [, file]]])\nPrints a stack trace from the point at which it’s invoked. frame specifies an optional\nstack frame from which to start. limit and file have the same meaning as for\nprint_tb().\nextract_tb(traceback [, limit])\nExtracts the stack trace information used by print_tb().The return value is a list of\ntuples of the form (filename, line, funcname, text) containing the same infor-\nmation that normally appears in a stack trace. limit is the number of entries to return.\nextract_stack([frame [, limit]])\nExtracts the same stack trace information used by print_stack(), but obtained from\nthe stack frame frame. If frame is omitted, the current stack frame of the caller is used\nand limit is the number of entries to return.\nformat_list(list)\nFormats stack trace information for printing. list is a list of tuples as returned by\nextract_tb() or extract_stack().\nformat_exception_only(type, value)\nFormats exception information for printing.\nformat_exception(type, value, traceback [, limit])\nFormats an exception and stack trace for printing.\nformat_tb(traceback [, limit])\nSame as format_list(extract_tb(traceback, limit)).\nformat_stack([frame [, limit]])\nSame as format_list(extract_stack(frame, limit)).\ntb_lineno(traceback)\nReturns the line number set in a traceback object.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1935,
      "extraction_method": "Direct"
    },
    {
      "page_number": 262,
      "chapter": null,
      "content": "237\ntypes\ntypes\nThe types module defines names for the built-in types that correspond to functions,\nmodules, generators, stack frames, and other program elements.The contents of this\nmodule are often used in conjunction with the built-in isinstance() function and\nother type-related operations.\nVariable\nDescription\nBuiltinFunctionType\nType of built-in functions\nCodeType\nType of code objects\nFrameType\nType of execution frame object\nFunctionType\nType of user-defined functions and lambdas\nGeneratorType\nType of generator-iterator objects\nGetSetDescriptorType\nType of getset descriptor objects\nLambdaType\nAlternative name for FunctionType\nMemberDescriptorType\nType of member descriptor objects\nMethodType\nType of user-defined class methods\nModuleType\nType of modules\nTracebackType\nType of traceback objects\nMost of the preceding type objects serve as constructors that can be used to create an\nobject of that type.The following descriptions provide the parameters used to create\nfunctions, modules, code objects, and methods. Chapter 3 contains detailed information\nabout the attributes of the objects created and the arguments that need to be supplied\nto the functions described next.\nFunctionType(code, globals [, name [, defarags [, closure]]])\nCreates a new function object.\nCodeType(argcount, nlocals, stacksize, flags, codestring, constants, names,\nvarnames, filename, name, firstlineno, lnotab [, freevars [, cellvars ]])\nCreates a new code object.\nMethodType(function, instance, class)\nCreates a new bound instance method.\nModuleType(name [, doc])\nCreates a new module object.\nNotes\nn The types module should not be used to refer the type of built-in objects such\nas integers, lists, or dictionaries. In Python 2, types contains other names such as\nIntType and DictType. However, these names are just aliases for the built-in\ntype names of int and dict. In modern code, you should just use the built-in\ntype names because the types module only contains the names listed previously\nin Python 3.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2024,
      "extraction_method": "Direct"
    },
    {
      "page_number": 263,
      "chapter": null,
      "content": "238\nChapter 13 Python Runtime Services\nwarnings\nThe warnings module provides functions to issue and filter warning messages. Unlike\nexceptions, warnings are intended to alert the user to potential problems, but without\ngenerating an exception or causing execution to stop. One of the primary uses of the\nwarnings module is to inform users about deprecated language features that may not be\nsupported in future versions of Python. For example:\n>>> import regex\n_ _main_ _:1: DeprecationWarning: the regex module is deprecated;  use the re \nmodule\n>>>\nLike exceptions, warnings are organized into a class hierarchy that describes general cat-\negories of warnings.The following lists the currently supported categories:\nWarning Object\nDescription\nWarning\nBase class of all warning types\nUserWarning\nUser-defined warning\nDeprecationWarning\nWarning for use of a deprecated feature\nSyntaxWarning\nPotential syntax problem\nRuntimeWarning\nPotential runtime problem\nFutureWarning\nWarning that the semantics of a particular feature will\nchange in a future release\nEach of these classes is available in the _ _builtin_ _ module as well as the \nexceptions module. In addition, they are also instances of Exception.This makes it\npossible to easily convert warnings into errors.\nWarnings are issued using the warn() function. For example:\nwarnings.warn(\"feature X is deprecated.\")\nwarnings.warn(\"feature Y might be broken.\", RuntimeWarning)\nIf desired, warnings can be filtered.The filtering process can be used to alter the output\nbehavior of warning messages, to ignore warnings, or to turn warnings into exceptions.\nThe filterwarnings() function is used to add a filter for a specific type of warning.\nFor example:\nwarnings.filterwarnings(action=\"ignore\",\nmessage=\".*regex.*\",\ncategory=DeprecationWarning)\nimport regex      # Warning message disappears\nLimited forms of filtering can also be specified using the –W option to the interpreter.\nFor example:\n% python –Wignore:the\\ regex:DeprecationWarning\nThe following functions are defined in the warnings module:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2073,
      "extraction_method": "Direct"
    },
    {
      "page_number": 264,
      "chapter": null,
      "content": "239\nwarnings\nwarn(message[, category[, stacklevel]])\nIssues a warning. message is a string containing the warning message, category is the\nwarning class (such as DeprecationWarning), and stacklevel is an integer that speci-\nfies the stack frame from which the warning message should originate. By default,\ncategory is UserWarning and stacklevel is 1.\nwarn_explicit(message, category, filename, lineno[, module[, registry]])\nThis is a low-level version of the warn() function. message and category have the\nsame meaning as for warn(). filename, lineno, and module explicitly specify the\nlocation of the warning. registry is an object representing all the currently active fil-\nters. If registry is omitted, the warning message is not suppressed.\nshowwarning(message, category, filename, lineno[, file])\nWrites a warning to a file. If file is omitted, the warning is printed to sys.stderr.\nformatwarning(message, category, filename, lineno)\nCreates the formatted string that is printed when a warning is issued.\nfilterwarnings(action[, message[, category[, module[, lineno[, append]]]]])\nAdds an entry to the list of warning filters. action is one of 'error', 'ignore',\n'always', 'default', 'once', or 'module'.The following list provides an explana-\ntion of each:\nAction\nDescription\n'error'\nConvert the warning into an exception\n'ignore'\nIgnore the warning\n'always'\nAlways print a warning message\n'default'\nPrint the warning once for each location where the warning occurs\n'module'\nPrint the warning once for each module in which the warning occurs\n'once'\nPrint the warning once regardless of where it occurs\nmessage is a regular expression string that is used to match against the warning mes-\nsage. category is a warning class such as DeprecationError. module is a regular\nexpression string that is matched against the module name. lineno is a specific line\nnumber or 0 to match against all lines. append specifies that the filter should be\nappended to the list of all filters (checked last). By default, new filters are added to the\nbeginning of the filter list. If any argument is omitted, it defaults to a value that matches\nall warnings.\nresetwarnings()\nResets all the warning filters.This discards all previous calls to filterwarnings() as\nwell as options specified with –W.\nNotes\nn The list of currently active filters is found in the warnings.filters variable.\nn When warnings are converted to exceptions, the warning category becomes the\nexception type. For instance, an error on DeprecationWarning will raise a\nDeprecationWarning exception.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2573,
      "extraction_method": "Direct"
    },
    {
      "page_number": 265,
      "chapter": null,
      "content": "240\nChapter 13 Python Runtime Services\nn The –W option can be used to specify a warning filter on the command line.The\ngeneral format of this option is\n-Waction:message:category:module:lineno\nwhere each part has the same meaning as for the filterwarning() function.\nHowever, in this case, the message and module fields specify substrings (instead\nof regular expressions) for the first part of the warning message and module name\nto be filtered, respectively.\nweakref\nThe weakref module is used to provide support for weak references. Normally, a refer-\nence to an object causes its reference count to increase—effectively keeping the object\nalive until the reference goes away.A weak reference, on the other hand, provides a way\nof referring to an object without increasing its reference count.This can be useful in\ncertain kinds of applications that must manage objects in unusual ways. For example, in\nan object-oriented program, where you might implement a relationship such as the\nObserver pattern, a weak reference can be used to avoid the creation of reference\ncycles.An example of this is shown in the “Object Memory Management” section of\nChapter 7.\nA weak reference is created using the weakref.ref() function as follows:\n>>> class A: pass\n>>> a = A()\n>>> ar = weakref.ref(a)        # Create a weak reference to a\n>>> print ar\n<weakref at 0x135a24; to 'instance' at 0x12ce0c>\nOnce a weak reference is created, the original object can be obtained from the weak\nreference by simply calling it as a function with no arguments. If the underlying object\nstill exists, it will be returned. Otherwise, None is returned to indicate that the original\nobject no longer exists. For example:\n>>> print ar()                # Print original object\n<_ _main_ _.A instance at 12ce0c>\n>>> del a                     # Delete the original object\n>>> print ar()                # a is gone, so this now returns None\nNone\n>>>\nThe following functions are defined by the weakref module:\nref(object[, callback])\nCreates a weak reference to object. callback is an optional function that will be\ncalled when object is about to be destroyed. If supplied, this function should accept a\nsingle argument, which is the corresponding weak reference object. More than one\nweak reference may refer to the same object. In this case, the callback functions will\nbe called in order from the most recently applied reference to the oldest reference.\nobject can be obtained from a weak reference by calling the returned weak reference\nobject as a function with no arguments. If the original object no longer exists, None\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2611,
      "extraction_method": "Direct"
    },
    {
      "page_number": 266,
      "chapter": null,
      "content": "241\nweakref\nwill be returned. ref() actually defines a type, ReferenceType, that can be used for\ntype-checking and subclasses.\nproxy(object[, callback])\nCreates a proxy using a weak reference to object.The returned proxy object is really a\nwrapper around the original object that provides access to its attributes and methods.As\nlong as the original object exists, manipulation of the proxy object will transparently\nmimic the behavior of the underlying object. On the other hand, if the original object\nhas been destroyed, operations on the proxy will raise a weakref.ReferenceError to\nindicate that the object no longer exists. callback is a callback function with the same\nmeaning as for the ref() function.The type of a proxy object is either ProxyType or\nCallableProxyType, depending on whether or not the original object is callable.\ngetweakrefcount(object)\nReturns the number of weak references and proxies that refer to object.\ngetweakrefs(object)\nReturns a list of all weak reference and proxy objects that refer to object.\nWeakKeyDictionary([dict])\nCreates a dictionary in which the keys are referenced weakly.When there are no more\nstrong references to a key, the corresponding entry in the dictionary is automatically\nremoved. If supplied, the items in dict are initially added to the returned\nWeakKeyDictionary object. Because only certain types of objects can be weakly refer-\nenced, there are numerous restrictions on acceptable key values. In particular, built-in\nstrings cannot be used as weak keys. However, instances of user-defined classes \nthat define a _ _hash_ _() method can be used as keys.An instance of\nWeakKeyDictionary has two methods, iterkeyrefs() and keyrefs(), that \nreturn the weak key references.\nWeakValueDictionary([dict])\nCreates a dictionary in which the values are referenced weakly.When there are no more\nstrong references to a value, corresponding entries in the dictionary will be discarded. If\nsupplied, the entries in dict are added to the returned WeakValueDictionary.An\ninstance of WeakValueDictionary has two methods, itervaluerefs() and\nvaluerefs(), that return the weak value references.\nProxyTypes\nThis is a tuple (ProxyType, CallableProxyType) that can be used for testing if an\nobject is one of the two kinds of proxy objects created by the proxy() function—for\nexample, isinstance(object, ProxyTypes).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2378,
      "extraction_method": "Direct"
    },
    {
      "page_number": 267,
      "chapter": null,
      "content": "242\nChapter 13 Python Runtime Services\nExample\nOne application of weak references is to create caches of recently computed results. For\ninstance, if a function takes a long time to compute a result, it might make sense to\ncache these results and to reuse them as long as they are still in use someplace in the\napplication. For example:\n_resultcache = { }\ndef foocache(x):\nif resultcache.has_key(x):\nr = _resultcache[x]()       # Get weak ref and dereference it\nif r is not None: return r\nr = foo(x)\n_resultcache[x] = weakref.ref(r)\nreturn r\nNotes\nn Only class instances, functions, methods, sets, frozen sets, files, generators, type\nobjects, and certain object types defined in library modules (for example, sockets,\narrays, and regular expression patterns) support weak references. Built-in functions\nand most built-in types such as lists, dictionaries, strings, and numbers cannot be\nused.\nn If iteration is ever used on a WeakKeyDictionary or WeakValueDictionary,\ngreat care should be taken to ensure that the dictionary does not change size\nbecause this may produce bizarre side effects such as items mysteriously disap-\npearing from the dictionary for no apparent reason.\nn If an exception occurs during the execution of a callback registered with ref()\nor proxy(), the exception is printed to standard error and ignored.\nn Weak references are hashable as long as the original object is hashable. Moreover,\nthe weak reference will maintain its hash value after the original object has been\ndeleted, provided that the original hash value is computed while the object still\nexists.\nn Weak references can be tested for equality but not for ordering. If the objects are\nstill alive, references are equal if the underlying objects have the same value.\nOtherwise, references are equal if they are the same reference.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1839,
      "extraction_method": "Direct"
    },
    {
      "page_number": 268,
      "chapter": null,
      "content": "14\nMathematics\nThis chapter describes modules for performing various kinds of mathematical opera-\ntions. In addition, the decimal module, which provides generalized support for decimal\nfloating-point numbers, is described.\ndecimal\nThe Python float data type is represented using a double-precision binary floating-\npoint encoding (usually as defined by the IEEE 754 standard).A subtle consequence of\nthis encoding is that decimal values such as 0.1 can’t be represented exactly. Instead, the\nclosest value is 0.10000000000000001.This inexactness carries over to calculations\ninvolving floating-point numbers and can sometimes lead to unexpected results (for\nexample, 3*0.1 == 0.3 evaluates as False).\nThe decimal module provides an implementation of the IBM General Decimal\nArithmetic Standard, which allows for the exact representation of decimals. It also gives\nprecise control over mathematical precision, significant digits, and rounding behavior.\nThese features can be useful if interacting with external systems that precisely define\nproperties of decimal numbers. For example, if writing Python programs that must\ninteract with business applications.\nThe decimal module defines two basic data types: a Decimal type that represents a\ndecimal number and a Context type that represents various parameters concerning\ncomputation such as precision and round-off error-handling. Here are a few simple\nexamples that illustrate the basics of how the module works:\nimport decimal\nx = decimal.Decimal('3.4')     # Create some decimal numbers\ny = decimal.Decimal('4.5')\n# Perform some math calculations using the default context\na = x * y        # a = decimal.Decimal('15.30')\nb = x / y        # b = decimal.Decimal('0.7555555555555555555555555556')\n# Change the precision and perform calculations\ndecimal.getcontext().prec = 3\nc = x * y        # c = decimal.Decimal('15.3')\nd = x / y        # d = decimal.Decimal('0.756')\n# Change the precision for just a single block of statements\nwith decimal.localcontext(decimal.Context(prec=10)):\ne = x * y   # e = decimal.Decimal('15.30')\nf = x / y   # f = decimal.Decimal('0.7555555556')\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2148,
      "extraction_method": "Direct"
    },
    {
      "page_number": 269,
      "chapter": null,
      "content": "244\nChapter 14 Mathematics\nDecimal Objects\nDecimal numbers are represented by the following class:\nDecimal([value [, context]])\nvalue is the value of the number specified as either an integer, a string containing a\ndecimal value such as '4.5', or a tuple (sign, digits, exponent). If a tuple is sup-\nplied, sign is 0 for positive, 1 for negative; digits is a tuple of digits specified as \nintegers; and exponent is an integer exponent.The special strings 'Infinity',\n'-Infinity', 'NaN', and 'sNaN' may be used to specify positive and negative infinity\nas well as Not a Number (NaN). 'sNaN' is a variant of NaN that results in an excep-\ntion if it is ever subsequently used in a calculation.An ordinary float object may not\nbe used as the initial value because that value may not be exact (which defeats the pur-\npose of using decimal in the first place).The context parameter is a Context object,\nwhich is described later. If supplied, context determines what happens if the initial\nvalue is not a valid number—raising an exception or returning a decimal with the value\nNaN.\nThe following examples show how to create various decimal numbers:\na = decimal.Decimal(42)               # Creates Decimal(\"42\")\nb = decimal.Decimal(\"37.45\")          # Creates Decimal(\"37.45\")\nc = decimal.Decimal((1,(2,3,4,5),-2)) # Creates Decimal(\"-23.45\")\nd = decimal.Decimal(\"Infinity\")\ne = decimal.Decimal(\"NaN\")\nDecimal objects are immutable and have all the usual numeric properties of the built-in\nint and float types.They can also be used as dictionary keys, placed in sets, sorted,\nand so forth. For the most part, you manipulate Decimal objects using the standard\nPython math operators. However, the methods in the following list can be used to carry\nout several common mathematical operations.All operations take an optional context\nparameter that controls the behavior of precision, rounding, and other aspects of the cal-\nculation. If omitted, the current context is used.\nMethod\nDescription\nx.exp([context])\nNatural exponent e**d\nx.fma(y, z [, context])\nx*y + z with no rounding of x*y component\nx.ln([context])\nNatural logarithm (base e) of x\nx.log10([context])\nBase-10 logarithm of x\nx.sqrt([context])\nSquare root of x\nContext Objects\nVarious properties of decimal numbers, such as rounding and precision, are controlled\nthrough the use of a Context object:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2373,
      "extraction_method": "Direct"
    },
    {
      "page_number": 270,
      "chapter": null,
      "content": "245\ndecimal\nContext(prec=None, rounding=None, traps=None, flags=None,\nEmin=None, Emax=None, capitals=1)\nThis creates a new decimal context.The parameters should be specified using keyword\narguments with the names shown. prec is an integer that sets the number of digits of\nprecision for arithmetic operations, rounding determines the rounding behavior, and\ntraps is a list of signals that produce a Python exception when certain events occur\nduring computation (such as division by zero). flags is a list of signals that indicate the\ninitial state of the context (such as overflow). Normally, flags is not specified. Emin\nand Emax are integers representing the minimum and maximum range for exponents,\nrespectively. capitals is a boolean flag that indicates whether to use 'E' or 'e' for\nexponents.The default is 1 ('E').\nNormally, new Context objects aren’t created directly. Instead, the function \ngetcontext() or localcontext() is used to return the currently active Context\nobject.That object is then modified as needed. Examples of this appear later in this sec-\ntion. However, in order to better understand those examples, it is necessary to explain\nthese context parameters in further detail.\nRounding behavior is determined by setting the rounding parameter to one of the\nfollowing values:\nConstant\nDescription\nROUND_CEILING\nRounds toward positive infinity. For example, 2.52 rounds up to\n2.6 and -2.58 rounds up to -2.5.\nROUND_DOWN\nRounds toward zero. For example, 2.58 rounds down to 2.5 and \n-2.58 rounds up to -2.5.\nROUND_FLOOR\nRounds toward negative infinity. For example, 2.58 rounds down\nto 2.5 and -2.52 rounds down to -2.6.\nROUND_HALF_DOWN\nRounds away from zero if the fractional part is greater than half;\notherwise, rounds toward zero. For example, 2.58 rounds up to\n2.6, 2.55 rounds down to 2.5 -2.55 rounds up to -2.5, and -2.58\nrounds down to -2.6.\nROUND_HALF_EVEN\nThe same as ROUND_HALF_DOWN except that if the fractional part\nis exactly half, the result is rounded down if the preceding digit is\neven and rounded up if the preceding digit is odd. For example,\n2.65 is rounded down to 2.6 and 2.55 is rounded up to 2.6.\nROUND_HALF_UP\nThe same as ROUND_HALF_DOWN except that if the fractional part\nis exactly half, it is rounded away from zero. For example 2.55\nrounds up to 2.6, and -2.55 rounds down to -2.6.\nROUND_UP\nRounds away from zero. For example, 2.52 rounds up to 2.6 and -\n2.52 rounds down to -2.6.\nROUND_05UP\nRounds away from zero if the last digit after toward zero would\nhave been 0 or 5. Otherwise, rounds toward zero. For example,\n2.54 rounds to 2.6 and 2.64 rounds to 2.6.\nThe traps and flags parameters of Context() are lists of signals.A signal represents a\ntype of arithmetic exception that may occur during computation. Unless listed in\ntraps, signals are ignored. Otherwise, an exception is raised.The following signals are\ndefined:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2899,
      "extraction_method": "Direct"
    },
    {
      "page_number": 271,
      "chapter": null,
      "content": "246\nChapter 14 Mathematics\nSignal\nDescription\nClamped\nExponent adjusted to fit the allowed range.\nDivisionByZero\nDivision of non-infinite number by 0.\nInexact\nRounding error occurred.\nInvalidOperation\nInvalid operation performed.\nOverflow\nExponent exceeds Emax after rounding. Also generates\nInexact and Rounded.\nRounded\nRounding occurred. May occur even if no information was lost\n(for example, “1.00 “ rounded to “1.0”).\nSubnormal\nExponent is less than Emin prior to rounding.\nUnderflow\nNumerical underflow. Result rounded to 0. Also generates\nInexact and Subnormal.\nThese signal names correspond to Python exceptions that can be used for error check-\ning. Here’s an example:\ntry:\nx = a/b\nexcept decimal.DivisionByZero:\nprint \"Division by zero\"\nLike exceptions, the signals are organized into a hierarchy:\nArithmeticError (built-in exception)\nDecimalException\nClamped\nDivisionByZero\nInexact\nOverflow\nUnderflow\nInvalidOperation\nRounded\nOverflow\nUnderflow\nSubnormal\nUnderflow\nThe Overflow and Underflow signals appear more than once in the table because\nthose signals also result in the parent signal (for example, an Underflow also signals\nSubnormal).The decimal.DivisionByZero signal also derives from the built-in\nDivisionByZero exception.\nIn many cases, arithmetic signals are silently ignored. For instance, a computation\nmay produce a round-off error but generate no exception. In this case, the signal names\ncan be used to check a set of sticky flags that indicate computation state. Here’s an\nexample:\nctxt = decimal.getcontext()       # Get current context\nx = a + b\nif ctxt.flags[Rounded]:\nprint \"Result was rounded!\"\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1650,
      "extraction_method": "Direct"
    },
    {
      "page_number": 272,
      "chapter": null,
      "content": "247\ndecimal\nWhen flags get set, they stay set until they are cleared using the clear_flags()\nmethod.Thus, one could perform an entire sequence of calculations and only check for\nerrors at the end.\nThe settings on an existing Context object c can be changed through the following\nattributes and methods:\nc.capitals\nFlag set to 1 or 0 that determines whether to use E or e as the exponent character.\nc.Emax\nInteger specifying maximum exponent.\nc.Emin\nInteger specifying minimum exponent.\nc.prec\nInteger specifying digits of precision.\nc.flags\nDictionary containing current flag values corresponding to signals. For example,\nc.flags[Rounded] returns the current flag value for the Rounded signal.\nc.rounding\nRounding rule in effect.An example is ROUND_HALF_EVEN.\nc.traps\nDictionary containing True/False settings for the signals that result in Python excep-\ntions. For example, c.traps[DivisionByZero] is usually True, whereas\nc.traps[Rounded] is False.\nc.clear_flags()\nResets all sticky flags (clears c.flags).\nc.copy()\nReturns a copy of context c.\nc.create_decimal(value)\nCreates a new Decimal object using c as the context.This may be useful in generating\nnumbers whose precision and rounding behavior override that of the default context.\nFunctions and Constants\nThe following functions and constants are defined by the decimal module.\ngetcontext()\nReturns the current decimal context. Each thread has its own decimal context so this\nreturns the context of the calling thread.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1500,
      "extraction_method": "Direct"
    },
    {
      "page_number": 273,
      "chapter": null,
      "content": "248\nChapter 14 Mathematics\nlocalcontext([c])\nCreates a context manager that sets the current decimal context to a copy of c for state-\nments defined inside the body of a with statement. If c is omitted, a copy of the cur-\nrent context is created. Here is an example of using this function that temporarily sets\nthe precision to five decimal places for a series of statements:\nwith localcontext() as c:\nc.prec = 5\nstatements\nsetcontext(c)\nSets the decimal context of the calling thread to c.\nBasicContext\nA premade context with nine digits of precision. Rounding is ROUND_HALF_UP; Emin is\n-999999999; Emax is 999999999; and all traps are enabled except for Inexact,\nRounded, and Subnormal.\nDefaultContext\nThe default context used when creating new contexts (the values stored here are used\nas default values for the new context). Defines 28 digits of precision; ROUND_HALF_EVEN\nrounding; and traps for Overflow, InvalidOperation, and DivisionByZero.\nExtendedContext\nA premade context with nine digits of precision. Rounding is ROUND_HALF_EVEN, Emin\nis -999999999, Emax is 999999999, and all traps are disabled. Never raises exceptions.\nInstead, results may be set to NaN or Infinity.\nInf\nThe same as Decimal(\"Infinity\").\nnegInf\nThe same as Decimal(\"-Infinity\").\nNaN\nThe same as Decimal(\"NaN\").\nExamples\nHere are some more examples showing basic usage of decimal numbers:\n>>> a = Decimal(\"42.5\")\n>>> b = Decimal(\"37.1\")\n>>> a + b\nDecimal(\"79.6\")\n>>> a / b\nDecimal(\"1.145552560646900269541778976\")\n>>> divmod(a,b)\n(Decimal(\"1\"), Decimal(\"5.4\"))\n>>> max(a,b)\nDecimal(\"42.5\")\n>>> c = [Decimal(\"4.5\"), Decimal(\"3\"), Decimal(\"1.23e3\")]\n>>> sum(c)\nDecimal(\"1237.5\")\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1680,
      "extraction_method": "Direct"
    },
    {
      "page_number": 274,
      "chapter": null,
      "content": "249\ndecimal\n>>> [10*x for x in c]\n[Decimal(\"45.0\"), Decimal(\"30\"), Decimal(\"1.230e4\")]\n>>> float(a)\n42.5\n>>> str(a)\n'42.5'\nHere’s an example of changing parameters in the context:\n>>> getcontext().prec = 4\n>>> a = Decimal(\"3.4562384105\")\n>>> a\nDecimal(\"3.4562384105\")\n>>> b = Decimal(\"5.6273833\")\n>>> getcontext().flags[Rounded]\n0\n>>> a + b\n9.084\n>>> getcontext().flags[Rounded]\n1\n>>> a / Decimal(\"0\")\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in ?\ndecimal.DivisionByZero: x / 0\n>>> getcontext().traps[DivisionByZero] = False\n>>> a / Decimal(\"0\")\nDecimal(\"Infinity\")\nNotes\nn The Decimal and Context objects have a large number of methods related to\nlow-level details concerning the representation and behavior of decimal opera-\ntions.These have not been documented here because they are not essential for\nthe basic use of this module. However, you should consult the online documenta-\ntion at http://docs.python.org/library/decimal.html for more information.\nn The decimal context is unique to each thread. Changes to the context only affect\nthat thread and not others.\nn A special number, Decimal(\"sNaN\"), may be used as a signaled-NaN.This num-\nber is never generated by any of the built-in functions. However, if it appears in a\ncomputation, an error is always signaled.You can use this to indicate invalid com-\nputations that must result in an error and must not be silently ignored. For exam-\nple, a function could return sNaN as a result.\nn The value of 0 may be positive or negative (that is, Decimal(0) and Decimal\n(\"-0\")).The distinct zeros still compare as equals.\nn This module is probably unsuitable for high-performance scientific computing\ndue to the significant amount of overhead involved in calculations.Also, there is\noften little practical benefit in using decimal floating point over binary floating\npoint in such applications.\nn A full mathematical discussion of floating-point representation and error analysis\nis beyond the scope of this book. Readers should consult a book on numerical\nanalysis for further details.The article “What Every Computer Scientist Should\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2128,
      "extraction_method": "Direct"
    },
    {
      "page_number": 275,
      "chapter": null,
      "content": "250\nChapter 14 Mathematics\nKnow About Floating-Point Arithmetic” by David Goldberg, in Computing\nSurveys,Association for Computing Machinery, March 1991 is also a worthy read\n(this article is easy to find on the Internet if you simply search for the title).\nn The IBM General Decimal Arithmetic Specification contains more information\nand can be easily located online through search engines.\nfractions\nThe fractions module defines a class Fraction that represents a rational number.\nInstances can be created in three different ways using the class constructor:\nFraction([numerator [,denominator]])\nCreates a new rational number. numerator and denominator have integral values and\ndefault to 0 and 1, respectively.\nFraction(fraction)\nIf fraction is an instance of numbers.Rational, creates a new rational number with\nthe same value as fraction.\nFraction(s)\nIf s is a string containing a fraction such as \"3/7\" or \"-4/7\", a fraction with the same\nvalue is created. If s is a decimal number such as \"1.25\", a fraction with that value is\ncreated (e.g., Fraction(5,4)).\nThe following class methods can create Fraction instances from other types of\nobjects:\nFraction.from_float(f)\nCreates a fraction representing the exact value of the floating-point number f.\nFraction.from_decimal(d)\nCreates a fraction representing the exact value of the Decimal number d.\nHere are some examples of using these functions:\n>>> f = fractions.Fraction(3,4)\n>>> g = fractions.Fraction(\"1.75\")\n>>> g\nFraction(7, 4)\n>>> h = fractions.Fraction.from_float(3.1415926)\nFraction(3537118815677477, 1125899906842624)\n>>>\nAn instance f of Fraction supports all of the usual mathematical operations.The\nnumerator and denominator are stored in the f.numerator and f.denominator\nattributes, respectively. In addition, the following method is defined:\nf.limit_denominator([max_denominator])\nReturns the fraction that has the closest value to f. max_denominator specifies the\nlargest denominator to use and defaults to 1000000.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2011,
      "extraction_method": "Direct"
    },
    {
      "page_number": 276,
      "chapter": null,
      "content": "251\nmath\nHere are some examples of using Fraction instances (using the values created in\nthe earlier example):\n>>> f + g\nFraction(5, 2)\n>>> f * g\nFraction(21, 16)\n>>> h.limit_denominator(10)\nFraction(22, 7)\n>>>\nThe fractions module also defines a single function:\ngcd(a, b)\nComputes the greatest common divisor of integers a and b.The result has the same sign\nas b if b is nonzero; otherwise, it’s the same sign as a.\nmath\nThe math module defines the following standard mathematical functions.These func-\ntions operate on integers and floats but don’t work with complex numbers (a separate\nmodule cmath can be used to perform similar operations on complex numbers).The\nreturn value of all functions is a float.All trigonometric functions assume the use of\nradians.\nFunction\nDescription\nacos(x)\nReturns the arc cosine of x.\nacosh(x)\nReturns the hyperbolic arc cosine of x.\nasin(x)\nReturns the arc sine of x.\nasinh(x)\nReturns the hyperbolic arc sine of x.\natan(x)\nReturns the arc tangent of x.\natan2(y, x)\nReturns atan(y / x).\natanh(x)\nReturns the hyperbolic arc tangent of x.\nceil(x)\nReturns the ceiling of x.\ncopysign(x,y)\nReturns x with the same sign as y.\ncos(x)\nReturns the cosine of x.\ncosh(x)\nReturns the hyperbolic cosine of x.\ndegrees(x)\nConverts x from radians to degrees.\nradians(x)\nConverts x from degrees to radians.\nexp(x)\nReturns e ** x.\nfabs(x)\nReturns the absolute value of x.\nfactorial(x)\nReturns x factorial.\nfloor(x)\nReturns the floor of x.\nfmod(x, y)\nReturns x % y as computed by the C fmod() function.\nfrexp(x)\nReturns the positive mantissa and exponent of x as a tuple.\nfsum(s)\nReturns the full precision sum of floating-point values in the iter-\nable sequence s. See the following note for a description.\nhypot(x, y)\nReturns the Euclidean distance, sqrt(x * x + y * y).\ncontinues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1824,
      "extraction_method": "Direct"
    },
    {
      "page_number": 277,
      "chapter": null,
      "content": "252\nChapter 14 Mathematics\nFunction\nDescription\nisinf(x)\nReturn True if x is infinity.\nisnan(x)\nReturns True if x is NaN.\nldexp(x, i)\nReturns x * (2 ** i).\nlog(x [, base])\nReturns the logarithm of x to the given base. If base is omitted,\nthis function computes the natural logarithm.\nlog10(x)\nReturns the base 10 logarithm of x.\nlog1p(x)\nReturns the natural logarithm of 1+x.\nmodf(x)\nReturns the fractional and integer parts of x as a tuple. Both\nhave the same sign as x.\npow(x, y)\nReturns x ** y.\nsin(x)\nReturns the sine of x.\nsinh(x)\nReturns the hyperbolic sine of x.\nsqrt(x)\nReturns the square root of x.\ntan(x)\nReturns the tangent of x.\ntanh(x)\nReturns the hyperbolic tangent of x.\ntrunc(x)\nTruncates x to the nearest integer towards 0.\nThe following constants are defined:\nConstant\nDescription\npi\nMathematical constant pi\ne\nMathematical constant e\nNotes\nn The floating-point values +inf, -inf, and nan can be created by passing strings\ninto the float() function—for example, float(\"inf\"), float(\"-inf\"), or\nfloat(\"nan\").\nn The math.fsum() function is more accurate than the built-in sum() function\nbecause it uses a different algorithm that tries to avoid floating-point errors intro-\nduced by cancellation effects. For example, consider the sequence s = [1,\n1e100, -1e100]. If you use sum(s), you will get a result of 0.0 (because the\nvalue of 1 is lost when added to the large value 1e100). However, using\nmath.sum(s) produces the correct result of 1.0.The algorithm used by\nmath.sum() is described in “Adaptive Precision Floating-Point Arithmetic and\nFast Robust Geometric Predicates” by Jonathan Richard Shewchuk, Carnegie\nMellon University School of Computer Science Technical Report CMU-CS-96-\n140, 1996.\nnumbers\nThe numbers module defines a series of abstract base classes that serve to organize vari-\nous kinds of numbers.The numeric classes are organized into a hierarchy in which each\nlevel progressively adds more capabilities.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1966,
      "extraction_method": "Direct"
    },
    {
      "page_number": 278,
      "chapter": null,
      "content": "253\nnumbers\nNumber\nA class that serves as the top of the numeric hierarchy.\nComplex\nA class that represents the complex numbers. Numbers of this type have real and imag\nattributes.This class inherits from Number.\nReal\nA class that represents the real numbers. Inherits from Complex.\nRational\nA class that represents fractions. Numbers of this type have numerator and\ndenominator attributes. Inherits from Real.\nIntegral\nA class that represents the integers. Inherits from Rational.\nThe classes in this module are not meant to be instantiated. Instead, they can be used\nto perform various kinds of type checks on values. For example:\nif isinstance(x, numbers.Number)     # x is any kind of number\nstatements\nif isinstance(x, numbers.Integral)   # x is an integral value\nstatements\nIf one of these type checks returns True, it means that x is compatible with all of the\nusual mathematical operations associated with that type and that a conversion to one of\nthe built-in types such as complex(), float(), or int() will work.\nThe abstract base classes can also be used as a base class for user-defined classes that\nare meant to emulate numbers. Doing this is not only just a good idea for type check-\ning, but it adds extra safety checks that make sure you implement all of the required\nmethods. For example:\n>>> class Foo(numbers.Real): pass\n...\n>>> f = Foo()\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: Can't instantiate abstract class Foo with abstract methods\n_ _abs_ _, _ _add_ _, _ _div_ _, _ _eq_ _, _ _float_ _, _ _floordiv_ _, _ _le_ _, _ _lt_ _,\n_ _mod_ _, _ _mul_ _, _ _neg_ _, _ _pos_ _, _ _pow_ _, _ _radd_ _, _ _rdiv_ _, \n➥_ _rfloordiv_ _,\n_ _rmod_ _, _ _rmul_ _, _ _rpow_ _, _ _rtruediv_ _, _ _truediv_ _, _ _trunc_ _\n>>>\nNotes\nn Refer to Chapter 7 (“Classes and Object-Oriented Programming”) for more\ninformation on abstract base classes.\nn PEP 3141 (http://www.python.org/dev/peps/pep-3141) has more information\nabout the type hierarchy and intended use of this module.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2044,
      "extraction_method": "Direct"
    },
    {
      "page_number": 279,
      "chapter": null,
      "content": "254\nChapter 14 Mathematics\nrandom\nThe random module provides a variety of functions for generating pseudo-random\nnumbers as well as functions for randomly generating values according to various distri-\nbutions on the real numbers. Most of the functions in this module depend on the func-\ntion random(), which generates uniformly distributed numbers in the range [0.0, 1.0)\nusing the Mersenne Twister generator.\nSeeding and Initialization\nThe following functions are used to control the state of the underlying random number\ngenerator:\nseed([x])\nInitializes the random number generator. If x is omitted or None, the system time is\nused to seed the generator. Otherwise, if x is an integer or long integer, its value is used.\nIf x is not an integer, it must be a hashable object and the value of hash(x) is used as a\nseed.\ngetstate()\nReturns an object representing the current state of the generator.This object can later\nbe passed to setstate() to restore the state.\nsetstate(state)\nRestores the state of the random number generator from an object returned by \ngetstate().\njumpahead(n)\nQuickly changes the state of the generator to what it would be if random() were called\nn times in a row. n must be a nonnegative integer.\nRandom Integers\nThe following functions are used to manipulate random integers.\ngetrandbits(k)\nCreates a long integer containing k random bits.\nrandint(a,b)\nReturns a random integer, x, in the range a <= x <= b.\nrandrange(start,stop [,step])\nReturns a random integer in range(start,stop,step). Does not include the end-\npoint.\nRandom Sequences\nThe following functions are used to randomize sequence data.\nchoice(seq)\nReturns a random element from the nonempty sequence seq.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1719,
      "extraction_method": "Direct"
    },
    {
      "page_number": 280,
      "chapter": null,
      "content": "255\nrandom\nsample(s, len)\nReturns a sequence length, len, containing elements chosen randomly from the\nsequence s.The elements in the resulting sequence are placed in the order in which\nthey were selected.\nshuffle(x [,random])\nRandomly shuffles the items in the list x in place. random is an optional argument that\nspecifies a random generation function. If supplied, it must be a function that takes no\narguments and returns a floating-point number in the range [0.0, 1.0).\nReal-Valued Random Distributions\nThe following functions generate random numbers on real numbers. Distribution and\nparameter names correspond to the standard names used in probability and statistics.You\nwill need to consult an appropriate text to find out more details.\nrandom()\nReturns a random number in the range [0.0, 1.0).\nuniform(a,b)\nReturns a uniformly distributed random number in the range [a, b).\nbetavariate(alpha, beta)\nReturns a value between 0 and 1 from the Beta distribution. alpha > -1 and beta >\n-1.\ncunifvariate(mean, arc)\nCircular uniform distribution. mean is the mean angle, and arc is the range of the dis-\ntribution, centered around the mean angle. Both of these values must be specified in\nradians in the range between 0 and pi. Returned values are in the range (mean\n- arc/2, mean + arc/2).\nexpovariate(lambd)\nExponential distribution. lambd is 1.0 divided by the desired mean. Returns values in\nthe range [0, +Infinity).\ngammavariate(alpha, beta)\nGamma distribution. alpha > -1, beta > 0.\ngauss(mu, sigma)\nGaussian distribution with mean mu and standard deviation sigma. Slightly faster than\nnormalvariate().\nlognormvariate(mu, sigma)\nLog normal distribution.Taking the natural logarithm of this distribution results in a\nnormal distribution with mean mu and standard deviation sigma.\nnormalvariate(mu, sigma)\nNormal distribution with mean mu and standard deviation sigma.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1898,
      "extraction_method": "Direct"
    },
    {
      "page_number": 281,
      "chapter": null,
      "content": "256\nChapter 14 Mathematics\nparetovariate(alpha)\nPareto distribution with shape parameter alpha.\ntriangular([low [, high [, mode]]])\nTriangular distribution.A random number n in the range low <= n < high with\nmode mode. By default, low is 0, high is 1.0, and mode is set to the midpoint of low\nand high.\nvonmisesvariate(mu, kappa)\nvon Mises distribution, where mu is the mean angle in radians between 0 and 2 * pi\nand kappa is a nonnegative concentration factor. If kappa is zero, the distribution\nreduces to a uniform random angle over the range 0 to 2 * pi.\nweibullvariate(alpha, beta)\nWeibull distribution with scale parameter alpha and shape parameter beta.\nNotes\nn The functions in this module are not thread-safe. If you are generating random\nnumbers in different threads, you should use locking to prevent concurrent\naccess.\nn The period of the random number generator (before numbers start repeating) is\n2**19937–1.\nn The random numbers generated by this module are deterministic and should not\nbe used for cryptography.\nn New types of random number generators can be created by subclassing \nrandom.Random and implementing the random(), seed(), getstate(),\ngetstate(), and jumpahead() methods.All the other functions in this module\nare actually internally implemented as methods of Random.Thus, they could be\naccessed as methods of an instance of the new random number generator.\nn The module provides two alternative random number generators classes—\nWichmannHill and SystemRandom—that are used by instantiating the appropri-\nate class and calling the preceding functions as methods.The WichmannHill class\nimplements the Wichmann-Hill generator that was used in earlier Python releas-\nes.The SystemRandom class generates random numbers using the system random\nnumber generator os.urandom().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1821,
      "extraction_method": "Direct"
    },
    {
      "page_number": 282,
      "chapter": null,
      "content": "15\nData Structures, Algorithms,\nand Code Simplification\nThe modules in this chapter are used to address common programming problems\nrelated to data structures; algorithms; and the simplification of code involving iteration,\nfunction programming, context managers, and classes.These modules should be viewed\nas a extension of Python’s built-in types and functions. In many cases, the underlying\nimplementation is highly efficient and may be better suited to certain kinds of problems\nthan what is available with the built-ins.\nabc\nThe abc module defines a metaclass and a pair of decorators for defining new abstract\nbase classes.\nABCMeta\nA metaclass that represents an abstract base class.To define an abstract class, you define a\nclass that uses ABCMeta as a metaclass. For example:\nimport abc\nclass Stackable:                  # In Python 3, use the syntax\n_ _metaclass_ _ = abc.ABCMeta   # class Stackable(metaclass=abc.ABCMETA)\n...\nA class created in this manner differs from an ordinary class in a few critical ways:\nn First, if the abstract class defines methods or properties that are decorated with\nthe abstractmethod and abstractproperty decorators described later, then\ninstances of derived classes can’t be created unless those classes provide a non-\nabstract implementation of those methods and properties.\nn Second, an abstract class has a class method register(subclass) that can be\nused to register additional types as a logical subclass. For any type subclass reg-\nistered with this function, the operation isinstance(x, AbstractClass) will\nreturn True if x is an instance of subclass.\nn A final feature of abstract classes is that they can optionally define a special class\nmethod _ _subclasshook_ _(cls, subclass).This method should return\nTrue if the type subclass is considered to be a subclass, return False if\nsubclass is not a subclass, or raise a NotImplemented exception if nothing is\nknown.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1939,
      "extraction_method": "Direct"
    },
    {
      "page_number": 283,
      "chapter": null,
      "content": "258\nChapter 15 Data Structures, Algorithms, and Code Simplification\nabstractmethod(method)\nA decorator that declares method to be abstract.When used in an abstract base class,\nderived classes defined directly via inheritance can only be instantiated if they define a\nnonabstract implementation of the method.This decorator has no effect on subclasses\nregistered using the register() method of an abstract base.\nabstractproperty(fget [, fset [, fdel [, doc]]])\nCreates an abstract property.The parameters are the same as the normal property()\nfunction.When used in an abstract base, derived classes defined directly via inheritance\ncan only be instantiated if they define a nonabstract implementation of the property.\nThe following code provides an example of defining a simple abstract class:\nfrom abc import ABCMeta, abstractmethod, abstractproperty\nclass Stackable:                 # In Python 3, use the syntax\n_ _metaclass_ _ = ABCMeta      # class Stackable(metaclass=ABCMeta)\n@abstractmethod\ndef push(self,item):\npass\n@abstractmethod\ndef pop(self):\npass\n@abstractproperty\ndef size(self):\npass\nHere is an example of a class that derives from Stackable:\nclass Stack(Stackable):\ndef _ _init_ _(self):\nself.items = []\ndef push(self,item):\nself.items.append(item)\ndef pop(self):\nreturn self.items.pop()\nHere is the error message that you get if you try to create a Stack:\n>>> s = Stack()\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: Can't instantiate abstract class Stack with abstract methods size\n>>>\nThis error can be fixed by adding a size() property to Stack.You can either do this\nby modifying the definition of Stack itself or inheriting from it and adding the\nrequired method or property:\nclass CompleteStack(Stack):\n@property\ndef size(self):\nreturn len(self.items)\nHere is an example of using the complete stack object:\n>>> s = CompleteStack()\n>>> s.push(\"foo\")\n>>> s.size\n1\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1948,
      "extraction_method": "Direct"
    },
    {
      "page_number": 284,
      "chapter": null,
      "content": "259\narray\nSee Also:\nChapter 7, “Classes and Object-Oriented Programming,” numbers (p. 252),\ncollections (p. 262).\narray\nThe array module defines a new object type, array, that works almost exactly like a\nlist, except that its contents are constrained to a single type.The type of an array is\ndetermined at the time of creation, using one of the type codes shown in Table 15.1.\nTable 15.1 Type Codes\nType Code\nDescription\nC Type\nMinimum Size (in Bytes)\n'c'\n8-bit character\nchar\n1\n'b'\n8-bit integer\nsigned char\n1\n'B'\n8-bit unsigned integer\nunsigned char\n1\n'u'\nUnicode character\nPY_UNICODE\n2 or 4\n'h'\n16-bit integer\nshort\n2\n'H'\n16-bit unsigned integer\nunsigned short\n2\n'i'\nInteger\nint\n4 or 8\n'I'\nUnsigned integer\nunsigned int\n4 or 8\n'l'\nLong integer\nlong\n4 or 8\n'L'\nUnsigned long integer\nunsigned long\n4 or 8\n'f'\nSingle-precision float\nfloat\n4\n'd'\nDouble-precision float\ndouble\n8\nThe representation of integers and long integers is determined by the machine architec-\nture (they may be 32 or 64 bits).When values stored as 'L' or 'I' are returned, they’re\nreturned as long integers in Python 2.\nThe module defines the following type:\narray(typecode [, initializer])\nCreates an array of type typecode. initializer is a string or list of values used to\ninitialize values in the array.The following attributes and methods apply to an array\nobject, a:\nItem\nDescription\na.typecode\nType code character used to create the array.\na.itemsize\nSize of items stored in the array (in bytes).\na.append(x)\nAppends x to the end of the array.\na.buffer_info()\nReturns (address, length), giving the memory location and\nlength of the buffer used to store the array.\na.byteswap()\nSwaps the byte ordering of all items in the array from big-endian\nto little-endian, or vice versa. This is only supported for integer\nvalues.\ncontinues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1830,
      "extraction_method": "Direct"
    },
    {
      "page_number": 285,
      "chapter": null,
      "content": "260\nChapter 15 Data Structures, Algorithms, and Code Simplification\nItem\nDescription\na.count(x)\nReturns the number of occurrences of x in a.\na.extend(b)\nAppends b to the end of array a. b can be an array or an iterable\nobject whose elements are the same type as in a.\na.fromfile(f, n) Reads n items (in binary format) from the file object f and\nappends to the end of the array. f must be a file object. Raises\nEOFError if fewer than n items can be read.\na.fromlist(list) Appends items from list to the end of the array. list can be\nany iterable object.\na.fromstring(s)\nAppends items from string s, where s is interpreted as a string \nof binary values—same as would have been read using \nfromfile().\na.index(x)\nReturns the index of the first occurrence of x in a. Raises\nValueError if not found.\na.insert(i, x)\nInserts x before position i.\na.pop([i])\nRemoves item i from the array and returns it. If i is omitted, the\nlast element is removed.\na.remove(x)\nRemoves the first occurrence of x from the array. Raises\nValueError if not found.\na.reverse()\nReverses the order of the array.\na.tofile(f)\nWrites all items to file f. Data is saved in native binary format.\na.tolist()\nConverts the array to an ordinary list of values.\na.tostring()\nConverts to a string of binary data—the same data as would be\nwritten using tofile().\na.tounicode()\nConverts the array to a Unicode string. Raises ValueError if the\narray is not of type 'u'.\nWhen items are inserted into an array, a TypeError exception is generated if the type\nof the item doesn’t match the type used to create the array.\nThe array module is useful if you need to have space-efficient storage for lists of\ndata and you know that all items in the list are going to be the same type. For example,\nstoring 10 million integers in a list requires about 160MB of memory whereas an array\nof 10 million integers requires only 40MB. Despite this space savings, none of the basic\noperations on an array tend to be faster than their list counterparts—in fact, they may\nbe slower.\nIn performing calculations with arrays, you will want to be careful with operations\nthat create lists. For example, using a list comprehension on an array will convert the\nentire array into a list, defeating any space-saving benefit.A better way to handle this is\nto create new arrays using generator expressions. For example:\na = array.array(\"i\", [1,2,3,4,5])\nb = array.array(a.typecode, (2*x for x in a))   # Create a new array from b\nBecause the point of using an array is to save space, it may be more desirable to perform\n“in-place” operations.An efficient way to do this is with code that uses enumerate(),\nlike this:\na = array.array(\"i\", [1,2,3,4,5])\nfor i, x in enumerate(a): \na[i] = 2*x\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2737,
      "extraction_method": "Direct"
    },
    {
      "page_number": 286,
      "chapter": null,
      "content": "261\nbisect\nFor large arrays, this in-place modification runs about 15 percent faster than the code\nthat creates a new array with a generator expression.\nNotes\nn The arrays created by this module are not suitable for numeric work such as\nmatrix or vector math. For example, the addition operator doesn’t add the corre-\nsponding elements of the arrays; instead, it appends one array to the other.To cre-\nate storage and calculation efficient arrays, use the numpy extension available at\nhttp://numpy.sourceforge.net/. Note that the numpy API is completely different.\nn The += operator can be used to append the contents of another array.The *=\noperator can be used to repeat an array.\nSee Also:\nstruct (p. 290)\nbisect\nThe bisect module provides support for keeping lists in sorted order. It uses a bisec-\ntion algorithm to do most of its work.\nbisect(list, item [, low [, high]])\nReturns the index of the insertion point for item to be placed in list in order to\nmaintain list in sorted order. low and high are indices specifying a subset of the list\nto examine. If items is already in the list, the insertion point will always be to the right\nof existing entries in the list.\nbisect_left(list, item [, low [, high]])\nReturns the index of the insertion point for item to be placed in list in order to\nmaintain list in sorted order. low and high are indices specifying a subset of the list\nto examine. If items is already in the list, the insertion point will always be to the left\nof existing entries in the list.\nbisect_right(list, item [, low [, high]])\nThe same as bisect().\ninsort(list, item [, low [, high]])\nInserts item into list in sorted order. If item is already in the list, the new entry is\ninserted to the right of any existing entries.\ninsort_left(list, item [, low [, high]])\nInserts item into list in sorted order. If item is already in the list, the new entry is\ninserted to the left of any existing entries.\ninsort_right(list, item [, low [, high]])\nThe same as insort().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2010,
      "extraction_method": "Direct"
    },
    {
      "page_number": 287,
      "chapter": null,
      "content": "262\nChapter 15 Data Structures, Algorithms, and Code Simplification\ncollections\nThe collections module contains high-performance implementations of a few useful\ncontainer types, abstract base classes for various kinds of containers, and a utility func-\ntion for creating name-tuple objects. Each is described in the sections that follow.\ndeque and defaultdict\nTwo new containers are defined in the collections module: deque and\ndefaultdict.\ndeque([iterable [, maxlen]])\nType representing a double-ended queue (deque, pronounced “deck”) object. iterable\nis an iterable object used to populate the deque.A deque allows items to be inserted or\nremoved from either end of the queue.The implementation has been optimized so that\nthe performance of these operations is approximately the same as (O(1)).This is slightly\ndifferent from a list where operations at the front of the list may require shifting of all\nthe elements that follow. If the optional maxlen argument is supplied, the resulting\ndeque object becomes a circular buffer of that size.That is, if new items are added, but\nthere is no more space, items are deleted from the opposite end to make room.\nAn instance, d, of deque has the following methods:\nd.append(x)\nAdds x to the right side of d.\nd.appendleft(x)\nAdds x to the left side of d.\nd.clear()\nRemoves all items from d.\nd.extend(iterable)\nExtends d by adding all the items in iterable on the right.\nd.extendleft(iterable)\nExtends d by adding all the items in iterable on the left. Due to the sequence of left\nappends that occur, items in iterable will appear in reverse order in d.\nd.pop()\nReturns and removes an item from the right side of d. Raises IndexError if d is\nempty.\nd.popleft()\nReturns and removes an item from the left side of d. Raises IndexError if d is empty.\nd.remove(item)\nRemoves the first occurrence of item. Raises ValueError if no match is found.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1904,
      "extraction_method": "Direct"
    },
    {
      "page_number": 288,
      "chapter": null,
      "content": "263\ncollections\nd.rotate(n)\nRotates all the items n steps to the right. If n is negative, items are rotated to the left.\nDeques are often overlooked by many Python programmers. However, this type\noffers many advantages. First, the implementation is highly efficient—even to a level of\nusing internal data structures that provide good processor cache behavior.Appending\nitems at the end is only slightly slower than the built-in list type, whereas inserting\nitems at the front is significantly faster. Operations that add new items to a deque are\nalso thread-safe, making this type appropriate for implementing queues. deques can also\nbe serialized using the pickle module.\ndefaultdict([default_factory], ...)\nA type that is exactly the same as a dictionary except for the handling of missing keys.\nWhen a lookup occurs on a key that does not yet exist, the function supplied as\ndefault_factory is called to provide a default value which is then saved as the value\nof the associated key.The remaining arguments to defaultdict are exactly the same as\nthe built-in dict() function.An instance d of defaultdictionary has the same\noperations as a built-in dictionary.The attribute d.default_factory contains the\nfunction passed as the first argument and can be modified as necessary.\nA defaultdict object is useful if you are trying to use a dictionary as a container\nfor tracking data. For example, suppose you wanted to keep track of the position of\neach word in a string s. Here is how you could use a defaultdict to do this easily:\n>>> from collections import defaultdict\n>>> s = \"yeah but no but yeah but no but yeah\"\n>>> words = s.split()\n>>> wordlocations = defaultdict(list)\n>>> for n, w in enumerate(words):\n...\nwordlocations[w].append(n)\n...\n>>> wordlocations\ndefaultdict(<type 'list'>, {'yeah': [0, 4, 8], 'but': [1, 3, 5, 7], 'no': [2, 6]})\n>>>\nIn this example, the lookup wordlocations[w] will “fail” the first time a word is\nencountered. However, instead of raising a KeyError, the function list supplied as\ndefault_factory is called to create a new value. Built-in dictionaries have a method\nsetdefault() that can be used to achieve a similar result, but it often makes \ncode confusing to read and run slower. For example, the statement that appends \na new item shown previously could be replaced by\nwordlocations.setdefault(w,[]).append(n).This is not nearly as clear and in a\nsimple timing test, it runs nearly twice as slow as using a defaultdict object.\nNamed Tuples\nTuples are frequently used to represent simple data structures. For example, a network\naddress might be represented as a tuple addr = (hostname, port).A common com-\nplaint with tuples is that the individual items have to be accessed by numerical index—\nfor example, addr[0] or addr[1].This leads to code that is confusing to read and hard\nto maintain unless you can remember what all of the index values mean (and the prob-\nlem gets worse the larger the tuple gets).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2970,
      "extraction_method": "Direct"
    },
    {
      "page_number": 289,
      "chapter": null,
      "content": "264\nChapter 15 Data Structures, Algorithms, and Code Simplification\nThe collections module contains a function namedtuple() that is used to create\nsubclasses of tuple in which attribute names can be used to access tuple elements.\nnamedtuple(typename, fieldnames [, verbose])\nCreates a subclass of tuple with name typename. fieldnames is a list of attribute\nnames specified as strings.The names in this list must be valid Python identifiers, must\nnot start with an underscore, and are specified in the same order as the items appearing\nin the tuple—for example, ['hostname','port']. Alternatively, fieldnames can be\nspecified as a string such as 'hostname port' or 'hostname, port'.The value\nreturned by this function is a class whose name has been set to the value supplied in\ntypename.You use this class to create instances of named tuples.The verbose flag, if set\nto True, prints the resulting class definition to standard output.\nHere is an example of using this function:\n>>> from collections import namedtuple\n>>> NetworkAddress = namedtuple('NetworkAddress',['hostname','port'])\n>>> a = NetworkAddress('www.python.org',80)\n>>> a.hostname\n'www.python.org'\n>>> a.port\n80\n>>> host, port = a\n>>> len(a)\n2\n>>> type(a)\n<class '_ _main_ _.NetworkAddress'>\n>>> isinstance(a, tuple)\nTrue\n>>>\nIn this example, the named tuple NetworkAddress is, in every way, indistinguished\nfrom a normal tuple except for the added support of being able to use attribute\nlookup such as a.hostname or a.port to access tuple components.The underlying\nimplementation is efficient—the class that is created does not use an instance dictionary\nor add any additional memory overhead in a built-in tuple.All of the normal tuple\noperations still work.\nA named tuple can be useful if defining objects that really only serve as a data struc-\ntures. For example, instead of a defining a class, like this:\nclass Stock(object):\ndef _ _init_ _(self,name,shares,price):\nself.name = name\nself.shares = shares\nself.price = price\nyou could define a named tuple instead:\nimport collections\nStock = collections.namedtuple('Stock','name shares price')\nBoth versions are going to work in a nearly identical manner. For example, in either\ncase, you would access fields by writing s.name, s.shares, and so on. However, the\nbenefit of the named tuple is that it is more memory-efficient and supports various\ntuple operations such as unpacking (for example, if you had a list of named tuples, you\ncould unpack values in a for-loop with a statement such as for name, shares,\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2550,
      "extraction_method": "Direct"
    },
    {
      "page_number": 290,
      "chapter": null,
      "content": "265\ncollections\nprice in stockList).The downside to a named tuple is that attribute access is not as\nefficient as with a class. For example, accessing s.shares is more than twice as slow if\ns is an instance of a named tuple instead of an ordinary class.\nNamed tuples are frequently used in other parts of the Python standard library. Here,\ntheir use is partly historical—in many library modules, tuples were originally used as the\nreturn value of various functions that would return information about files, stack\nframes, or other low-level details. Code that used these tuples wasn’t always so elegant.\nThus, the switch to a named tuple was made to clean up their usage without breaking\nbackwards compatibility.Another subtle problem with tuples is that once you start using\na tuple, the expected number of fields is locked forever (e.g., if you suddenly add a new\nfield, old code will break).Variants of named tuples have been used in the library to add\nnew fields to the data returned by certain functions. For example, an object might sup-\nport a legacy tuple interface, but then provide additional values that are only available as\nnamed attributes.\nAbstract Base Classes\nThe collections module defines a series of abstract base classes.The purpose of these\nclasses is to describe programming interfaces on various kinds of containers such as lists,\nsets, and dictionaries.There are two primary uses of these classes. First, they can be used\nas a base class for user-defined objects that want to emulate the functionality of built-in\ncontainer types. Second, they can be used for type checking. For example, if you \nwanted to check that s worked like a sequence, you could use isinstance(s,\ncollections.Sequence).\nContainer\nBase class for all containers. Defines a single abstract method _ _contains_ _(), which\nimplements the in operator.\nHashable\nBase class for objects that can be used as a hash table key. Defines a single abstract\nmethod _ _hash_ _().\nIterable\nBase class for objects that support the iteration protocol. Defines a single abstract\nmethod _ _iter_ _().\nIterator\nBase class for iterator objects. Defines the abstract method next() but also inherits\nfrom Iterable and provides a default implementation of _ _iter_ _() that simply\ndoes nothing.\nSized\nBase class for containers whose size can be determined. Defines the abstract method\n_ _len_ _().\nCallable\nBase class for objects that support function call. Defines the abstract method\n_ _call_ _().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2494,
      "extraction_method": "Direct"
    },
    {
      "page_number": 291,
      "chapter": null,
      "content": "266\nChapter 15 Data Structures, Algorithms, and Code Simplification\nSequence\nBase class for objects that look like sequences. Inherits from Container, Iterable,\nand Sized and defines the abstract methods _ _getitem_ _() and _ _len_ _().Also\nprovides a default implementation of _ _contains_ _(), _ _iter_ _(),\n_ _reversed_ _(), index(), and count() that are implemented using nothing but the\n_ _getitem_ _() and _ _len_ _() methods.\nMutableSequence\nBase class for mutable sequences. Inherits from Sequence and adds the abstract methods\n_ _setitem_ _() and _ _delitem_ _().Also provides a default implementation of\nappend(), reverse(), extend(), pop(), remove(), and _ _iadd_ _().\nSet\nBase class for objects that work like sets. Inherits from Container, Iterable,\nand Sized and defines the abstract methods _ _len_ _(), _ _iter_ _(), and \n_ _contains_ _().Also provides a default implementation of the set operators\n_ _le_ _(), _ _lt_ _(), _ _eq_ _(), _ _ne_ _(), _ _gt_ _(), _ _ge_ _(), _ _and_ _(),\n_ _or_ _(), _ _xor_ _(), _ _sub_ _(), and isdisjoint().\nMutableSet\nBase class for mutable sets. Inherits from Set and adds the abstract methods add() and\ndiscard().Also provides a default implementation of clear(), pop(), remove(),\n_ _ior_ _(), _ _iand_ _(), _ _ixor_ _(), and _ _isub_ _().\nMapping\nBase class for objects that support mapping (dictionary) lookup. Inherits from Sized,\nIterable, and Container and defines the abstract methods _ _getitem_ _(),\n_ _len_ _(), and _ _iter_ _().A default implementation of _ _contains_ _(),\nkeys(), items(), values(), get(), _ _eq_ _(), and _ _ne_ _() is also provided.\nMutableMapping\nBase class for mutable mapping objects. Inherits from Mapping and adds the abstract\nmethods _ _setitem_ _() and _ _delitem_ _().An implementation of pop(),\npopitem(), clear(), update(), and setdefault() is also added.\nMappingView\nBase class for mapping views.A mapping view is an object that is used for accessing the\ninternals of a mapping object as a set. For example, a key view is a set-like object that\nshows the keys in a mapping. See Appendix A,“Python 3” for more details.\nKeysView\nBase class for a key view of a mapping. Inherits from MappingView and Set.\nItemsView\nBase class for item view of a mapping. Inherits from MappingView and Set.\nValuesView\nBase class for a (key, item) view of a mapping. Inherits from MappingView and Set.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2394,
      "extraction_method": "Direct"
    },
    {
      "page_number": 292,
      "chapter": null,
      "content": "267\ncontextlib\nPython’s built-in types are already registered with all of these base classes as appro-\npriate.Also, by using these base classes, it is possible to write programs that are more\nprecise in their type checking. Here are some examples:\n# Pull off the last item of a sequence\nif isinstance(x, collections.Sequence):\nlast = x[-1]\n# Only iterate over an object if its size is known\nif isinstance(x, collections.Iterable) and isinstance(x, collections.Sized):\nfor item in x:\nstatements\n# Add a new item to a set\nif isinstance(x, collections.MutableSet):\nx.add(item)\nSee Also:\nChapter 7, “Classes and Object-Oriented Programming.”\ncontextlib\nThe contextlib module provides a decorator and utility functions for creating context\nmanagers used in conjunction with the with statement.\ncontextmanager(func)\nA decorator that creates a context manager from a generator function func.The way in\nwhich you use this decorator is as follows:\n@contextmanager\ndef foo(args):\nstatements\ntry:\nyield value\nexcept Exception as e:\nerror handling (if any)\nstatements\nWhen the statement with foo(args) as value appears, the generator function is\nexecuted with the supplied arguments until the first yield statement is reached.The\nvalue returned by yield is placed into the variable value.At this point, the body of\nthe with statement executes. Upon completion, the generator function resumes. If any\nkind of exception is raised inside the with-body, that exception is raised inside the gen-\nerator function where it can be handled as appropriate. If the error is to be propagated,\nthe generator should use raise to re-raise the exception.An example of using this deco-\nrator can be found in the “Context Managers” section of Chapter 5.\nnested(mgr1, mgr2, ..., mgrN)\nA function that invokes more than one context manager mgr1, mgr2, and so on as a sin-\ngle operation. Returns a tuple containing the different return values of the with state-\nments.The statement with nested(m1,m2) as (x,y): statements is the same as\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2026,
      "extraction_method": "Direct"
    },
    {
      "page_number": 293,
      "chapter": null,
      "content": "268\nChapter 15 Data Structures, Algorithms, and Code Simplification\nsaying with m1 as x: with m2 as y: statements. Be aware that if an inner con-\ntext manager traps and suppresses an exception, no exception information is passed\nalong to the outer managers.\nclosing(object)\nCreates a context manager that automatically executes object.close() when execu-\ntion leaves the body of the with statement.The value returned by the with statement is\nthe same as object.\nfunctools\nThe functools module contains functions and decorators that are useful for creating\nhigher-order functions, functional programming, and decorators.\npartial(function [, *args [, **kwargs]])\nCreates a function-like object, partial, that when called, calls function with posi-\ntional arguments args, keyword arguments kwargs, and any additional positional or\nkeyword arguments that are supplied.Additional positional arguments are added to the\nend of args, and additional keyword arguments are merged into kwargs, overwriting\nany previously defined values (if any).A typical use of partial() is when making a\nlarge number of function calls where many of the arguments are held fixed. For \nexample:\nfrom functools import partial\nmybutton = partial(Button, root, fg=\"black\",bg=\"white\",font=\"times\",size=\"12\")\nb1 = mybutton(text=\"Ok\")        # Calls Button() with text=\"Ok\" and all of the\nb2 = mybutton(text=\"Cancel\")    # additional arguments supplied to partial() above\nb3 = mybutton(text=\"Restart\")\nAn instance p of the object created by partial has the following attributes:\nItem\nDescription\np.func\nFunction that is called when p is called.\np.args\nTuple containing the leftmost positional arguments supplied to\np.func when called. Additional positional arguments are con-\ncatenated to the end of this value.\np.keywords\nDictionary containing the keyword arguments supplied to p.func\nwhen called. Additional keyword arguments are merged into this\ndictionary.\nUse caution when using a partial object as a stand-in for a regular function.The\nresult is not exactly the same as a normal function. For instance, if you use partial()\ninside a class definition, it behaves like a static method, not an instance method.\nreduce(function, items [, initial])\nApplies a function, function, cumulatively to the items in the iterable items and\nreturns a single value. function must take two arguments and is first applied to the first\ntwo items of items.This result and subsequent elements of items are then combined\none at a time in a similar manner, until all elements of items have been consumed.\ninitial is an optional starting value used in the first computation and when items is\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2662,
      "extraction_method": "Direct"
    },
    {
      "page_number": 294,
      "chapter": null,
      "content": "269\nheapq\nempty.This function is the same as the reduce() function that was a built-in in Python\n2. For future compatibility, use this version instead.\nupdate_wrapper(wrapper, wrapped [, assigned [, updated]])\nThis is a utility function that is useful when writing decorators. Copies attributes from a\nfunction wrapped to a wrapper function wrapper in order to make the wrapped func-\ntion look like the original function. assigned is a tuple of attribute names to copy and\nis set to ('_ _name_ _','_ _module_ _','_ _doc_ _') by default. updated is a tuple\ncontaining the names of function attributes that are dictionaries and which you want\nvalues merged in the wrapper. By default, it is a tuple ('_ _dict_ _',).\nwraps(function [, assigned [, updated ]])\nA decorator carries out the same task as update_wrapper() on the function to which\nit is applied. assigned and updated have the same meaning.A typical use of this deco-\nrator is when writing other decorators. For example:\nfrom functools import wraps\ndef debug(func):\n@wraps(func)\ndef wrapped(*args,**kwargs):\nprint(\"Calling %s\" % func._ _name_ _)\nr = func(*args,**kwargs)\nprint(\"Done calling %s\" % func._ _name_ _)\nreturn wrapped\n@debug\ndef add(x,y):\nreturn x+y\nSee Also:\nChapter 6, “Functions and Functional Programming.”\nheapq\nThe heapq module implements a priority queue using a heap. Heaps are simply lists of\nordered items in which the heap condition has been imposed. Specifically, heap[n] <=\nheap[2*n+1] and heap[n] <= heap[2*n+2] for all n, starting with n = 0. heap[0]\nalways contains the smallest item.\nheapify(x)\nConverts a list, x, into a heap, in place.\nheappop(heap)\nReturns and removes the smallest item from heap, preserving the heap condition.\nRaises IndexError if heap is empty.\nheappush(heap, item)\nAdds item to the heap, preserving the heap condition.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1850,
      "extraction_method": "Direct"
    },
    {
      "page_number": 295,
      "chapter": null,
      "content": "270\nChapter 15 Data Structures, Algorithms, and Code Simplification\nheappushpop(heap, item)\nAdds item to the heap and removes the smallest item from heap in a single operation.\nThis is more efficient than calling heappush() and heappop() separately.\nheapreplace(heap, item)\nReturns and removes the smallest item from the heap.At the same time, a new item is\nadded.The heap condition is preserved in the process.This function is more efficient\nthan calling heappop() and heappush() in sequence. In addition, the returned value is\nobtained prior to adding the new item.Therefore, the return value could be larger than\nitem. Raises IndexError if heap is empty.\nmerge(s1, s2, ...)\nCreates an iterator that merges the sorted iterables s1, s2, and so on into a single sorted\nsequence.This function does not consume the inputs but returns an iterator that incre-\nmentally processes the data.\nnlargest(n, iterable [, key])\nCreates a list consisting of the n largest items in iterable.The largest item appears first\nin the returned list. key is an optional function that takes a single input parameter and\ncomputes the comparison key for each item in iterable.\nnsmallest(n, iterable [, key])\nCreates a list consisting of the n smallest items in iterable.The smallest item appears\nfirst in the returned list. key is an optional key function.\nNote\nThe theory and implementation of heap queues can be found in most books on algo-\nrithms.\nitertools\nThe itertools module contains functions for creating efficient iterators, useful for\nlooping over data in various ways.All the functions in this module return iterators that\ncan be used with the for statement and other functions involving iterators such as gen-\nerators and generator expressions.\nchain(iter1, iter2, ..., iterN)\nGiven a group of iterators (iter1, … , iterN), this function creates a new iterator that\nchains all the iterators together.The returned iterator produces items from iter1 until\nit is exhausted.Then items from iter2 are produced.This continues until all the items\nin iterN are exhausted.\nchain.from_iterable(iterables)\nAn alternative constructor for a chain where the iterables is an iterable that produces\na sequence of iterable objects.The result of this operation is the same as what would be\nproduced by the following fragment of generator code:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2336,
      "extraction_method": "Direct"
    },
    {
      "page_number": 296,
      "chapter": null,
      "content": "271\nitertools\nfor it in iterables:\nfor x in it:\nyield x\ncombinations(iterable, r)\nCreates an iterator that returns all r-length subsequences of items taken from\niterable.The items in the returned subsequences are ordered in the same way in\nwhich they were ordered in the input iterable. For example, if iterable is the list\n[1,2,3,4], the sequence produced by combinations([1,2,3,4], 2) is [1,2],\n[1,3], [1,4], [2,3], [3,4].\ncount([n])\nCreates an iterator that produces consecutive integers starting with n. If n is omitted,\ncounting starts at 0. (Note that this iterator does not support long integers. If \nsys.maxint is exceeded, the counter overflows and continues to count starting with \n-sys.maxint - 1.)\ncycle(iterable)\nCreates an iterator that cycles over the elements in iterable over and over again.\nInternally, a copy of the elements in iterable is made.This copy is used to return the\nrepeated items in the cycle.\ndropwhile(predicate, iterable)\nCreates an iterator that discards items from iterable as long as the function \npredicate(item) is True. Once predicate returns False, that item and all subse-\nquent items in iterable are produced.\ngroupby(iterable [, key])\nCreates an iterator that groups consecutive items produced by iterable.The grouping\nprocess works by looking for duplicate items. For instance, if iterable produces the\nsame item on several consecutive iterations, that defines a group. If this is applied to a\nsorted list, the groups would define all the unique items in the list. key, if supplied, is a\nfunction that is applied to each item. If present, the return value of this function is used\nto compare successive items instead of the items themselves.The iterator returned by\nthis function produces tuples (key, group), where key is the key value for the group\nand group is an iterator that yields all the items that made up the group.\nifilter(predicate, iterable)\nCreates an iterator that only produces items from iterable for which\npredicate(item) is True. If predicate is None, all the items in iterable that evalu-\nate as True are returned.\nifilterfalse(predicate, iterable)\nCreates an iterator that only produces items from iterable for which\npredicate(item) is False. If predicate is None, all the items in iterable that eval-\nuate as False are returned.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2318,
      "extraction_method": "Direct"
    },
    {
      "page_number": 297,
      "chapter": null,
      "content": "272\nChapter 15 Data Structures, Algorithms, and Code Simplification\nimap(function, iter1, iter2, ..., iterN)\nCreates an iterator that produces items function(i1,i2, .. iN), where i1, i2, …,\niN are items taken from the iterators iter1, iter2, …, iterN, respectively. If function\nis None, the tuples of the form (i1, i2, ..., iN) are returned. Iteration stops\nwhenever one of the supplied iterators no longer produces any values.\nislice(iterable, [start,] stop [, step])\nCreates an iterator that produces items in a manner similar to what would be returned\nby a slice, iterable[start:stop:step].The first start items are skipped and itera-\ntion stops at the position specified in stop. step specifies a stride that’s used to skip\nitems. Unlike slices, negative values may not be used for any of start, stop, or step.\nIf start is omitted, iteration starts at 0. If step is omitted, a step of 1 is used.\nizip(iter1, iter2, ... iterN)\nCreates an iterator that produces tuples (i1, i2, ..., iN), where i1, i2, …, iN are\ntaken from the iterators iter1, iter2, …, iterN, respectively. Iteration stops whenever\none of the supplied iterators no longer produces any values.This function produces the\nsame values as the built-in zip() function.\nizip_longest(iter1, iter2, ..., iterN [,fillvalue=None])\nThe same as izip() except that iteration continues until all of the input iterables\niter1, iter2, and so on are exhausted. None is used to fill in values for the iterables\nthat are already consumed unless a different value is specified with the fillvalue key-\nword argument.\npermutations(iterable [, r])\nCreates an iterator that returns all r-length permutations of items from iterable. If r\nis omitted, then permutations have the same length as the number of items in \niterable.\nproduct(iter1, iter2, ... iterN, [repeat=1])\nCreates an iterator that produces tuples representing the Cartesian product of items in\nitem1, item2, and so on. repeat is a keyword argument that specifies the number of\ntimes to repeat the produced sequence.\nrepeat(object [, times])\nCreates an iterator that repeatedly produces object. times, if supplied, specifies a\nrepeat count. Otherwise, the object is returned indefinitely.\nstarmap(func [, iterable])\nCreates an iterator that produces the values func(*item), where item is taken from\niterable.This only works if iterable produces items suitable for calling a function\nin this manner.\ntakewhile(predicate [, iterable])\nCreates an iterator that produces items from iterable as long as predicate(item) is\nTrue. Iteration stops immediately once predicate evaluates as False.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2616,
      "extraction_method": "Direct"
    },
    {
      "page_number": 298,
      "chapter": null,
      "content": "273\noperator\ntee(iterable [, n])\nCreates n independent iterators from iterable.The created iterators are returned as an\nn-tuple.The default value of n is 2.This function works with any iterable object.\nHowever, in order to clone the original iterator, the items produced are cached and\nused in all the newly created iterators. Great care should be taken not to use the origi-\nnal iterator iterable after tee() has been called. Otherwise, the caching mechanism\nmay not work correctly.\nExamples\nThe following examples illustrate how some of the functions in the itertools module\noperate:\nfrom itertools import *\n# Iterate over the numbers 0,1,...,10,9,8,...,1 in an endless cycle\nfor i in cycle(chain(range(10),range(10,0,-1))):\nprint i\n# Create a list of unique items in a\na = [1,4,5,4,9,1,2,3,4,5,1]\na.sort()\nb = [k for k,g in groupby(a)]   # b = [1,2,3,4,5,9]\n# Iterate over all possible combinations of pairs of values from x and y\nx = [1,2,3,4,5]\ny = [10,11,12]\nfor r in product(x,y):\nprint(r)\n# Produces output (1,10),(1,11),(1,12), ... (5,10),(5,11),(5,12)\noperator\nThe operator module provides functions that access the built-in operators and special\nmethods of the interpreter described in Chapter 3,“Types and Objects.” For example,\nadd(3, 4) is the same as 3 + 4. For operations that also have an in-place version, you\ncan use a function such as iadd(x,y) which is the same as x += y.The following list\nshows functions defined in the operator module and how they are mapped onto vari-\nous operators:\nFunction\nDescription\nadd(a, b)\nReturns a + b for numbers\nsub(a, b)\nReturns a – b\nmul(a, b)\nReturns a * b for numbers\ndiv(a, b)\nReturns a / b (old division)\nfloordiv(a, b)\nReturns a // b\ntruediv(a, b)\nReturns a / b (new division)\nmod(a, b)\nReturns a % b\nneg(a)\nReturns -a\npos(a)\nReturns +a\nabs(a)\nReturns the absolute value of a\ninv(a), invert(a)\nReturns the inverse of a\ncontinues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1912,
      "extraction_method": "Direct"
    },
    {
      "page_number": 299,
      "chapter": null,
      "content": "274\nChapter 15 Data Structures, Algorithms, and Code Simplification\nFunction\nDescription\nlshift(a, b)\nReturns a << b\nrshift(a, b)\nReturns a >> b\nand_(a, b)\nReturns a & b (bitwise AND)\nor_(a, b)\nReturns a | b (bitwise OR)\nxor(a, b)\nReturns a ^ b (bitwise XOR)\nnot_(a)\nReturns not a\nlt(a, b)\nReturns a < b\nle(a, b)\nReturns a <= b\neq(a, b)\nReturns a == b\nne(a, b)\nReturns a != b\ngt(a, b)\nReturns a > b\nge(a, b)\nReturns a >= b\ntruth(a)\nReturns True if a is true, False otherwise\nconcat(a, b)\nReturns a + b for sequences\nrepeat(a, b)\nReturns a * b for sequence a and integer b\ncontains(a, b)\nReturns the result of b in a\ncountOf(a, b)\nReturns the number of occurrences of b in a\nindexOf(a, b)\nReturns the index of the first occurrence of b in a\ngetitem(a, b)\nReturns a [b]\nsetitem(a, b, c)\na [b] = c\ndelitem(a, b)\ndel a [b]\ngetslice(a, b, c)\nReturns a[b:c]\nsetslice(a, b, c, v) Sets a[b:c] = v\ndelslice(a, b, c)\ndel a[b:c]\nis_(a, b)\na is b\nis_not(a, b)\na is not b\nAt first glance, it might not be obvious why anyone would want to use these functions\nbecause the operations they perform can easily be accomplished by simply typing the\nnormal syntax.Where these functions are useful is when working with code uses call-\nback functions and where you might otherwise be defining an anonymous function\nwith lambda. For example, consider the following timing benchmark that uses the\nfunctools.reduce() function:\n>>> from timeit import timeit\n>>> timeit(\"reduce(operator.add,a)\",\"import operator; a = range(100)\")\n12.055853843688965\n>>> timeit(\"reduce(lambda x,y: x+y,a)\",\"import operator; a = range(100)\")\n25.012306928634644\n>>>\nIn the example, notice how using operator.add as the callback runs more than twice\nas fast as the version that uses lambda x,y: x+y.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1773,
      "extraction_method": "Direct"
    },
    {
      "page_number": 300,
      "chapter": null,
      "content": "275\noperator\nThe operator module also defines the following functions that create wrappers\naround attribute access, item lookup, and method calls.\nattrgetter(name [, name2 [, ... [, nameN]]])\nCreates a callable object, f, where a call to f(obj) returns obj.name. If more \nthan one argument is given, a tuple of results is returned. For example,\nattrgetter('name','shares') returns (obj.name, obj.shares) when called.\nname can also include additional dot lookups. For example, if name is\n\"address.hostname\", then f(obj) returns obj.address.hostname.\nitemgetter(item [, item2 [, ... [, itemN]]])\nCreates a callable object, f, where a call to f(obj) returns obj[item]. If more than\none item is given as arguments, a call to f(obj) returns a tuple containing\n(obj[item], obj[item2], ..., obj[itemN]).\nmethodcaller(name [, *args [, **kwargs]])\nCreates a callable object, f, where a call to f(obj) returns obj.name(*args,\n**kwargs).\nThese functions are also useful for optimizing the performance of operations involv-\ning callback function, especially those involving common data processing operations\nsuch as sorting. For example, if you wanted to sort a list of tuples rows on column 2,\nyou could either use sorted(rows, key=lambda r: r[2]) or use sorted(rows,\nkey=itemgetter(2)).The second version runs much faster because it avoids the over-\nhead associated with lambda.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1391,
      "extraction_method": "Direct"
    },
    {
      "page_number": 301,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 302,
      "chapter": null,
      "content": "16\nString and Text Handling\nThis chapter describes the most commonly used Python modules related to basic\nstring and text processing.The focus of this chapter is on the most common string\noperations such as processing text, regular expression pattern matching, and text format-\nting.\ncodecs\nThe codecs module is used to handle different character encodings used with Unicode\ntext I/O.The module is used both to define new character encodings and to process\ncharacter data using a wide range of existing encodings such as UTF-8, UTF-16, etc. It\nis far more common for programmers to simply use one of the existing encodings, so\nthat is what is discussed here. If you want to create new encodings, consult the online\ndocumentation for further details.\nLow-Level codecs Interface\nEach character encoding is assigned a common name such as 'utf-8' or 'big5'.The\nfollowing function is used to perform a lookup.\nlookup(encoding)\nLooks up a codec in the codec registry. encoding is a string such as 'utf-8'. If noth-\ning is known about the requested encoding, LookupError is raised. Otherwise, an\ninstance c of CodecInfo is returned.\nA CodecInfo instance c has the following methods:\nc.encode(s [, errors])\nA stateless encoding function that encodes the Unicode string s and returns a tuple\n(bytes, length_consumed). bytes is an 8-bit string or byte-array containing the\nencoded data. length_consumed is the number of characters in s that were encoded.\nerrors is the error handling policy and is set to 'strict' by default.\nc.decode(bytes [, errors])\nA stateless encoding function that decodes a byte string bytes and returns a tuple (s,\nlength_consumed). s is a Unicode string, and length_consumed is the number of\nbytes in bytes that were consumed during decoding. errors is the error-handling pol-\nicy and is set to 'strict’ by default.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1854,
      "extraction_method": "Direct"
    },
    {
      "page_number": 303,
      "chapter": null,
      "content": "278\nChapter 16 String and Text Handling\nc.streamreader(bytestream [, errors])\nReturns a StreamReader instance that is used to read encoded data. bytestream is a\nfile-like object that has been opened in binary mode. errors is the error-handling pol-\nicy and is 'strict' by default.An instance r of StreamReader supports the following\nlow-level I/O operations:\nMethod\nDescription\nr.read([size [, chars [, firstline]]]) Returns at most chars characters\nof decoded text. size is the maxi-\nmum number of bytes to read from\nlow-level byte-stream and is used to\ncontrol internal buffering. \nfirstline is a flag that, if set,\nreturns the first line even if a decod-\ning error occurs later in the file.\nr.readline([size [, keepends]])\nReturns a single line of decoded\ntext. keepends is a flag that con-\ntrols whether or not the line endings\nare preserved (true by default).\nr.readlines([size [, keepends]])\nReads all of the lines into a list.\nr.reset()\nResets the internal buffers and\nstate.\nc.streamwriter(bytestream [, errors])\nReturns a StreamWriter instance that is used to write encoded data. bytestream is a\nfile-like object that has been opened in byte-mode. errors is the error handling policy\nand is 'strict' by default.An instance w of StreamWriter supports the following\nlow-level I/O operations:\nMethod\nDescription\nw.write(s)\nWrites an encoded representation of string s\nw.writelines(lines)\nWrites a list of strings in lines to the file\nw.reset()\nResets the internal buffers and state\nc.incrementalencoder([errors])\nReturns an IncrementalEncoder instance that can be used to encode strings in multi-\nple steps. errors is 'strict' by default.An instance e of IncrementalEncoder has\nthese methods:\nMethod\nDescription\ne.encode(s [,final])\nReturns an encoded representation of string s as a\nbyte string. final is a flag that should be set to\nTrue on the final call to encode().\ne.reset()\nResets the internal buffers and state.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1948,
      "extraction_method": "Direct"
    },
    {
      "page_number": 304,
      "chapter": null,
      "content": "279\ncodecs\nc.incrementaldecoder([errors])\nReturns an IncrementalDecoder instance that can be used to decode byte strings in\nmultiple steps. errors is 'strict' by default.An instance d of IncrementalDecoder\nhas these methods:\nMethod\nDescription\nd.decode(bytes [,final])\nReturns a decoded string from the encoded bytes\nin bytes. final is a flag that should be set to\nTrue on the final call to decode().\nd.reset()\nResets the internal buffers and state.\nI/O-Related Functions\nThe codecs module provides a collection of high-level functions that are used to sim-\nplify I/O involving encoded text. Most programmers will use one of these functions\ninstead of the low-level codecs interface described in the first section.\nopen(filename, mode[, encoding[, errors[, buffering]]])\nOpens filename in the given mode and provides transparent data encoding/decoding\naccording to the encoding specified in encoding. errors is one of 'strict',\n'ignore', 'replace', 'backslashreplace', or 'xmlcharrefreplace'.The default\nis 'strict'. buffering has the same meaning as for the built-in open() function.\nRegardless of the mode specified in mode, the underlying file is always opened in binary\nmode. In Python 3, you can use the built-in open() function instead of\ncodecs.open().\nEncodedFile(file, inputenc[, outputenc [, errors]])\nA class that provides an encoding wrapper around an existing file object, file. Data\nwritten to the file is first interpreted according to the input encoding inputenc and\nthen written to the file using the output encoding outputenc. Data read from the file\nis decoded according to inputenc. If outputenc is omitted, it defaults to inputenc.\nerrors has the same meaning as for open() and defaults to 'strict'.\niterencode(iterable, encoding\n[, errors])\nA generator function that incrementally encodes all of the strings in iterable to the\nspecified encoding. errors is 'strict' by default.\niterdecode(iterable, encoding\n[, errors])\nA generator function that incrementally decodes all of the byte strings in iterable\naccording to the specified encoding. errors is 'strict' by default.\nUseful Constants\ncodecs defines the following byte-order marker constants that can be used to help\ninterpret files when you don’t know anything about the underlying encoding.These\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2296,
      "extraction_method": "Direct"
    },
    {
      "page_number": 305,
      "chapter": null,
      "content": "280\nChapter 16 String and Text Handling\nbyte-order markers are sometimes written at the beginning of a file to indicate its char-\nacter encoding and can be used to pick an appropriate codec to use.\nConstant\nDescription\nBOM\nNative byte-order marker for the machine (BOM_BE or BOM_LE)\nBOM_BE\nBig-endian byte-order marker ('\\xfe\\xff')\nBOM_LE\nLittle-endian byte-order marker ('\\xff\\xfe')\nBOM_UTF8\nUTF-8 marker ('\\xef\\xbb\\xbf')\nBOM_UTF16_BE\n16-bit UTF-16 big-endian marker ('\\xfe\\xff')\nBOM_UTF16_LE\n16-bit UTF-16 little-endian marker ('\\xff\\xfe')\nBOM_UTF32_BE\n32-bit UTF-32 big-endian marker ('\\x00\\x00\\xfe\\xff')\nBOM_UTF32_LE\n32-bit UTF-32 little-endian marker ('\\xff\\xfe\\x00\\x00')\nStandard Encodings\nThe following is a list of some of the most commonly used character encodings.The\nencoding name is what you would pass to functions such as open() or lookup() when\nspecifying an encoding.A full list of encodings can be found by consulting the online\ndocumentation for the codecs module (http://docs.python.org/library/codecs).\nCodec Name\nDescription\nascii\n7-bit ASCII characters\ncp437\nExtended ASCII character set from MS-DOS\ncp1252\nExtended ASCII character set from Windows\nlatin-1, iso-8859-1\nASCII extended with Latin characters\nutf-16\nUTF-16\nutf-16-be\nUTF-16 big-endian\nutf-16-le\nUTF-16 little-endian\nutf-32\nUTF-32\nutf-32-be\nUTF-32 big-endian\nutf-32-le\nUTF-32 little-endian\nutf-8\nUTF-8\nNotes\nn Further use of the codecs module is described in Chapter 9,“Input and\nOutput.”\nn Consult the online documentation for information on how to create new kinds\nof character encodings.\nn Great care needs to be taken with the inputs to encode() and decode() opera-\ntions.All encode() operations should be given Unicode strings, and all\ndecode() operations should be given byte strings. Python 2 is not entirely con-\nsistent in this regard, whereas Python 3 strictly enforces the distinction between\nstrings. For example, Python 2 has some codecs that map byte-strings to byte-\nstrings (e.g., the “bz2” codec).These are unavailable in Python 3 and should not\nbe used if you care about compatibility.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2110,
      "extraction_method": "Direct"
    },
    {
      "page_number": 306,
      "chapter": null,
      "content": "281\nre\nre\nThe re module is used to perform regular-expression pattern matching and replacement\nin strings. Both unicode and byte-strings are supported. Regular-expression patterns are\nspecified as strings containing a mix of text and special-character sequences. Because\npatterns often make extensive use of special characters and the backslash, they’re usually\nwritten as “raw” strings, such as r'(?P<int>\\d+)\\.(\\d*)'. For the remainder of this\nsection, all regular-expression patterns are denoted using the raw string syntax.\nPattern Syntax\nThe following special-character sequences are recognized in regular expression patterns:\nCharacter(s)\nDescription\ntext\nMatches the literal string text.\n.\nMatches any character except newline.\n^\nMatches the start of a string.\n$\nMatches the end of a string.\n*\nMatches zero or more repetitions of the preceding expres-\nsion, matching as many repetitions as possible.\n+\nMatches one or more repetitions of the preceding expres-\nsion, matching as many repetitions as possible.\n?\nMatches zero repetitions or one repetition of the preceding\nexpression.\n*?\nMatches zero or more repetitions of the preceding expres-\nsion, matching as few repetitions as possible.\n+?\nMatches one or more repetitions of the preceding expres-\nsion, matching as few repetitions as possible.\n??\nMatches zero or one repetitions of the preceding expres-\nsion, matching as few repetitions as possible.\n{m}\nMatches exactly m repetitions of the preceding expression.\n{m, n}\nMatches from m to n repetitions of the preceding expres-\nsion, matching as many repetitions as possible. If m is omit-\nted, it defaults to 0. If n is omitted, it defaults to infinity.\n{m, n}?\nMatches from m to n repetitions of the preceding expres-\nsion, matching as few repetitions as possible.\n[...]\nMatches a set of characters such as r'[abcdef]' or\nr'[a-zA-z]'. Special characters such as * are not active\ninside a set.\n[^...]\nMatches the characters not in the set, such as r'[^0-9]'.\nA|B\nMatches either A or B, where A and B are both regular\nexpressions.\n(...)\nMatches the regular expression inside the parentheses as\na group and saves the matched substring. The contents of\na group can be obtained using the group() method of\nMatchObject objects obtained while matching.\ncontinues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2289,
      "extraction_method": "Direct"
    },
    {
      "page_number": 307,
      "chapter": null,
      "content": "282\nChapter 16 String and Text Handling\nCharacter(s)\nDescription\n(?aiLmsux)\nInterprets the letters \"a\", \"i\", \"L\", \"m\", \"s\", \"u\", and\n\"x\" as flag settings corresponding to the re.A, re.I,\nre.L, re.M, re.S, re.U, re.X flag settings given to\nre.compile(). \"a\" only available in Python 3.\n(?:...)\nMatches the regular expression inside the parentheses but\ndiscards the matched substring.\n(?P<name>...)\nMatches the regular expression in the parentheses and\ncreates a named group. The group name must be a valid\nPython identifier.\n(?P=name)\nMatches the same text that was matched by an earlier\nnamed group.\n(?#...)\nA comment. The contents of the parentheses are ignored.\n(?=...)\nMatches the preceding expression only if followed by the\npattern in the parentheses. For example, r'Hello\n(?=World)' matches 'Hello ' only if followed by\n'World'.\n(?!...)\nMatches the preceding expression only if it’s not followed\nby the pattern in parentheses. For example, r'Hello\n(?!World)' matches 'Hello ' only if it’s not followed\nby 'World'.\n(?<=...)\nMatches the following expression if it’s preceded by a\nmatch of the pattern in parentheses. For example,\nr'(?<=abc)def' matches 'def' only if it’s preceded by\n'abc'.\n(?<!...)\nMatches the following expression only if it’s not preceded\nby a match of the pattern in parentheses. For example,\nr'(?<!abc)def' matches 'def' only if it’s not preceded\nby 'abc'.\n(?(id|name)ypat|npat) Checks to see whether the regular expression group identi-\nfied by id or name exists. If so, the regular expression\nypat is matched. If not, the optional expression npat is\nmatched. For example, the pattern r'(Hello)?(?(1)\nWorld|Howdy)' matches the string 'Hello World' or\nthe string 'Howdy'.\nStandard character escape sequences such as '\\n' and '\\t' are recognized as standard\ncharacters in a regular expression (for example, r'\\n+' would match one or more new-\nline characters). In addition, literal symbols that normally have special meaning in a reg-\nular expression can be specified by preceding them with a backslash. For example,\nr'\\*' matches the character *. In addition, a number of backslash sequences corre-\nspond to special sets of characters:\nCharacter(s)\nDescription\n\\number\nMatches the text that was matched by a previous group number. Groups\nare numbered from 1 to 99, starting from the left.\n\\A\nMatches only at the start of the string.\n\\b\nMatches the empty string at the beginning or end of a word. A word is a\nsequence of alphanumeric characters terminated by whitespace or any\nother nonalphanumeric character.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2557,
      "extraction_method": "Direct"
    },
    {
      "page_number": 308,
      "chapter": null,
      "content": "283\nre\nCharacter(s)\nDescription\n\\B\nMatches the empty string not at the beginning or end of a word.\n\\d\nMatches any decimal digit. Same as r'[0-9]'.\n\\D\nMatches any nondigit character. Same as r'[^0-9]'.\n\\s\nMatches any whitespace character. Same as r'[\\t\\n\\r\\f\\v]'.\n\\S\nMatches any nonwhitespace character. Same as r'[^ \\t\\n\\r\\f\\v]'.\n\\w\nMatches any alphanumeric character.\n\\W\nMatches any character not contained in the set defined by \\w.\n\\Z\nMatches only at the end of the string.\n\\\\\nMatches a literal backslash.\nThe \\d, \\D, \\s, \\S, \\w, and \\W special characters are interpreted differently if matching\nUnicode strings. In this case, they match all Unicode characters that match the\ndescribed property. For example, \\d matches any Unicode character that is classified as a\ndigit such as European,Arabic, and Indic digits which each occupy a different range of\nUnicode characters.\nFunctions\nThe following functions are used to perform pattern matching and replacement:\ncompile(str [, flags])\nCompiles a regular-expression pattern string into a regular-expression object.This\nobject can be passed as the pattern argument to all the functions that follow.The object\nalso provides a number of methods that are described shortly. flags is the bitwise OR\nof the following:\nFlag\nDescription\nA or ASCII\nPerform 8-bit ASCII-only matching (Python 3 only).\nI or IGNORECASE\nPerforms non–case-sensitive matching.\nL or LOCALE\nUses locale settings for \\w, \\W, \\b, and \\B.\nM or MULTILINE\nMakes ^ and $ apply to each line in addition to the beginning and\nend of the entire string. (Normally ^ and $ apply only to the begin-\nning and end of an entire string.)\nS or DOTALL\nMakes the dot (.) character match all characters, including the\nnewline.\nU or UNICODE\nUses information from the Unicode character properties database\nfor \\w, \\W, \\b, and \\B.  (Python 2 only. Python 3 uses Unicode by\ndefault.)\nX or VERBOSE\nIgnores unescaped whitespace and comments in the pattern\nstring.\nescape(string)\nReturns a string with all nonalphanumerics backslashed.\nfindall(pattern, string [,flags])\nReturns a list of all nonoverlapping matches of pattern in string, including empty\nmatches. If the pattern has groups, a list of the text matched by the groups is returned.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2253,
      "extraction_method": "Direct"
    },
    {
      "page_number": 309,
      "chapter": null,
      "content": "284\nChapter 16 String and Text Handling\nIf more than one group is used, each item in the list is a tuple containing the text for\neach group. flags has the same meaning as for compile().\nfinditer(pattern, string, [, flags])\nThe same as findall(), but returns an iterator object instead.The iterator returns items\nof type MatchObject.\nmatch(pattern, string [, flags])\nChecks whether zero or more characters at the beginning of string match pattern.\nReturns a MatchObject on success or None otherwise. flags has the same meaning as\nfor compile().\nsearch(pattern, string [, flags])\nSearches string for the first match of pattern. flags has the same meaning as for\ncompile(). Returns a MatchObject on success or None if no match was found.\nsplit(pattern, string [, maxsplit = 0])\nSplits string by the occurrences of pattern. Returns a list of strings including the text\nmatched by any groups in the pattern. maxsplit is the maximum number of splits to\nperform. By default, all possible splits are performed.\nsub(pattern, repl, string [, count = 0])\nReplaces the leftmost nonoverlapping occurrences of pattern in string by using the\nreplacement repl. repl can be a string or a function. If it’s a function, it’s called with a\nMatchObject and should return the replacement string. If repl is a string, back-\nreferences such as '\\6' are used to refer to groups in the pattern.The sequence\n'\\g<name>' is used to refer to a named group. count is the maximum number of sub-\nstitutions to perform. By default, all occurrences are replaced.Although these functions\ndon’t accept a flags parameter like compile(), the same effect can be achieved by\nusing the (?iLmsux) notation described earlier in this section.\nsubn(pattern, repl, string [, count = 0])\nSame as sub(), but returns a tuple containing the new string and the number of substi-\ntutions.\nRegular Expression Objects\nA compiled regular-expression object, r, created by the compile() function has the fol-\nlowing methods and attributes:\nr.flags\nThe flags argument used when the regular expression object was compiled, or 0 if no\nflags were specified.\nr.groupindex\nA dictionary mapping symbolic group names defined by r'(?P<id>)' to group \nnumbers.\nr.pattern\nThe pattern string from which the regular expression object was compiled.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2299,
      "extraction_method": "Direct"
    },
    {
      "page_number": 310,
      "chapter": null,
      "content": "285\nre\nr.findall(string [, pos [, endpos]])\nIdentical to the findall() function. pos and endpos specify the starting and ending\npositions for the search.\nr.finditer(string [, pos [, endpos]])\nIdentical to the finditer() function. pos and endpos specify the starting and ending\npositions for the search.\nr.match(string [, pos] [, endpos])\nChecks whether zero or more characters at the beginning of string match. pos and\nendpos specify the range of string to be searched. Returns a MatchObject for a\nmatch and returns None otherwise.\nr.search(string [, pos] [, endpos])\nSearches string for a match. pos and endpos specify the starting and ending positions\nfor the search. Returns a MatchObject for a match and returns None otherwise.\nr.split(string [, maxsplit = 0])\nIdentical to the split() function.\nr.sub(repl, string [, count = 0])\nIdentical to the sub() function.\nr.subn(repl, string [, count = 0])\nIdentical to the subn() function.\nMatch Objects\nThe MatchObject instances returned by search() and match() contain information\nabout the contents of groups as well as positional data about where matches occurred.A\nMatchObject instance, m, has the following methods and attributes:\nm.expand(template)\nReturns a string that would be obtained by doing regular-expression backslash substitu-\ntion on the string template. Numeric back-references such as \"\\1\" and \"\\2\" and\nnamed references such as \"\\g<n>\" and \"\\g<name>\" are replaced by the contents of the\ncorresponding group. Note that these sequences should be specified using raw strings or\nwith a literal backslash character such as r'\\1' or '\\\\1'.\nm.group([group1, group2, ...])\nReturns one or more subgroups of the match.The arguments specify group numbers or\ngroup names. If no group name is given, the entire match is returned. If only one group\nis given, a string containing the text matched by the group is returned. Otherwise, a\ntuple containing the text matched by each of the requested groups is returned.An\nIndexError is raised if an invalid group number or name is given.\nm.groups([default])\nReturns a tuple containing the text matched by all groups in a pattern. default is the\nvalue returned for groups that didn’t participate in the match (the default is None).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2249,
      "extraction_method": "Direct"
    },
    {
      "page_number": 311,
      "chapter": null,
      "content": "286\nChapter 16 String and Text Handling\nm.groupdict([default])\nReturns a dictionary containing all the named subgroups of the match. default is the\nvalue returned for groups that didn’t participate in the match (the default is None).\nm.start([group])\nm.end([group])\nThese two methods return the indices of the start and end of the substring matched by\na group. If group is omitted, the entire matched substring is used. Returns None if the\ngroup exists but didn’t participate in the match.\nm.span([group])\nReturns a 2-tuple (m.start(group), m.end(group)). If group didn’t contribute to\nthe match, this returns (None, None). If group is omitted, the entire matched sub-\nstring is used.\nm.pos\nThe value of pos passed to the search() or match() function.\nm.endpos\nThe value of endpos passed to the search() or match() function.\nm.lastindex\nThe numerical index of the last group that was matched. It’s None if no groups were\nmatched.\nm.lastgroup\nThe name of the last named group that was matched. It’s None if no named groups\nwere matched or present in the pattern.\nm.re\nThe regular-expression object whose match() or search() method produced this\nMatchObject instance.\nm.string\nThe string passed to match() or search().\nExample\nThe following example shows how to use the re module to search for, extract data\nfrom, and replace a text pattern in a string.\nimport re\ntext = \"Guido will be out of the office from 12/15/2012 - 1/3/2013.\"\n# A regex pattern for a date.\ndatepat = re.compile('(\\d+)/(\\d+)/(\\d+)')\n# Find and print all dates\nfor m in datepat.finditer(text):\nprint(m.group())\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1602,
      "extraction_method": "Direct"
    },
    {
      "page_number": 312,
      "chapter": null,
      "content": "287\nstring\n# Find all dates, but print in a different format\nmonthnames = [None,'Jan','Feb','Mar','Apr','May','Jun',\n'Jul','Aug','Sep','Oct','Nov','Dec']\nfor m in datepat.finditer(text):\nprint (\"%s %s, %s\" % (monthnames[int(m.group(1)], m.group(2), m.group(3)))\n# Replace all dates with fields in the European format (day/month/year)\ndef fix_date(m):\nreturn \"%s/%s/%s\" % (m.group(2),m.group(1),m.group(3))\nnewtext = datepat.sub(fix_date, text)\n# An alternative replacement\nnewtext = datepat.sub(r'\\2/\\1/\\3', text)\nNotes\nn Detailed information about the theory and implementation of regular expressions\ncan be found in textbooks on compiler construction.The book Mastering Regular\nExpressions by Jeffrey Friedl (O’Reilly & Associates, 1997) may also be useful.\nn The most difficult part of using the re module is writing the regular expression\npatterns. For writing patterns, consider using a tool such as Kodos\n(http://kodos.sourceforget.net).\nstring\nThe string module contains a number of useful constants and functions for manipulat-\ning strings. It also contains classes for implementing new string formatters.\nConstants\nThe following constants define various sets of characters that may be useful in various\nstring processing operations.\nConstant\nDescription\nascii_letters\nA string containing all lowercase and uppercase ASCII letters.\nascii_lowercase\nThe string 'abcdefghijklmnopqrstuvwxyz'.\nascii_uppercase\nThe string 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.\ndigits\nThe string '0123456789'.\nhexdigits\nThe string '0123456789abcdefABCDEF'.\nletters\nConcatenation of lowercase and uppercase.\nlowercase\nString containing all lowercase letters specific to the current\nlocale setting.\noctdigits\nThe string '01234567'.\npunctuation\nString of ASCII punctuation characters.\nprintable\nString of printable characters—a combination of letters,\ndigits, punctuation, and whitespace.\nuppercase\nString containing all uppercase letters specific to the current\nlocale setting.\nwhitespace\nString containing all whitespace characters. This usually includes\nspace, tab, linefeed, return, formfeed, and vertical tab.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2110,
      "extraction_method": "Direct"
    },
    {
      "page_number": 313,
      "chapter": null,
      "content": "288\nChapter 16 String and Text Handling\nNote that some of these constants (for example, letters and uppercase) will vary\ndepending on the locale settings of the system.\nFormatter Objects\nThe str.format() method of strings is used to perform advanced string formatting\noperations.As seen in Chapter 3,“Types and Objects,” and Chapter 4,“Operators and\nExpressions,” this method can access items of sequences or mappings, attributes of\nobjects, and other kinds of related operations.The string module defines a class\nFormatter that can be used to implement your own customized formatting operation.\nThis class exposes the pieces that implement the string formatting operation and allow\nyou to customize them.\nFormatter()\nCreates a new Formatter instance.An instance f of Formatter supports the following\noperations.\nf.format(format_string, *args, **kwargs)\nFormats the string format_string. By default, the output is the same as calling \nformat_string.format(*args, **kwargs). For example, f.format(\"{name} is\n{0:d} years old\", 39,name=\"Dave\") creates the string \"Dave is 39 years\nold\".\nf.vformat(format_string, args, kwargs)\nA method that actually carries out the work of f.format(). args is a tuple of posi-\ntional arguments, and kwargs is a dictionary of keyword arguments.This is a faster\nmethod to use if you have already captured argument information in a tuple and dic-\ntionary.\nf.parse(format_string)\nA function that creates an iterator for parsing the contents of the format string \nformat_string.The iterator sweeps over the format string and produces tuples of \nthe format (literal_text, field_name, format_spec, conversion).\nliteral_text is any literal text that precedes the next format specifier enclosed in\nbraces { ... }. It may be an empty string if there is no leading text. field_name is a\nstring that specifies the field name in the format specifier. For example, if the specifier is\n'{0:d}', then the field name is '0'. format_spec is the format specifier that appears\nafter the colon—for example, 'd' in the previous example. It will be an empty string if\nit wasn’t specified. conversion is a string containing the conversion specifier (if any). In\nthe previous example, it is None, but if the specifier was '{0!s:d}', it would be set to\n's'. field_name, format_spec, and conversion will all be None for the last frag-\nment of the format string.\nf.get_field(fieldname, args, kwargs)\nExtracts the value associated with a given fieldname from args and kwargs.\nfieldname is a string such as \"0\" or \"name\" as returned by the parse() method\nshown previously. Returns a tuple (value, key) where value is the field value and\nkey is used to locate the value in args or kwargs. If key is an integer, it is an index in\nargs. If it is a string, it is the key used in kwargs.The fieldname may include additional\nindexing and attribute lookup such as '0.name’ or '0[name]'. In this case, the method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2927,
      "extraction_method": "Direct"
    },
    {
      "page_number": 314,
      "chapter": null,
      "content": "289\nstring\ncarries out the extra lookup and returns the appropriate value. However, the value of\nkey in the returned tuple is just set to '0'.\nf.get_value(key, args, kwargs)\nExtracts the object from args or kwargs corresponding to key. If key is an integer, the\nobject is taken from args. If it is a string, it is taken from kwargs.\nf.check_unused_args(used_args, args, kwargs)\nChecks for unused arguments in the format() operation. used_args is a set of all of\nthe used argument keys (see get_field()) that were found in the format string. args\nand kwargs are the positional and keyword arguments passed to format().The default\nbehavior is to raise a TypeError for unused arguments.\nf.format_value(value, format_spec)\nFormats a single value according to the given format specification. By default, this sim-\nply executes the built-in function format(value, format_spec).\nf.convert_field(value, conversion)\nConverts a value returned by get_field() according to the specified conversion\ncode. If conversion is None, value is returned unmodified. If conversion is 's' or\n'r', value is converted to a string using str() or repr(), respectively.\nIf you want to create your own customized string formatting, you can create a\nFormatter object and simply use the default methods to carry out the formatting as\nyou wish. It is also possible to define a new class that inherits from Formatter and\nreimplements any of the methods shown earlier.\nFor details on the syntax of format specifiers and advanced string formatting, refer to\nChapter 3 and Chapter 4.\nTemplate Strings\nThe string module defines a new string type, Template, that simplifies certain string\nsubstitutions.An example can be found in Chapter 9.\nThe following creates a new template string object:\nTemplate(s)\nHere, s is a string and Template is defined as a class.\nA Template object, t, supports the following methods:\nt.substitute(m [, **kwargs])\nThis method takes a mapping object, m (for example, a dictionary), or a list of keyword\narguments and performs a keyword substitution on the string t.This substitution\nreplaces the string '$$' with a single '$' and the strings '$key' or '${key}' with\nm['key’] or kwargs['key'] if keyword arguments were supplied. key must spell a\nvalid Python identifier. If the final string contains any unresolved '$key' patterns, a\nKeyError exception is raised.\nt.safe_substitute(m [, **kwargs])\nThe same as substitute() except that no exceptions or errors will be generated.\nInstead, unresolved $key references will be left in the string unmodified.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2565,
      "extraction_method": "Direct"
    },
    {
      "page_number": 315,
      "chapter": null,
      "content": "290\nChapter 16 String and Text Handling\nt.template\nContains the original strings passed to Template().\nThe behavior of the Template class can be modified by subclassing it and redefining\nthe attributes delimiter and idpattern. For example, this code changes the escape\ncharacter $ to @ and restricts key names to letters only:\nclass MyTemplate(string.Template):\ndelimiter = '@'        # Literal character for escape sequence\nidpattern = '[A-Z]*'   # Identifier regular expression pattern\nUtility Functions\nThe string module also defines a couple of functions for manipulating strings that\naren’t defined as a method on string objects.\ncapwords(s)\nCapitalizes the first letter of each word in s, replaces repeated whitespace characters\nwith a single space, and removes leading and trailing whitespace.\nmaketrans(from, to)\nCreates a translation table that maps each character in from to the character in the same\nposition in to. from and to must be the same length.This function is used to create\narguments suitable for use with the translate() method of strings.\nstruct\nThe struct module is used to convert data between Python and binary data structures\n(represented as Python byte strings).These data structures are often used when interact-\ning with functions written in C, binary file formats, network protocols, or binary com-\nmunication over serial ports.\nPacking and Unpacking Functions\nThe following module-level functions are used to pack and unpack data in byte strings.\nIf your program is repeatedly performing these operations, consider the use of a Struct\nobject described in the next section.\npack(fmt, v1, v2, ...)\nPacks the values v1, v2, and so on into a byte string according to the format string in\nfmt.\npack_into(fmt, buffer, offset, v1, v2 ...)\nPacks the values v1, v2, and so forth into a writable buffer object buffer starting at\nbyte offset offset.This only works with objects that support the buffer interface.\nExamples include array.array and bytearray objects.\nunpack(fmt, string)\nUnpacks the contents of a byte string according to the format string in fmt. Returns\na tuple of the unpacked values.The length of string must exactly match the size of\nthe format as determined by the calcsize() function.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2249,
      "extraction_method": "Direct"
    },
    {
      "page_number": 316,
      "chapter": null,
      "content": "291\nstruct\nunpack_from(fmt, buffer, offset)\nUnpacks the contents of a buffer object according to the format string in fmt starting\nat offset offset. Returns a tuple of the unpacked values.\ncalcsize(fmt)\nCalculates the size in bytes of the structure corresponding to a format string fmt.\nStruct Objects\nThe struct module defines a class Struct that provides an alternative interface for\npacking and unpacking. Using this class is more efficient because the format string is\nonly interpreted once.\nStruct(fmt)\nCreates a Struct instance representing data packed according to the given format code.\nAn instance s of Struct has the following methods that work exactly the same as their\nfunctional counterparts described in the previous section:\nMethod\nDescription\ns.pack(v1, v2, ...)\nPacks values into a byte string\ns.pack_into(buffer, offset, v1, v2, ...) Packs values into a buffer object\ns.unpack(bytes)\nUnpacks values from a byte string\ns.unpack_from(buffer, offset)\nUnpacks values from a buffer\nobject\ns.format\nThe format code being used\ns.size\nThe size in bytes of the format \nFormat Codes\nThe format strings used in the struct module are a sequence of characters with the\nfollowing interpretations:\nFormat\nC Type\nPython Type\n'x'\npad byte\nNo value\n'c'\nchar\nString of length 1\n'b'\nsigned char\nInteger\n'B'\nunsigned char\nInteger\n'?'\n_Bool (C99)\nBoolean\n'h'\nshort\nInteger\n'H'\nunsigned short\nInteger\n'i'\nint\nInteger\n'I'\nunsigned int\nInteger\n'l'\nlong\nInteger\n'L'\nunsigned long\nInteger\n'q'\nlong long\nLong\n'Q'\nunsigned long long\nLong\ncontinues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1559,
      "extraction_method": "Direct"
    },
    {
      "page_number": 317,
      "chapter": null,
      "content": "292\nChapter 16 String and Text Handling\nFormat\nC Type\nPython Type\n'f'\nfloat\nFloat\n'd'\ndouble\nFloat\n's'\nchar[]\nString\n'p'\nchar[]\nString with length encoded in the first byte\n'P'\nvoid *\nInteger\nEach format character can be preceded by an integer to indicate a repeat count (for\nexample, '4i' is the same as 'iiii'). For the 's' format, the count represents the\nmaximum length of the string, so '10s' represents a 10-byte string.A format of '0s'\nindicates a string of zero length.The 'p' format is used to encode a string in which the\nlength appears in the first byte, followed by the string data.This is useful when dealing\nwith Pascal code, as is sometimes necessary on the Macintosh. Note that the length of\nthe string in this case is limited to 255 characters.\nWhen the 'I' and 'L' formats are used to unpack a value, the return value is a\nPython long integer. In addition, the 'P' format may return an integer or long integer,\ndepending on the word size of the machine.\nThe first character of each format string can also specify a byte ordering and align-\nment of the packed data, as shown here:\nFormat\nByte Order\nSize and Alignment\n'@'\nNative\nNative\n'='\nNative\nStandard\n'<'\nLittle-endian\nStandard\n'>'\nBig-endian\nStandard\n'!'\nNetwork (big-endian)\nStandard\nNative byte ordering may be little-endian or big-endian, depending on the machine\narchitecture.The native sizes and alignment correspond to the values used by the C\ncompiler and are implementation-specific.The standard alignment assumes that no\nalignment is needed for any type.The standard size assumes that short is 2 bytes, int is\n4 bytes, long is 4 bytes, float is 32 bits, and double is 64 bits.The 'P' format can\nonly use native byte ordering.\nNotes\nn Sometimes it’s necessary to align the end of a structure to the alignment require-\nments of a particular type.To do this, end the structure-format string with the\ncode for that type with a repeat count of zero. For example, the format 'llh0l'\nspecifies a structure that ends on a 4-byte boundary (assuming that longs are\naligned on 4-byte boundaries). In this case, two pad bytes would be inserted after\nthe short value specified by the 'h' code.This only works when native size and\nalignment are being used—standard size and alignment don’t enforce alignment\nrules.\nn The 'q’ and 'Q' formats are only available in “native” mode if the C compiler\nused to build Python supports the long long data type.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2440,
      "extraction_method": "Direct"
    },
    {
      "page_number": 318,
      "chapter": null,
      "content": "293\nunicodedata\nSee Also:\narray (p. 259), ctypes (p. 612)\nunicodedata\nThe unicodedata module provides access to the Unicode character database, which\ncontains character properties for all Unicode characters.\nbidirectional(unichr)\nReturns the bidirectional category assigned to unichr as a string or an empty string if\nno such value is defined. Returns one of the following:\nValue\nDescription\nL\nLeft-to-Right\nLRE\nLeft-to-Right embedding\nLRO\nLeft-to-Right override\nR\nRight-to-Left\nAL\nRight-to-Left Arabic\nRLE\nRight-to-Left embedding\nRLO\nRight-to-Left override\nPDF\nPop directional format\nEN\nEuropean number\nES\nEuropean number separator\nET\nEuropean number terminator\nAN\nArabic number\nCS\nCommon number separator\nNSM\nNonspacing mark\nBN\nBoundary neutral\nB\nParagraph separator\nS\nSegment separator\nWS\nWhitespace\nON\nOther neutrals\ncategory(unichr)\nReturns a string describing the general category of unichr.The returned string is one\nof the following values:\nValue\nDescription\nLu\nLetter, uppercase\nLl\nLetter, lowercase\nLt\nLetter, title case\nMn\nMark, nonspacing\nMc\nMark, spacing combining\nMe\nMark, enclosing\ncontinues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1129,
      "extraction_method": "Direct"
    },
    {
      "page_number": 319,
      "chapter": null,
      "content": "294\nChapter 16 String and Text Handling\nValue\nDescription\nNd\nNumber, decimal digit\nNl\nNumber, letter\nNo\nNumber, other\nZs\nSeparator, space\nZl\nSeparator, line\nZp\nSeparator, paragraph\nCc\nOther, control\nCf\nOther, format\nCs\nOther, surrogate\nCo\nOther, private use\nCn\nOther, not assigned\nLm\nLetter, modifier\nLo\nLetter, other\nPc\nPunctuation, connector\nPd\nPunctuation, dash\nPs\nPunctuation, open\nPe\nPunctuation, close\nPi\nPunctuation, initial quote\nPf\nPunctuation, final quote\nPo\nPunctuation, other\nSm\nSymbol, math\nSc\nSymbol, currency\nSk\nSymbol, modifier\nSo\nSymbol, other\ncombining(unichr)\nReturns an integer describing the combining class for unichr or 0 if no combining\nclass is defined. One of the following values is returned:\nValue\nDescription\n0\nSpacing, split, enclosing, reordrant, and Tibetan subjoined\n1\nOverlays and interior\n7\nNuktas\n8\nHiragana/Katakana voicing marks\n9\nViramas\n10-199\nFixed-position classes\n200\nBelow left attached\n202\nBelow attached\n204\nBelow right attached\n208\nLeft attached\n210\nRight attached\n212\nAbove left attached\n214\nAbove attached\n216\nAbove right attached\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1102,
      "extraction_method": "Direct"
    },
    {
      "page_number": 320,
      "chapter": null,
      "content": "295\nunicodedata\nValue\nDescription\n218\nBelow left\n220\nBelow\n222\nBelow right\n224\nLeft\n226\nRight\n228\nAbove left\n230\nAbove\n232\nAbove right\n233\nDouble below\n234\nDouble above\n240\nBelow (iota subscript)\ndecimal(unichr[, default])\nReturns the decimal integer value assigned to the character unichr. If unichr is not a\ndecimal digit, default is returned or ValueError is raised.\ndecomposition(unichr)\nReturns a string containing the decomposition mapping of unichr or the empty string\nif no such mapping is defined.Typically, characters containing accent marks can be\ndecomposed into multicharacter sequences. For example, decomposition(u\"\\u00fc\")\n(\"ü\") returns the string \"0075 0308\" corresponding to the letter u and the umlaut (¨)\naccent mark.The string returned by this function may also include the following strings:\nValue\nDescription\n<font>\nA font variant (for example, a blackletter form)\n<noBreak>\nA nonbreaking version of a space or hyphen\n<initial>\nAn initial presentation form (Arabic)\n<medial>\nA medial presentation form (Arabic)\n<final>\nA final presentation form (Arabic)\n<isolated>\nAn isolated presentation form (Arabic)\n<circle>\nAn encircled form\n<super>\nA superscript form\n<sub>\nA subscript form\n<vertical>\nA vertical layout presentation form\n<wide>\nA wide (or zenkaku) compatibility character\n<narrow>\nA narrow (or hankaku) compatibility character\n<small>\nA small variant form (CNS compatibility)\n<square>\nA CJK squared-font variant\n<fraction>\nA vulgar fraction form\n<compat>\nOtherwise unspecified compatibility character\ndigit(unichr[, default])\nReturns the integer digit value assigned to the character unichr. If unichr is not \na digit, default is returned or ValueError is raised.This function differs from \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1743,
      "extraction_method": "Direct"
    },
    {
      "page_number": 321,
      "chapter": null,
      "content": "296\nChapter 16 String and Text Handling\ndecimal() in that it works with characters that may represent digits but that are not\ndecimal digits.\neast_asian_width(unichr)\nReturns the east Asian width assigned to unichr.\nlookup(name)\nLooks up a character by name. For example, lookup('COPYRIGHT SIGN') returns \nthe corresponding Unicode character. Common names can be found at\nhttp://www.unicode.org/charts.\nmirrored(unichr)\nReturns 1 if unichr is a “mirrored” character in bidirectional text and returns 0 other-\nwise.A mirrored character is one whose appearance might be changed to appear prop-\nerly if text is rendered in reverse order. For example, the character '(' is mirrored\nbecause it might make sense to flip it to ')' in cases where text is printed from right to\nleft.\nname(unichr [, default])\nReturns the name of a Unicode character, unichr. Raises ValueError if no name is\ndefined or returns default if provided. For example, name(u'\\xfc') returns 'LATIN\nSMALL LETTER U WITH DIAERESIS'.\nnormalize(form, unistr)\nNormalizes the Unicode string unistr according to normal form form. form is one of\n'NFC', 'NFKC', 'NFD', or 'NFKD'.The normalization of a string partly pertains to the\ncomposition and decomposition of certain characters. For example, the Unicode string\nfor the word “resumé” could be represented as u'resum\\u00e9' or as the string \nu'resume\\u0301'. In the first string, the accented character é is represented as a single\ncharacter. In the second string, the accented character is represented by the letter e fol-\nlowed by a combining accent mark (´). 'NFC' normalization converts the string unistr\nso that all of the characters are fully composed (for example, é is a single character).\n'NFD' normalization converts unistr so that characters are decomposed (for example,\né is the letter e followed by an accent). 'NFKC' and 'NFKD' perform the same function\nas 'NFC' and 'NFD' except that they additionally transform certain characters that may\nbe represented by more than one Unicode character value into a single standard value.\nFor example, Roman numerals have their own Unicode character values but are also\njust represented by the Latin letters I, V, M, and so on. 'NFKC' and 'NFKD' would con-\nvert the special Roman numeral characters into their Latin equivalents.\nnumeric(unichr[, default])\nReturns the value assigned to the Unicode character unichr as a floating-point num-\nber. If no numeric value is defined, default is returned or ValueError is raised. For\nexample, the numeric value of U+2155 (the character for the fraction \"1/5\") is 0.2.\nunidata_version\nA string containing the Unicode database version used (for example, '5.1.0').\nNote\nFor further details about the Unicode character database, see http://www.unicode.org.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2778,
      "extraction_method": "Direct"
    },
    {
      "page_number": 322,
      "chapter": null,
      "content": "17\nPython Database Access\nThis chapter describes the programming interfaces that Python uses to interface with\nrelational and hash table style databases. Unlike other chapters that describe specific\nlibrary modules, the material in this chapter partly applies to third-party extensions. For\nexample, if you want Python to interface with a MySQL or Oracle database, you would\nfirst have to download a third-party extension module.That module, in turn, would\nthen follow the basic conventions described here.\nRelational Database API Specification\nFor accessing relational databases, the Python community has developed a standard\nknown as the Python Database API Specification V2.0, or PEP 249 for short (the formal\ndescription can be found at http://www.python.org/dev/peps/pep-249/). Specific\ndatabase modules (e.g., MySQL, Oracle, and so on) follow this specification, but may\nadd even more features.This section covers the essential elements needed to use it for\nmost applications.\nAt a high level, the database API defines a set of functions and objects for connecting\nto a database server, executing SQL queries, and obtaining results. Two primary objects\nare used for this: a Connection object that manages the connection to the database and\na Cursor object that is used to perform queries.\nConnections\nTo connect to a database, every database module provides a module-level function \nconnect(parameters).The exact parameters depend on the database but typically\ninclude information such as the data source name, user name, password, host name, and\ndatabase name.Typically these are provided with keyword arguments dsn, user, pass-\nword, host, and database, respectively. So, a call to connect() might look like this:\nconnect(dsn=\"hostname:DBNAME\",user=\"michael\",password=\"peekaboo\")\nIf successful, a Connection object is returned.An instance c of Connection has the\nfollowing methods:\nc.close()\nCloses the connection to the server.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1959,
      "extraction_method": "Direct"
    },
    {
      "page_number": 323,
      "chapter": null,
      "content": "298\nChapter 17 Python Database Access\nc.commit()\nCommits all pending transactions to the database. If the database supports transactions,\nthis must be called for any changes to take effect. If the underlying database does not\nsupport transactions, this method does nothing.\nc.rollback()\nRolls back the database to the start of any pending transactions.This method is some-\ntimes used in databases that do not support transactions in order to undo any changes\nmade to the database. For example, if an exception occurred in code that was in the\nmiddle of updating a database, you might use this to undo changes made before the\nexception.\nc.cursor()\nCreates a new Cursor object that uses the connection.A cursor is an object that you\nwill use to execute SQL queries and obtain results.This is described in the next section.\nCursors\nIn order to perform any operations on the database, you first create a connection c and\nthen you call c.cursor() method to create a Cursor object.An instance cur of a\nCursor has a number of standard methods and attributes that are used to execute\nqueries:\ncur.callproc(procname [, parameters])\nCalls a stored procedure with name procname. parameters, which is a sequence of\nvalues that are used as the arguments to the procedure.The result of this function is a\nsequence with the same number of items as parameters.This sequence is a copy of\nparameters where the values of any output arguments have been replaced with their\nmodified values after execution. If a procedure also produces an output set, it can be\nread using the fetch*() methods described next.\ncur.close()\nCloses the cursor, preventing any further operations on it.\ncur.execute(query [, parameters])\nExecutes a query or command query on the database. query is a string containing the\ncommand (usually SQL), and parameters is either a sequence or mapping that is used\nto supply values to variables in the query string (this is described in the next section).\ncur.executemany(query [, parametersequence])\nRepeatedly executes a query or command. query is a query string, and \nparametersquence is a sequence of parameters. Each item in this sequence is a\nsequence or mapping object that you would have used with the execute() method\nshown earlier.\ncur.fetchone()\nReturns the next row of the result set produced by execute() or executemany().\nThe result is typically a list or tuple containing values for the different columns of the\nresult. None is returned if there are no more rows available.An exception is raised if\nthere is no pending result or if the previously executed operation didn’t create a result\nset.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2627,
      "extraction_method": "Direct"
    },
    {
      "page_number": 324,
      "chapter": null,
      "content": "299\nRelational Database API Specification\ncur.fetchmany([size])\nReturns a sequence of result rows (e.g., a list of tuples). size is the number of rows to\nreturn. If omitted, the value of cur.arraysize is used as a default.The actual number\nof rows returned may be less than requested.An empty sequence is returned if no more\nrows are available.\ncur.fetchall()\nReturns a sequence of all remaining result rows (e.g., a list of tuples).\ncur.nextset()\nDiscards all remaining rows in the current result set and skips to the next result set (if\nany). Returns None if there are no more result sets; otherwise, a True value is returned\nand subsequent fetch*() operations return data from the new set.\ncur.setinputsize(sizes)\nGives the cursor a hint about the parameters to be passed on subsequent execute*()\nmethods. sizes is a sequence of type objects (described shortly) or integers which give\nthe maximum expected string length for each parameter. Internally, this is used to pre-\ndefine memory buffers for creating the queries and commands sent to the database.\nUsing this can speed up subsequent execute*() operations.\ncur.setoutputsize(size [, column])\nSets the buffer size for a specific column in result sets. column is an integer index into\nthe result row, and size is the number of bytes.A typical use of this method is to set\nlimits on large database columns such as strings, BLOBs, and LONGs prior to making\nany execute*() calls. If column is omitted, it sets a limit for all columns in the result.\nCursors have a number of attributes that describe the current result set and give\ninformation about the cursor itself.\ncur.arraysize\nAn integer that gives the default value used for the fetchmany() operation.This value\nmay vary between database modules and may be initially set to a value that the module\nconsiders to be “optimal.”\ncur.description\nA sequence of tuples that give information about each column in the current result set.\nEach tuple has the form (name, type_code, display_size, internal_size,\nprecision, scale, null_ok).The first field is always defined and corresponds to\nthe column name.The type_code can be used in comparisons involving the type\nobjects described in the “Type Objects” section.The other fields may be set to None if\nthey don’t apply to the column.\ncur.rowcount\nThe number of rows in the last result produced by one of the execute*() methods. If\nset to -1, it means that there is either no result set or that the row count can’t be deter-\nmined.\nAlthough not required by the specification, the Cursor object in most database\nmodules also implements the iteration protocol. In this case, a statement such as for\nrow in cur: will iterate over the rows the result set created by the last execute*()\nmethod.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2762,
      "extraction_method": "Direct"
    },
    {
      "page_number": 325,
      "chapter": null,
      "content": "300\nChapter 17 Python Database Access\nHere is a simple example showing how some of these operations are used with the\nsqlite3 database module, which is a built-in library:\nimport sqlite3\nconn = sqlite3.connect(\"dbfile\")\ncur = conn.cursor()\n# Example of a simple query\ncur.execute(\"select name, shares, price from portfolio where account=12345\")\n# Looping over the results\nwhile True:\nrow = cur.fetchone()\nif not row: break\n# Process the row\nname, shares, price = row\n...\n# An alternative approach (using iteration)\ncur.execute(\"select name, shares, price from portfolio where account=12345\")\nfor name, shares, price in cur:\n# Process the row\n...\nForming Queries\nA critical part of using the database API involves forming SQL query strings to pass\ninto the execute*() methods of cursor objects. Part of the problem here is that you\nneed to fill in parts of the query string with parameters supplied by the user. For exam-\nple, you might be inclined to write code like this:\nsymbol = \"AIG\"\naccount = 12345\ncur.execute(\"select shares from portfolio where name='%s' and account=%d\" %\n(symbol, account))\nAlthough this “works,” you should never manually form queries using Python string\noperations like this. If you do, it opens up your code to a potential SQL injection\nattack—a vulnerability that someone can use to execute arbitrary statements on the\ndatabase server. For example, in the previous code, someone might supply a value for\nsymbol that looks like \"EVIL LAUGH'; drop table portfolio;--\" which probably\ndoes something other than what you anticipated.\nAll database modules provide their own mechanism for value substitution. For exam-\nple, instead of forming the entire query as shown, you might do this instead:\nsymbol  = \"AIG\"\naccount = 12345\ncur.execute(\"select shares from portfolio where name=? and account=?\", \n(symbol, account))\nHere, the '?' placeholders are successively replaced with values from the tuple \n(symbol, account).\nSadly, there is no standard convention for placeholders across database module imple-\nmentations. However, each module defines a variable paramstyle that indicates the\nformatting of value substitutions to be used in queries. Possible values of this variable\nare as follows:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2238,
      "extraction_method": "Direct"
    },
    {
      "page_number": 326,
      "chapter": null,
      "content": "301\nRelational Database API Specification\nParameter Style\nDescription\n'qmark'\nQuestion mark style where each ? in the query is replaced by suc-\ncessive items in a sequence. For example, cur.execute(\"...\nwhere name=? and account=?\", (symbol, account)). The\nparameters are specified as a tuple.\n'numeric'\nNumeric style where :n is filled in with the parameter value at index\nn. For example, cur.execute(\"... where name=:0 and\naccount=:1\",(symbol, account)).\n'named'\nNamed style where :name is filled in with a named value. For this\nstyle, the parameters must be given as a mapping. For example,\ncur.execute(\"... where name=:symbol and\naccount=:account\", {'symbol':symbol, 'account':\naccount}).\n'format'\nPrintf-style format codes such as %s, %d, etc. For example,\ncur.execute(\"... where name=%s and account=%d\",\n(symbol, account)).\n'pyformat'\nPython extended format codes such as %(name)s. Similar to the\n'named' style. Parameters must be specified as a mapping instead\nof a tuple.\nType Objects\nWhen working with database data, built-in types such as integers and strings are usually\nmapped to an equivalent type in the database. However, for dates, binary data, and other\nspecial types, data management is more tricky.To assist with this mapping, database\nmodules implement a set of constructor functions for creating objects of various types.\nDate(year, month, day)\nCreates an object representing a date.\nTime(hour, minute, second)\nCreates an object representing a time.\nTimestamp(year, month, day, hour, minute, second)\nCreates an object representing a timestamp.\nDateFromTicks(ticks)\nCreates a date object from a value of the system time. ticks is the number of seconds\nas returned by a function such as time.time().\nTimeFromTicks(ticks)\nCreates a time object from a value of the system time.\nTimestampFromTicks(ticks)\nCreates a timestamp object from a value of the system time.\nBinary(s)\nCreates a binary object from a byte-string s.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1958,
      "extraction_method": "Direct"
    },
    {
      "page_number": 327,
      "chapter": null,
      "content": "302\nChapter 17 Python Database Access\nIn addition to these constructor functions, the following type objects might be\ndefined.The purpose of these codes is to perform type checking against the type_code\nfield of cur.description, which describes the contents of the current result set.\nType Object \nDescription\nSTRING\nCharacter or text data\nBINARY\nBinary data such as BLOBs\nNUMBER\nNumeric data\nDATETIME\nDate and time data\nROWID\nRow ID data\nError Handling\nDatabase modules define a top-level exception Error that is a base class for all other\nerrors.The following exceptions are for more specific kinds of database errors:\nException\nDescription\nInterfaceError\nErrors related to the database interface, but not the database\nitself.\nDatabaseError\nErrors related to the database itself.\nDataError\nErrors related to the processed data. For example, bad type\nconversions, division by zero, etc.\nOperationalError\nErrors related to the operation of the database itself. For\nexample, a lost connection.\nIntegrityError\nError when relational integrity of the database is broken.\nInternalError\nInternal error in the database. For example, if a stale cursor.\nProgrammingError\nErrors in SQL queries.\nNotSupportedError\nError for methods in the database API that aren’t supported by\nthe underlying database. \nModules may also define a Warning exception that is used by the database module to\nwarn about things such as data truncation during updates.\nMultithreading\nIf you are mixing database access with multithreading, the underlying database module\nmay or may not be thread-safe.The following variable is defined in each module to\nprovide more information.\nthreadsafety\nAn integer that indicates the thread safety of the module. Possible values are:\n0\nNo thread safety. Threads may not share any part of the module.\n1\nThe module is thread-safe, but connections may not be shared.\n2\nThe module and connections are thread-safe, but cursors may not be shared.\n3\nThe module, connections, and cursors are all thread-safe.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2024,
      "extraction_method": "Direct"
    },
    {
      "page_number": 328,
      "chapter": null,
      "content": "303\nsqlite3 Module\nMapping Results into Dictionaries\nA common issue concerning database results is the mapping of tuples or lists into a dic-\ntionary of named fields. For example, if the result set of a query contains a large number\nof columns, it may be easier to work with this data using descriptive field names instead\nof hard-coding the numeric index of specific fields within a tuple.\nThere are many ways to handle this, but one of the most elegant ways to process\nresult data is through the use of generator functions. For example:\ndef generate_dicts(cur):\nimport itertools\nfieldnames = [d[0].lower() for d in cur.description ]\nwhile True:\nrows = cur.fetchmany()\nif not row: return\nfor row in rows:\nyield dict(itertools.izip(fieldnames,row))\n# Sample use\ncur.execute(\"select name, shares, price from portfolio\")\nfor r in generate_dicts(cur):\nprint r['name'],r['shares'],r['price']\nBe aware that the naming of columns is not entirely consistent between databases—\nespecially with respect to things such as case sensitivity. So, you’ll need to be a little\ncareful if you try to apply this technique to code that’s meant to work with a variety of\ndifferent database modules.\nDatabase API Extensions\nFinally, many extensions and advanced features can be added to specific database \nmodules—for example, support for two-phase commits and extended error handling.\nPEP-249 has additional information about the recommended interface for these features\nand should be consulted by advanced users.Third-party library modules also may sim-\nplify the use of relational database interfaces.\nsqlite3 Module\nThe sqlite3 module provides a Python interface to the SQLite database library\n(http://www.sqlite.org). SQLite is a C library that implements a self-contained relation-\nal database entirely within a file or in memory.Although it is simple, this library is\nattractive for various reasons. For one, it does not rely upon a separate database server\nnor does it require any kind of special configuration—you can start to use it right away\nin your programs by simply connecting to a database file (and if it doesn’t exist, a new\nfile is created).The database also supports transactions for improved reliability (even\nacross system crashes) as well as locking to allow the same database file to be simultane-\nously accessed from multiple processes.\nThe programming interface to the library follows the conventions described in the\nprevious section on the Database API, so much of that detail is not repeated here.\nInstead, this section focuses on the technical details of using this module as well as fea-\ntures that are specific to the sqlite3 module.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2667,
      "extraction_method": "Direct"
    },
    {
      "page_number": 329,
      "chapter": null,
      "content": "304\nChapter 17 Python Database Access\nModule-Level Functions\nThe following functions are defined by the sqlite3 module:\nconnect(database [, timeout [, isolation_level [, detect_types]]])\nCreates a connection to a SQLite database. database is a string that specifies the name\nof the database file. It can also be a string \":memory:\", in which case an in-memory\ndatabase is used (note that this kind of database only persists as long as the Python\nprocess remains running and would be lost on program exit).The timeout parameter\nspecifies the amount of time to wait for an internal reader-writer lock to be released\nwhen other connections are updating the database. By default, timeout is 5 seconds.\nWhen SQL statements such as INSERT or UPDATE are used, a new transaction is auto-\nmatically started if one wasn’t already in effect.The isolation_level parameter is a\nstring that provides an optional modifier to the underlying SQL BEGIN statement that is\nused to start this transaction. Possible values are \"\" (the default), \"DEFERRED\",\n\"EXCLUSIVE\", or \"IMMEDIATE\".The meaning of these settings is related to the under-\nlying database lock and is as follows:\nIsolation Level\nDescription\n\"\" (empty string)\nUse the default setting (DEFERRED).\n\"DEFERRED\"\nStarts a new transaction, but does not acquire the lock until the\nfirst database operation is actually performed.\n\"EXCLUSIVE\"\nStarts a new transaction and guarantees that no other connections\ncan read or write the database until changes are committed.\n\"IMMEDIATE\"\nStarts a new transaction and guarantees that no other connection\ncan make database modifications until changes are committed.\nOther connections can still read from the database, however.\nThe detect_types parameter enables some extra type detection (implemented by\nextra parsing of SQL queries) when returning results. By default it is 0 (meaning no\nextra detection). It can be set to the bitwise-or of PARSE_DECLTYPES and\nPARSE_COLNAMES. If PARSE_DECLTYPES is enabled, queries are examined for SQL type-\nnames such as \"integer\" or \"number(8)\" in order to determine the type of result\ncolumns. If PARSE_COLNAMES is enabled, special strings of the form \"colname\n[typename]\" (including the double quotes) can be embedded into queries where \ncolname is the column name and typename is the name of a type registered with the\nregister_converter() function described next.These strings are simply transformed\ninto colname when passed to the SQLite engine, but the extra type specifier is used\nwhen converting values in the results of a query. For example, a query such as 'select\nprice as \"price [decimal]\" from portfolio' is interpreted as 'select price\nas price from portfolio', and the results will be converted according to the “dec-\nimal” conversion rule.\nregister_converter(typename, func)\nRegisters a new type name for use with the detect_types option to connect().\ntypename is a string containing the type name as it will be used in queries, and func is\na function that takes a single bytestring as input and returns a Python datatype as a result.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3085,
      "extraction_method": "Direct"
    },
    {
      "page_number": 330,
      "chapter": null,
      "content": "305\nsqlite3 Module\nFor example, if you call sqlite3.register_converter('decimal', decimal.\nDecimal), then you can have values in queries converted to Decimal objects by writing\nqueries such as 'select price as \"price [decimal]\" from stocks'.\nregister_adapter(type, func)\nRegisters an adapter function for a Python type type that is used when storing values\nof that type in the datatype. func is a function that accepts an instance of type type as\ninput and returns a int, float, UTF-8–encoded byte string, Unicode string, or buffer\nas a result. For example, if you wanted to store Decimal objects, you might use\nsqlite3.register_adapter(decimal.Decimal,float).\ncomplete_statement(s)\nReturns True if the string s represents one or more complete SQL statements separat-\ned by semicolons.This might be useful if writing an interactive program that reads\nqueries from the user.\nenable_callback_tracebacks(flag)\nDetermines the handling of exceptions in user-defined callback functions such as con-\nverters and adapters. By default, exceptions are ignored. If flag is set to True, traceback\nmessages will be printed on sys.stderr.\nConnection Objects\nThe Connection object c returned by the connect() function supports the standard\noperations described in the Database API. In addition, the following methods specific to\nthe sqlite3 module are provided.\nc.create_function(name, num_params, func)\nCreates a user-defined function that can be used in SQL statements. name is a string\ncontaining the name of the function, num_params is an integer giving the number of\nparameters, and func is a Python function that provides the implementation. Here is a\nsimple example:\ndef toupper(s):\nreturn s.upper()\nc.create_function(\"toupper\",1,toupper)\n# Sample use in a query\nc.execute(\"select toupper(name),foo,bar from sometable\")\nAlthough a Python function is being defined, the parameters and inputs of this function\nshould only be int, float, str, unicode, buffer, or None.\nc.create_aggregate(name, num_params, aggregate_class)\nCreates a user-defined aggregation function for use in SQL statements. name is a string\ncontaining the name of the function, and num_params is an integer giving the number of\ninput parameters. aggregate_class is a class that implements the aggregation operation.\nThis class must support initialization with no arguments and implements a step(params)\nmethod that accepts the same number of parameters as given in num_params and a\nfinalize() method that returns the final result. Here is a simple example:\nclass Averager(object):\ndef _ _init_ _(self):\nself.total = 0.0\nself.count = 0\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2616,
      "extraction_method": "Direct"
    },
    {
      "page_number": 331,
      "chapter": null,
      "content": "306\nChapter 17 Python Database Access\ndef step(self,value):\nself.total += value\nself.count += 1\ndef finalize(self):\nreturn self.total / self.count\nc.create_aggregate(\"myavg\",1,Averager)\n# Sample use in a query\nc.execute(\"select myavg(num) from sometable\")\nAggregation works by making repeated calls to the step() method with input values\nand then calling finalize() to obtain the final value.\nc.create_collation(name, func)\nRegisters a user-defined collation function for use in SQL statements. name is a string\ncontaining the name of the collation function, and func is a function that accepts two\ninputs and returns -1, 0, 1 depending on whether or not the first input is below, equal\nto, or above the second input.You use the user-defined function using a SQL expression\nsuch as \"select * from table order by colname collate name\".\nc.execute(sql [, params])\nA shortcut method that creates a cursor object using c.cursor() and executes the cur-\nsor’s execute() method with SQL statements in sql with the parameters in params.\nc.executemany(sql [, params])\nA shortcut method that creates a cursor object using c.cursor() and executes the cur-\nsor’s executemany() method with SQL statements in sql with the parameters in\nparams.\nc.executescript(sql)\nA shortcut method that creates a cursor object using c.cursor() and executes the cur-\nsor’s executescript() method with SQL statements in sql.\nc.interrupt()\nAborts any currently executing queries on the connection.This is meant to be called\nfrom a separate thread.\nc.iterdump()\nReturns an iterator that dumps the entire database contents to a series of SQL state-\nments that could be executed to recreate the database.This could be useful if exporting\nthe database elsewhere or if you need to dump the contents of an in-memory database\nto a file for later restoration.\nc.set_authorizer(auth_callback)\nRegisters an authorization callback function that gets executed on every access to a col-\numn of data in the database.The callback function must take five arguments as\nauth_callback(code, arg1, arg2, dbname, innername).The value returned by\nthis callback is one of SQLITE_OK if access is allowed, SQLITE_DENY if the SQL state-\nment should fail with an error, or SQLITE_IGNORE if the column should be ignored by\ntreating it as a Null value.The first argument code is an integer action code. arg1 and\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2372,
      "extraction_method": "Direct"
    },
    {
      "page_number": 332,
      "chapter": null,
      "content": "307\nsqlite3 Module\narg2 are parameters whose values depend on the value of code. dbname is a string con-\ntaining the name of the database (usually \"main\"), and innername is the name of the\ninnermost view or trigger that is attempting access or None if no view or trigger is\nactive.The following table lists the values for code and meaning of the arg1 and arg2\nparameters:\nCode\nArg1\nArg2\nSQLITE_CREATE_INDEX\nIndex name\nTable name\nSQLITE_CREATE_TABLE\nTable name\nNone\nSQLITE_CREATE_TEMP_INDEX\nIndex name\nTable name\nSQLITE_CREATE_TEMP_TABLE\nTable name\nNone\nSQLITE_CREATE_TEMP_TRIGGER\nTrigger name\nTable name\nSQLITE_CREATE_TEMP_VIEW\nView name\nNone\nSQLITE_CREATE_TRIGGER\nTrigger name\nTable name\nSQLITE_CREATE_VIEW\nView name\nNone\nSQLITE_DELETE\nTable name\nNone\nSQLITE_DROP_INDEX\nIndex name\nTable name\nSQLITE_DROP_TABLE\nTable name\nNone\nSQLITE_DROP_TEMP_INDEX\nIndex name\nTable name\nSQLITE_DROP_TEMP_TABLE\nTable name\nNone\nSQLITE_DROP_TEMP_TRIGGER\nTrigger name\nTable name\nSQLITE_DROP_TEMP_VIEW\nView name\nNone\nSQLITE_DROP_TRIGGER\nTrigger name\nTable name\nSQLITE_DROP_VIEW\nView name\nNone\nSQLITE_INSERT\nTable name\nNone\nSQLITE_PRAGMA\nPragma name\nNone\nSQLITE_READ\nTable name\nColumn name\nSQLITE_SELECT\nNone\nNone\nSQLITE_TRANSACTION\nNone\nNone\nSQLITE_UPDATE\nTable name\nColumn name\nSQLITE_ATTACH\nFilename\nNone\nSQLITE_DETACH\nDatabase name\nNone\nSQLITE_ALTER_TABLE\nDatabase name\nTable name\nSQLITE_REINDEX\nIndex name\nNone\nSQLITE_ANALYZE\nTable name\nNone\nSQLITE_CREATE_VTABLE\nTable name\nModule name\nSQLITE_DROP_VTABLE\nTable name\nModule name\nSQLITE_FUNCTION\nFunction name\nNone\nc.set_progress_handler(handler, n)\nRegisters a callback function that gets executed every n instructions of the SQLite vir-\ntual machine. handler is a function that takes no arguments.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1754,
      "extraction_method": "Direct"
    },
    {
      "page_number": 333,
      "chapter": null,
      "content": "308\nChapter 17 Python Database Access\nThe following attributes are also defined on connection objects.\nc.row_factory\nA function that gets called to create the object representing the contents of each result\nrow.This function takes two arguments: the cursor object used to obtain the result and a\ntuple with the raw result row.\nc.text_factory\nA function that is called to create the objects representing text values in the database.\nThe function must take a single argument that is a UTF-8–encoded byte string.The\nreturn value should be some kind of string. By default, a Unicode string is returned.\nc.total_changes\nAn integer representing the number of rows that have been modified since the database\nconnection was opened.\nA final feature of connection objects is that they can be used with the context-\nmanager protocol to automatically handle transactions. For example:\nconn = sqlite.connect(\"somedb\")\nwith conn:\nconn.execute(\"insert into sometable values (?,?)\", (\"foo\",\"bar\")))\nIn this example, a commit() operation is automatically performed after all statements in\nthe with block have executed and no errors have occurred. If any kind of exception is\nraised, a rollback() operation is performed and the exception is reraised.\nCursors and Basic Operations\nTo perform basic operations on a sqlite3 database, you first have to create a cursor\nobject using the cursor() method of a connection.You then use the execute(),\nexecutemany(), or executescript() methods of the cursor to execute SQL state-\nments. See the Database API section for further details about the general operation of\nthese methods. Instead of repeating that information here, a set of common database use\ncases are presented along with sample code.The goal is to show both the operation of\ncursor objects and some common SQL operations for those programmers who might\nneed a brief refresher on the syntax.\nCreating New Database Tables\nThe following code shows how to open a database and create a new table:\nimport sqlite3\nconn = sqlite3.connect(\"mydb\")\ncur = conn.cursor()\ncur.execute(\"create table stocks (symbol text, shares integer, price real)\")\nconn.commit()\nWhen defining tables, a few primitive SQLite datatypes should be used: text, integer,\nreal, and blob.The blob type is a bytestring, whereas the text type is assumed to be\nUTF-8–encoded Unicode.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2352,
      "extraction_method": "Direct"
    },
    {
      "page_number": 334,
      "chapter": null,
      "content": "309\nsqlite3 Module\nInserting New Values into a Table\nThe following code shows how to insert new items into a table:\nimport sqlite3\nconn = sqlite3.connect(\"mydb\")\ncur = conn.cursor()\ncur.execute(\"insert into stocks values (?,?,?)\",('IBM',50,91.10))\ncur.execute(\"insert into stocks values (?,?,?)\",('AAPL',100,123.45))\nconn.commit()\nWhen inserting values, you should always use the ? substitutions as shown. Each ? is\nreplaced by a value from a tuple of values supplied as parameters.\nIf you have a sequence of data to insert, you can use the executemany() method of\na cursor like this:\nstocks = [ ('GOOG',75,380.13),\n('AA',60,14.20),\n('AIG',125, 0.99) ]\ncur.executemany(\"insert into stocks values (?,?,?)\",stocks)\nUpdating an Existing Row\nThe following code shows how you might update columns for an existing row:\ncur.execute(\"update stocks set shares=? where symbol=?\",(50,'IBM'))\nAgain, when you need to insert values into the SQL statement, make sure you use the ?\nplaceholders and supply a tuple of values as parameters.\nDeleting Rows\nThe following code shows how to delete rows:\ncur.execute(\"delete from stocks where symbol=?\",('SCOX',))\nPerforming Basic Queries\nThe following code shows how you can perform basic queries and obtain the results:\n# Select all columns from a table\nfor row in cur.execute(\"select * from stocks\"):\nstatements\n# Select a few columns\nfor shares, price in cur.execute(\"select shares,price from stocks\"):\nstatements\n# Select matching rows\nfor row in cur.execute(\"select * from stocks where symbol=?\",('IBM',))\nstatements\n# Select matching rows with ordering\nfor row in cur.execute(\"select * from stocks order by shares\"):\nstatements\n# Select matching rows with ordering in reverse\nfor row in cur.execute(\"select * from stocks order by shares desc\"):\nstatements\n# Joining tables on a common column name (symbol)\nfor row in cur.execute(\"\"\"select s.symbol, s.shares, p.price \nfrom stocks as s, prices as p using(symbol)\"\"\"):\nstatements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1985,
      "extraction_method": "Direct"
    },
    {
      "page_number": 335,
      "chapter": null,
      "content": "310\nChapter 17 Python Database Access\nDBM-Style Database Modules\nPython includes a number of library modules for supporting UNIX DBM-style data-\nbase files. Several standard types of these databases are supported.The dbm module is\nused to read standard UNIX-dbm database files.The gdbm module is used to read GNU\ndbm database files (http://www.gnu.org/software/gdbm).The dbhash module is used\nto read database files created by the Berkeley DB library (http://www.oracle.com/\ndatabase/berkeley-db/index.html).The dumbdbm module is a pure-Python module that\nimplements a simple DBM-style database on its own.\nAll of these modules provide an object that implements a persistent string-based dic-\ntionary.That is, it works like a Python dictionary except that all keys and values are\nrestricted to strings.A database file is typically opened using a variation of the open()\nfunction.\nopen(filename [, flag [, mode]])\nThis function opens the database file filename and returns a database object. flag is\n'r' for read-only access, 'w' for read-write access, 'c' to create the database if it\ndoesn’t exist, or 'n' to force the creation of a new database. mode is the integer file-\naccess mode used when creating the database (the default is 0666 on UNIX).\nThe object returned by the open() function minimally supports the following \ndictionary-like operations:\nOperation\nDescription\nd[key] = value\nInserts value into the database\nvalue = d[key]\nGets data from the database\ndel d[key]\nRemoves a database entry\nd.close()\nCloses the database\nkey in d\nTests for a key\nd.sync()\nWrites all changes out to the database\nSpecific implementations may also add additional features (consult the appropriate mod-\nule reference for details).\nOne issue with the various DBM-style database modules is that not every module is\ninstalled on every platform. For example, if you use Python on Windows, the dbm and\ngdbm modules are typically unavailable. However, a program may still want to create a\nDBM-style database for its own use.To address this issue, Python provides a module\nanydbm that can be used to open and create a DBM-style database file.This module\nprovides an open() function as described previously, but it is guaranteed to work on all\nplatforms. It does this by looking at the set of available DBM modules and picking the\nmost advanced library that is available (typically dbhash if it’s installed).As a fallback, it\nuses the dumbdbm module which is always available.\nAnother module is whichdb, which has a function whichdb(filename) that can be\nused to probe a file in order to determine what kind of DBM-database created it.\nAs a general rule, it is probably best not to rely upon these low-level modules for\nany application where portability is important. For example, if you create a DBM data-\nbase on one machine and then transfer the database file to another machine, there is a\nchance that Python won’t be able to read it if the underlying DBM module isn’t\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2977,
      "extraction_method": "Direct"
    },
    {
      "page_number": 336,
      "chapter": null,
      "content": "311\nshelve Module\ninstalled.A high degree of caution is also in order if you are using these database mod-\nules to store large amounts of data, have a situation where multiple Python programs\nmight be opening the same database file concurrently, or need high reliability and trans-\nactions (the sqlite3 module might be a safer choice for that).\nshelve Module\nThe shelve module provides support for persistent objects using a special “shelf”\nobject.This object behaves like a dictionary except that all the objects it contains are\nstored on disk using a hash-table based database such as dbhash, dbm or gdbm. Unlike\nthose modules, however, the values stored in a shelf are not restricted to strings. Instead,\nany object that is compatible with the pickle module may be stored.A shelf is created\nusing the shelve.open() function.\nopen(filename [,flag='c' [, protocol [, writeback]]])\nOpens a shelf file. If the file doesn’t exist, it’s created. filename should be the database\nfilename and should not include a suffix. flag has the same meaning as described in\nthe chapter introduction and is one of 'r', 'w', 'c', or 'n'. If the database file doesn’t\nexist, it is created. protocol specifies the protocol used to pickle objects stored in the\ndatabase. It has the same meaning as described in the pickle module. writeback con-\ntrols the caching behavior of the database object. If True, all accessed entries are cached\nin memory and only written back when the shelf is closed.The default value is False.\nReturns a shelf object.\nOnce a shelf is opened, the following dictionary operations can be performed on it:\nOperation\nDescription\nd[key] = data\nStores data at key. Overwrites existing data.\ndata = d[key]\nRetrieves data at key.\ndel d[key]\nDeletes data at key.\nd.has_key(key)\nTests for the existence of key.\nd.keys()\nReturns all keys.\nd.close()\nCloses the shelf.\nd.sync()\nWrites unsaved data to disk.\nThe key values for a shelf must be strings.The objects stored in a shelf must be serializ-\nable using the pickle module.\nShelf(dict [, protocol [, writeback]])\nA mixin class that implements the functionality of a shelf on top of a dictionary object,\ndict.When this is used, objects stored in the returned shelf object will be pickled and\nstored in the underlying dictionary dict. Both protocol and writeback have the\nsame meaning as for shelve.open().\nThe shelve module uses the anydbm module to select an appropriate DBM module\nfor use. In most standard Python installations, it is likely to be the dbhash, which relies\nupon the Berkeley DB library.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2574,
      "extraction_method": "Direct"
    },
    {
      "page_number": 337,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 338,
      "chapter": null,
      "content": "18\nFile and Directory Handling\nThis chapter describes Python modules for high-level file and directory handling.\nTopics include modules for processing various kinds of basic file encodings such as gzip\nand bzip2 files, modules for extracting file archives such as zip and tar files, and modules\nfor manipulating the file system itself (e.g., directory listings, moving, renaming, copy-\ning, and so on). Low-level operating system calls related to files are covered in Chapter\n19,“Operating System Services.” Modules for parsing the contents of files such as XML\nand HTML are mostly covered in Chapter 24,“Internet Data Handling and Encoding.”\nbz2\nThe bz2 module is used to read and write data compressed according to the bzip2\ncompression algorithm.\nBZ2File(filename [, mode [, buffering [, compresslevel]]])\nOpens a .bz2 file, filename, and returns a file-like object. mode is 'r' for reading or\n'w' for writing. Universal newline support is also available by specifying a mode of\n'rU'. buffering specifies the buffer size in bytes with a default value of 0 (no buffer-\ning). compresslevel is a number between 1 and 9.A value of 9 (the default) provides\nthe highest level of compression but consumes the most processing time.The returned\nobject supports all the common file operations, including close(), read(),\nreadline(), readlines(), seek(), tell(), write(), and writelines().\nBZ2Compressor([compresslevel])\nCreates a compressor object that can be used to sequentially compress a sequence of\ndata blocks. compresslevel specifies the compression level as a number between 1 and\n9 (the default).\nAn instance, c, of BZ2Compressor has the following two methods:\nc.compress(data)\nFeeds new string data to the compressor object, c. Returns a string of compressed data\nif possible. Because compression involves chunks of data, the returned string may not\ninclude all the data and may include compressed data from previous calls to \ncompress().The flush() method should be used to return any remaining data \nstored in the compressor after all input data has been supplied.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2092,
      "extraction_method": "Direct"
    },
    {
      "page_number": 339,
      "chapter": null,
      "content": "314\nChapter 18 File and Directory Handling\nc.flush()\nFlushes the internal buffers and returns a string containing the compressed version of all\nremaining data.After this operation, no further compress() calls should be made on\nthe object.\nBZ2Decompressor()\nCreates a decompressor object.\nAn instance, d, of BZ2Decompressor supports just one method:\nd.decompress(data)\nGiven a chunk of compressed data in the string data, this method returns uncom-\npressed data. Because data is processed in chunks, the returned string may or may not\ninclude a decompressed version of everything supplied in data. Repeated calls to this\nmethod will continue to decompress data blocks until an end-of-stream marker is found\nin the input. If subsequent attempts are made to decompress data after that, an\nEOFError exception will be raised.\ncompress(data [, compresslevel])\nReturns a compressed version of the data supplied in the string data. compresslevel\nis a number between 1 and 9 (the default).\ndecompress(data)\nReturns a string containing the decompressed data in the string data.\nfilecmp\nThe filecmp module provides the following functions, which can be used to compare\nfiles and directories:\ncmp(file1, file2 [, shallow])\nCompares the files file1 and file2 and returns True if they’re equal, False if not. By\ndefault, files that have identical attributes as returned by os.stat() are considered to\nbe equal. If the shallow parameter is specified and is False, the contents of the two\nfiles are compared to determine equality.\ncmpfiles(dir1, dir2, common [, shallow])\nCompares the contents of the files contained in the list common in the two directories\ndir1 and dir2. Returns a tuple containing three lists of filenames (match, mismatch,\nerrors). match lists the files that are the same in both directories, mismatch lists the\nfiles that don’t match, and errors lists the files that could not be compared for some\nreason.The shallow parameter has the same meaning as for cmp().\ndircmp(dir1, dir2 [, ignore[, hide]])\nCreates a directory comparison object that can be used to perform various comparison\noperations on the directories dir1 and dir2. ignore is a list of filenames to ignore and\nhas a default value of ['RCS','CVS','tags']. hide is a list of filenames to hide and\ndefaults to the list [os.curdir, os.pardir] (['.', '..'] on UNIX).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2354,
      "extraction_method": "Direct"
    },
    {
      "page_number": 340,
      "chapter": null,
      "content": "315\nfilecmp\nA directory object, d, returned by dircmp() has the following methods and \nattributes:\nd.report()\nCompares directories dir1 and dir2 and prints a report to sys.stdout.\nd.report_partial_closure()\nCompares dir1 and dir2 and common immediate subdirectories. Results are printed\nto sys.stdout.\nd.report_full_closure()\nCompares dir1 and dir2 and all subdirectories recursively. Results are printed to\nsys.stdout.\nd.left_list\nLists the files and subdirectories in dir1.The contents are filtered by hide and ignore.\nd.right_list\nLists the files and subdirectories in dir2.The contents are filtered by hide and ignore.\nd.common\nLists the files and subdirectories found in both dir1 and dir2.\nd.left_only\nLists the files and subdirectories found only in dir1.\nd.right_only\nLists the files and subdirectories found only in dir2.\nd.common_dirs\nLists the subdirectories that are common to dir1 and dir2.\nd.common_files\nLists the files that are common to dir1 and dir2.\nd.common_funny\nLists the files in dir1 and dir2 with different types or for which no information can\nbe obtained from os.stat().\nd.same_files\nLists the files with identical contents in dir1 and dir2.\nd.diff_files\nLists the files with different contents in dir1 and dir2.\nd.funny_files\nLists the files that are in both dir1 and dir2 but that could not be compared for some\nreason (for example, insufficient permission to access).\nd.subdirs\nA dictionary that maps names in d.common_dirs to additional dircmp objects.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1506,
      "extraction_method": "Direct"
    },
    {
      "page_number": 341,
      "chapter": null,
      "content": "316\nChapter 18 File and Directory Handling\nNote\nThe attributes of a dircmp object are evaluated lazily and not determined at the time\nthe dircmp object is first created. Thus, if you’re interested in only some of the attrib-\nutes, there’s no added performance penalty related to the other unused attributes.\nfnmatch\nThe fnmatch module provides support for matching filenames using UNIX shell-style\nwildcard characters.This module only performs filename matching, whereas the glob\nmodule can be used to actually obtain file listings.The pattern syntax is as follows:\nCharacter(s)\nDescription\n*\nMatches everything\n?\nMatches any single character\n[seq]\nMatches any character in seq\n[!seq]\nMatches any character not in seq\nThe following functions can be used to test for a wildcard match:\nfnmatch(filename, pattern)\nReturns True or False depending on whether filename matches pattern. Case sen-\nsitivity depends on the operating system (and may be non–case-sensitive on certain\nplatforms such as Windows).\nfnmatchcase(filename, pattern)\nPerforms a case-sensitive comparison of filename against pattern.\nfilter(names, pattern)\nApplies the fnmatch() function to all of the names in the sequence names and returns\na list of all names that match pattern.\nExamples\nfnmatch('foo.gif', '*.gif')               # Returns True\nfnmatch('part37.html', 'part3[0-5].html') # Returns False\n# Example of finding files in an entire directory tree\n# using os.walk(), fnmatch, and generators\ndef findall(topdir, pattern):\nfor path, files, dirs in os.walk(topdir):\nfor name in files:\nif fnmatch.fnmatch(name,pattern):\nyield os.path.join(path,name)\n# Find all .py files\nfor pyfile in findall(\".\",\"*.py\"):\nprint pyfile\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1714,
      "extraction_method": "Direct"
    },
    {
      "page_number": 342,
      "chapter": null,
      "content": "317\ngzip\nglob\nThe glob module returns all filenames in a directory that match a pattern specified\nusing the rules of the UNIX shell (as described in the fnmatch module).\nglob(pattern)\nReturns a list of pathnames that match pattern.\niglob(pattern)\nReturns the same results as glob() but using an iterator.\nExample\nhtmlfile = glob('*.html')\nimgfiles = glob('image[0-5]*.gif')\nNote\nTilde (˜) and shell variable expansion are not performed. Use os.path.expanduser()\nand os.path.expandvars(), respectively, to perform these expansions prior to call-\ning glob().\ngzip\nThe gzip module provides a class, GzipFile, that can be used to read and write files\ncompatible with the GNU gzip program. GzipFile objects work like ordinary files\nexcept that data is automatically compressed or decompressed.\nGzipFile([filename [, mode [, compresslevel [, fileobj]]]])\nOpens a GzipFile. filename is the name of a file, and mode is one of 'r', 'rb', 'a',\n'ab', 'w', or 'wb'.The default is 'rb'. compresslevel is an integer from 1 to 9 that\ncontrols the level of compression. 1 is the fastest and produces the least compression; 9\nis the slowest and produces the most compression (the default). fileobj is an existing\nfile object that should be used. If supplied, it’s used instead of the file named by \nfilename.\nopen(filename [, mode [, compresslevel]])\nSame as GzipFile(filename, mode, compresslevel).The default mode is 'rb'.\nThe default compresslevel is 9.\nNotes\nn Calling the close() method of a GzipFile object doesn’t close files passed in\nfileobj.This allows additional information to be written to a file after the com-\npressed data.\nn Files produced by the UNIX compress program are not supported.\nn This module requires the zlib module.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1749,
      "extraction_method": "Direct"
    },
    {
      "page_number": 343,
      "chapter": null,
      "content": "318\nChapter 18 File and Directory Handling\nshutil\nThe shutil module is used to perform high-level file operations such as copying,\nremoving, and renaming.The functions in this module should only be used for proper\nfiles and directories. In particular, they do not work for special kinds of files on the file\nsystem such as named pipes, block devices, etc.Also, be aware that these functions don’t\nalways correctly deal with advanced kinds of file metadata (e.g., resource forks, creator\ncodes, etc.).\ncopy(src,dst)\nCopies the file src to the file or directory dst, retaining file permissions. src and dst\nare strings.\ncopy2(src, dst)\nLike copy() but also copies the last access and modification times.\ncopyfile(src, dst)\nCopies the contents of src to dst. src and dst are strings.\ncopyfileobj(f1, f2 [, length])\nCopies all data from open file object f1 to open file object f2. length specifies a max-\nimum buffer size to use.A negative length will attempt to copy the data entirely with\none operation (that is, all data will be read as a single chunk and then written).\ncopymode(src, dst)\nCopies the permission bits from src to dst.\ncopystat(src, dst)\nCopies the permission bits, last access time, and last modification time from src to dst.\nThe contents, owner, and group of dst are unchanged.\ncopytree(src, dst, symlinks [,ignore]])\nRecursively copies an entire directory tree rooted at src.The destination directory dst\nwill be created (and should not already exist). Individual files are copied using copy2().\nIf symlinks is true, symbolic links in the source tree are represented as symbolic links\nin the new tree. If symlinks is false or omitted, the contents of linked files are copied\nto the new directory tree. ignore is an optional function that can be used to filter out\nspecific files.As input, this function should accept a directory name and a list of directo-\nry contents.As a return value, it should return a list of filenames to be ignored. If errors\noccur during the copy process, they are collected and the Error exception is raised at\nthe end of processing.The exception argument is a list of tuples containing (srcname,\ndstname, exception) for all errors that occurred.\nignore_pattern(pattern1, pattern2, ...)\nCreates a function that can be used for ignoring all of the glob-style patterns given in\npattern1, pattern2, etc.The returned function accepts as input two arguments, the\nfirst of which is a directory name and the second of which is a list of directory con-\ntents.As a result, a list of filenames to be ignored is returned. The primary use of the\nreturned function is as the ignore parameter to the copytree() function shown earli-\ner. However, the resulting function might also be used for operations involving the\nos.walk() function.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2789,
      "extraction_method": "Direct"
    },
    {
      "page_number": 344,
      "chapter": null,
      "content": "319\ntarfile\nmove(src, dst)\nMoves a file or directory src to dst.Will recursively copy src if it is being moved to a\ndifferent file system.\nrmtree(path [, ignore_errors [, onerror]])\nDeletes an entire directory tree. If ignore_errors is true, errors will be ignored.\nOtherwise, errors are handled by the onerror function (if supplied).This function must\naccept three parameters (func, path, and excinfo), where func is the function that\ncaused the error (os.remove() or os.rmdir()), path is the pathname passed to the\nfunction, and excinfo is the exception information returned by sys.exc_info(). If\nan error occurs and onerror is omitted, an exception is raised.\ntarfile\nThe tarfile module is used to manipulate tar archive files. Using this module, it is\npossible to read and write tar files, with or without compression.\nis_tarfile(name)\nReturns True if name appears to be a valid tar file that can be read by this module.\nopen([name [, mode [, fileobj [, bufsize]]]])\nCreates a new TarFile object with the pathname name. mode is a string that specifies\nhow the tar file is to be opened.The mode string is a combination of a file mode and a\ncompression scheme specified as 'filemode[:compression]'.Valid combinations\ninclude the following:\nMode\nDescription\n'r'\nOpen for reading. If the file is compressed, it is decompressed trans-\nparently. This is the default mode.\n'r:'\nOpen for reading without compression.\n'r:gz'\nOpen for reading with gzip compression.\n'r:bz2'\nOpen for reading with bzip2 compression.\n'a', 'a:'\nOpen for appending with no compression.\n'w', 'w:'\nOpen for writing with no compression.\n'w:gz'\nOpen for writing with gzip compression.\n'w:bz2'\nOpen for writing with bzip2 compression.\nThe following modes are used when creating a TarFile object that only allows\nsequential I/O access (no random seeks):\nMode\nDescription\n'r|'\nOpen a stream of uncompressed blocks for reading\n'r|gz'\nOpen a gzip compressed stream for reading\n'r|bz2'\nOpen a bzip2 compressed stream for reading\n'w|'\nOpen an uncompressed stream for writing\n'w|gz'\nOpen a gzip compressed stream for writing\n'w|bz2'\nOpen a bzip2 compressed stream for writing\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2159,
      "extraction_method": "Direct"
    },
    {
      "page_number": 345,
      "chapter": null,
      "content": "320\nChapter 18 File and Directory Handling\nIf the parameter fileobj is specified, it must be an open file object. In this case, the\nfile overrides any filename specified with name. bufsize specifies the block size used in\na tar file.The default is 20*512 bytes.\nA TarFile instance, t, returned by open() supports the following methods and\nattributes:\nt.add(name [, arcname [, recursive]])\nAdds a new file to the tar archive. name is the name of any kind of file (directory, sym-\nbolic link, and so on). arcname specifies an alternative name to use for the file inside\nthe archive. recursive is a Boolean flag that indicates whether or not to recursively\nadd the contents of directories. By default, it is set to True.\nt.addfile(tarinfo [, fileobj])\nAdds a new object to the tar archive. tarinfo is a TarInfo structure that contains\ninformation about the archive member. fileobj is an open file object from which data\nwill be read and saved in the archive.The amount of data to read is determined by the\nsize attribute of tarinfo.\nt.close()\nCloses the tar archive, writing two zero blocks to the end if the archive was opened for\nwriting.\nt.debug\nControls the amount of debugging information produced, with 0 producing no output\nand 3 producing all debugging messages. Messages are written to sys.stderr.\nt.dereference\nIf this attribute is set to True, symbolic and hard links are dereferenced and the entire\ncontents of the referenced file are added to the archive. If it’s set to False, just the link\nis added.\nt.errorlevel\nDetermines how errors are handled when an archive member is being extracted. If this\nattribute is set to 0, errors are ignored. If it’s set to 1, errors result in OSError or\nIOError exceptions. If it’s set to 2, nonfatal errors additionally result in TarError\nexceptions.\nt.extract(member [, path])\nExtracts a member from the archive, saving it to the current directory. member is either\nan archive member name or a TarInfo instance. path is used to specify a different des-\ntination directory.\nt.extractfile(member)\nExtracts a member from the archive, returning a read-only file-like object that can be\nused to read its contents using read(), readline(), readlines(), seek(), and\ntell() operations. member is either an archive member name or a TarInfo object. If\nmember refers to a link, an attempt will be made to open the target of the link.\nt.getmember(name)\nLooks up archive member name and returns a TarInfo object containing information\nabout it. Raises KeyError if no such archive member exists. If member name appears\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2574,
      "extraction_method": "Direct"
    },
    {
      "page_number": 346,
      "chapter": null,
      "content": "321\ntarfile\nmore than once in the archive, information for the last entry is returned (which is\nassumed to be the more recent).\nt.getmembers()\nReturns a list of TarInfo objects for all members of the archive.\nt.getnames()\nReturns a list of all archive member names.\nt.gettarinfo([name [, arcname [, fileobj]]])\nReturns a TarInfo object corresponding to a file, name, on the file system or an open\nfile object, fileobj. arcname is an alternative name for the object in the archive.The\nprimary use of this function is to create an appropriate TarInfo object for use in meth-\nods such as add().\nt.ignore_zeros\nIf this attribute is set to True, empty blocks are skipped when reading an archive. If it’s\nset to False (the default), an empty block signals the end of the archive. Setting this\nmethod to True may be useful for reading a damaged archive.\nt.list([verbose])\nLists the contents of the archive to sys.stdout. verbose determines the level of\ndetail. If this method is set to False, only the archive names are printed. Otherwise, full\ndetails are printed (the default).\nt.next()\nA method used for iterating over the members of an archive. Returns the TarInfo\nstructure for the next archive member or None.\nt.posix\nIf this attribute is set to True, the tar file is created according to the POSIX 1003.1-\n1990 standard.This places restrictions on filename lengths and file size (filenames must\nbe less than 256 characters and files must be less than 8GB in size). If this attribute is set\nto False, the archive is created using GNU extensions that lift these restrictions.The\ndefault value is False.\nMany of the previous methods manipulate TarInfo instances.The following table\nshows the methods and attributes of a TarInfo instance ti.\nAttribute\nDescription\nti.gid\nGroup ID\nti.gname\nGroup name\nti.isblk()\nReturns True if the object is a block device\nti.ischr()\nReturns True if the object is a character device\nti.isdev()\nReturns True if the object is a device (character, block, or FIFO)\nti.isdir()\nReturns True if the object is a directory\nti.isfifo()\nReturns True if the object is a FIFO\nti.isfile()\nReturns True if the object is a regular file\nti.islnk()\nReturns True if the object is a hard link\nti.isreg()\nSame as isfile()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2252,
      "extraction_method": "Direct"
    },
    {
      "page_number": 347,
      "chapter": null,
      "content": "322\nChapter 18 File and Directory Handling\nAttribute\nDescription\nti.issym()\nReturns True if the object is a symbolic link\nti.linkname\nTarget filename of a hard or symbolic link\nti.mode\nPermission bits\nti.mtime\nLast modification time\nti.name\nArchive member name\nti.size\nSize in bytes\nti.type\nFile type that is one of the constants REGTYPE, AREGTYPE, LNKTYPE,\nSYMTYPE, DIRTYPE, FIFOTYPE, CONTTYPE, CHRTYPE, BLKTYPE, or\nGNUTYPE_SPARSE\nti.uid\nUser ID\nti.uname\nUsername\nExceptions\nThe following exceptions are defined by the tarfile module:\nTarError\nBase class for all other exceptions.\nReadError\nRaised when an error occurs while opening a tar file (for example, when opening an\ninvalid file).\nCompressionError\nRaised when data can’t be decompressed.\nStreamError\nRaised when an unsupported operation is performed on a stream-like TarFile object\n(for instance, an operation that requires random access).\nExtractError\nRaised for nonfatal errors during extraction (only if errorlevel is set to 2).\nExample\n# Open a tar file and put some files into it\nt = tarfile.open(\"foo.tar\",\"w\")\nt.add(\"README\")\nimport glob\nfor pyfile in glob.glob(\"*.py\"):\nt.add(pyfile)\nt.close()\n# Open a tar file and iterate over all of its members\nt = tarfile.open(\"foo.tar\")\nfor f in t:\nprint(\"%s %d\" % (f.name, f.size))\n# Scan a tar file and print the contents of \"README\" files\nt = tarfile.open(\"foo.tar\")\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1398,
      "extraction_method": "Direct"
    },
    {
      "page_number": 348,
      "chapter": null,
      "content": "323\ntempfile\nfor f in t:\nif os.path.basename(f.name) == \"README\":\ndata = t.extractfile(f).read()\nprint(\"**** %s ****\" % f.name)\ntempfile\nThe tempfile module is used to generate temporary filenames and files.\nmkdtemp([suffix [,prefix [, dir]]])\nCreates a temporary directory accessible only by the owner of the calling process and\nreturns its absolute pathname. suffix is an optional suffix that will be appended to the\ndirectory name, prefix is an optional prefix that will be inserted at the beginning of\nthe directory name, and dir is a directory where the temporary directory should be\ncreated.\nmkstemp([suffix [,prefix [, dir [,text]]]])\nCreates a temporary file and returns a tuple (fd, pathname), where fd is an integer\nfile descriptor returned by os.open() and pathname is absolute pathname of the file.\nsuffix is an optional suffix appended to the filename, prefix is an optional prefix\ninserted at the beginning of the filename, dir is the directory in which the file should\nbe created, and text is a boolean flag that indicates whether to open the file in text\nmode or binary mode (the default).The creation of the file is guaranteed to be atomic\n(and secure) provided that the system supports the O_EXCL flag for os.open().\nmktemp([suffix [, prefix [,dir]]])\nReturns a unique temporary filename. suffix is an optional file suffix to append to the\nfilename, prefix is an optional prefix inserted at the beginning of the filename, and\ndir is the directory in which the file is created.This function only generates a unique\nfilename and doesn’t actually create or open a temporary file. Because this function gen-\nerates a name before the file is actually opened, it introduces a potential security prob-\nlem.To address this, consider using mkstemp() instead.\ngettempdir()\nReturns the directory in which temporary files are created.\ngettempprefix()\nReturns the prefix used to generate temporary files. Does not include the directory in\nwhich the file would reside.\nTemporaryFile([mode [, bufsize [, suffix [,prefix [, dir]]]]])\nCreates a temporary file using mkstemp() and returns a file-like object that supports\nthe same methods as an ordinary file object. mode is the file mode and defaults to\n'w+b'. bufsize specifies the buffering behavior and has the same meaning as for the\nopen() function. suffix, prefix, and dir have the same meaning as for mkstemp().\nThe object returned by this function is only a wrapper around a built-in file object\nthat’s accessible in the file attribute.The file created by this function is automatically\ndestroyed when the temporary file object is destroyed.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2623,
      "extraction_method": "Direct"
    },
    {
      "page_number": 349,
      "chapter": null,
      "content": "324\nChapter 18 File and Directory Handling\nNamedTemporaryFile([mode [, bufsize [, suffix [,prefix [, dir [, delete ]]]]]])\nCreates a temporary file just like TemporaryFile() but makes sure the filename is visi-\nble on the file system.The filename can be obtained by accessing the name attribute of\nthe returned file object. Note that certain systems may prevent the file from being\nreopened using this name until the temporary file has been closed.The delete parame-\nter, if set to True (the default), forces the temporary file to be deleted as soon as it is\nclosed.\nSpooledTemporaryFile([max_size [, mode [, bufsize [, suffix [, prefix [,\ndir]]]]]])\nCreates a temporary file such as TemporaryFile except that the file contents are\nentirely held in memory until they exceed the size given in max_size.This internal\nspooling is implemented by first holding the file contents in a StringIO object until it\nis necessary to actually go to the file system. If any kind of low-level file I/O operation\nis performed involving the fileno() method, the memory contents are immediately\nwritten to a proper temporary file as defined by the TemporaryFile object. The file\nobject returned by SpooledTemporaryFile also has a method rollover() that can\nbe used to force the contents to be written to the file system.\nTwo global variables are used to construct temporary names.They can be assigned to\nnew values if desired.Their default values are system-dependent.\nVariable\nDescription\ntempdir\nThe directory in which filenames returned by mktemp() reside.\ntemplate\nThe prefix of filenames generated by mktemp(). A string of decimal dig-\nits is added to template to generate unique filenames.\nNote\nBy default, the tempfile module creates files by checking a few standard locations.\nFor example, on UNIX, files are created in one of /tmp, /var/tmp, or /usr/tmp. On\nWindows, files are created in one of C:\\TEMP, C:\\TMP, \\TEMP, or \\TMP. These directo-\nries can be overridden by setting one or more of the TMPDIR, TEMP, and TMP environ-\nment variables. If, for whatever reason, temporary files can’t be created in any of the\nusual locations, they will be created in the current working directory.\nzipfile\nThe zipfile module is used to manipulate files encoded in the popular zip format\n(originally known as PKZIP, although now supported by a wide variety of programs).\nZip files are widely used by Python, mainly for the purpose of packaging. For example, if\nzip files containing Python source code are added to sys.path, then files contained\nwithin the zip file can be loaded via import (the zipimport library module implements\nthis functionality, although it’s never necessary to use that library directly). Packages dis-\ntributed as .egg files (created by the setuptools extension) are also just zip files in dis-\nguise (an .egg file is actually just a zip file with some extra metadata added to it).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2906,
      "extraction_method": "Direct"
    },
    {
      "page_number": 350,
      "chapter": null,
      "content": "325\nzipfile\nThe following functions and classes are defined by the zipfile module:\nis_zipfile(filename)\nTests filename to see if it’s a valid zip file. Returns True if filename is a zip file;\nreturns False otherwise.\nZipFile(filename [, mode [, compression [,allowZip64]]])\nOpens a zip file, filename, and returns a ZipFile instance. mode is 'r' to read from\nan existing file, 'w' to truncate the file and write a new file, or 'a' to append to an\nexisting file. For 'a' mode, if filename is an existing zip file, new files are added to it.\nIf filename is not a zip file, the archive is simply appended to the end of the file.\ncompression is the zip compression method used when writing to the archive and is\neither ZIP_STORED or ZIP_DEFLATED.The default is ZIP_STORED.The allowZip64\nargument enables the use of ZIP64 extensions, which can be used to create zip files that\nexceed 2GB in size. By default, this is set to False.\nPyZipFile(filename [, mode[, compression [,allowZip64]]])\nOpens a zip file like ZipFile() but returns a special PyZipFile instance with one\nextra method, writepy(), used to add Python source files to the archive.\nZipInfo([filename [, date_time]])\nManually creates a new ZipInfo instance, used to contain information about an archive\nmember. Normally, it’s not necessary to call this function except when using the\nz.writestr() method of a ZipFile instance (described later).The filename and\ndate_time arguments supply values for the filename and date_time attributes\ndescribed below.\nAn instance, z, of ZipFile or PyZipFile supports the following methods and\nattributes:\nz.close()\nCloses the archive file.This must be called in order to flush records to the zip file before\nprogram termination.\nz.debug\nDebugging level in the range of 0 (no output) to 3 (most output).\nz.extract(name [, path [, pwd ]])\nExtracts a file from the archive and places it in the current working directory. name is\neither a string that fully specifies the archive member or a ZipInfo instance. path spec-\nifies a different directory in which the file will extracted, and pwd is the password to use\nfor encrypted archives.\nz.extractall([path [members [, pwd]]])\nExtracts all members of an archive into the current working directory. path specifies a\ndifferent directory, and pwd is a password for encrypted archives. members is a list of\nmembers to extract, which must be a proper subset of the list returned by the\nnamelist() method (described next).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2476,
      "extraction_method": "Direct"
    },
    {
      "page_number": 351,
      "chapter": null,
      "content": "326\nChapter 18 File and Directory Handling\nz.getinfo(name)\nReturns information about the archive member name as a ZipInfo instance (described\nshortly).\nz.infolist()\nReturns a list of ZipInfo objects for all the members of the archive.\nz.namelist()\nReturns a list of the archive member names.\nz.open(name [, mode [, pwd]])\nOpens an archive member named name and returns a file-like object for reading the\ncontents. name can either be a string or a ZipInfo instance describing one of the\narchive members. mode is the file mode and must be one of the read-only file modes\nsuch as 'r', 'rU', or 'U'. pwd is the password to use for encrypted archive members.\nThe file object that is returned supports the read(), readline(), and readlines()\nmethods as well as iteration with the for statement.\nz.printdir()\nPrints the archive directory to sys.stdout.\nz.read(name [,pwd])\nReads archive contents for member name and returns the data as a string. name is either\na string or a ZipInfo instance describing the archive member. pwd is the password to\nuse for encrypted archive members.\nz.setpassword(pwd)\nSets the default password used to extract encrypted files from the archive.\nz.testzip()\nReads all the files in the archive and verifies their CRC checksums. Returns the name\nof the first corrupted file or None if all files are intact.\nz.write(filename[, arcname[, compress_type]])\nWrites filename to the archive with the archive name arcname. compress_type is\nthe compression parameter and is either ZIP_STORED or ZIP_DEFLATED. By default, the\ncompression parameter given to the ZipFile() or PyZipFile() function is used.The\narchive must be opened in 'w' or 'a' mode for writes to work.\nz.writepy(pathname)\nThis method, available only with PyZipFile instances, is used to write Python source\nfiles (*.py files) to a zip archive and can be used to easily package Python applications\nfor distribution. If pathname is a file, it must end with .py. In this case, one of the cor-\nresponding .pyo, .pyc, or .py files will be added (in that order). If pathname is a\ndirectory and the directory is not a Python package directory, all the corresponding\n.pyo, .pyc, or .py files are added at the top level. If the directory is a package, the files\nare added under the package name as a file path. If any subdirectories are also package\ndirectories, they are added recursively.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2382,
      "extraction_method": "Direct"
    },
    {
      "page_number": 352,
      "chapter": null,
      "content": "327\nzipfile\nz.writestr(arcinfo, s)\nWrites the string s into the zip file. arcinfo is either a filename within the archive in\nwhich the data will be stored or a ZipInfo instance containing a filename, date, and\ntime.\nZipInfo instances i returned by the ZipInfo(), z.getinfo(), and z.infolist()\nfunctions have the following attributes:\nAttribute\nDescription\ni.filename\nArchive member name.\ni.date_time\nTuple (year,month,day,hours,minutes,seconds) con-\ntaining the last modification time. month and day are numbers\nin the range 1–12 and 1–31, respectively. All other values start\nat 0.\ni.compress_type\nCompression type for the archive member. Only ZIP_STORED\nand ZIP_DEFLATED are currently supported by this module.\ni.comment\nArchive member comment.\ni.extra\nExpansion field data, used to contain additional file attributes.\nThe data stored here depends on the system that created the\nfile.\ni.create_system\nInteger code describing the system that created the archive.\nCommon values are 0 (MS-DOS FAT), 3 (UNIX), 7 (Macintosh),\nand 10 (Windows NTFS). \ni.create_version\nPKZIP version code that created the zip archive.\ni.extract_version\nMinimum version needed to extract the archive.\ni.reserved\nReserved field. Currently set to 0.\ni.flag_bits\nZip flag bits that describe the data encoding including encryp-\ntion and compression.\ni.volume\nVolume number of the file header.\ni.internal_attr\nDescribes the internal structure of the archive contents. If the\nlow-order bit is 1, the data is ASCII text. Otherwise, binary data\nis assumed.\ni.external_attr\nExternal file attributes which are operating system dependent.\ni.header_offset\nByte offset to the file header.\ni.file_offset\nByte offset to the start of the file data.\ni.CRC\nCRC checksum of the uncompressed file.\ni.compress_size\nSize of the compressed file data.\ni.file_size\nSize of the uncompressed file.\nNote\nDetailed documentation about the internal structure of zip files can be found as a PKZIP\nApplication Note at http://www.pkware.com/appnote.html.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2020,
      "extraction_method": "Direct"
    },
    {
      "page_number": 353,
      "chapter": null,
      "content": "328\nChapter 18 File and Directory Handling\nzlib\nThe zlib module supports data compression by providing access to the zlib library.\nadler32(string [, value])\nComputes the Adler-32 checksum of string. value is used as the starting value\n(which can be used to compute a checksum over the concatenation of several strings).\nOtherwise, a fixed default value is used.\ncompress(string [, level])\nCompresses the data in string, where level is an integer from 1 to 9 controlling the\nlevel of compression. 1 is the least (fastest) compression, and 9 is the best (slowest) com-\npression.The default value is 6. Returns a string containing the compressed data or rais-\nes error if an error occurs.\ncompressobj([level])\nReturns a compression object. level has the same meaning as in the compress()\nfunction.\ncrc32(string [, value])\nComputes a CRC checksum of string. If value is present, it’s used as the starting\nvalue of the checksum. Otherwise, a fixed value is used.\ndecompress(string [, wbits [, buffsize]])\nDecompresses the data in string. wbits controls the size of the window buffer, and\nbuffsize is the initial size of the output buffer. Raises error if an error occurs.\ndecompressobj([wbits])\nReturns a compression object.The wbits parameter controls the size of the window\nbuffer.\nA compression object, c, has the following methods:\nc.compress(string)\nCompresses string. Returns a string containing compressed data for at least part of the\ndata in string.This data should be concatenated to the output produced by earlier\ncalls to c.compress() to create the output stream. Some input data may be stored in\ninternal buffers for later processing.\nc.flush([mode])\nCompresses all pending input and returns a string containing the remaining compressed\noutput. mode is Z_SYNC_FLUSH, Z_FULL_FLUSH, or Z_FINISH (the default).\nZ_SYNC_FLUSH and Z_FULL_FLUSH allow further compression and are used to allow\npartial error recovery on decompression. Z_FINISH terminates the compression stream.\nA decompression object, d, has the following methods and attributes:\nd.decompress(string [,max_length])\nDecompresses string and returns a string containing uncompressed data for at least\npart of the data in string.This data should be concatenated with data produced by\nearlier calls to decompress() to form the output stream. Some input data may be\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2350,
      "extraction_method": "Direct"
    },
    {
      "page_number": 354,
      "chapter": null,
      "content": "329\nzlib\nstored in internal buffers for later processing. max_length specifies the maximum size\nof returned data. If exceeded, unprocessed data will be placed in the\nd.unconsumed_tail attribute.\nd.flush()\nAll pending input is processed, and a string containing the remaining uncompressed\noutput is returned.The decompression object cannot be used again after this call.\nd.unconsumed_tail\nString containing data not yet processed by the last decompress() call.This would\ncontain data if decompression needs to be performed in stages due to buffer size limita-\ntions. In this case, this variable would be passed to subsequent decompress() calls.\nd.unused_data\nString containing extra bytes that remain past the end of the compressed data.\nNote\nThe zlib library is available at http://www.zlib.net.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 818,
      "extraction_method": "Direct"
    },
    {
      "page_number": 355,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 356,
      "chapter": null,
      "content": "19\nOperating System Services\nThe modules in this chapter provide access to a wide variety of operating system \nservices with an emphasis on low-level I/O, process management, and the operating\nenvironment. Modules that are commonly used in conjunction with writing systems\nprograms are also included—for example, modules to read configuration files, write log\nfiles, and so forth. Chapter 18,“File and Directory Handling,” covers high-level modules\nrelated to file and filesystem manipulation—the material presented here tends be at a\nlower level than that.\nMost of Python’s operating system modules are based on POSIX interfaces. POSIX\nis a standard that defines a core set of operating system interfaces. Most UNIX systems\nsupport POSIX, and other platforms such as Windows support large portions of the\ninterface.Throughout this chapter, functions and modules that only apply to a specific\nplatform are noted as such. UNIX systems include both Linux and Mac OS X.\nWindows systems include all versions of Windows unless otherwise noted.\nReaders may want to supplement the material presented here with additional refer-\nences. The C Programming Language, Second Edition by Brian W. Kernighan and Dennis\nM. Ritchie (Prentice Hall, 1989) provides a good overview of files, file descriptors, and\nthe low-level interfaces on which many of the modules in this section are based. More\nadvanced readers may want to consult a book such as Advanced Programming in the UNIX\nEnvironment, 2nd Edition by W. Richard Stevens and Stephen Rago (Addison Wesley,\n2005). For an overview of general concepts, you may want to locate a college textbook\non operating systems. However, given the high cost and limited day-to-day practical\nutility of these books, you’re probably better off asking a nearby computer science stu-\ndent to loan you their copy for a weekend.\ncommands\nThe commands module is used to execute simple system commands specified as a string\nand return their output as a string. It only works on UNIX systems.The functionality\nprovided by this module is somewhat similar to using backquotes (`) in a UNIX shell\nscript. For example, typing x = commands.getoutput('ls –l') is similar to saying\nx=`ls –l`.\ngetoutput(cmd)\nExecutes cmd in a shell and returns a string containing both the standard output and\nstandard error streams of the command.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2363,
      "extraction_method": "Direct"
    },
    {
      "page_number": 357,
      "chapter": null,
      "content": "332\nChapter 19 Operating System Services\ngetstatusoutput(cmd)\nLike getoutput(), except that a 2-tuple (status, output) is returned, where \nstatus is the exit code, as returned by the os.wait() function, and output is the\nstring returned by getoutput().\nNotes\nn This module is only available in Python 2. In Python 3, both of the previous\nfunctions are found in the subprocess module.\nn Although this module can be used for simple shell operations, you are almost\nalways better off using the subprocess module for launching subprocesses and\ncollecting their output.\nSee Also:\nsubprocess (p. 402)\nConfigParser, configparser\nThe ConfigParser module (called configparser in Python 3) is used to read .ini\nformat configuration files based on the Windows INI format.These files consist of\nnamed sections, each with its own variable assignments such as the following:\n# A comment\n; A comment\n[section1]\nname1 = value1\nname2 = value2\n[section2]\n; Alternative syntax for assigning values\nname1: value1\nname2: value2\n...\nThe ConfigParser Class\nThe following class is used to manage configuration variables:\nConfigParser([defaults [, dict_type]])\nCreates a new ConfigParser instance. defaults is an optional dictionary of values\nthat can be referenced in configuration variables by including string format specifiers\nsuch as '%(key)s’ where key is a key of defaults. dict_type specifies the type of\ndictionary that is used internally for storing configuration variables. By default, it is\ndict (the built-in dictionary).\nAn instance c of ConfigParser has the following operations:\nc.add_section(section)\nAdds a new section to the stored configuration parameters. section is a string with the\nsection name.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1717,
      "extraction_method": "Direct"
    },
    {
      "page_number": 358,
      "chapter": null,
      "content": "333\nConfigParser, configparser\nc.defaults()\nReturns the dictionary of default values.\nc.get(section, option [, raw [, vars]])\nReturns the value of option option from section section as a string. By default, the\nreturned string is processed through an interpolation step where format strings such as\n'%(option)s' are expanded. In this case, option may the name of another configura-\ntion option in the same section or one of the default values supplied in the defaults\nparameter to ConfigParser. raw is a Boolean flag that disables this interpolation fea-\nture, returning the option unmodified. vars is an optional dictionary containing more\nvalues for use in '%' expansions.\nc.getboolean(section, option)\nReturns the value of option from section section converted to Boolean value.Values\nsuch as \"0\", \"true\", \"yes\", \"no\", \"on\", and \"off\" are all understood and checked in\na case-insensitive manner.Variable interpolation is always performed by this method (see\nc.get()).\nc.getfloat(section, option)\nReturns the value of option from section section converted to a float with variable\ninterpolation.\nc.getint(section, option)\nReturns the value of option from section section converted to an integer with vari-\nable interpolation.\nc.has_option(section, option)\nReturns True if section section has an option named option.\nc.has_section(section)\nReturns True if there is a section named section.\nc.items(section [, raw [, vars]])\nReturns a list of (option, value) pairs from section section. raw is a Boolean flag\nthat disables the interpolation feature if set to True. vars is a dictionary of additional\nvalues that can be used in '%’ expansions.\nc.options(section)\nReturns a list of all options in section section.\nc.optionxform(option)\nTransforms the option name option to the string that’s used to refer to the option. By\ndefault, this is a lowercase conversion.\nc.read(filenames)\nReads configuration options from a list of filenames and stores them. filenames is\neither a single string, in which case that is the filename that is read, or a list of file-\nnames. If any of the given filenames can’t be found, they are ignored.This is useful if\nyou want to read configuration files from many possible locations, but where such files\nmay or may not be defined.A list of the successfully parsed filenames is returned.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2336,
      "extraction_method": "Direct"
    },
    {
      "page_number": 359,
      "chapter": null,
      "content": "334\nChapter 19 Operating System Services\nc.readfp(fp [, filename])\nReads configuration options from a file-like object that has already been opened in fp.\nfilename specifies the filename associated with fp (if any). By default, the filename is\ntaken from fp.name or is set to '<???>' if no such attribute is defined.\nc.remove_option(section, option)\nRemoves option from section section.\nc.remove_section(section)\nRemoves section section.\nc.sections()\nReturns a list of all section names.\nc.set(section, option, value)\nSets a configuration option option to value in section section. value should be a\nstring.\nc.write(file)\nWrites all of the currently held configuration data to file. file is a file-like object\nthat has already been opened.\nExample\nThe ConfigParser module is often overlooked, but it is an extremely useful tool for\ncontrolling programs that have an extremely complicated user configuration or runtime\nenvironment. For example, if you’re writing a component that has to run inside of a\nlarge framework, a configuration file is often an elegant way to supply runtime parame-\nters. Similarly, a configuration file may be a more elegant approach than having a pro-\ngram read large numbers of command-line options using the optparse module.There\nare also subtle, but important, differences between using configuration files and simply\nreading configuration data from a Python source script.\nThe following few examples illustrate some of the more interesting features of the\nConfigParser module. First, consider a sample .ini file:\n# appconfig.ini\n# Configuration file for my mondo application\n[output]\nLOGFILE=%(LOGDIR)s/app.log\nLOGGING=on\nLOGDIR=%(BASEDIR)s/logs\n[input]\nINFILE=%(INDIR)s/initial.dat\nINDIR=%(BASEDIR)s/input\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1759,
      "extraction_method": "Direct"
    },
    {
      "page_number": 360,
      "chapter": null,
      "content": "335\nConfigParser, configparser\nThe following code illustrates how you read a configuration file and supply default val-\nues to some of the variables:\nfrom configparser import ConfigParser  # Use from ConfigParser in Python 2\n# Dictionary of default variable settings\ndefaults = {\n'basedir' : '/Users/beazley/app'\n}\n# Create a ConfigParser object and read the .ini file\ncfg = ConfigParser(defaults)\ncfg.read('appconfig.ini')\nAfter you have read a configuration file, you use the get() method to retrieve option\nvalues. For example:\n>>> cfg.get('output','logfile')\n'/Users/beazley/app/logs/app.log'\n>>> cfg.get('input','infile')\n'/Users/beazley/app/input/initial.dat'\n>>> cfg.getboolean('output','logging')\nTrue\n>>>\nHere, you immediately see some interesting features. First, configuration parameters are\ncase insensitive.Thus, if your program is reading a parameter 'logfile', it does not\nmatter if the configuration file uses 'logfile', 'LOGFILE', or 'LogFile'. Second,\nconfiguration parameters can include variable substitutions such as '%(BASEDIR)s' and\n'%(LOGDIR)s' as seen in the file.These substitutions are also case insensitive. Moreover,\nthe definition order of configuration parameters does not matter in these substitutions.\nFor example, in appconfig.ini, the LOGFILE parameter makes a reference to the\nLOGDIR parameter, which is defined later in the file. Finally, values in configuration files\nare often interpreted correctly even if they don’t exactly match Python syntax or\ndatatypes. For example, the 'on' value of the LOGGING parameter is interpreted as True\nby the cfg.getboolean() method.\nConfiguration files also have the ability to be merged together. For example, suppose\nthe user had their own configuration file with custom settings:\n; userconfig.ini\n;\n; Per-user settings\n[output]\nlogging=off\n[input]\nBASEDIR=/tmp\nYou can merge the contents of this file in with already loaded configuration parameters.\nFor example:\n>>> cfg.read('userconfig.ini')\n['userconfig.ini']\n>>> cfg.get('output','logfile')\n'/Users/beazley/app/logs/app.log'\n>>> cfg.get('output','logging')\n'off'\n>>> cfg.get('input','infile')\n'/tmp/input/initial.dat'\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2175,
      "extraction_method": "Direct"
    },
    {
      "page_number": 361,
      "chapter": null,
      "content": "336\nChapter 19 Operating System Services\nHere, you will notice that the newly loaded configuration selectively replaces the\nparameters that were already defined. Moreover, if you change one of the configuration\nparameters that’s used in variable substitutions of other configuration parameters, the\nchanges correctly propagate. For example, the new setting of BASEDIR in the input\nsection affects previously defined configuration parameters in that section such as\nINFILE.This behavior is an important but subtle difference between using a config file\nand simply defining a set of program parameters in a Python script.\nNotes\nTwo other classes can be used in place of ConfigParser.The class RawConfigParser\nprovides all of the functionality of ConfigParser but doesn’t perform any variable\ninterpolation.The SafeConfigParser class provides the same functionality as\nConfigParser, but it addresses some subtle problems that arise if configuration values\nthemselves literally include special formatting characters used by the interpolation fea-\nture (e.g., '%').\ndatetime\nThe datetime module provides a variety of classes for representing and manipulating\ndates and times. Large parts of this module are simply related to different ways of creat-\ning and outputting date and time information. Other major features include mathemati-\ncal operations such as comparisons and calculations of time deltas. Date manipulation is\na complex subject, and readers would be strongly advised to consult Python’s online\ndocumentation for an introductory background concerning the design of this module.\ndate Objects\nA date object represents a simple date consisting of a year, month, and day.The follow-\ning four functions are used to create dates:\ndate(year, month, day)\nCreates a new date object. year is an integer in the range datetime.MINYEAR to\ndatetime.MAXYEAR. month is an integer in the range 1 to 12, and day is an integer in\nthe range 1 to the number of days in the given month.The returned date object is\nimmutable and has the attributes year, month, and day corresponding to the values of\nthe supplied arguments.\ndate.today()\nA class method that returns a date object corresponding to the current date.\ndate.fromtimestamp(timestamp)\nA class method that returns a date object corresponding to the timestamp timestamp.\ntimestamp is a value returned by the time.time() function.\ndate.fromordinal(ordinal)\nA class method that returns a date object corresponding to an ordinal number of\ndays from the minimum allowable date (January 1 of year 1 has ordinal value 1 and\nJanuary 1, 2006 has ordinal value 732312).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2626,
      "extraction_method": "Direct"
    },
    {
      "page_number": 362,
      "chapter": null,
      "content": "337\ndatetime\nThe following class attributes describe the maximum rate and resolution of date\ninstances.\ndate.min\nClass attribute representing the earliest date that can be represented\n(datetime.date(1,1,1)).\ndate.max\nClass attribute representing the latest possible date (datetime.date(9999,12,31)).\ndate.resolution\nSmallest resolvable difference between non-equal date objects\n(datetime.timedelta(1)).\nAn instance, d, of date has read-only attributes d.year, d.month, and d.day and\nadditionally provides the following methods:\nd.ctime()\nReturns a string representing the date in the same format as normally used by the\ntime.ctime() function.\nd.isocalendar()\nReturns the date as a tuple (iso_year, iso_week, iso_weekday), where iso_week\nis in the range 1 to 53 and iso_weekday is the range 1 (Monday) to 7 (Sunday).The\nfirst iso_week is the first week of the year that contains a Thursday.The range of values\nfor the three tuple components are determined by the ISO 8601 standard.\nd.isoformat()\nReturns an ISO 8601–formatted string of the form 'YYYY-MM-DD' representing the\ndate.\nd.isoweekday()\nReturns the day of the week in the range 1 (Monday) to 7 (Sunday).\nd.replace([year [, month [, day ]]])\nReturns a new date object with one or more of the supplied components replaced by\na new value. For example, d.replace(month=4) returns a new date where the month\nhas been replaced by 4.\nd.strftime(format)\nReturns a string representing the date formatted according to the same rules as the\ntime.strftime() function.This function only works for dates later than the year\n1900. Moreover, format codes for components missing from date objects (such as\nhours, minutes, and so on) should not be used.\nd.timetuple()\nReturns a time.struct_time object suitable for use by functions in the time module.\nValues related to the time of day (hours, minutes, seconds) will be set to 0.\nd.toordinal()\nConverts d to an ordinal value. January 1 of year 1 has ordinal value 1.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1979,
      "extraction_method": "Direct"
    },
    {
      "page_number": 363,
      "chapter": null,
      "content": "338\nChapter 19 Operating System Services\nd.weekday()\nReturns the day of the week in the range 0 (Monday) to 6 (Sunday).\ntime Objects\ntime objects are used to represent a time in hours, minutes, seconds, and microseconds.\nTimes are created using the following class constructor:\ntime(hour [, minute [, second [, microsecond [, tzinfo]]]])\nCreates a time object representing a time where 0 <= hour < 24, 0 <= minute <\n60, 0 <= second < 60, and 0 <= microsecond < 1000000. tzinfo provides time\nzone information and is an instance of the tzinfo class described later in this section.\nThe returned time object has the attributes hour, minute, second, microsecond, and\ntzinfo, which hold the corresponding values supplied as arguments.\nThe following class attributes of time describe the range of allowed values and reso-\nlution of time instances:\ntime.min\nClass attribute representing the minimum representable time (datetime.time(0,0)).\ntime.max\nClass attribute representing the maximum representable time (datetime.time(23,59,\n59, 999999)).\ntime.resolution\nSmallest resolvable difference between non-equal time objects\n(datetime.timedelta(0,0,1)).\nAn instance, t, of a time object has attributes t.hour, t.minute, t.second,\nt.microsecond, and t.tzinfo in addition to the following methods:\nt.dst()\nReturns the value of t.tzinfo.dst(None).The returned object is a timedelta\nobject. If no time zone is set, None is returned.\nt.isoformat()\nReturns a string representing the time as 'HH:MM:SS.mmmmmm'. If the microseconds are\n0, that part of the string is omitted. If time zone information has been supplied, the\ntime may have an offset added to it (for example, 'HH:MM:SS.mmmmmm+HH:MM').\nt.replace([hour [, minute [, second [, microsecond [, tzinfo ]]]]])\nReturns a new time object, where one or more components have been replaced by the\nsupplied values. For example, t.replace(second=30) changes the seconds field to 30\nand returns a new time object.The arguments have the same meaning as those supplied\nto the time() function shown earlier.\nt.strftime(format)\nReturns a string formatted according to the same rules as the time.strftime() func-\ntion in the time module. Because date information is unavailable, only the formatting\ncodes for time-related information should be used.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2299,
      "extraction_method": "Direct"
    },
    {
      "page_number": 364,
      "chapter": null,
      "content": "339\ndatetime\nt.tzname()\nReturns the value of t.tzinfo.tzname(). If no time zone is set, None is returned.\nt.utcoffset()\nReturns the value of t.tzinfo.utcoffset(None).The returned object is a\ntimedelta object. If no time zone has been set, None is returned.\ndatetime objects\ndatetime objects are used to represent dates and times together.There are many possi-\nble ways to create a datetime instance:\ndatetime(year, month, day [, hour [, minute [, second [, microsecond [,\ntzinfo]]]]])\nCreates a new datetime object that combines all the features of date and time\nobjects.The arguments have the same meaning as arguments provided to date() and\ntime().\ndatetime.combine(date,time)\nA class method that creates a datetime object by combining the contents of a date\nobject, date, and a time object, time.\ndatetime.fromordinal(ordinal)\nA class method that creates a datetime object given an ordinal day (integer number of\ndays since datetime.min).The time components are all set to 0, and tzinfo is set to\nNone.\ndatetime.fromtimestamp(timestamp [, tz])\nA class method that creates a datetime object from a timestamp returned by the\ntime.time() function. tz provides optional time zone information and is a tzinfo\ninstance.\ndatetime.now([tz])\nA class method that creates a datetime object from the current local date and time. tz\nprovides optional time zone information and is an instance of tzinfo.\ndatetime.strptime(datestring, format)\nA class method that creates a datetime object by parsing the date string in \ndatestring according to the date format in format.The parsing is performed using\nthe strptime() function in the time module.\ndatetime.utcfromtimestamp(timestamp)\nA class method that creates a datetime object from a timestamp typically returned by\ntime.gmtime().\ndatetime.utcnow()\nA class method that creates a datetime object from the current UTC date and time.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1892,
      "extraction_method": "Direct"
    },
    {
      "page_number": 365,
      "chapter": null,
      "content": "340\nChapter 19 Operating System Services\nThe following class attributes describe the range of allowed dates and resolution:\ndatetime.min\nEarliest representable date and time (datetime.datetime(1,1,1,0,0)).\ndatetime.max\nLatest representable date and time (datetime.\ndatetime(9999,12,31,23,59,59,999999)).\ndatetime.resolution\nSmallest resolvable difference between non-equal datetime objects\n(datetime.timedelta(0,0,1)).\nAn instance, d, of a datetime object has the same methods as date and time\nobjects combined. In additional, the following methods are available:\nd.astimezone(tz)\nReturns a new datetime object but in a different time zone, tz.The members of the\nnew object will be adjusted to represent the same UTC time but in the time zone tz.\nd.date()\nReturns a date object with the same date.\nd.replace([year [, month [, day [, hour [, minute [, second [, microsecond [,\ntzinfo]]]]]]])\nReturns a new datetime object with one or more of the listed parameters replaced by\nnew values. Use keyword arguments to replace an individual value.\nd.time()\nReturns a time object with the same time.The resulting time object has no time zone\ninformation set.\nd.timetz()\nReturns a time object with the same time and time zone information.\nd.utctimetuple()\nReturns a time.struct_time object containing date and time information normalized\nto UTC time.\ntimedelta objects\ntimedelta objects represent the difference between two dates or times.These objects\nare normally created as the result of computing a difference between two datetime\ninstances using the - operator. However, they can be manually constructed using the\nfollowing class:\ntimedelta([days [, seconds [, microseconds [, milliseconds [, minutes [, hours [,\nweeks ]]]]]]])\nCreates a timedelta object that represents the difference between two dates and times.\nThe only significant parameters are days, seconds, and microseconds, which are used\ninternally to represent a difference.The other parameters, if supplied, are converted into\ndays, seconds, and microseconds.The attributes days, seconds, and microseconds of\nthe returned timedelta object contain these values.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2142,
      "extraction_method": "Direct"
    },
    {
      "page_number": 366,
      "chapter": null,
      "content": "341\ndatetime\nThe following class attributes describe the maximum range and resolution of\ntimedelta instances:\ntimedelta.min\nThe most negative timedelta object that can be represented \n(timedelta(-999999999))\ntimedelta.max\nThe most positive timedelta object that can be represented\n(timedelta(days=999999999, hours=23, minutes=59, seconds=59,\nmicroseconds=999999)).\ntimedelta.resolution\nA timedelta object representing the smallest resolvable difference between non-equal\ntimedelta objects (timedelta(microseconds=1)).\nMathematical Operations Involving Dates\nA significant feature of the datetime module is that it supports mathematical opera-\ntions involving dates. Both date and datetime objects support the following \noperations:\nOperation\nDescription\ntd = date1 - date2\nReturns a timedelta object\ndate2 = date1 + td\nAdds a timedelta to a date\ndate2 = date1 - td\nSubtracts a timedelta from a date\ndate1 < date2\nDate comparison\ndate1 <= date2\ndate1 == date2\ndate1 != date2\ndate1 > date2\ndate1 >= date2\nWhen comparing dates, you must use care when time zone information has been sup-\nplied. If a date includes tzinfo information, that date can only be compared with other\ndates that include tzinfo; otherwise, a TypeError is generated.When two dates in dif-\nferent time zones are compared, they are first adjusted to UTC before being compared.\ntimedelta objects also support a variety of mathematical operations:\nOperation\nDescription\ntd3 = td2 + td1\nAdds two time deltas\ntd3 = td2 - td1\nSubtracts two time deltas\ntd2 = td1 * i\nMultiplication by an integer\ntd2 = i * td2\ntd2 = td1 // i\nFloor division by an integer, i\ntd2 = -td1\nUnary subtraction, addition\ntd2 = +td1\nabs(td)\nAbsolute value\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1713,
      "extraction_method": "Direct"
    },
    {
      "page_number": 367,
      "chapter": null,
      "content": "342\nChapter 19 Operating System Services\nOperation\nDescription\ntd1 < td2\nComparison\ntd1 <= td2\ntd1 == td2\ntd1 != td2\ntd1 > td2\ntd1 >= td2\nHere are some examples:\n>>> today = datetime.datetime.now()\n>>> today.ctime()\n'Thu Oct 20 11:10:10 2005'\n>>> oneday = datetime.timedelta(days=1)\n>>> tomorrow = today + oneday\n>>> tomorrow.ctime()\n'Fri Oct 21 11:10:10 2005'\n>>>\nIn addition to these operations, all date, datetime, time, and timedelta objects are\nimmutable.This means that they can be used as dictionary keys, placed in sets, and used\nin a variety of other operations.\ntzinfo Objects\nMany of the methods in the datetime module manipulate special tzinfo objects that\nrepresent information about a time zone. tzinfo is merely a base class. Individual time\nzones are created by inheriting from tzinfo and implementing the following methods:\ntz.dst(dt)\nReturns a timedelta object representing daylight savings time adjustments, if applica-\nble. Returns None if no information is known about DST.The argument dt is either a\ndatetime object or None.\ntz.fromutc(dt)\nConverts a datetime object, dt, from UTC time to the local time zone and returns a\nnew datetime object.This method is called by the astimezone() method on \ndatetime objects.A default implementation is already provided by tzinfo, so it’s usu-\nally not necessary to redefine this method.\ntz.tzname(dt)\nReturns a string with the name of the time zone (for example, \"US/Central\"). dt is\neither a datetime object or None.\ntz.utcoffset(dt)\nReturns a timedelta object representing the offset of local time from UTC in minutes\neast of UTC.The offset incorporates all elements that make up the local time, including\ndaylight savings time, if applicable.The argument dt is either a datetime object or\nNone.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1781,
      "extraction_method": "Direct"
    },
    {
      "page_number": 368,
      "chapter": null,
      "content": "343\nerrno\nThe following example shows a basic prototype of how one would define a time\nzone:\n# Variables that must be defined\n# TZOFFSET   - Timezone offset in hours from UTC. For\n#              example, US/CST is -6 hours\n# DSTNAME    - Name of timezone when DST is in effect\n# STDNAME    - Name of timezone when DST not in effect\nclass SomeZone(datetime.tzinfo):\ndef utcoffset(self,dt):\nreturn datetime.timedelta(hours=TZOFFSET) + self.dst(dt)\ndef dst(self,dt):\n# is_dst() is a function you must implement to see\n# whether DST is in effect according to local timezone rules.\nif is_dst(dt):\nreturn datetime.timedelta(hours=1)\nelse:\nreturn datetime.timedelta(0)\ndef tzname(self,dt):\nif is_dst(dt):\nreturn DSTNAME\nelse:\nreturn STDNAME\nA number of examples of defining time zones can also be found in the online docu-\nmentation for datetime.\nDate and Time Parsing\nA common question that arises with date handling is how to parse different kinds of\ntime and date strings into an appropriate datetime object.The only parsing function\nthat is really provided by the datetime module is datetime.strptime(). However, in\norder to use this, you need to specify the precise date format using various combina-\ntions of format codes (see time.strptime()). For example, to parse the date string\ns=\"Aug 23, 2008\", you would have to use d = datetime.datetime.strptime(s,\n\"%b %d, %Y\").\nFor “fuzzy” date parsing that automatically understands a number of common date\nformats, you must turn to third-party modules. Go to the Python Package Index\n(http://pypi.python.org) and do a search for “datetime” to find a wide variety of utili-\nty modules that expand the feature set of the datetime module.\nSee also:\ntime (p. 405)\nerrno\nThe errno module defines symbolic names for the integer error codes returned by var-\nious operating system calls, especially those found in the os and socket modules.These\ncodes are typically found in the errno attribute of an OSError or IOError exception.\nThe os.strerror() function can be used to translate an error code into a string error\nmessage.The following dictionary can also be used to translate an integer error code\ninto its symbolic name:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2184,
      "extraction_method": "Direct"
    },
    {
      "page_number": 369,
      "chapter": null,
      "content": "344\nChapter 19 Operating System Services\nerrorcode\nThis dictionary maps errno integers to symbolic names (such as 'EPERM').\nPOSIX Error Codes\nThe following table shows the POSIX symbolic names for common system error codes.\nThe error codes listed here are supported on almost every version of UNIX, Macintosh\nOS-X, and Windows. Different UNIX systems may provide additional error codes \nthat are less common and not listed here. If such errors occur, you can consult the\nerrorcode dictionary to find the appropriate symbolic name to use in your program.\nError Code\nDescription\nE2BIG\nArg list too long.\nEACCES\nPermission denied.\nEADDRINUSE\nAddress already in use.\nEADDRNOTAVAIL\nCannot assign requested address.\nEAFNOSUPPORT\nAddress family not supported by protocol.\nEAGAIN\nTry again.\nEALREADY\nOperation already in progress.\nEBADF\nBad file number.\nEBUSY\nDevice or resource busy.\nECHILD\nNo child processes.\nECONNABORTED\nSoftware caused connection abort.\nECONNREFUSED\nConnection refused.\nECONNRESET\nConnection reset by peer.\nEDEADLK\nResource deadlock would occur.\nEDEADLOCK\nFile-locking deadlock error.\nEDESTADDRREQ\nDestination address required.\nEDOM\nMath argument out of domain of function.\nEDQUOT\nQuota exceeded.\nEEXIST\nFile exists.\nEFAULT\nBad address.\nEFBIG\nFile too large.\nEHOSTDOWN\nHost is down.\nEHOSTUNREACH\nNo route to host.\nEILSEQ\nIllegal byte sequence.\nEINPROGRESS\nOperation now in progress.\nEINTR\nInterrupted system call.\nEINVAL\nInvalid argument.\nEIO\nI/O error.\nEISCONN\nTransport endpoint is already connected.\nEISDIR\nIs a directory.\nELOOP\nToo many symbolic links encountered.\nEMFILE\nToo many open files.\nEMLINK\nToo many links.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1656,
      "extraction_method": "Direct"
    },
    {
      "page_number": 370,
      "chapter": null,
      "content": "345\nerrno\nError Code\nDescription\nEMSGSIZE\nMessage too long.\nENETDOWN\nNetwork is down.\nENETRESET\nNetwork dropped connection due to reset.\nENETUNREACH\nNetwork is unreachable.\nENFILE\nFile table overflow.\nENOBUFS\nNo buffer space available.\nENODEV\nNo such device.\nENOENT\nNo such file or directory.\nENOEXEC\nExec format error.\nENOLCK\nNo record locks available.\nENOMEM\nOut of memory.\nENOPROTOOPT\nProtocol not available.\nENOSPC\nNo space left on device.\nENOSYS\nFunction not implemented.\nENOTCONN\nTransport endpoint is not connected.\nENOTDIR\nNot a directory.\nENOTEMPTY\nDirectory not empty.\nENOTSOCK\nSocket operation on non-socket.\nENOTTY\nNot a terminal.\nENXIO\nNo such device or address.\nEOPNOTSUPP\nOperation not supported on transport endpoint.\nEPERM\nOperation not permitted.\nEPFNOSUPPORT\nProtocol family not supported.\nEPIPE\nBroken pipe.\nEPROTONOSUPPORT\nProtocol not supported.\nEPROTOTYPE\nProtocol wrong type for socket.\nERANGE\nMath result not representable.\nEREMOTE\nObject is remote.\nEROFS\nRead-only file system.\nESHUTDOWN\nCannot send after transport endpoint shutdown.\nESOCKTNOSUPPORT\nSocket type not supported.\nESPIPE\nIllegal seek.\nESRCH\nNo such process.\nESTALE\nStale NFS file handle.\nETIMEDOUT\nConnection timed out.\nETOOMANYREFS\nToo many references: Cannot splice.\nEUSERS\nToo many users.\nEWOULDBLOCK\nOperation would block.\nEXDEV\nCross-device link.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1364,
      "extraction_method": "Direct"
    },
    {
      "page_number": 371,
      "chapter": null,
      "content": "346\nChapter 19 Operating System Services\nWindows Error Codes\nThe error codes in the following table are only available on Windows.\nError Code\nDescription\nWSAEACCES\nPermission denied.\nWSAEADDRINUSE\nAddress already in use.\nWSAEADDRNOTAVAIL\nCannot assign requested address.\nWSAEAFNOSUPPORT\nAddress family not supported by protocol family.\nWSAEALREADY\nOperation already in progress.\nWSAEBADF\nInvalid file handle.\nWSAECONNABORTED\nSoftware caused connection abort.\nWSAECONNREFUSED\nConnection refused.\nWSAECONNRESET\nConnection reset by peer.\nWSAEDESTADDRREQ\nDestination address required.\nWSAEDISCON\nRemote shutdown.\nWSAEDQUOT\nDisk quota exceeded.\nWSAEFAULT\nBad address.\nWSAEHOSTDOWN\nHost is down.\nWSAEHOSTUNREACH\nNo route to host.\nWSAEINPROGRESS\nOperation now in progress.\nWSAEINTR\nInterrupted system call.\nWSAEINVAL\nInvalid argument.\nWSAEISCONN\nSocket already connected.\nWSAELOOP\nCannot translate name.\nWSAEMFILE\nToo many open files.\nWSAEMSGSIZE\nMessage too long.\nWSAENAMETOOLONG\nName too long.\nWSAENETDOWN\nNetwork is down.\nWSAENETRESET\nNetwork dropped connection on reset.\nWSAENETUNREACH\nNetwork is unreachable.\nWSAENOBUFS\nNo buffer space is available.\nWSAENOPROTOOPT\nBad protocol option.\nWSAENOTCONN\nSocket is not connected.\nWSAENOTEMPTY\nCannot remove non-empty directory.\nWSAENOTSOCK\nSocket operation on non-socket.\nWSAEOPNOTSUPP\nOperation not supported.\nWSAEPFNOSUPPORT\nProtocol family not supported.\nWSAEPROCLIM\nToo many processes.\nWSAEPROTONOSUPPORT\nProtocol not supported.\nWSAEPROTOTYPE\nProtocol wrong type for socket.\nWSAEREMOTE\nItem not available locally.\nWSAESHUTDOWN\nCannot send after socket shutdown.\nWSAESOCKTNOSUPPORT\nSocket type not supported.\nWSAESTALE\nFile handle no longer available.\nWSAETIMEDOUT\nConnection timed out.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1753,
      "extraction_method": "Direct"
    },
    {
      "page_number": 372,
      "chapter": null,
      "content": "347\nfcntl\nError Code\nDescription\nWSAETOOMANYREFS\nToo many references to a kernel object.\nWSAEUSERS\nQuota exceeded.\nWSAEWOULDBLOCK\nResource temporarily unavailable.\nWSANOTINITIALISED\nSuccessful WSA startup not performed.\nWSASYSNOTREADY\nNetwork subsystem not available.\nWSAVERNOTSUPPORTED\nWinsock.dll version out of range.\nfcntl\nThe fcntl module performs file and I/O control on UNIX file descriptors. File\ndescriptors can be obtained using the fileno() method of a file or socket object.\nfcntl(fd, cmd [, arg])\nPerforms a command, cmd, on an open file descriptor, fd. cmd is an integer command\ncode. arg is an optional argument that’s either an integer or a string. If arg is passed as\nan integer, the return value of this function is an integer. If arg is a string, it’s interpret-\ned as a binary data structure, and the return value of the call is the contents of the\nbuffer converted back into a string object. In this case, the supplied argument and\nreturn value should be less than 1,024 bytes to avoid possible data corruption.The fol-\nlowing commands are available:\nCommand\nDescription\nF_DUPFD\nDuplicates a file descriptor. arg is the lowest number that the new\nfile descriptor can assume. Similar to the os.dup() system call.\nF_SETFD\nSets the close-on-exec flag to arg (0 or 1). If set, the file is\nclosed on an exec() system call.\nF_GETFD\nReturns the close-on-exec flag.\nF_SETFL\nSets status flags to arg, which is the bitwise OR of the following:\nO_NDELAY—Nonblocking I/O (System V)\nO_APPEND—Append mode (System V)\nO_SYNC—Synchronous write (System V)\nFNDELAY—Nonblocking I/O (BSD)\nFAPPEND—Append mode (BSD)\nFASYNC—Sends SIGIO signal to process group when I/O is possi-\nble (BSD)\nF_GETFL\nGets status flags as set by F_SETFL.\nF_GETOWN\nGets process ID or process group ID set to receive SIGIO and\nSIGURG signals (BSD).\nF_SETOWN\nSets process ID or process group ID to receive SIGIO and SIGURG\nsignals (BSD).\nF_GETLK\nReturns flock structure used in file-locking operations.\nF_SETLK\nLocks a file, returning -1 if the file is already locked.\nF_SETLKW\nLocks a file but waits if the lock cannot be acquired.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2129,
      "extraction_method": "Direct"
    },
    {
      "page_number": 373,
      "chapter": null,
      "content": "348\nChapter 19 Operating System Services\nAn IOError exception is raised if the fcntl() function fails.The F_GETLK and\nF_SETLK commands are supported through the lockf() function.\nioctl(fd, op, arg [, mutate_flag])\nThis function is like the fcntl() function, except that the operations supplied in op\nare generally defined in the library module termios.The extra mutate_flag controls\nthe behavior of this function when a mutable buffer object is passed as an argument.\nFurther details about this can be found in the online documentation. Because the pri-\nmary use of ioctl() is to interact with device-drivers and other low-level components\nof the operating system, its use depends highly on the underlying platform. It should\nnot be used in code that aims to be portable.\nflock(fd, op)\nPerforms a lock operation, op, on the file descriptor fd. op is the bitwise OR of the\nfollowing constants, which are found in fnctl:\nItem\nDescription\nLOCK_EX\nExclusive lock. All further attempts to acquire the lock will block until\nthe lock is released.\nLOCK_NB\nNon-blocking mode. Returns immediately with an IOError if the lock is\nalready in use.\nLOCK_SH\nShared lock. Blocks any attempts to acquire an exclusive lock\n(LOCK_EX), but shared locks can still be acquired.\nLOCK_UN\nUnlock. Releases any previous held lock.\nIn nonblocking mode, an IOError exception is raised if the lock cannot be acquired.\nOn some systems, the process of opening and locking a file can be performed in a sin-\ngle operation by adding special flags to the os.open() operation. Consult the os mod-\nule for more details.\nlockf(fd, op [, len [, start [, whence]]])\nPerforms record or range locking on part of a file. op is the same as for the flock()\nfunction. len is the number of bytes to lock. start is the starting position of the lock\nrelative to the value of whence. whence is 0 for the beginning of the file, 1 for the cur-\nrent position, and 2 for the end of the file.\nExample\nimport fcntl\n# Open a file\nf = open(\"foo\",\"w\")\n# Set the close-on-exec bit for a file object f\nfcntl.fcntl(f.fileno(), fcntl.F_SETFD, 1)\n# Lock a file (blocking)\nfcntl.flock(f.fileno(), fcntl.LOCK_EX)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2168,
      "extraction_method": "Direct"
    },
    {
      "page_number": 374,
      "chapter": null,
      "content": "349\nio\n# Lock the first 8192 bytes of a file (non-blocking)\ntry:\nfcntl.lockf(f.fileno(), fcntl.LOCK_EX | fcntl.LOCK_NB, 8192, 0, 0)\nexcept IOError,e:\nprint \"Unable to acquire lock\", e\nNotes\nn The set of available fcntl() commands and options is system-dependent.The\nfcntl module may contain more than 100 constants on some platforms.\nn Although locking operations defined in other modules often make use of the\ncontext-manager protocol, this is not the case for file locking. If you acquire a file\nlock, make sure your code is written to properly release the lock.\nn Many of the functions in this module can also be applied to the file descriptors of\nsockets.\nio\nThe io module implements classes for various forms of I/O as well as the built-in\nopen() function that is used in Python 3.The module is also available for use in\nPython 2.6.\nThe central problem addressed by the io module is the seamless handling of differ-\nent forms of basic I/O. For example, working with text is slightly different than work-\ning with binary data because of issues related to newlines and character encodings.To\nhandle these differences, the module is built as a series of layers, each of which adds\nmore functionality to the last.\nBase I/O Interface\nThe io module defines a basic I/O programming interface that all file-like objects\nimplement.This interface is defined by a base class IOBase.An instance f of IOBase\nsupports these basic operations:\nAttribute\nDescription\nf.closed\nFlag indicating whether or not the file is closed.\nf.close()\nCloses the file.\nf.fileno()\nReturns the integer file descriptor.\nf.flush()\nFlushes the I/O buffers (if any).\nf.isatty()\nReturns True if f is a terminal.\nf.readable()\nReturns True if f was opened for reading.\nf.readline([limit])\nReads one line from the stream. limit is the maxi-\nmum number of bytes to read.\nf.readlines([limit])\nReads all lines from f and return as a list. limit, if\nprovided, is the maximum number of bytes that can be\nread before stopping. The actual number of bytes read\nwill be slightly greater to accommodate the last line,\nwhich is kept intact.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2115,
      "extraction_method": "Direct"
    },
    {
      "page_number": 375,
      "chapter": null,
      "content": "350\nChapter 19 Operating System Services\nAttribute\nDescription\nf.seek(offset, [whence]) Moves the file pointer to a new position relative to the\nlocation specified in whence. offset is the number of\nbytes. whence is 0 for the start of the file, 1 for the\ncurrent position, and 2 for the end of the file.\nf.seekable()\nReturns True if f is seekable.\nf.tell()\nReturns the current value of the file pointer.\nf.truncate([size])\nTruncates the file size so that it is at most size bytes.\nIf size isn’t given, it truncates the file to 0 bytes.\nf.writable()\nReturns True if f was opened for writing.\nf.writelines(lines)\nWrites a sequence of lines to f. Line endings are not\nadded so they must already be part of each line.\nRaw I/O\nThe lowest level of the I/O system is related to direct I/O involving raw bytes.The\ncore object for this is FileIO, which provides a fairly direct interface to low-level sys-\ntem calls such as read() and write().\nFileIO(name [, mode [, closefd]])\nA class for performing raw low-level I/O on a file or system file descriptor. name is\neither a filename or an integer file descriptor such as that returned by the os.open()\nfunction or the fileno() method of other file objects. mode is one of 'r' (the\ndefault); 'w'; or 'a' for reading, writing, or appending.A '+’ can be added to the mode\nfor update mode in which both reading and writing is supported. closefd is a flag that\ndetermines if the close() method actually closes the underlying file. By default, this is\nTrue, but it can be set False if you’re using FileIO to put a wrapper around a file that\nwas already opened elsewhere. If a filename was given, the resulting file object is opened\ndirectly using the operating system’s open() call.There is no internal buffering, and all\ndata is processed as raw byte strings.An instance f of FileIO has all of the basic I/O\noperations described earlier plus the following attributes and methods:\nAttribute\nDescription\nf.closefd\nFlag that determines if the underlying file descriptor will be\nclosed on f.close() (read-only).\nf.mode\nFile mode used when opening (read-only).\nf.name\nfilename (read-only).\nf.read([size])\nReads at most size bytes using a single system call. If size\nis omitted, as much data as possible is returned using\nf.readall(). This operation may returns fewer bytes than\nrequested so you must use len() to check. None is returned if\nno data is available in non-blocking mode.\nf.readall()\nReads as much data as is available and returns as a single\nbyte string. An empty string is returned on EOF. In non-blocking\nmode, only as much data as is immediately available is\nreturned.\nf.write(bytes)\nWrites a byte string or byte-array to f using a single system call.\nThe number of bytes actually written is returned—which may be\nless than the number supplied in bytes.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2821,
      "extraction_method": "Direct"
    },
    {
      "page_number": 376,
      "chapter": null,
      "content": "351\nio\nIt is important to emphasize that FileIO objects are extremely low-level, providing a\nrather thin layer over operating system calls such as read() and write(). Specifically,\nusers of this object will need to diligently check return codes as there is no guarantee\nthat the f.read() or f.write() operations will read or write all of the requested data.\nThe fcntl module can be used to change low-level aspects of files such as file locking,\nblocking behavior, and so forth.\nFileIO objects should not be used for line-oriented data such as text.Although\nmethods such as f.readline() and f.readlines() are defined, these come from the\nIOBase base class where they are both implemented entirely in Python and work by\nissuing f.read() operations for a single byte at a time. Needless to say, the resulting\nperformance is horrible. For example, using f.readline() on a FileIO object f is\nmore than 750 times slower than using f.readline() on a standard file object created\nby the open() function in Python 2.6.\nBuffered Binary I/O\nThe buffered I/O layer contains a collection of file objects that read and write raw\nbinary data, but with in-memory buffering.As input, these objects all require a file\nobject that implements raw I/O such as the FileIO object in the previous section.All\nof the classes in this section inherit from BufferedIOBase.\nBufferedReader(raw [, buffer_size])\nA class for buffered binary reading on a raw file specified in raw. buffer_size specifies\nthe buffer size to use in bytes. If omitted, the value of DEFAULT_BUFFER_SIZE is used\n(8,192 bytes as of this writing).An instance f of BufferedReader supports all of the\noperations provided on IOBase in addition to these operations:\nMethod\nDescription\nf.peek([n])\nReturns at most n bytes of data from the I/O buffer without mov-\ning the file pointer. If n is omitted, a single byte is returned. If \nnecessary, a read operation will be issued to fill the buffer if it is\ncurrently empty. This operation never returns more bytes than the\ncurrent buffer size, so the result may be smaller than the request-\ned number of bytes in n.\nf.read([n])\nReads n bytes and returns as a byte string. If n is omitted, all\navailable data (up to EOF) is read and returned. If the underlying\nfile is non-blocking, any available data is read and returned. If a\nnon-blocking file is read and no data is available, a\nBlockingIOError exception is raised.\nf.read1([n])\nReads up to n bytes and returns as a byte string using a single\nsystem call. If any data is already loaded in the buffer, it is simply\nreturned. Otherwise, a single read() is made on the raw file to\nreturn data. Unlike f.read(), this operation may return less data\nthan requested even if the underlying file is not at EOF.\nf.readinto(b)\nReads len(b) bytes of data from the file into an existing\nbytearray object b. The actual number of bytes read is\nreturned. If the underlying file is in non-blocking mode, a\nBlockingIOError exception is raised if no data is available.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3011,
      "extraction_method": "Direct"
    },
    {
      "page_number": 377,
      "chapter": null,
      "content": "352\nChapter 19 Operating System Services\nBufferedWriter(raw [, buffer_size [, max_buffer_size]])\nA class for buffered binary writing on a raw file specified in raw. buffer_size specifies\nthe number of bytes that can be saved in the buffer before data is flushed to the under-\nlying I/O stream.The default value is DEFAULT_BUFFER_SIZE. max_buffer_size\nspecifies the maximum buffer size to use for storing output data that is being written to\na non-blocking stream and defaults to twice the value of buffer_size.This value is\nlarger to allow for continued writing while the previous buffer contents are written to\nthe I/O stream by the operating system.An instance f of BufferedWriter supports\nthe following operations:\nMethod\nDescription\nf.flush()\nWrites all bytes stored in the buffer to the underlying I/O stream.\nRaises a BlockingIOError exception if the file is in non-\nblocking mode and the operation would block (e.g., if the stream\ncan’t accept any new data at the moment).\nf.write(bytes)\nWrites the bytes in bytes to the I/O stream and returns the\nnumber of bytes actually written. If the underlying stream is non-\nblocking, a BlockingIOError exception is raised if write opera-\ntion would block.\nBufferedRWPair(reader, writer [, buffer_size [, max_buffer_size]])\nA class for buffered binary reading and writing on a pair of raw I/O streams. reader is\na raw file that supports reading, and writing is a raw file that supports writing.These\nfiles may be different, which may be useful for certain kinds of communication involv-\ning pipes and sockets.The buffer size parameters have the same meaning as for\nBufferedWriter.An instance f of BufferedRWPair supports all of the operations for\nBufferedReader and BufferedWriter.\nBufferedRandom(raw [, buffer_size [, max_buffer_size]])\nA class for buffered binary reading and writing on a raw I/O stream that supports ran-\ndom access (e.g., seeking). raw must be a raw file that supports both read, write,\nand seek operations.The buffer size parameters have the same meaning as for\nBufferedWriter.An instance f of BufferedRandom supports all of the \noperations for BufferedReader and BufferedWriter.\nBytesIO([bytes])\nAn in-memory file that implements the functionality of a buffered I/O stream. bytes is\na byte string that specifies the initial contents of the file.An instance b of BytesIO sup-\nports all of the operations of BufferedReader and BufferedWriter objects. In addi-\ntion, a method b.getvalue() can be used to return the current contents of the file as\na byte string.\nAs with FileIO objects, all the file objects in this section should not be used with\nline-oriented data such as text.Although it’s not quite as bad due to buffering, the\nresulting performance is still quite poor (e.g., more than 50 times slower than reading\nlines with files created using the Python 2.6 built-in open() function).Also, because of\ninternal buffering, you need to take care to manage flush() operations when writing.\nFor example, if you use f.seek() to move the file pointer to a new location, you\nshould first use f.flush() to flush any previously written data (if any).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3138,
      "extraction_method": "Direct"
    },
    {
      "page_number": 378,
      "chapter": null,
      "content": "353\nio\nAlso, be aware that the buffer size parameters only specify a limit at which writes\noccur and do not necessarily set a limit on internal resource use. For example, when you\ndo a f.write(data) on a buffered file f, all of the bytes in data are first copied into\nthe internal buffers. If data represents a very large byte array, this copying will substan-\ntially increase the memory use of your program.Thus, it is better to write large amounts\nof data in reasonably sized chunks, not all at once with a single write() operation. It\nshould be noted that because the io module is relatively new, this behavior might be\ndifferent in future versions.\nText I/O\nThe text I/O layer is used to process line-oriented character data.The classes defined in\nthis section build upon buffered I/O streams and add line-oriented processing as well as\nUnicode character encoding and decoding.All of the classes here inherit from\nTextIOBase.\nTextIOWrapper(buffered [, encoding [, errors [, newline [, line_buffering]]]])\nA class for a buffered text stream. buffered is a buffered I/O as described in the previ-\nous section. encoding is a string such as 'ascii' or 'utf-8' that specifies the text\nencoding. errors specifies the Unicode error-handling policy and is 'strict' by\ndefault (see Chapter 9,“Input and Output,” for a description). newline is the character\nsequence representing a newline and may be None, '', '\\n', '\\r', or '\\r\\n'. If None\nis given, then universal newline mode is enabled in which any of the other line endings\nare translated into '\\n' when reading and os.linesep is used as the newline on out-\nput. If newline is one of the other values, then all '\\n' characters are translated into\nthe specified newline on output. line_buffering is a flag that controls whether or not\na flush() operation is performed when any write operation contains the newline char-\nacter. By default, this is False.An instance f of TextIOWrapper supports all of the\noperations defined on IOBase as well as the following:\nMethod\nDescription\nf.encoding\nThe name of the text encoding being used.\nf.errors\nEncoding and decoding error handling policy.\nf.line_buffering\nFlag that determines line buffering behavior.\nf.newlines\nNone, a string, or a tuple giving all of the different forms of\nnewlines translated.\nf.read([n])\nReads at most n characters from the underlying stream and\nreturns as a string. If n is omitted, then this reads all avail-\nable data to the end of file. Returns the empty string at EOF.\nThe returned strings are decoded according to the encoding\nsetting in f.encoding.\nf.readline([limit])\nReads a single line of text and returns as a string. Returns\nan empty string at EOF. limit is the maximum number of\nbytes to read.\nf.write(s)\nWrites string s to the underlying stream using the text\nencoding in f.encoding.\nStringIO([initial [, encoding [, errors [, newline]]]])\nAn in-memory file object with the same behavior as a TextIOWrapper. initial is a\nstring that specifies the initial contents of the file.The other parameters have the same\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3064,
      "extraction_method": "Direct"
    },
    {
      "page_number": 379,
      "chapter": null,
      "content": "354\nChapter 19 Operating System Services\nmeaning as with TextIOWrapper.An instance s of StringIO supports all of the usual\nfile operations, in addition to a method s.getvalue() that returns the current con-\ntents of the memory buffer.\nThe open() Function\nThe io module defines the following open() function, which is the same as the built-\nin open() function in Python 3.\nopen(file [, mode [, buffering [, encoding [, errors [, newline [, closefd]]]]]])\nOpens file and returns an appropriate I/O object. file is either a string specifying\nthe name of a file or an integer file descriptor for an I/O stream that has already been\nopened.The result of this function is one of the I/O classes defined in the io module\ndepending on the settings of mode and buffering. If mode is any of the text modes\nsuch as 'r', 'w', 'a', or 'U', then an instance of TextIOWrapper is returned. If mode\nis a binary mode such as 'rb' or 'wb', then the result depends on the setting of\nbuffering. If buffering is 0, then an instance of FileIO is returned for performing\nraw unbuffered I/O. If buffering is any other value, then an instance of\nBufferReader, BufferedWriter, or BufferedRandom is returned depending on the\nfile mode.The encoding, errors, and errors parameters are only applicable to files\nopened in text mode and passed to the TextIOWrapper constructor.The closefd is\nonly applicable if file is an integer descriptor and is passed to the FileIO constructor.\nAbstract Base Classes\nThe io module defines the following abstract base classes that can be used for type\nchecking and defining new I/O classes:\nAbstract Class\nDescription\nIOBase\nBase class for all I/O classes.\nRawIOBase\nBase class for objects that support raw binary I/O. Inherits\nfrom IOBase.\nBufferedIOBase\nBase class for objects that support buffered binary I/O.\nInherits from IOBase.\nTextIOBase\nBase class for objects that support text streams. Inherits\nfrom IOBase.\nIt is rare for most programmers to work with these classes directly.You should refer to\nthe online documentation for details concerning their use and definition.\nNote\nThe io module is a new addition to Python, first appearing in Python 3 and backported\nto Python 2.6. As of this writing, the module is immature and has extremely poor run-\ntime performance—especially for any application that involves heavy amounts of text\nI/O. If you are using Python 2, you will be better served by the built-in open() function\nthan using the I/O classes defined in the io module. If you are using Python 3, there\nseems to be no other alternative. Although performance improvements are likely in\nfuture releases, this layered approach to I/O coupled with Unicode decoding is unlikely\nto match the raw I/O performance found in the C standard library, which is the basis for\nI/O in Python 2.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2818,
      "extraction_method": "Direct"
    },
    {
      "page_number": 380,
      "chapter": null,
      "content": "355\nlogging\nlogging\nThe logging module provides a flexible facility for applications to log events, errors,\nwarnings, and debugging information.This information can be collected, filtered, writ-\nten to files, sent to the system log, and even sent over the network to remote machines.\nThis section covers the essential details of using this module for most common cases.\nLogging Levels\nThe main focus of the logging module concerns the issuing and handling of log mes-\nsages. Each message consists of some text along with an associated level that indicates its\nseverity. Levels have both a symbolic name and numerical value as follows:\nLevel\nValue\nDescription\nCRITICAL\n50\nCritical errors/messages\nERROR\n40\nErrors\nWARNING\n30\nWarning messages\nINFO\n20\nInformative messages\nDEBUG\n10\nDebugging\nNOTSET\n0\nNo level set\nThese different levels are the basis for various functions and methods throughout the\nlogging module. For example, there are methods to issue log messages at each level as\nwell as filters that work by blocking messages that don’t meet a certain threshold value.\nBasic Configuration\nBefore using any other functions in the logging module, you should first perform\nsome basic configuration of a special object known as the root logger.The root logger is\nresponsible for managing the default behavior of log messages including the logging\nlevel, output destination, message format, and other basic details.The following function\nis used for configuration:\nbasicConfig([**kwargs])\nPerforms basic configuration of the root logger.This function should be called before\nany other logging calls are made.The function accepts a number of keyword arguments:\nKeyword Argument\nDescription\nfilename\nAppends log messages to a file with the given filename.\nfilemode\nSpecifies the mode used to open the file. By default, mode 'a'\n(append) is used.\nformat\nFormat string used to produce log messages.\ndatefmt\nFormat string used to output dates and times.\nlevel\nSets the level of the root logger. All log messages with a level\nequal to or above this level will be processed. Lower-level mes-\nsages will be silently ignored.\nstream\nProvides an open file to which log messages are sent. The\ndefault stream is sys.stderr. This parameter may not be used\nsimultaneously with the filename parameter.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2307,
      "extraction_method": "Direct"
    },
    {
      "page_number": 381,
      "chapter": null,
      "content": "356\nChapter 19 Operating System Services\nMost of these parameters are self-explanatory.The format argument is used to specify\nthe format of log messages along with optional contextual information such as file-\nnames, levels, line numbers, and so forth. datefmt is a date format string compatible\nwith the time.strftime() function. If omitted, the date format is set to the ISO8601\nformat.\nThe following expansions are recognized in format:\nFormat\nDescription\n%(name)s\nName of the logger.\n%(levelno)s\nNumeric logging level.\n%(levelname)s\nText name of the logging level.\n%(pathname)s\nPathname of the source file where the logging call was executed.\n%(filename)s\nfilename of the source file where the logging call was executed.\n%(funcName)s\nFunction name in which the logging call was made.\n%(module)s\nModule name where the logging call executed.\n%(lineno)d\nLine number where the logging call executed.\n%(created)f\nTime when the logging call executed. The value is a number as\nreturned by time.time().\n%(asctime)s\nASCII-formatted date and time when the logging call was executed.\n%(msecs)s\nMillisecond portion of the time when the logging call executed.\n%(thread)d\nThread ID.\n%(threadName)s\nThread name.\n%(process)d\nProcess ID.\n%(message)s\nThe logged message (supplied by user).\nHere is an example that illustrates a single configuration where log messages with a\nlevel of INFO or higher are appended to a file:\nimport logging\nlogging.basicConfig(\nfilename = \"app.log\",\nformat   = \"%(levelname)-10s %(asctime)s %(message)s\"\nlevel    = logging.INFO\n)\nWith this configuration, a CRITICAL log message of 'Hello World' will appear as fol-\nlows in the log file 'app.log'.\nCRITICAL   2005-10-25 20:46:57,126 Hello World\nLogger Objects\nIn order to issue log messages, you have to obtain a Logger object.This section\ndescribes the process of creating, configuring, and using these objects.\nCreating a Logger\nTo create a new Logger object, you use the following function:\ngetLogger([logname])\nReturns a Logger instance associated with the name logname. If no such object exists,\na new Logger instance is created and returned. logname is a string that specifies a name\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2178,
      "extraction_method": "Direct"
    },
    {
      "page_number": 382,
      "chapter": null,
      "content": "357\nlogging\nor series of names separated by periods (for example 'app' or 'app.net'). If you omit\nlogname, you will get the Logger object associated with the root logger.\nThe creation of Logger instances is different than what you find in most other\nlibrary modules.When you create a Logger, you always give it a name which is passed\nto getLogger() as the logname parameter. Internally, getLogger() keeps a cache of\nthe Logger instances along with their associated names. If another part of the program\nrequests a logger with the same name, the previously created instance is returned.This\narrangement greatly simplifies the handling of log messages in large applications because\nyou don’t have to figure out how to pass Logger instances around between different\nprogram modules. Instead, in each module where you want logging, you just use\ngetLogger() to get a reference to the appropriate Logger object.\nPicking Names\nFor reasons that will become clear later, you should always pick meaningful names\nwhen using getLogger(). For example, if your application is called 'app', then you\nshould minimally use getLogger('app') at the top of every program module that\nmakes up the application. For example:\nimport logging\nlog = logging.getLogger('app')\nYou might also consider adding the module name to the logger such as\ngetLogger('app.net') or getLogger('app.user') in order to more clearly indi-\ncate the source of log messages.This can be done using statements such as this:\nimport logging\nlog = logging.getLogger('app.'+_ _name_ _)\nAdding the module name makes it easier to selectively turn off or reconfigure the log-\nging for specific program modules as will be described later.\nIssuing Log Messages\nIf log is an instance of a Logger object (created using the getLogger() function in\nthe previous section), the following methods are used to issue log messages at the differ-\nent logging levels:\nLogging Level\nMethod\nCRITICAL\nlog.critical(fmt [, *args [, exc_info [, extra]]])\nERROR\nlog.error(fmt [, *args [, exc_info [, extra]]])\nWARNING\nlog.warning(fmt [, *args [, exc_info [, extra]]])\nINFO\nlog.info(fmt [, *args [, exc_info [, extra]]])\nDEBUG\nlog.debug(fmt [, *args [, exc_info [, extra]]])\nThe fmt argument is a format string that specifies the format of the log message.Any\nremaining arguments in args serve as arguments for format specifiers in the format\nstring.The string formatting operator % is used to form the resulting message from these\narguments. If multiple arguments are provided, they are placed into a tuple for format-\nting. If a single argument is provided, it is placed directly after the % when formatting.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2654,
      "extraction_method": "Direct"
    },
    {
      "page_number": 383,
      "chapter": null,
      "content": "358\nChapter 19 Operating System Services\nThus, if you pass a single dictionary as an argument, the format string can include dic-\ntionary key names. Here are a few examples that illustrate how this works:\nlog = logging.getLogger(\"app\")\n# A log message using positional formatting\nlog.critical(\"Can't connect to %s at port %d\", host, port)\n# A log message using dictionary formatting\nparms = {\n'host' : 'www.python.org',\n'port' : 80\n}\nlog.critical(\"Can't connect to %(host)s at port %(port)d\", parms)\nThe keyword argument exc_info, if set to True, adds exception information from\nsys.exc_info() to the log message. If exc_info is set to an exception tuple such as\nthat returned by sys.exc_info(), then that information is used.The extra keyword\nargument is a dictionary that supplies additional values for use in log message format\nstrings (described later). Both exc_info and extra must be specified as keyword argu-\nments.\nWhen issuing log messages, you should avoid code that carries out string formatting\nat the time the message is issued (that is, formatting a message and then passing the\nresult into the logging module). For example,\nlog.critical(\"Can't connect to %s at port %d\" % (host, port))\nIn this example, the string formatting operation always occurs before the call to\nlog.critical() because the arguments to a function or method have to be fully eval-\nuated. However, in the example at the top of the page, the parameters used for string\nformatting operation are merely passed to the logging module and used only if the log\nmessage is actually going to be handled.This is a very subtle distinction, but because\nmany applications choose to filter log messages or only emit logs during debugging, the\nfirst approach performs less work and runs faster when logging is disabled.\nIn addition to the methods shown, there are a few additional methods for issuing log\nmessages on a Logger instance log.\nlog.exception(fmt [, *args ])\nIssues a message at the ERROR level but adds exception information from the current\nexception being handled.This can only be used inside except blocks.\nlog.log(level, fmt [, *args [, exc_info [, extra]]])\nIssues a logging message at the level specified by level.This can be used if the logging\nlevel is determined by a variable or if you want to have additional logging levels not\ncovered by the five basic levels.\nlog.findCaller()\nReturns a tuple (filename, lineno, funcname) corresponding to the caller’s source\nfilename, line number, and function name.This information is sometimes useful when\nissuing log messages—for example, if you want to add information about the location of\nthe logging call to a message.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2678,
      "extraction_method": "Direct"
    },
    {
      "page_number": 384,
      "chapter": null,
      "content": "359\nlogging\nFiltering Log Messages\nEach Logger object log has an internal level and filtering mechanism that determines\nwhich log messages get handled.The following two methods are used to perform sim-\nple filtering based on the numeric level of log messages:\nlog.setLevel(level)\nSets the level of log. Only logging messages with a level greater than or equal to \nlevel will be handled.All other messages are simply ignored. By default, the level is\nlogging.NOTSET which processes all log messages.\nlog.isEnabledFor(level)\nReturns True if a logging message at level level would be processed.\nLogging messages can also be filtered based on information associated with the mes-\nsage itself—for example, the filename, the line number, and other details.The following\nmethods are used for this:\nlog.addFilter(filt)\nAdds a filter object, filt, to the logger.\nlog.removeFilter(filt)\nRemoves a filter object, filt, from the logger.\nIn both methods, filt is an instance of a Filter object.\nFilter(logname)\nCreates a filter that only allows log messages from logname or its children to pass\nthrough. For example, if logname is 'app', then messages from loggers such as 'app',\n'app.net', or 'app.user' will pass, but messages from a logger such as 'spam' will\nnot.\nCustom filters can be created by subclassing Filter and implementing the method\nfilter(record) that receives as input a record containing information about a log-\nging message.As output, True or False is returned depending on whether or not the\nmessage should be handled.The record object passed to this method typically has the\nfollowing attributes:\nAttribute\nDescription\nrecord.name\nLogger name\nrecord.levelname\nLevel name\nrecord.levelno\nLevel number\nrecord.pathname\nPathname of the module\nrecord.filename\nBase filename\nrecord.module\nModule name\nrecord.exc_info\nException information\nrecord.lineno\nLine number where log message was issued\nrecord.funcName\nFunction name where log message was issued\nrecord.created\nTime at which issued\nrecord.thread\nThread identifier\nrecord.threadName\nThread name\nrecord.process\nPID of currently executing process\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2125,
      "extraction_method": "Direct"
    },
    {
      "page_number": 385,
      "chapter": null,
      "content": "360\nChapter 19 Operating System Services\nThe following example illustrates how you create a custom filter:\nclass FilterFunc(logging.Filter):\ndef _ _init_ _(self,name):\nself.funcName = name\ndef filter(self, record):\nif record.funcName == self.funcName: return False\nelse: return True\nlog.addFilter(FilterFunc('foo'))    # Ignore all messages originating from foo()\nlog.addFilter(FilterFunc('bar'))    # Ignore all messages originating from bar()\nMessage Propagation and Hierarchical Loggers\nIn advanced logging applications, Logger objects can be organized into a hierarchy.This\nis done by giving a logger object a name such as 'app.net.client'. Here, there are\nactually three different Logger objects called 'app', 'app.net', and\n'app.net.client'.When a message is issued on any of the loggers and it successfully\npasses that logger’s filter, it propagates to and is handled by all of the parents. For exam-\nple, a message successfully issued on 'app.net.client' also propagates to 'app.net',\n'app' and the root logger.\nThe following attributes and methods of a Logger object log control this propaga-\ntion.\nlog.propagate\nA Boolean flag that indicates whether or not messages propagate to the parent logger.\nBy default, this is set to True.\nlog.getEffectiveLevel()\nReturns the effective level of the logger. If a level has been set using setLevel(), that\nlevel is returned. If no level has been explicitly set (the level is logging.NOTSET in this\ncase), this function returns the effective level of the parent logger instead. If none of the\nparent loggers have a level set, the effective level of the root logger will be returned.\nThe primary purpose of hierarchical logging is to be able to more easily filter log\nmessages originating from different parts of a large application. For example, if you\nwanted to shut down log messages from the 'app.net.client' part of an application,\nyou might add configuration code such as the following:\nimport logging\nlogging.getLogger('app.net.client').propagate = False\nOr, in this code, we’re ignoring all but the most severe messages from a program \nmodule:\nimport logging\nlogging.getLogger('app.net.client').setLevel(logging.CRITICAL)\nA subtle aspect of hierarchical loggers is that the decision to handle a log message is\nmade entirely by the level and filters on the Logger object on which the message was\nissued, not by the filters on any of the parents.Thus, if a message passes the first set of\nfilters, it is propagated to and handled by all the parent loggers regardless of their own fil-\nter and level settings—even if these filters would have rejected the message.At first\nglance, the behavior is counterintuitive and might even seem like a bug. However, set-\nting the level of a child logger to a value that is lower than its parent is one way to\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2821,
      "extraction_method": "Direct"
    },
    {
      "page_number": 386,
      "chapter": null,
      "content": "361\nlogging\noverride the settings on the parent, achieving a kind of level promotion. Here is an\nexample:\nimport logging\n# The top-level logger 'app'. \nlog = logging.getLogger('app')\nlog.setLevel(logging.CRITICAL)         # Only accept CRITICAL level messages.\n# A child logger 'app.net'\nnet_log = logging.getLogger('app.net')\nnet_log.setLevel(logging.ERROR)        # Accept ERROR messages on 'app.net'.\n# These messages will now be handled by the\n# 'app' logger even though its level is\n# CRITICAL.\nWhen using hierarchical loggers, you only have to configure the logging objects where\nyou want to change the filtering or propagation behavior. Because messages naturally\npropagate to the root logger, it will ultimately be responsible for producing the output\nand any configuration that you made using basicConfig() will apply.\nMessage Handling\nNormally, messages are handled by the root logger. However, any Logger object can\nhave special handlers added to it that receive and process log messages.This is done\nusing these methods of a Logger instance log.\nlog.addHandler(handler)\nAdds a Handler object to the logger.\nlog.removeHandler(handler)\nRemoves the Handler object handler from the logger.\nThe logging module has a variety of pre-built handlers for writing log messages to\nfiles, streams, system logs, and so forth.These are described in further detail in the next\nsection. However, the following example shows how loggers and handlers are hooked\ntogether using these methods.\nimport logging\nimport sys\n# Create a top-level logger called 'app'\napp_log = logging.getLogger(\"app\")\napp_log.setLevel(logging.INFO)\napp_log.propagate = False\n# Add some message handlers to the 'app' log\napp_log.addHandler(logging.FileHandler('app.log'))\napp_log.addHandler(logging.StreamHandler(sys.stderr))\n# Issue some messages.  These go to app.log and sys.stderr\napp_log.critical(\"Creeping death detected!\")\napp_log.info(\"FYI\")\nWhen you add your own handlers to process messages, it is often your intent to over-\nride the behavior of the root logger.This is why message propagation is disabled in the\nprevious example (i.e., the 'app' logger is simply going to handle all of the messages).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2202,
      "extraction_method": "Direct"
    },
    {
      "page_number": 387,
      "chapter": null,
      "content": "362\nChapter 19 Operating System Services\nHandler Objects\nThe logging module provides a collection of pre-built handlers that can process log\nmessages in various in ways.These handlers are added to Logger objects using their\naddHandler() method. In addition, each handler can be configured with its own filter-\ning and levels.\nBuilt-In Handlers\nThe following handler objects are built-in. Some of these handlers are defined in a sub-\nmodule logging.handlers, which must be imported specifically if necessary.\nhandlers.DatagramHandler(host,port)\nSends log messages to a UDP server located on the given host and port. Log messages\nare encoded by taking the dictionary of the corresponding LogRecord object and\nencoding it using the pickle module.The transmitted network message consists of a 4-\nbyte network order (big-endian) length followed by the pickled record data.To recon-\nstruct the message, the receiver must strip the length header, read the entire message,\nunpickle the contents, and call logging.makeLogRecord(). Because UDP is unreli-\nable, network errors may result in lost log messages.\nFileHandler(filename [, mode [, encoding [, delay]]])\nWrites log messages to the file filename. mode is the file mode to use when opening\nthe file and defaults to 'a'. encoding is the file encoding. delay is a Boolean flag that,\nif set True, defers the opening of the log file until the first log message is issued. By\ndefault, it is False.\nhandlers.HTTPHandler(host, url [, method])\nUploads log messages to an HTTP server using HTTP GET or POST methods. host\nspecifies the host machine, url is the URL to use, and method is either 'GET' (the\ndefault) or 'POST'.The log message is encoded by taking the dictionary of the corre-\nsponding LogRecord object and encoding it as a set of URL query-string variables\nusing the urllib.urlencode() function.\nhandlers.MemoryHandler(capacity [, flushLevel [, target]])\nThis handler is used to collect log messages in memory and to flush them to another\nhandler, target, periodically. capacity is the size of the memory buffer in bytes.\nflushLevel is a numeric logging level that forces a memory flush should a logging\nmessage of that level or higher appear.The default value is ERROR. target is another\nHandler object that receives the messages. If target is omitted, you will need to set a\ntarget using the setTarget() method of the resulting handler object in order for this\nhandler to do anything.\nhandlers.NTEventLogHandler(appname [, dllname [, logtype]])\nSends messages to the event log on Windows NT,Windows 2000, or Windows XP.\nappname is the name of the application name to use in the event log. dllname is a full\npath name to a .DLL or .EXE file that provides message definitions to hold in the log. If\nomitted, dllname is set to 'win32service.pyd'. logtype is either 'Application',\n'System', or 'Security'.The default value is 'Application'.This handler is only\navailable if Win32 extensions for Python have been installed.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2994,
      "extraction_method": "Direct"
    },
    {
      "page_number": 388,
      "chapter": null,
      "content": "363\nlogging\nhandlers.RotatingFileHandler(filename [, mode [, maxBytes [, backupCount [,\nencoding [, delay]]]]])\nWrites log messages to the file filename. However, if the file exceeds the size specified\nby maxBytes, the file is rotated to filename.1 and a new log file, filename, is\nopened. backupCount specifies the maximum number of backup files to create. By\ndefault, the value of backupCount is 0. However, when specified, backup files are rotat-\ned through the sequence filename.1, filename.2, … ,filename.N, where \nfilename.1 is always the most recent backup and filename.N is always the oldest\nbackup. mode specifies the file mode to use when opening the log file.The default\nmode is 'a'. If maxBytes is 0 (the default), the log file is never rolled over and is\nallowed to grow indefinitely. encoding and delay have the same meaning as with\nFileHandler.\nhandlers.SMTPHandler(mailhost, fromaddr, toaddrs, subject [, credentials])\nSends log messages to a remote host using email. mailhost is the address of an SMTP\nserver that can receive the message.The address can be a simple host name specified as a\nstring or a tuple (host, port). fromaddr is the from address, toaddrs is the destina-\ntion address, and subject is the subject to use in the message. credentials is a tuple\n(username, password) with the username and password.\nhandlers.SocketHandler(host, port)\nSends log messages to a remote host using a TCP socket connection. host and port\nspecify the destination. Messages are sent in the same format as described for\nDatagramHandler. Unlike DatagramHandler, this handler reliably delivers log mes-\nsages.\nStreamHandler([fileobj])\nWrites log messages to an already open file-like object, fileobj. If no argument is pro-\nvided, messages are written to sys.stderr.\nhandlers.SysLogHandler([address [, facility]])\nSends log messages to a UNIX system logging daemon. address specifies the destina-\ntion as a (host, port) tuple. If omitted, a destination of ('localhost', 514) is\nused. facility is an integer facility code and is set to SysLogHandler.LOG_USER by\ndefault.A full list of facility codes can be found in the definition of SysLogHandler.\nhandlers.TimedRotatingFileHandler(filename [, when [, interval [, backupCount [,\nencoding [, delay [, utc]]]]]])\nThe same as RotatingFileHandler, but the rotation of files is controlled by time\ninstead of file size. interval is a number, and when is a string that specifies units.\nPossible values for when are 'S' (seconds), 'M' (minutes), 'H' (hours), 'D' (days), 'W'\n(weeks), and 'midnight' (roll over at midnight). For example, setting interval to 3\nand when to 'D' rolls the log every three days. backupCount specifies the maximum\nnumber of backup files to keep. utc is a Boolean flag that determines whether or not to\nuse local time (the default) or UTC time.\nhandlers.WatchedFileHandler(filename [, mode [, encoding [, delay]]])\nThe same as FileHandler, but the inode and device of the opened log file is moni-\ntored. If it changes since the last log message was issued, the file is closed and reopened\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3086,
      "extraction_method": "Direct"
    },
    {
      "page_number": 389,
      "chapter": null,
      "content": "364\nChapter 19 Operating System Services\nagain using the same filename.These changes might occur if a log file has been deleted\nor moved as a result of a log rotation operation carried out externally to the running\nprogram.This handler only works on UNIX systems.\nHandler Configuration\nEach Handler object h can be configured with its own level and filtering.The follow-\ning methods are used to do this:\nh.setLevel(level)\nSets the threshold of messages to be handled. level is a numeric code such as ERROR or\nCRITICAL.\nh.addFilter(filt)\nAdds a Filter object, filt, to the handler. See the addFilter() method of Logger\nobjects for more information.\nh.removeFilter(filt)\nRemoves a Filter object, filt, from the handler.\nIt is important to stress that levels and filters can be set on handlers independently\nfrom any settings used on the Logger objects to which handlers are attached. Here is an\nexample that illustrates this:\nimport logging\nimport sys\n# Create a handler that prints CRITICAL level messages to stderr \ncrit_hand = logging.StreamHandler(sys.stderr)\ncrit_hand.setLevel(logging.CRITICAL)\n# Create a top-level logger called 'app'\napp_log = logging.getLogger(\"app\")\napp_log.setLevel(logging.INFO)\napp_log.addHandler(logging.FileHandler('app.log'))\napp_log.addHandler(crit_handler)\nIn this example, there is a single logger called 'app’ with a level of INFO.Two handlers\nare attached to it, but one of the handlers (crit_handler) has its own level setting of\nCRITICAL.Although this handler will receive log messages with a level of INFO or\nhigher, it selectively discards those that are not CRITICAL.\nHandler Cleanup\nThe following methods are used on handlers to perform cleanup.\nh.flush()\nFlushes all logging output.\nh.close()\nCloses the handler.\nMessage Formatting\nBy default, Handler objects emit log messages exactly as they are formatted in logging\ncalls. However, sometimes you want to add additional contextual information to the\nmessages such as timestamps, filenames, line numbers, and so forth.This section\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2047,
      "extraction_method": "Direct"
    },
    {
      "page_number": 390,
      "chapter": null,
      "content": "365\nlogging\ndescribes how this extra information can be automatically added to log messages.\nFormatter Objects\nTo change the log message format, you must first create a Formatter object:\nFormatter([fmt [, datefmt]])\nCreates a new Formatter object. fmt provides a format string for messages.Within\nfmt, you can place various expansions as previously described for the basicConfig()\nfunction. datefmt is a date format string compatible with the time.strftime() func-\ntion. If omitted, the date format is set to the ISO8601 format.\nTo take effect, Formatter objects must be attached to handler objects.This is done\nusing the h.setFormatter() method of a Handler instance h.\nh.setFormatter(format)\nSets the message formatter object used to create log messages on the Handler instance\nh. format must be an instance of Formatter.\nHere is an example that illustrates how to customize the log message format on a\nhandler:\nimport logging\nimport sys\n# Set the message format\nformat = logging.Formatter(\"%(levelname)-10s %(asctime)s %(message)s\")\n# Create a handler that prints CRITICAL level messages to stderr \ncrit_hand = logging.StreamHandler(sys.stderr)\ncrit_hand.setLevel(logging.CRITICAL)\ncrit_hand.setFormatter(format)\nIn this example, a custom Formatter is set on the crit_hand handler. If a logging\nmessage such as \"Creeping death detected.\" is processed by this handler, the fol-\nlowing log message is produced:\nCRITICAL   2005-10-25 20:46:57,126 Creeping death detected.\nAdding Extra Context to Messages\nIn certain applications, it is useful to add additional context information to log mes-\nsages.This extra information can be provided in one of two ways. First, all of the basic\nlogging operations (e.g., log.critical(), log.warning(), etc.) have a keyword\nparameter extra that is used to supply a dictionary of additional fields for use in mes-\nsage format strings.These fields are merged in with the context data previously\ndescribed for Formatter objects. Here is an example:\nimport logging, socket\nlogging.basicConfig(\nformat = \"%(hostname)s %(levelname)-10s %(asctime)s %(message)s\"\n)\n# Some extra context\nnetinfo = {\n'hostname' : socket.gethostname(),\n'ip'       : socket.gethostbyname(socket.gethostname())\n}\nlog = logging.getLogger('app')\n# Issue a log message with the extra context data\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2322,
      "extraction_method": "Direct"
    },
    {
      "page_number": 391,
      "chapter": null,
      "content": "366\nChapter 19 Operating System Services\nlog.critical(\"Could not connect to server\", extra=netinfo)\nThe downside of this approach is that you have to make sure every logging operation\nincludes the extra information or else the program will crash.An alternative approach is\nto use the LogAdapter class as a wrapper for an existing logger.\nLogAdapter(log [, extra])\nCreates a wrapper around a Logger object log. extra is a dictionary of extra context\ninformation to be supplied to message formatters.An instance of LogAdapter has the\nsame interface as a Logger object. However, operations that issue log messages will\nautomatically add the extra information supplied in extra.\nHere is an example of using a LogAdapter object:\nimport logging, socket\nlogging.basicConfig(\nformat = \"%(hostname)s %(levelname)-10s %(asctime)s %(message)s\"\n)\n# Some extra context\nnetinfo = {\n'hostname' : socket.gethostname(),\n'ip'       : socket.gethostbyname(socket.gethostname())\n}\n# Create a logger\nlog = logging.LogAdapter(logging.getLogger(\"app\"), netinfo)\n# Issue a log message. Extra context data is supplied by the LogAdapter\nlog.critical(\"Could not connect to server\")\nMiscellaneous Utility Functions\nThe following functions in logging control a few other aspects of logging:\ndisable(level)\nGlobally disables all logging messages below the level specified in level. This can be\nused to turn off logging on a applicationwide basis—for instance, if you want to tem-\nporarily disable or reduce the amount of logging output.\naddLevelName(level, levelName)\nCreates an entirely new logging level and name. level is a number and levelName is a\nstring.This can be used to change the names of the built-in levels or to add more levels\nthan are supported by default.\ngetLevelName(level)\nReturns the name of the level corresponding to the numeric value level.\nshutdown()\nShuts down all logging objects, flushing output if necessary.\nLogging Configuration\nSetting an application to use the logging module typically involves the following basic\nsteps:\n1. Use getLogger() to create various Logger objects. Set parameters such as the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2127,
      "extraction_method": "Direct"
    },
    {
      "page_number": 392,
      "chapter": null,
      "content": "367\nlogging\nlevel, as appropriate.\n2. Create Handler objects by instantiating one of the various types of handlers\n(FileHandler, StreamHandler, SocketHandler, and so on) and set an appro-\npriate level.\n3. Create message Formatter objects and attach them to the Handler objects using\nthe setFormatter() method.\n4. Attach the Handler objects to the Logger objects using the addHandler()\nmethod.\nBecause the configuration of each step can be somewhat involved, your best bet is to\nput all the logging configuration into a single well-documented location. For example,\nyou might create a file applogconfig.py that is imported by the main program of\nyour application:\n# applogconfig.py\nimport logging\nimport sys\n# Set the message format\nformat = logging.Formatter(\"%(levelname)-10s %(asctime)s %(message)s\")\n# Create a handler that prints CRITICAL level messages to stderr \ncrit_hand = logging.StreamHandler(sys.stderr)\ncrit_hand.setLevel(logging.CRITICAL)\ncrit_hand.setFormatter(format)\n# Create a handler that prints messages to a file\napplog_hand = logging.FileHandler('app.log')\napplog_hand.setFormatter(format)\n# Create a top-level logger called 'app'\napp_log = logging.getLogger(\"app\")\napp_log.setLevel(logging.INFO)\napp_log.addHandler(applog_hand)\napp_log.addHandler(crit_hand)\n# Change the level on the 'app.net' logger\nlogging.getLogger(\"app.net\").setLevel(logging.ERROR)\nIf changes need to be made to any part of the logging configuration, having everything\nin one location makes things easier to maintain. Keep in mind that this special file only\nneeds to be imported once and in only one location in the program. In other parts of\nthe code where you want to issue log messages, you simply include code like this:\nimport logging\napp_log = logging.getLogger(\"app\")\n...\napp_log.critical(\"An error occurred\")\nThe logging.config Submodule\nAs an alternative to hard-coding the logging configuration in Python code, it is also\npossible to configure the logging module through the use of an INI-format configura-\ntion file.To do this, use the following functions found in logging.config.\nfileConfig(filename [, defaults [, disable_existing_loggers]])\nReads the logging configuration from the configuration file filename. defaults is a\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2256,
      "extraction_method": "Direct"
    },
    {
      "page_number": 393,
      "chapter": null,
      "content": "368\nChapter 19 Operating System Services\ndictionary of default configuration parameters for use in the config file.The specified\nfilename is read using the ConfigParser module. disable_existing_loggers is a\nBoolean flag that specifies whether or not any existing loggers are disabled when new\nconfiguration data is read. By default, this is True.\nThe online documentation for the logging module goes into some detail on the\nexpected format of configuration files. However, experienced programmers can proba-\nbly extrapolate from the following example, which is a configuration file version of\napplogconfig.py shown in the previous section.\n; applogconfig.ini\n;\n; Configuration file for setting up logging\n; The following sections provide names for Logger, Handler, and Formatter\n; objects that will be configured later in the file.\n[loggers]\nkeys=root,app,app_net\n[handlers]\nkeys=crit,applog\n[formatters]\nkeys=format\n[logger_root]\nlevel=NOTSET\nhandlers=\n[logger_app]\nlevel=INFO\npropagate=0\nqualname=app\nhandlers=crit,applog\n[logger_app_net]\nlevel=ERROR\npropagate=1\nqualname=app.net\nhandlers=\n[handler_crit]\nclass=StreamHandler\nlevel=CRITICAL\nformatter=format\nargs=(sys.stderr,)\n[handler_applog]\nclass=FileHandler\nlevel=NOTSET\nformatter=format\nargs=('app.log',)\n[formatter_format]\nformat=%(levelname)-10s %(asctime)s %(message)s\ndatefmt=\nTo read this configuration file and set up logging, you would use this code:\nimport logging.config\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1458,
      "extraction_method": "Direct"
    },
    {
      "page_number": 394,
      "chapter": null,
      "content": "369\nmmap\nlogging.config.fileConfig('applogconfig.ini')\nAs before, modules that want to issue log messages do not need to worry about the\ndetails of loading the logging configuration.They merely import the logging module\nand get a reference to the appropriate Logger object. For example:\nimport logging\napp_log = logging.getLogger(\"app\")\n...\napp_log.critical(\"An error occurred\")\nPerformance Considerations\nAdding logging to an application can severely degrade its performance if you aren’t\ncareful. However, there are some techniques that can be used to reduce the overhead.\nFirst, Python’s optimized mode (-O) removes all code that is conditionally executed\nusing statements such as if _ _debug_ _: statements. If the sole purpose of logging\nis debugging, you could conditionally execute all of the logging calls and have the calls\nremoved in optimized mode.\nA second technique would be to use a Null object in place of a Logger object\nwhen logging is to be completely disabled.This is different than using None. Instead,\nyou want to use an instance of an object that silently swallows all operations that get\nperformed on it. For example:\nclass Null(object):\ndef _ _init_ _(self, *args, **kwargs): pass\ndef _ _call_ _(self, *args, **kwargs): return self\ndef _ _getattribute_ _(self, name): return self\ndef _ _setattr_ _(self, name, value): pass\ndef _ _delattr_ _(self,name): pass\nlog = Null()\nlog.critical(\"An error occurred.\")     # Does nothing\nDepending on your cleverness, logging can also be managed through the use of decora-\ntors and metaclasses. Because these features of Python operate at the time that func-\ntions, methods, and classes are defined, they can be used to selectively add or remove\nlogging features from parts of a program in a way that does not impact performance\nwhen logging is disabled. Please refer to Chapter 6,“Functions and Functional\nProgramming,” and Chapter 7,“Classes and Object-Oriented Programming,” for further\ndetails.\nNotes\nn The logging module provides a large number of customization options not dis-\ncussed here. Readers should consult online documentation for further details.\nn It is safe to use the logging module with programs that use threads. In particu-\nlar, it is not necessary to add locking operations around code that is issuing log\nmessages.\nmmap\nThe mmap module provides support for a memory-mapped file object.This object\nbehaves both like a file and a byte string and can be used in most places where an ordi-\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2492,
      "extraction_method": "Direct"
    },
    {
      "page_number": 395,
      "chapter": null,
      "content": "370\nChapter 19 Operating System Services\nnary file or byte string is expected. Furthermore, the contents of a memory-mapped file\nare mutable.This means that modifications can be made using index-assignment and\nslice-assignment operators. Unless a private mapping of the file has been made, such\nchanges directly alter the contents of the underlying file.\nA memory-mapping file is created by the mmap() function, which is slightly differ-\nent on UNIX and Windows.\nmmap(fileno, length [, flags, [prot [,access [, offset]]]])\n(UNIX). Returns an mmap object that maps length bytes from the file with an integer\nfile descriptor, fileno. If fileno is -1, anonymous memory is mapped. flags specifies\nthe nature of the mapping and is one of the following:\nFlag\nMeaning\nMAP_PRIVATE\nCreates a private copy-on-write mapping. Changes to the object will\nbe private to this process.\nMAP_SHARED\nShares the mapping with all other processes mapping the same\nareas of the file. Changes to the object will affect all mappings. \nThe default flags setting is MAP_SHARED. prot specifies the memory protections of the\nobject and is the bitwise OR of the following:\nSetting\nMeaning\nPROT_READ\nData can be read from the object.\nPROT_WRITE\nModifications can be made to the object.\nPROT_EXEC\nThe object can contain executable instructions.\nThe default value of prot is PROT_READ | PROT_WRITE.The modes specified in prot\nmust match the access permissions used to open the underlying file descriptor fileno.\nIn most cases, this means that the file should be opened in read/write mode (for exam-\nple, os.open(name, os.O_RDWR)).\nThe optional access parameter may be used as an alternative to flags and prot. If\ngiven, it has one of the following values:\nAccess\nMeaning\nACCESS_READ\nRead-only access.\nACCESS_WRITE\nRead/write access with write-through. Modifications affect the under-\nlying file.\nACCESS_COPY\nRead/write access with copy-on-write. Modifications affect memory\nbut do not change the underlying file.\nWhen access is supplied, it is typically given as a keyword argument—for example,\nmmap(fileno, length, access=ACCESS_READ). It is an error to supply values for\nboth access and flags. The offset parameter specifies the number of bytes from\nthe start of the file and defaults to 0. It must be a multiple of \nmmap.ALLOCATIONGRANULARITY.\nmmap(fileno, length[, tagname [,access [, offset]]])\n(Windows) Returns an mmap object that maps length bytes from the file specified by\nthe integer file descriptor fileno. Use a fileno of -1 for anonymous memory. If\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2551,
      "extraction_method": "Direct"
    },
    {
      "page_number": 396,
      "chapter": null,
      "content": "371\nmmap\nlength is larger than the current size of the file, the file is extended to length bytes. If\nlength is 0, the current length of the file is used as the length as long as the file is non-\nempty (otherwise, an exception will be raised). tagname is an optional string that can\nbe used to name the mapping. If tagname refers to an existing mapping, that mapping\nis opened. Otherwise, a new mapping is created. If tagname is None, an unnamed map-\nping is created. access is an optional parameter that specifies the access mode. It takes\nthe same values for access as described for the UNIX version of mmap() shown earli-\ner. By default, access is ACCESS_WRITE. offset is the number of bytes from the\nbeginning of the file and defaults to 0. It must be a multiple of \nmmap.ALLOCATIONGRANULARITY.\nA memory-mapped file object, m, supports the following methods.\nm.close()\nCloses the file. Subsequent operations will result in an exception.\nm.find(string[, start])\nReturns the index of the first occurrence of string. start specifies an optional start-\ning position. Returns -1 if no match is found.\nm.flush([offset, size])\nFlushes modifications of the in-memory copy back to the file system. offset and size\nspecify an optional range of bytes to flush. Otherwise, the entire mapping is flushed.\nm.move(dst,src,count)\nCopies count bytes starting at index src to the destination index dst.This copy is per-\nformed using the C memmove() function, which is guaranteed to work correctly when\nthe source and destination regions happen to overlap.\nm.read(n)\nReads up to n bytes from the current file position and returns the data as a string.\nm.read_byte()\nReads a single byte from the current file position and returns as a string of length 1.\nm.readline()\nReturns a line of input starting at the current file position.\nm.resize(newsize)\nResizes the memory-mapped object to contain newsize bytes.\nm.seek(pos[, whence])\nSets the file position to a new value. pos and whence have the same meaning as for the\nseek() method on file objects.\nm.size()\nReturns the length of the file.This value may be larger than the size of the memory-\nmapped region.\nm.tell()\nReturns the value of the file pointer.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2211,
      "extraction_method": "Direct"
    },
    {
      "page_number": 397,
      "chapter": null,
      "content": "372\nChapter 19 Operating System Services\nm.write(string)\nWrites a string of bytes to the file at the current file pointer.\nm.write_byte(byte)\nWrites a single byte into memory at the current file pointer.\nNotes\nn Although UNIX and Windows supply slightly different mmap() functions, this\nmodule can be used in a portable manner by relying on the optional access\nparameter that is common to both functions. For example,\nmmap(fileno,length,access=ACCESS_WRITE) will work on both UNIX and\nWindows.\nn Certain memory mapping may only work with a length that’s a multiple of the\nsystem page size, which is contained in the constant mmap.PAGESIZE.\nn On UNIX SVR4 systems, anonymous mapped memory can be obtained by call-\ning mmap() on the file /dev/zero, opened with appropriate permissions.\nn On UNIX BSD systems, anonymous mapped memory can be obtained by calling\nmmap() with a negative file descriptor and the flag mmap.MAP_ANON.\nmsvcrt\nThe msvcrt module provides access to a number of useful functions in the Microsoft\nVisual C runtime library.This module is available only on Windows.\ngetch()\nReads a keypress and returns the resulting character.This call blocks if a keypress is not\navailable. If the pressed key was a special function key, the call returns '\\000' or\n'\\xe0' and the next call returns the keycode.This function doesn’t echo characters to\nthe console, nor can the function be used to read Ctrl+C.\ngetwch()\nThe same as getch() except that a Unicode character is returned.\ngetche()\nLike getch() except that characters are echoed (if printable).\ngetwche()\nThe same as getche() except that a Unicode character is returned.\nget_osfhandle(fd)\nReturns the file handle for file descriptor fd. Raises IOError if fd is not recognized.\nheapmin()\nForces the internal Python memory manager to return unused blocks to the operating\nsystem.This works only on Windows NT and raises IOError on failure.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1921,
      "extraction_method": "Direct"
    },
    {
      "page_number": 398,
      "chapter": null,
      "content": "373\nmsvcrt\nkbhit()\nReturns True if a keypress is waiting to be read.\nlocking(fd, mode, nbytes)\nLocks part of a file, given a file descriptor from the C runtime. nbytes is the number\nof bytes to lock relative to the current file pointer. mode is one of the following \nintegers:\nSetting\nDescription\n0\nUnlocks the file region (LK_UNLCK)\n1\nLocks the file region (LK_LOCK)\n2\nLocks the file region; nonblocking (LK_NBLCK)\n3\nLocks for writing (LK_RLCK)\n4\nLocks for writing; nonblocking (LK_NBRLCK)\nAttempts to acquire a lock that takes more than approximately 10 seconds results in an\nIOError exception.\nopen_osfhandle(handle, flags)\nCreates a C runtime file descriptor from the file handle handle. flags is the bitwise\nOR of os.O_APPEND, os.O_RDONLY, and os.O_TEXT. Returns an integer file descriptor\nthat can be used as a parameter to os.fdopen() to create a file object.\nputch(char)\nPrints the character char to the console without buffering.\nputwch(char)\nThe same as putch() except that char is a Unicode character.\nsetmode(fd, flags)\nSets the line-end translation mode for file descriptor fd. flags is os.O_TEXT for text\nmode and os.O_BINARY for binary mode.\nungetch(char)\nCauses the character char to be “pushed back” into the console buffer. It will be the\nnext character read by getch() or getche().\nungetwch(char)\nThe same as ungetch() except that char is a Unicode character.\nNote\nA wide variety of Win32 extensions are available that provide access to the Microsoft\nFoundation Classes, COM components, graphical user interfaces, and so forth. These\ntopics are far beyond the scope of this book, but detailed information about many of\nthese topics is available in Python Programming on Win32 by Mark Hammond and Andy\nRobinson (O’Reilly & Associates, 2000). Also, http://www.python.org maintains an\nextensive list of contributed modules for use under Windows.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1884,
      "extraction_method": "Direct"
    },
    {
      "page_number": 399,
      "chapter": null,
      "content": "374\nChapter 19 Operating System Services\nSee Also:\nwinreg (p. 408)\noptparse\nThe optparse module provides high-level support for processing UNIX-style \ncommand-line options supplied in sys.argv.A simple example of using the module is\nfound in Chapter 9. Use of optparse primarily focuses on the OptionParser class.\nOptionParser([**args])\nCreates a new command option parser and returns an OptionParser instance.A variety\nof optional keyword arguments can be supplied to control configuration.These keyword\narguments are described in the following list:\nKeyword Argument\nDescription\nadd_help_option\nSpecifies whether or not a special help option (--help and -h)\nis supported. By default, this is set to True.\nconflict_handler\nSpecifies the handling of conflicting command-line options. May\nbe set to either 'error' (the default value) or 'resolve'. In\n'error' mode, an optparse.OptionConflictError excep-\ntion will be raised if conflicting option strings are added to the\nparser. In 'resolve' mode, conflicts are resolved so that\noptions added later take priority. However, earlier options may still\nbe available if they were added under multiple names and no con-\nflicts exist for at least one of the names.\ndescription\nA string that provides a description of the program for display dur-\ning help. This string will automatically be reformatted to fit the\nscreen when displayed.\nformatter\nInstance of an optparse.HelpFormatter class used to format\ntext when printing help. May be either optparse.\nIndentedHelpFormatter (the default) or optparse.\nTitledHelpFormatter.\noption_class\nThe Python class that’s used to hold information about each \ncommand-line option. The default class is optparse.Option.\noption_list\nA list of options used to populate the parser. By default, this list\nis empty, and options are added using the add_option()\nmethod instead. If supplied, this list contains objects of type\nOption.\nprog\nThe program name used to replace '%prog' in help text.\nusage\nThe usage string that’s printed when the --help option is used\nor incorrect options are passed. The default value is the string\n'%prog [options]', where the '%prog' keyword gets\nreplaced with either the value of os.path.basename\n(sys.argv[0]) or the value of the prog keyword argument (if\nsupplied). The value optparse.SUPPRESS_USAGE can be given\nto suppress the usage message entirely.\nversion\nVersion string that’s printed when the -version option is supplied.\nBy default, version is None and no --version option is added.\nWhen this string is supplied, -version is automatically added. The\nspecial keyword '%prog' is replaced by the program name.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2644,
      "extraction_method": "Direct"
    },
    {
      "page_number": 400,
      "chapter": null,
      "content": "375\noptparse\nUnless you really need to customize option processing in some way, an OptionParser\nwill usually be created with no arguments. For example:\np = optparse.OptionParser()\nAn instance, p, of OptionParser supports the following methods:\np.add_option(name1, ..., nameN [, **parms])\nAdds a new option to p.The arguments name1, name2, and so on are all of the various\nnames for the option. For example, you might include short and long option names\nsuch as '-f' and '--file’. Following the option names, an optional set of keyword\narguments is supplied that specifies how the option will be processed when parsed.\nThese keyword arguments are described in the following list:\nKeyword Argument\nDescription\naction\nAction to perform when the option is parsed. Acceptable values\nare as follows:\n'store'—Option has an argument that is read and stored. This\nis the default if no action is specified explicitly.\n'store_const'—The option takes no arguments, but when the\noption is encountered, a constant value specified with the\nconst keyword argument is stored.\n'store_true'—Like 'store_const' but stores a Boolean\nTrue when the option is parsed.\n'store_false'—Like 'store_true' but stores False\ninstead.\n'append'—Option has an argument that is appended to a list\nwhen parsed. This is used if the same command-line option is\nused to specify multiple values.\n'count'—Option takes no arguments, but a counter value is\nstored. The counter value is increased by one each time the\nargument is encountered.\n'callback'—Invokes a callback function specified with the\ncallback keyword argument when the option is encountered.\n'help'—Prints a help message when the option is parsed. This\nis only needed if you want help to be displayed via a different\noption than the standard -h or --help option.\n'version’—Prints the version number supplied to\nOptionParser(), if any. Only used if you want to display ver-\nsion information using an option other than the standard -v or\n--version option.\ncallback\nSpecifies a callback function to be invoked when the option is\nencountered. This callback function is a Python callable object\nthat is invoked as callback(option, opt_str, value,\nparser, *args, **kwargs). The option argument is an\ninstance of optparse.Option, opt_str is the option string\nsupplied on the command line that triggered the callback,\nvalue is the value of the option (if any), parser is the instance\nof OptionParser that’s running, args are positional argu-\nments supplied using the callback_args keyword argument,\nand kwargs are keyword arguments supplied using the \ncallback_kwargs keyword argument.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2622,
      "extraction_method": "Direct"
    },
    {
      "page_number": 401,
      "chapter": null,
      "content": "376\nChapter 19 Operating System Services\nKeyword Argument\nDescription\ncallback_args\nOptional positional arguments supplied to a callback function\nspecified with the callback argument.\ncallback_kwargs\nOptional keyword arguments supplied to a callback function\nspecified with the callback argument.\nchoices\nA list of strings that specifies all possible option values. Used\nwhen an option only has a limited set of values (for example,\n['small’, 'medium', 'large']).\nconst\nThe constant value that’s stored with the 'store_const'\naction.\ndefault\nSets the default value of the option if not supplied. By default,\nthe default value is None.\ndest\nSets the name of the attribute used to store option values dur-\ning parsing. Normally the name is derived from the option name\nitself.\nhelp\nHelp text for this particular option. If this is not supplied, the\noption will be listed in help without a description. The value\noptparse.SUPPRESS_HELP can be used to hide an option. The\nspecial keyword '%default’ is replaced by the option default\nvalue in the help string.\nmetavar\nSpecifies the name of an option argument that’s used when\nprinting help text.\nnargs\nSpecifies the number of option arguments for actions that\nexpect arguments. The default value is 1. If a number greater\nthan 1 is used, option arguments will be collected into a tuple\nthat is then used whenever arguments are handled.\ntype\nSpecifies the type of an option. Valid types are 'string' (the\ndefault), 'int', 'long’, 'choice’, 'float’, and 'complex’.\np.disable_interspersed_args()\nDisallows the mixing of simple options with positional arguments. For example, if '-x’\nand '-y' are options that take no parameters, the options must appear before any argu-\nments (for example, 'prog -x -y arg1 arg2 arg3').\np.enable_interspersed_args()\nAllows the mixing of options with positional arguments. For example, if '-x’ and '-y'\nare simple options that take no parameters, they may be mixed with the arguments,\nsuch as in 'prog -x arg1 arg2 -y arg3'.This is the default behavior.\np.parse_args([arglist])\nParses command-line options and returns a tuple (options, args) where options is\nan object containing the values of all the options and args is a list of all the remaining\npositional arguments left over.The options object stores all the option data in attrib-\nutes with names that match the option name. For example, the option '--output'\nwould have its value stored in options.output. If the option does not appear, the\nvalue will be None.The name of the attribute can be set using the dest keyword argu-\nment to add_option(), described previously. By default, arguments are taken from\nsys.argv[1:]. However, a different source of arguments can be supplied as an optional\nargument, arglist.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2766,
      "extraction_method": "Direct"
    },
    {
      "page_number": 402,
      "chapter": null,
      "content": "377\noptparse\np.set_defaults(dest=value, ... dest=value)\nSets the default values of particular option destinations.You simply supply keyword\narguments that specify the destinations you wish to set.The name of the keyword argu-\nments should match the names specified using the dest parameter in add_option(),\ndescribed earlier.\np.set_usage(usage)\nChanges the usage string displayed in text produced by the --help option.\nExample\n# foo.py\nimport optparse\np = optparse.OptionParser()\n# A simple option, with no arguments\np.add_option(\"-t\", action=\"store_true\", dest=\"tracing\")\n# An option that accepts a string argument\np.add_option(\"-o\", \"--outfile\", action=\"store\", type=\"string\", dest=\"outfile\")\n# An option requires an integer argument\np.add_option(\"-d\", \"--debuglevel\", action=\"store\", type=\"int\", dest=\"debug\")\n# An option with a few choices\np.add_option(\"--speed\", action=\"store\", type=\"choice\", dest=\"speed\",\nchoices=[\"slow\",\"fast\",\"ludicrous\"])\n# An option taking multiple arguments\np.add_option(\"--coord\", action=\"store\", type=\"int\", dest=\"coord\", nargs=2)\n# A set of options that control a common destination\np.add_option(\"--novice\", action=\"store_const\", const=\"novice\", dest=\"mode\")\np.add_option(\"--guru\", action=\"store_const\", const=\"guru\", dest=\"mode\")\n# Set default values for the various option destinations\np.set_defaults(tracing=False,\ndebug=0,\nspeed=\"fast\",\ncoord=(0,0),\nmode=\"novice\")\n# Parse the arguments\nopt, args = p.parse_args()\n# Print option values\nprint \"tracing   :\", opt.tracing\nprint \"outfile   :\", opt.outfile\nprint \"debug     :\", opt.debug\nprint \"speed     :\", opt.speed\nprint \"coord     :\", opt.coord\nprint \"mode      :\", opt.mode\n# Print remaining arguments\nprint \"args      :\", args\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1738,
      "extraction_method": "Direct"
    },
    {
      "page_number": 403,
      "chapter": null,
      "content": "378\nChapter 19 Operating System Services\nHere is a short interactive UNIX session that shows how the previous code works:\n% python foo.py -h\nusage: foo.py [options]\noptions:\n-h, --help            show this help message and exit\n-t\n-o OUTFILE, --outfile=OUTFILE\n-d DEBUG, --debuglevel=DEBUG\n--speed=SPEED\n--coord=COORD\n--novice\n--guru\n% python foo.py -t -o outfile.dat -d 3 --coord 3 4 --speed=ludicrous blah\ntracing   : True\noutfile   : outfile.dat\ndebug     : 3\nspeed     : ludicrous\ncoord     : (3, 4)\nmode      : novice\nargs      : ['blah']\n% python foo.py --speed=insane\nusage: foo.py [options]\nfoo.py:error:option --speed:invalid choice:'insane' \n(choose from 'slow', 'fast', 'ludicrous')\nNotes\nn When specifying option names, use a single dash to specify a short name such as\n'-x' and a double-dash to specify a long name such as '--exclude'.An\nOptionError exception will be raised if you attempt to define an option that is a\nmix of the two styles, such as '-exclude'.\nn Python also includes a module getopt that provides support for command-line\nparsing in a style similar to a C library of the same name. For all practical purpos-\nes, there is no benefit to using that module over optparse (which is much high-\ner level and requires far less coding).\nn The optparse module contains a considerable number of advanced features\nrelated to customization and specialized handling of certain kinds of command-\nline options. However, none of these features are required for the most common\ntypes of command-line option parsing. Readers should consult the online library\ndocumentation for more details and additional examples.\nos\nThe os module provides a portable interface to common operating-system services. It\ndoes this by searching for an OS-dependent built-in module such as nt or posix and\nexporting the functions and data as found there. Unless otherwise noted, functions are\navailable on Windows and UNIX. UNIX systems include both Linux and Mac OS X.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1984,
      "extraction_method": "Direct"
    },
    {
      "page_number": 404,
      "chapter": null,
      "content": "379\nos\nThe following general-purpose variables are defined:\nenviron\nA mapping object representing the current environment variables. Changes to the map-\nping are reflected in the current environment. If the putenv() function is also available,\nthen changes are also reflected in subprocesses.\nlinesep\nThe string used to separate lines on the current platform. May be a single character\nsuch as '\\n' for POSIX or multiple characters such as '\\r\\n' for Windows.\nname\nThe name of the OS-dependent module imported: 'posix', 'nt', 'dos', 'mac',\n'ce', 'java', 'os2', or 'riscos'.\npath\nThe OS-dependent standard module for pathname operations.This module can also be\nloaded using import os.path.\nProcess Environment\nThe following functions are used to access and modify various parameters related to the\nenvironment in which a process runs. Process, group, process group, and session IDs are\nintegers unless otherwise noted.\nchdir(path)\nChanges the current working directory to path.\nchroot(path)\nChanges the root directory of the current process (UNIX).\nctermid()\nReturns a string with the filename of the control terminal for the process (UNIX).\nfchdir(fd)\nChanges the current working directory. fd is a file descriptor to an opened directory\n(UNIX).\ngetcwd()\nReturns a string with the current working directory.\ngetcwdu()\nReturns a Unicode string with the current working directory.\ngetegid()\nReturns the effective group ID (UNIX).\ngeteuid()\nReturns the effective user ID (UNIX).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1498,
      "extraction_method": "Direct"
    },
    {
      "page_number": 405,
      "chapter": null,
      "content": "380\nChapter 19 Operating System Services\ngetgid()\nReturns the real group ID of the process (UNIX).\ngetgroups()\nReturns a list of integer group IDs to which the process owner belongs (UNIX).\ngetlogin()\nReturns the user name associated with the effective user ID (UNIX).\ngetpgid(pid)\nReturns the process group ID of the process with process ID pid. If pid is 0, the\nprocess group of the calling process is returned (UNIX).\ngetpgrp()\nReturns the ID of the current process group. Process groups are typically used in con-\njunction with job control.The process group is not necessarily the same as the group\nID of the process (UNIX).\ngetpid()\nReturns the real process ID of the current process (UNIX and Windows).\ngetppid()\nReturns the process ID of the parent process (UNIX).\ngetsid(pid)\nReturns the process session identifier of process pid. If pid is 0, the identifier of the\ncurrent process is returned (UNIX).\ngetuid()\nReturns the real user ID of the current process (UNIX).\nputenv(varname, value)\nSets environment variable varname to value. Changes affect subprocesses started with\nos.system(), popen(), fork(), and execv().Assignments to items in os.environ\nautomatically call putenv(). However, calls to putenv() don’t update os.environ\n(UNIX and Windows).\nsetegid(egid)\nSets the effective group ID (UNIX).\nseteuid(euid)\nSets the effective user ID (UNIX).\nsetgid(gid)\nSets the group ID of the current process (UNIX).\nsetgroups(groups)\nSets the group access list of the current process. groups is a sequence of integers speci-\nfying group identifiers. Can only be called by root (UNIX).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1611,
      "extraction_method": "Direct"
    },
    {
      "page_number": 406,
      "chapter": null,
      "content": "381\nos\nsetpgrp()\nCreates a new process group by calling the system call setpgrp() or setpgrp(0, 0),\ndepending on which version is implemented (if any). Returns the ID of the new\nprocess group (UNIX).\nsetpgid(pid, pgrp)\nAssigns process pid to process group pgrp. If pid is equal to pgrp, the process becomes\na new process group leader. If pid is not equal to pgrp, the process joins an existing\ngroup. If pid is 0, the process ID of the calling process is used. If pgrp is 0, the process\nspecified by pid becomes a process group leader (UNIX).\nsetreuid(ruid,euid)\nSets the real and effective user ID of the calling process (UNIX).\nsetregid(rgid,egid)\nSets the real and effective group ID of the calling process (UNIX).\nsetsid()\nCreates a new session and returns the newly created session ID. Sessions are typically\nassociated with terminal devices and the job control of processes that are started within\nthem (UNIX).\nsetuid(uid)\nSets the real user ID of the current process.This function is privileged and often can be\nperformed only by processes running as root (UNIX).\nstrerror(code)\nReturns the error message corresponding to the integer error code (UNIX and\nWindows).The errno module defines symbolic names for these error codes.\numask(mask)\nSets the current numeric umask and returns the previous umask.The umask is used to\nclear permissions bits on files that are created by the process (UNIX and Windows).\nuname()\nReturns a tuple of strings (sysname, nodename, release, version, machine)\nidentifying the system type (UNIX).\nunsetenv(name)\nUnsets the environment variable name.\nFile Creation and File Descriptors\nThe following functions provide a low-level interface for manipulating files and pipes.\nIn these functions, files are manipulated in terms of an integer file descriptor, fd.The\nfile descriptor can be extracted from a file object by invoking its fileno() method.\nclose(fd)\nCloses the file descriptor fd previously returned by open() or pipe().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1984,
      "extraction_method": "Direct"
    },
    {
      "page_number": 407,
      "chapter": null,
      "content": "382\nChapter 19 Operating System Services\ncloserange(low, high)\nCloses all file descriptors fd in the range low <= fd < high. Errors are ignored.\ndup(fd)\nDuplicates file descriptor fd. Returns a new file descriptor that’s the lowest-numbered\nunused file descriptor for the process.The new and old file descriptors can be used\ninterchangeably. Furthermore, they share state, such as the current file pointer and locks\n(UNIX and Windows).\ndup2(oldfd, newfd)\nDuplicates file descriptor oldfd to newfd. If newfd already corresponds to a valid file\ndescriptor, it’s closed first (UNIX and Windows).\nfchmod(fd, mode)\nChanges the mode of the file associated with fd to mode. See the description of\nos.open() for a description of mode (UNIX).\nfchown(fd, uid, gid)\nChanges the owner and group ID of the file associated with fd to uid and gid. Use a\nvalid of -1 for uid or gid to keep the value unchanged (UNIX).\nfdatasync(fd)\nForces all cached data written to fd to be flushed to disk (UNIX).\nfdopen(fd [, mode [, bufsize]])\nCreates an open file object connected to file descriptor fd.The mode and bufsize\narguments have the same meaning as in the built-in open() function. mode should be a\nstring such as 'r', 'w', or 'a'. On Python 3, this function accepts any additional\nparameters that work with the built-in open() function such as specifications for the\nencoding and line ending. However, if portability with Python 2 is a concern, you\nshould only use the mode and bufsize arguments described here.\nfpathconf(fd, name)\nReturns configurable pathname variables associated with the open file with descriptor\nfd. name is a string that specifies the name of the value to retrieve.The values are usual-\nly taken from parameters contained in system header files such as <limits.h> and\n<unistd.h>. POSIX defines the following constants for name:\nConstant\nDescription\n\"PC_ASYNC_IO\"\nIndicates whether asynchronous I/O can be performed \non fd.\n\"PC_CHOWN_RESTRICTED\"\nIndicates whether the chown() function can be used. If\nfd refers to a directory, this applies to all files in the\ndirectory.\n\"PC_FILESIZEBITS\"\nMaximum size of a file.\n\"PC_LINK_MAX\"\nMaximum value of the file’s link count.\n\"PC_MAX_CANON\"\nMaximum length of a formatted input line. fd refers to a\nterminal.\n\"PC_MAX_INPUT\"\nMaximum length of an input line. fd refers to a terminal.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2349,
      "extraction_method": "Direct"
    },
    {
      "page_number": 408,
      "chapter": null,
      "content": "383\nos\nConstant\nDescription\n\"PC_NAME_MAX\"\nMaximum length of a filename in a directory.\n\"PC_NO_TRUNC\"\nIndicates whether an attempt to create a file with a name\nlonger than PC_NAME_MAX for a directory will fail with an\nENAMETOOLONG error.\n\"PC_PATH_MAX\"\nMaximum length of a relative path name when the direc-\ntory fd is the current working directory.\n\"PC_PIPE_BUF\"\nSize of the pipe buffer when fd refers to a pipe or FIFO.\n\"PC_PRIO_IO\"\nIndicates whether priority I/O can be performed on fd.\n\"PC_SYNC_IO\"\nIndicates whether synchronous I/O can be performed \non fd.\n\"PC_VDISABLE\"\nIndicates whether fd allows special-character processing\nto be disabled. fd must refer to a terminal.\nNot all names are available on all platforms, and some systems may define additional\nconfiguration parameters. However, a list of the names known to the operating system\ncan be found in the dictionary os.pathconf_names. If a known configuration name is\nnot included in os.pathconf_names, its integer value can also be passed as name. Even\nif a name is recognized by Python, this function may still raise an OSError if the host\noperating system doesn’t recognize the parameter or associate it with the file fd.This\nfunction is only available on some versions of UNIX.\nfstat(fd)\nReturns the status for file descriptor fd. Returns the same values as the os.stat()\nfunction (UNIX and Windows).\nfstatvfs(fd)\nReturns information about the file system containing the file associated with file\ndescriptor fd. Returns the same values as the os.statvfs() function (UNIX).\nfsync(fd)\nForces any unwritten data on fd to be written to disk. Note that if you are using an\nobject with buffered I/O (for example, a Python file object), you should first flush the\ndata before calling fsync().Available on UNIX and Windows.\nftruncate(fd, length)\nTruncates the file corresponding to file descriptor fd so that it’s at most length bytes\nin size (UNIX).\nisatty(fd)\nReturns True if fd is associated with a TTY-like device such as a terminal (UNIX).\nlseek(fd, pos, how)\nSets the current position of file descriptor fd to position pos.Values of how are as fol-\nlows: SEEK_SET sets the position relative to the beginning of the file, SEEK_CUR sets it\nrelative to the current position, and SEEK_END sets it relative to the end of the file. In\nolder Python code, it is common to see these constants replaced with their numeric\nvalues of 0, 1, or 2, respectively.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2433,
      "extraction_method": "Direct"
    },
    {
      "page_number": 409,
      "chapter": null,
      "content": "384\nChapter 19 Operating System Services\nopen(file [, flags [, mode]])\nOpens the file file. flags is the bitwise OR of the following constant values:\nValue\nDescription\nO_RDONLY\nOpen the file for reading.\nO_WRONLY\nOpen the file for writing.\nO_RDWR\nOpen for reading and writing (updates).\nO_APPEND\nAppend bytes to the end of the file.\nO_CREAT\nCreate the file if it doesn’t exist.\nO_NONBLOCK\nDon’t block on open, read, or write (UNIX).\nO_NDELAY\nSame as O_NONBLOCK (UNIX).\nO_DSYNC\nSynchronous writes (UNIX).\nO_NOCTTY\nWhen opening a device, don’t set controlling terminal (UNIX).\nO_TRUNC\nIf the file exists, truncates to zero length.\nO_RSYNC\nSynchronous reads (UNIX).\nO_SYNC\nSynchronous writes (UNIX).\nO_EXCL\nError if O_CREAT and the file already exists.\nO_EXLOCK\nSet an exclusive lock on the file. \nO_SHLOCK\nSet a shared lock on the file.\nO_ASYNC\nEnables asynchronous input mode in which a SIGIO signal is gen-\nerated with input is available.\nO_DIRECT\nUse direct I/O mode where reads and writes go directly to the disk\ninstead of the operating system read/write caches.\nO_DIRECTORY\nRaises an error if the file is not a directory.\nO_NOFOLLOW\nDon’t follow symbolic links.\nO_NOATIME\nDon’t update the last access time of the file.\nO_TEXT\nText mode (Windows).\nO_BINARY\nBinary mode (Windows).\nO_NOINHERIT\nFile not inherited by child processes (Windows).\nO_SHORT_LIVED\nHint to system that the file is used for short-term storage\n(Windows).\nO_TEMPORARY\nDelete file when closed (Windows).\nO_RANDOM\nHint to system that file will be used for random access (Windows).\nO_SEQUENTIAL\nHint to system that file will be accessed sequentially (Windows).\nSynchronous I/O modes (O_SYNC, O_DSYNC, O_RSYNC) force I/O operations to block\nuntil they’ve been completed at the hardware level (for example, a write will block until\nthe bytes have been physically written to disk).The mode parameter contains the file\npermissions represented as the bitwise OR of the following octal values (which are\ndefined as constants in the stat module as indicated):\nMode\nMeaning\n0100\nUser has execute permission (stat.S_IXUSR).\n0200\nUser has write permission (stat.S_IWUSR).\n0400\nUser has read permission (stat.S_IRUSR).\n0700\nUser has read/write/exec permission (stat.S_IRWXU).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2257,
      "extraction_method": "Direct"
    },
    {
      "page_number": 410,
      "chapter": null,
      "content": "385\nos\nMode\nMeaning\n0010\nGroup has execute permission (stat.S_IXGRP).\n0020\nGroup has write permission (stat.S_IWGRP).\n0040\nGroup has read permission (stat.S_IRGRP).\n0070\nGroup has read/write/exec permission (stat.S_IRWXG).\n0001\nOthers have execute permission (stat.S_IXOTH).\n0002\nOthers have write permission (stat.S_IWOTH).\n0004\nOthers have read permission (stat.S_IROTH).\n0007\nOthers have read/write/exec permission (stat.S_IRWXO).\n4000\nSet UID mode (stat.S_ISUID).\n2000\nSet GID mode (stat.S_ISGID).\n1000\nSet the sticky bit (stat.S_ISVTX).\nThe default mode of a file is (0777 & ˜umask), where the umask setting is used to\nremove selected permissions. For example, a umask of 0022 removes the write permis-\nsion for groups and others.The umask can be changed using the os.umask() function.\nThe umask setting has no effect on Windows.\nopenpty()\nOpens a psuedo-terminal and returns a pair of file descriptors (master,slave) for the\nPTY and TTY.Available on some versions of UNIX.\npipe()\nCreates a pipe that can be used to establish unidirectional communication with another\nprocess. Returns a pair of file descriptors (r, w) usable for reading and writing, respec-\ntively.This function is usually called prior to executing a fork() function.After the\nfork(), the sending process closes the read end of the pipe and the receiving process\ncloses the write end of the pipe.At this point, the pipe is activated and data can be sent\nfrom one process to another using read() and write() functions (UNIX).\nread(fd, n)\nReads at most n bytes from file descriptor fd. Returns a byte string containing the\nbytes read.\ntcgetpgrp(fd)\nReturns the process group associated with the control terminal given by fd (UNIX).\ntcsetpgrp(fd, pg)\nSets the process group associated with the control terminal given by fd (UNIX).\nttyname(fd)\nReturns a string that specifies the terminal device associated with file descriptor fd. If\nfd is not associated with a terminal device, an OSError exception is raised (UNIX).\nwrite(fd, str)\nWrites the byte string str to file descriptor fd. Returns the number of bytes actually\nwritten.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2121,
      "extraction_method": "Direct"
    },
    {
      "page_number": 411,
      "chapter": null,
      "content": "386\nChapter 19 Operating System Services\nFiles and Directories\nThe following functions and variables are used to manipulate files and directories on\nthe file system.To handle variances in filenaming schemes, the following variables con-\ntain information about the construction of path names:\nVariable\nDescription\naltsep\nAn alternative character used by the OS to separate pathname compo-\nnents, or None if only one separator character exists. This is set to '/' on\nDOS and Windows systems, where sep is a backslash.\ncurdir\nThe string used to refer to the current working directory: '.' for UNIX and\nWindows and ':' for the Macintosh.\ndevnull\nThe path of the null device (for example, /dev/null).\nextsep\nCharacter that separates the base filename from its type (for example, the\n'.' in 'foo.txt').\npardir\nThe string used to refer to the parent directory: '..' for UNIX and\nWindows and '::' for the Macintosh.\npathsep\nThe character used to separate search path components (as contained in\nthe $PATH environment variable): ':' for UNIX and ';' for DOS and\nWindows.\nsep\nThe character used to separate pathname components: '/' for UNIX and\nWindows and ':' for the Macintosh.\nThe following functions are used to manipulate files:\naccess(path, accessmode)\nChecks read/write/execute permissions for this process to access the file \npath. accessmode is R_OK, W_OK, X_OK, or F_OK for read, write, execute, or existence,\nrespectively. Returns 1 if access is granted, 0 if not.\nchflags(path, flags)\nChanges the file flags on path. flags is the bitwise-or of the constants listed next.\nFlags starting with UF_ can be set by any user, whereas SF_ flags can only be changed\nby the superuser (UNIX).\nFlag\nMeaning\nstat.UF_NODUMP\nDo not dump the file.\nstat.UF_IMMUTABLE\nThe file is read-only.\nstat.UF_APPEND\nThe file only supports append operations.\nstat.UF_OPAQUE\nThe directory is opaque.\nstat.UF_NOUNLINK\nThe file may not be deleted or renamed.\nstat.SF_ARCHIVED\nThe file can be archived.\nstat.SF_IMMUTABLE\nThe file is read-only.\nstat.SF_APPEND\nThe file only supports append operations.\nstat.SF_NOUNLINK\nThe file may not be deleted or renamed.\nstat.SF_SNAPSHOT\nThe file is a snapshot file.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2195,
      "extraction_method": "Direct"
    },
    {
      "page_number": 412,
      "chapter": null,
      "content": "387\nos\nchmod(path, mode)\nChanges the mode of path. mode has the same values as described for the open()\nfunction (UNIX and Windows).\nchown(path, uid, gid)\nChanges the owner and group ID of path to the numeric uid and gid. Setting uid or\ngid to -1 causes that parameter to remain unmodified (UNIX).\nlchflags(path, flags)\nThe same as chflags(), but doesn’t follow symbolic links (UNIX).\nlchmod(path, mode)\nThe same as chmod() except that if path is a symbolic link, it modifies the link itself,\nnot the file the link refers to.\nlchown(path, uid, gid)\nThe same as chown() but doesn’t follow symbolic links (UNIX).\nlink(src, dst)\nCreates a hard link named dst that points to src (UNIX).\nlistdir(path)\nReturns a list containing the names of the entries in the directory path.The list is\nreturned in arbitrary order and doesn’t include the special entries of '.' and '..'. If\npath is Unicode, the resulting list will only contain Unicode strings. Be aware that if\nany filenames in the directory can’t be properly encoded into Unicode, they are silently\nskipped. If path is given as a byte string, then all filenames are returned as a list of byte\nstrings.\nlstat(path)\nLike stat() but doesn’t follow symbolic links (UNIX).\nmakedev(major, minor)\nCreates a raw device number given major and minor device numbers (UNIX).\nmajor(devicenum)\nReturns the major device number from a raw device number devicenum created by\nmakedev().\nminor(devicenum)\nReturns the minor device number from a raw device number devicenum created by\nmakedev().\nmakedirs(path [, mode])\nRecursive directory-creation function. Like mkdir() but makes all the intermediate-\nlevel directories needed to contain the leaf directory. Raises an OSError exception if\nthe leaf directory already exists or cannot be created.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1796,
      "extraction_method": "Direct"
    },
    {
      "page_number": 413,
      "chapter": null,
      "content": "388\nChapter 19 Operating System Services\nmkdir(path [, mode])\nCreates a directory named path with numeric mode mode.The default mode is 0777.\nOn non-UNIX systems, the mode setting may have no effect or be ignored.\nmkfifo(path [, mode])\nCreates a FIFO (a named pipe) named path with numeric mode mode.The default\nmode is 0666 (UNIX).\nmknod(path [, mode, device])\nCreates a device-special file. path is the name of the file, mode specifies the permissions\nand type of file, and device is the raw device number created using os.makedev().\nThe mode parameter accepts the same parameters as open() when setting the file’s\naccess permissions. In addition, the flags stat.S_IFREG, stat.S_IFCHR,\nstat.S_IFBLK, and stat.S_IFIFO are added to mode to indicate a file type (UNIX).\npathconf(path, name)\nReturns configurable system parameters related to the path name path. name is a \nstring that specifies the name of the parameter and is the same as described for the\nfpathconf() function (UNIX).\nreadlink(path)\nReturns a string representing the path to which a symbolic link, path, points (UNIX).\nremove(path)\nRemoves the file path.This is identical to the unlink() function.\nremovedirs(path)\nRecursive directory-removal function.Works like rmdir() except that, if the leaf direc-\ntory is successfully removed, directories corresponding to the rightmost path segments\nwill be pruned away until either the whole path is consumed or an error is raised\n(which is ignored because it generally means that a parent directory isn’t empty). Raises\nan OSError exception if the leaf directory could not be removed successfully.\nrename(src, dst)\nRenames the file or directory src to dst.\nrenames(old, new)\nRecursive directory-renaming or file-renaming function.Works like rename() except it\nfirst attempts to create any intermediate directories needed to make the new path name.\nAfter the rename, directories corresponding to the rightmost path segments of the old\nname will be pruned away using removedirs().\nrmdir(path)\nRemoves the directory path.\nstat(path)\nPerforms a stat() system call on the given path to extract information about a file.\nThe return value is an object whose attributes contain file information. Common\nattributes include:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2246,
      "extraction_method": "Direct"
    },
    {
      "page_number": 414,
      "chapter": null,
      "content": "389\nos\nAttribute\nDescription\nst_mode\nInode protection mode\nst_ino\nInode number\nst_dev\nDevice the inode resides on\nst_nlink\nNumber of links to the inode\nst_uid\nUser ID of the owner\nst_gid\nGroup ID of the owner\nst_size\nFile size in bytes\nst_atime\nTime of last access\nst_mtime\nTime of last modification\nst_ctime\nTime of last status change\nHowever, additional attributes may be available depending on the system.The object\nreturned by stat() also looks like a 10-tuple containing the parameters (st_mode,\nst_ino, st_dev, st_nlink, st_uid, st_gid, st_size, st_atime,\nst_mtime, st_ctime).This latter form is provided for backward compatibility.The\nstat module defines constants that are used to extract fields from this tuple.\nstat_float_times([newvalue])\nReturns True if the times returned by stat() are floating-point numbers instead of\nintegers.The behavior can be changed by supplying a Boolean value for newvalue.\nstatvfs(path)\nPerforms a statvfs() system call on the given path to get information about the file\nsystem.The return value is an object whose attributes describe the file system. Common\nattributes include:\nAttribute\nDescription\nf_bsize\nPreferred system block size\nf_frsize\nFundamental file system block size\nf_blocks\nTotal number of blocks in the file system\nf_bfree\nTotal number of free blocks\nf_bavail\nFree blocks available to a non-superuser\nf_files\nTotal number of file inodes\nf_ffree\nTotal number of free file inodes\nf_favail\nFree nodes available to a non-superuser\nf_flag\nFlags (system-dependent)\nf_namemax\nMaximum filename length\nThe returned object also behaves like a tuple containing these attributes in the order\nlisted.The standard module statvfs defines constants that can be used to extract infor-\nmation from the returned statvfs data (UNIX).\nsymlink(src, dst)\nCreates a symbolic link named dst that points to src.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1865,
      "extraction_method": "Direct"
    },
    {
      "page_number": 415,
      "chapter": null,
      "content": "390\nChapter 19 Operating System Services\nunlink(path)\nRemoves the file path. Same as remove().\nutime(path, (atime, mtime))\nSets the access and modified time of the file to the given values. (The second argument\nis a tuple of two items.) The time arguments are specified in terms of the numbers\nreturned by the time.time() function.\nwalk(top [, topdown [, onerror [,followlinks]]])\nCreates a generator object that walks through a directory tree. top specifies the top of\nthe directory, and topdown is a Boolean that indicates whether to traverse directories in\na top-down (the default) or bottom-up order.The returned generator produces tuples\n(dirpath, dirnames, filenames) where dirpath is a string containing the path to\nthe directory, dirnames is a list of all subdirectories in dirpath, and filenames is a\nlist of the files in dirpath, not including directories.The onerror parameter is a func-\ntion accepting a single argument. If any errors occur during processing, this function\nwill be called with an instance of os.error.The default behavior is to ignore errors. If\na directory is walked in a top-down manner, modifications to dirnames will affect the\nwalking process. For example, if directories are removed from dirnames, those directo-\nries will be skipped. By default, symbolic links are not followed unless the fol-\nlowlinks argument is set to True.\nProcess Management\nThe following functions and variables are used to create, destroy, and manage processes:\nabort()\nGenerates a SIGABRT signal that’s sent to the calling process. Unless the signal is caught\nwith a signal handler, the default is for the process to terminate with an error.\ndefpath\nThis variable contains the default search path used by the exec*p*() functions if the\nenvironment doesn’t have a 'PATH' variable.\nexecl(path, arg0, arg1, ...)\nEquivalent to execv(path, (arg0, arg1, ...)).\nexecle(path, arg0, arg1, ..., env)\nEquivalent to execve(path, (arg0, arg1, ...), env).\nexeclp(path, arg0, arg1, ...)\nEquivalent to execvp(path, (arg0, arg1, ...)).\nexecv(path, args)\nExecutes the program path with the argument list args, replacing the current process\n(that is, the Python interpreter).The argument list may be a tuple or list of strings.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2242,
      "extraction_method": "Direct"
    },
    {
      "page_number": 416,
      "chapter": null,
      "content": "391\nos\nexecve(path, args, env)\nExecutes a new program like execv() but additionally accepts a dictionary, env, that\ndefines the environment in which the program runs. env must be a dictionary mapping\nstrings to strings.\nexecvp(path, args)\nLike execv(path, args) but duplicates the shell’s actions in searching for an exe-\ncutable file in a list of directories.The directory list is obtained from\nenviron['PATH'].\nexecvpe(path, args, env)\nLike execvp() but with an additional environment variable as in the execve() func-\ntion.\n_exit(n)\nExits immediately to the system with status n, without performing any cleanup actions.\nThis is typically only done in child processes created by fork().This is also different\nthan calling sys.exit(), which performs a graceful shutdown of the interpreter.The\nexit code n is application-dependent, but a value of 0 usually indicates success, whereas\na nonzero value indicates an error of some kind. Depending on the system, a number of\nstandard exit code values may be defined:\nValue\nDescription\nEX_OK\nNo errors.\nEX_USAGE\nIncorrect command usage.\nEX_DATAERR\nIncorrect input data.\nEX_NOINPUT\nMissing input.\nEX_NOUSER\nUser doesn’t exist.\nEX_NOHOST\nHost doesn’t exist.\nEX_NOTFOUND\nNot found.\nEX_UNAVAILABLE\nService unavailable.\nEX_SOFTWARE\nInternal software error.\nEX_OSERR\nOperating system error.\nEX_OSFILE\nFile system error.\nEX_CANTCREAT\nCan’t create output.\nEX_IOERR\nI/O error.\nEX_TEMPFAIL\nTemporary failure.\nEX_PROTOCOL\nProtocol error.\nEX_NOPERM\nInsufficient permissions.\nEX_CONFIG\nConfiguration error.\nfork()\nCreates a child process. Returns 0 in the newly created child process and the child’s\nprocess ID in the original process.The child process is a clone of the original process\nand shares many resources such as open files (UNIX).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1794,
      "extraction_method": "Direct"
    },
    {
      "page_number": 417,
      "chapter": null,
      "content": "392\nChapter 19 Operating System Services\nforkpty()\nCreates a child process using a new pseudo-terminal as the child’s controlling terminal.\nReturns a pair (pid, fd), in which pid is 0 in the child and fd is a file descriptor of\nthe master end of the pseudo-terminal.This function is available only in certain versions\nof UNIX.\nkill(pid, sig)\nSends the process pid the signal sig.A list of signal names can be found in the signal\nmodule (UNIX).\nkillpg(pgid, sig)\nSends the process group pgid the signal sig. A list of signal names can be found in the\nsignal module (UNIX).\nnice(increment)\nAdds an increment to the scheduling priority (the “niceness”) of the process. Returns\nthe new niceness.Typically, users can only decrease the priority of a process because\nincreasing the priority requires root access.The effect of changing the priority is \nsystem-dependent, but decreasing the priority is commonly done to make a process run\nin the background in a way such that it doesn’t noticeably impact the performance of\nother processes (UNIX).\nplock(op)\nLocks program segments into memory, preventing them from being swapped.The value\nof op is an integer that determines which segments are locked.The value of op is\nplatform-specific but is typically one of UNLOCK, PROCLOCK, TXTLOCK, or DATLOCK.\nThese constants are not defined by Python but might be found in the <sys/lock.h>\nheader file.This function is not available on all platforms and often can be performed\nonly by a process with an effective user ID of 0 (root) (UNIX).\npopen(command [, mode [, bufsize]])\nOpens a pipe to or from a command.The return value is an open file object connected\nto the pipe, which can be read or written depending on whether mode is 'r' (the\ndefault) or 'w'. bufsize has the same meaning as in the built-in open() function.The\nexit status of the command is returned by the close() method of the returned file\nobject, except that when the exit status is zero, None is returned.\nspawnv(mode, path, args)\nExecutes the program path in a new process, passing the arguments specified in args as\ncommand-line parameters. args can be a list or a tuple.The first element of args\nshould be the name of the program. mode is one of the following constants:\nConstant\nDescription\nP_WAIT\nExecutes the program and waits for it to terminate. Returns the pro-\ngram’s exit code.\nP_NOWAIT\nExecutes the program and returns the process handle.\nP_NOWAITO\nSame as P_NOWAIT.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2454,
      "extraction_method": "Direct"
    },
    {
      "page_number": 418,
      "chapter": null,
      "content": "393\nos\nConstant\nDescription\nP_OVERLAY\nExecutes the program and destroys the calling process (same as the\nexec functions).\nP_DETACH\nExecutes the program and detaches from it. The calling program contin-\nues to run but cannot wait for the spawned process.\nspawnv() is available on Windows and some versions of UNIX.\nspawnve(mode, path, args, env)\nExecutes the program path in a new process, passing the arguments specified in args as\ncommand-line parameters and the contents of the mapping env as the environment.\nargs can be a list or a tuple. mode has the same meaning as described for spawnv().\nspawnl(mode, path, arg1, ..., argn)\nThe same as spawnv() except that all the arguments are supplied as extra parameters.\nspawnle(mode, path, arg1, ... , argn, env)\nThe same as spawnve() except that the arguments are supplied as parameters.The last\nparameter is a mapping containing the environment variables.\nspawnlp(mode, file, arg1, ... , argn)\nThe same as spawnl() but looks for file using the settings of the PATH environment\nvariable (UNIX).\nspawnlpe(mode, file, arg1, ... , argn, env)\nThe same as spawnle() but looks for file using the settings of the PATH environment\nvariable (UNIX).\nspawnvp(mode, file, args)\nThe same as spawnv() but looks for file using the settings of the PATH environment\nvariable (UNIX).\nspawnvpe(mode, file, args, env)\nThe same as spawnve() but looks for file using the settings of the PATH environment\nvariable (UNIX).\nstartfile(path [, operation])\nLaunches the application associated with the file path.This performs the same action as\nwould occur if you double-clicked the file in Windows Explorer.The function returns\nas soon as the application is launched. Furthermore, there is no way to wait for comple-\ntion or to obtain exit codes from the application. path is a relative to the current direc-\ntory. operation is an optional string that specifies the action to perform when opening\npath. By default, it is set to 'open’, but it may be set to 'print', 'edit', 'explore',\nor 'find' (the exact list depends on the type of path (Windows)).\nsystem(command)\nExecutes command (a string) in a subshell. On UNIX, the return value is the exit status\nof the process as returned by wait(). On Windows, the exit code is always 0.The \nsubprocess module provides considerably more power and is the preferred way to\nlaunch subprocesses.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2379,
      "extraction_method": "Direct"
    },
    {
      "page_number": 419,
      "chapter": null,
      "content": "394\nChapter 19 Operating System Services\ntimes()\nReturns a 5-tuple of floating-point numbers indicating accumulated times in seconds.\nOn UNIX, the tuple contains the user time, system time, children’s user time, children’s\nsystem time, and elapsed real time in that order. On Windows, the tuple contains the\nuser time, system time, and zeros for the other three values.\nwait([pid])\nWaits for completion of a child process and returns a tuple containing its process ID\nand exit status.The exit status is a 16-bit number whose low byte is the signal number\nthat killed the process and whose high byte is the exit status (if the signal number is\nzero).The high bit of the low byte is set if a core file was produced. pid, if given, speci-\nfies the process to wait for. If it’s omitted, wait() returns when any child process exits\n(UNIX).\nwaitpid(pid, options)\nWaits for a change in the state of a child process given by process ID pid and returns a\ntuple containing its process ID and exit status indication, encoded as for wait().\noptions should be 0 for normal operation or WNOHANG to avoid hanging if no child\nprocess status is available immediately.This function can also be used to gather informa-\ntion about child processes that have only stopped executing for some reason. Setting\noptions to WCONTINUED gathers information from a child when it resumes operation\nafter being stopped via job control. Setting options to WUNTRACED gathers information\nfrom a child that has been stopped, but from which no status information has been\nreported yet.\nwait3([options])\nThe same as waitpid() except that the function waits for a change in any child\nprocess. Returns a 3-tuple (pid, status, rusage), where pid is the child process\nID, status is the exit status code, and rusage contains resource usage information as\nreturned by resource.getrusage().The options parameter has the same meaning as\nfor waitpid().\nwait4(pid, options)\nThe same as waitpid() except that the return result is the same tuple as returned by\nwait3().\nThe following functions take a process status code as returned by waitpid(),\nwait3(), or wait4() and are used to examine the state of the process (UNIX).\nWCOREDUMP(status)\nReturns True if the process dumped core.\nWIFEXITED(status)\nReturns True if the process exited using the exit() system call.\nWEXITSTATUS(status)\nIf WIFEXITED(status) is true, the integer parameter to the exit() system call is\nreturned. Otherwise, the return value is meaningless.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2492,
      "extraction_method": "Direct"
    },
    {
      "page_number": 420,
      "chapter": null,
      "content": "395\nos\nWIFCONTINUED(status)\nReturns True if the process has resumed from a job-control stop.\nWIFSIGNALED(status)\nReturns True if the process exited due to a signal.\nWIFSTOPPED(status)\nReturns True if the process has been stopped.\nWSTOPSIG(status)\nReturns the signal that caused the process to stop.\nWTERMSIG(status)\nReturns the signal that caused the process to exit.\nSystem Configuration\nThe following functions are used to obtain system configuration information:\nconfstr(name)\nReturns a string-valued system configuration variable. name is a string specifying the\nname of the variable.The acceptable names are platform-specific, but a dictionary of\nknown names for the host system is found in os.confstr_names. If a configuration\nvalue for a specified name is not defined, the empty string is returned. If name is\nunknown, ValueError is raised.An OSError may also be raised if the host system\ndoesn’t support the configuration name.The parameters returned by this function most-\nly pertain to the build environment on the host machine and include paths of system\nutilities, compiler options for various program configurations (for example, 32-bit, 64-\nbit, and large-file support), and linker options (UNIX).\ngetloadavg()\nReturns a 3-tuple containing the average number of items in the system run-queue\nover the last 1, 5, and 15 minutes (UNIX).\nsysconf(name)\nReturns an integer-valued system-configuration variable. name is a string specifying the\nname of the variable.The names defined on the host system can be found in the dic-\ntionary os.sysconf_names. Returns -1 if the configuration name is known but the\nvalue is not defined. Otherwise, a ValueError or OSError may be raised. Some sys-\ntems may define more than 100 different system parameters. However, the following list\ndetails the parameters defined by POSIX.1 that should be available on most UNIX \nsystems:\nParameter\nDescription\n\"SC_ARG_MAX\"\nMaximum length of the arguments that can be used with exec().\n\"SC_CHILD_MAX\"\nMaximum number of processes per user ID.\n\"SC_CLK_TCK\"\nNumber of clock ticks per second.\n\"SC_NGROUPS_MAX\" Maximum number of simultaneous supplementary group IDs.\n\"SC_STREAM_MAX\"\nMaximum number of streams a process can open at one time.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2243,
      "extraction_method": "Direct"
    },
    {
      "page_number": 421,
      "chapter": null,
      "content": "396\nChapter 19 Operating System Services\nParameter\nDescription\n\"SC_TZNAME_MAX\"\nMaximum number of bytes in a time zone name.\n\"SC_OPEN_MAX\"\nMaximum number of files a process can open at one time.\n\"SC_JOB_CONTROL\" System supports job control.\n\"SC_SAVED_IDS\"\nIndicates whether each process has a saved set-user-ID and a\nsaved set-group-ID.\nurandom(n)\nReturns a string containing n random bytes generated by the system (for example,\n/dev/urandom on UNIX).The returned bytes are suitable for cryptography.\nExceptions\nThe os module defines a single exception to indicate errors.\nerror\nException raised when a function returns a system-related error.This is the same as the\nbuilt-in exception OSError.The exception carries two values: errno and strerr.The\nfirst contains the integer error value as described for the errno module.The latter con-\ntains a string error message. For exceptions involving the file system, the exception also\ncontains a third attribute, filename, which is the filename passed to the function.\nos.path\nThe os.path module is used to manipulate pathnames in a portable manner. It’s\nimported by the os module.\nabspath(path)\nReturns an absolute version of the path name path, taking the current working direc-\ntory into account. For example, abspath('../Python/foo') might return\n'/home/beazley/Python/foo'.\nbasename(path)\nReturns the base name of path name path. For example, basename('/usr/local/\npython') returns 'python'.\ncommonprefix(list)\nReturns the longest string that’s a prefix of all strings in list. If list is empty, the\nempty string is returned.\ndirname(path)\nReturns the directory name of path name path. For example, dirname('/usr/local/\npython') returns '/usr/local'.\nexists(path)\nReturns True if path refers to an existing path. Returns False if path refers to a bro-\nken symbolic link.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1841,
      "extraction_method": "Direct"
    },
    {
      "page_number": 422,
      "chapter": null,
      "content": "397\nos.path\nexpanduser(path)\nReplaces path names of the form '~user' with a user’s home directory. If the expan-\nsion fails or path does not begin with '~', the path is returned unmodified.\nexpandvars(path)\nExpands environment variables of the form '$name' or '${name}' in path.\nMalformed or nonexistent variable names are left unchanged.\ngetatime(path)\nReturns the time of last access as the number of seconds since the epoch (see the time\nmodule).The return value may be a floating-point number if\nos.stat_float_times() returns True.\ngetctime(path)\nReturns the time of last modification on UNIX and the time of creation on Windows.\nThe time is returned as the number of seconds since the epoch (see the time module).\nThe return value may be a floating-point number in certain cases (see getatime()).\ngetmtime(path)\nReturns the time of last modification as the number of seconds since the epoch (see the\ntime module).The return value may be a floating-point number in certain cases (see\ngetatime()).\ngetsize(path)\nReturns the file size in bytes.\nisabs(path)\nReturns True if path is an absolute path name (begins with a slash).\nisfile(path)\nReturns True if path is a regular file.This function follows symbolic links, so both\nislink() and isfile() can be true for the same path.\nisdir(path)\nReturns True if path is a directory. Follows symbolic links.\nislink(path)\nReturns True if path refers to a symbolic link. Returns False if symbolic links are\nunsupported.\nismount(path)\nReturns True if path is a mount point.\njoin(path1 [, path2 [, ...]])\nIntelligently joins one or more path components into a pathname. For example,\njoin('home', 'beazley', 'Python') returns 'home/beazley/Python'.\nlexists(path)\nReturns True if path exists. Returns True for all symbolic links, even if the link is bro-\nken.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1820,
      "extraction_method": "Direct"
    },
    {
      "page_number": 423,
      "chapter": null,
      "content": "398\nChapter 19 Operating System Services\nnormcase(path)\nNormalizes the case of a path name. On non-case-sensitive file systems, this converts\npath to lowercase. On Windows, forward slashes are also converted to backslashes.\nnormpath(path)\nNormalizes a path name.This collapses redundant separators and up-level references so\nthat 'A//B', 'A/./B', and 'A/foo/../B' all become 'A/B'. On Windows, forward\nslashes are converted to backslashes.\nrealpath(path)\nReturns the real path of path, eliminating symbolic links if any (UNIX).\nrelpath(path [, start])\nReturns a relative path to path from the current working directory. start can be sup-\nplied to specify a different starting directory.\nsamefile(path1, path2)\nReturns True if path1 and path2 refer to the same file or directory (UNIX).\nsameopenfile(fp1, fp2)\nReturns True if the open file objects fp1 and fp2 refer to the same file (UNIX).\nsamestat(stat1, stat2)\nReturns True if the stat tuples stat1 and stat2 as returned by fstat(), lstat(), or\nstat() refer to the same file (UNIX).\nsplit(path)\nSplits path into a pair (head, tail), where tail is the last pathname component and\nhead is everything leading up to that. For example, '/home/user/foo' gets split into\n('/home/ user', 'foo').This tuple is the same as would be returned by\n(dirname(), basename()).\nsplitdrive(path)\nSplits path into a pair (drive, filename) where drive is either a drive specification\nor the empty string. drive is always the empty string on machines without drive speci-\nfications.\nsplitext(path)\nSplits a path name into a base filename and suffix. For example, splitext('foo.txt')\nreturns ('foo', '.txt').\nsplitunc(path)\nSplits a path name into a pair (unc,rest) where unc is a UNC (Universal Naming\nConvention) mount point and rest the remainder of the path (Windows).\nsupports_unicode_filenames\nVariable set to True if the file system allows Unicode filenames.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1916,
      "extraction_method": "Direct"
    },
    {
      "page_number": 424,
      "chapter": null,
      "content": "399\nsignal\nNote\nOn Windows, some care is required when working with filenames that include a drive let-\nter (for example, 'C:spam.txt'). In most cases, filenames are interpreted as being\nrelative to the current working directory. For example, if the current directory is\n'C:\\Foo\\', then the file 'C:spam.txt' is interpreted as the file\n'C:\\Foo\\C:spam.txt', not the file 'C:\\spam.txt'.\nSee Also:\nfnmatch (p. 316), glob (p. 317), os (p. 378).\nsignal\nThe signal module is used to write signal handlers in Python. Signals usually corre-\nspond to asynchronous events that are sent to a program due to the expiration of a\ntimer, arrival of incoming data, or some action performed by a user.The signal interface\nemulates that of UNIX, although parts of the module are supported on other platforms.\nalarm(time)\nIf time is nonzero, a SIGALRM signal is scheduled to be sent to the program in time\nseconds.Any previously scheduled alarm is canceled. If time is zero, no alarm is sched-\nuled and any previously set alarm is canceled. Returns the number of seconds remain-\ning before any previously scheduled alarm or zero if no alarm was scheduled (UNIX).\ngetsignal(signalnum)\nReturns the signal handler for signal signalnum.The returned object is a callable\nPython object.The function may also return SIG_IGN for an ignored signal, SIG_DFL\nfor the default signal handler, or None if the signal handler was not installed from the\nPython interpreter.\ngetitimer(which)\nReturns the current value of an internal timer identified by which.\npause()\nGoes to sleep until the next signal is received (UNIX).\nset_wakeup_fd(fd)\nSets a file descriptor fd on which a '\\0' byte will be written when a signal is received.\nThis, in turn, can be used to handle signals in programs that are polling file descriptors\nusing functions such as those found in the select module.The file described by fd\nmust be opened in non-blocking mode for this to work.\nsetitimer(which, seconds [, interval])\nSets an internal timer to generate a signal after seconds seconds and repeatedly there-\nafter every interval seconds. Both of these parameters are specified as floating-point\nnumbers.The which parameter is one of ITIMER_REAL, ITIMER_VIRTUAL, or\nITIMER_PROF.The choice of which determines what signal is generated after the timer\nhas expired. SIGALRM is generated for ITIMER_REAL, SIGVTALRM is generated for\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2390,
      "extraction_method": "Direct"
    },
    {
      "page_number": 425,
      "chapter": null,
      "content": "400\nChapter 19 Operating System Services\nITIMER_VIRTUAL, and SIGPROF is generated for ITIMER_PROF. Set seconds to 0 to\nclear a timer. Returns a tuple (seconds, interval) with the previous settings of the\ntimer.\nsiginterrupt(signalnum, flag)\nSets the system call restart behavior for a given signal number. If flag is False, system\ncalls interrupted by signal signalnum will be automatically restarted. If set True, the\nsystem call will be interrupted.An interrupted system call will typically result in an\nOSError or IOError exception where the associated error number is set to\nerrno.EINTR or errno.EAGAIN.\nsignal(signalnum, handler)\nSets a signal handler for signal signalnum to the function handler. handler must be a\ncallable Python object taking two arguments: the signal number and frame object.\nSIG_IGN or SIG_DFL can also be given to ignore a signal or use the default signal han-\ndler, respectively.The return value is the previous signal handler, SIG_IGN, or SIG_DFL.\nWhen threads are enabled, this function can only be called from the main thread.\nOtherwise, a ValueError exception is raised.\nIndividual signals are identified using symbolic constants of the form SIG*.These\nnames correspond to integer values that are machine-specific.Typical values are as \nfollows:\nSignal Name\nDescription\nSIGABRT\nAbnormal termination\nSIGALRM\nAlarm\nSIGBUS\nBus error\nSIGCHLD\nChange in child status\nSIGCLD\nChange in child status\nSIGCONT\nContinue\nSIGFPE\nFloating-point error\nSIGHUP\nHang up\nSIGILL\nIllegal instruction\nSIGINT\nTerminal interrupt character\nSIGIO\nAsynchronous I/O\nSIGIOT\nHardware fault\nSIGKILL\nTerminate\nSIGPIPE\nWrite to pipe, no readers\nSIGPOLL\nPollable event\nSIGPROF\nProfiling alarm\nSIGPWR\nPower failure\nSIGQUIT\nTerminal quit character\nSIGSEGV\nSegmentation fault\nSIGSTOP\nStop\nSIGTERM\nTermination\nSIGTRAP\nHardware fault\nSIGTSTP\nTerminal stop character\nSIGTTIN\nControl TTY\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1901,
      "extraction_method": "Direct"
    },
    {
      "page_number": 426,
      "chapter": null,
      "content": "401\nsignal\nSignal Name\nDescription\nSIGTTOU\nControl TTY\nSIGURG\nUrgent condition\nSIGUSR1\nUser defined\nSIGUSR2\nUser defined\nSIGVTALRM\nVirtual time alarm\nSIGWINCH\nWindow size change\nSIGXCPU\nCPU limit exceeded\nSIGXFSZ\nFile size limit exceeded\nIn addition, the module defines the following variables:\nVariable\nDescription\nSIG_DFL\nSignal handler that invokes the default signal handler\nSIG_IGN\nSignal handler that ignores a signal\nNSIG\nOne more than the highest signal number\nExample\nThe following example illustrates a timeout on establishing a network connection (the\nsocket module already provides a timeout option so this example is merely meant to\nillustrate the basic concept of using the signal module).\nimport signal, socket\ndef handler(signum, frame):\nprint 'Timeout!'\nraise IOError, 'Host not responding.'\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsignal.signal(signal.SIGALRM, handler)\nsignal.alarm(5)                     # 5-second alarm\nsock.connect('www.python.org', 80)  # Connect\nsignal.alarm(0)                     # Clear alarm\nNotes\nn Signal handlers remain installed until explicitly reset, with the exception of\nSIGCHLD (whose behavior is implementation-specific).\nn It’s not possible to temporarily disable signals.\nn Signals are only handled between the atomic instructions of the Python inter-\npreter.The delivery of a signal can be delayed by long-running calculations writ-\nten in C (as might be performed in an extension module).\nn If a signal occurs during an I/O operation, the I/O operation may fail with an\nexception. In this case, the errno value is set to errno.EINTR to indicate an\ninterrupted system call.\nn Certain signals such as SIGSEGV cannot be handled from Python.\nn Python installs a small number of signal handlers by default. SIGPIPE is ignored,\nSIGINT is translated into a KeyboardInterrupt exception, and SIGTERM is\ncaught in order to perform cleanup and invoke sys.exitfunc.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1952,
      "extraction_method": "Direct"
    },
    {
      "page_number": 427,
      "chapter": null,
      "content": "402\nChapter 19 Operating System Services\nn Extreme care is needed if signals and threads are used in the same program.\nCurrently, only the main thread of execution can set new signal handlers or\nreceive signals.\nn Signal handling on Windows is of only limited functionality.The number of sup-\nported signals is extremely limited on this platform.\nsubprocess\nThe subprocess module contains functions and objects that generalize the task of cre-\nating new processes, controlling input and output streams, and handling return codes.\nThe module centralizes functionality contained in a variety of other modules such as\nos, popen2, and commands.\nPopen(args, **parms)\nExecutes a new command as a subprocess and returns a Popen object representing the\nnew process.The command is specified in args as either a string, such as 'ls -l', or\nas a list of strings, such as ['ls', '-l']. parms represents a collection of keyword\narguments that can be set to control various properties of the subprocess.The following\nkeyword parameters are understood:\nKeyword\nDescription\nbufsize\nSpecifies the buffering behavior, where 0 is unbuffered, 1 is\nline-buffered, a negative value uses the system default, and\nother positive values specify the approximate buffer size. The\ndefault value is 0.\nclose_fds\nIf True, all file descriptors except 0, 1, and 2 are closed prior\nto execution of the child process. The default value is False.\ncreation_flags\nSpecifies process-creation flags on Windows. The only flag\ncurrently available is CREATE_NEW_CONSOLE. The default\nvalue is 0.\ncwd\nThe directory in which the command will execute. The current\ndirectory of the child process is changed to cwd prior to exe-\ncution. The default value is None, which uses the current\ndirectory of the parent process.\nenv\nDictionary of environment variables for the new process. The\ndefault value is None, which uses the environment variables\nof the parent process.\nexecutable\nSpecifies the name of the executable program to use. This is\nrarely needed because the program name is already included\nin args. If shell has been given, this parameter specifies\nthe name of the shell to use. The default value is None.\npreexec_fn\nSpecifies a function that will be called in the child process\njust before the command is executed. The function should\ntake no arguments.\nshell\nIf True, the command is executed using the UNIX shell like\nthe os.system() function. The default shell is /bin/sh, but\nthis can be changed by also setting executable. The default\nvalue of shell is None.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2546,
      "extraction_method": "Direct"
    },
    {
      "page_number": 428,
      "chapter": null,
      "content": "403\nsubprocess\nKeyword\nDescription\nstartupinfo\nProvides startup flags used when creating processes on\nWindows. The default value is None. Possible values include\nSTARTF_USESHOWWINDOW and STARTF_USESTDHANDLERS.\nstderr\nFile object representing the file to use for stderr in the child\nprocess. May be a file object created via open(), an integer\nfile descriptor, or the special value PIPE, which indicates that\na new pipe should be created. The default value is None.\nstdin\nFile object representing the file to use for stdin in the child\nprocess. May be set to the same values as stderr. The\ndefault value is None.\nstdout\nFile object representing the file to use for stdout in the child\nprocess. May be set to the same values as stderr. The\ndefault value is None.\nuniversal_newlines\nIf True, the files representing stdin, stdout, and stderr\nare opened in text mode with universal newline mode\nenabled. See the open() function for a full description.\ncall(args, **parms)\nThis function is exactly the same as Popen(), except that it simply executes the com-\nmand and returns its status code instead (that is, it does not return a Popen object).This\nfunction is useful if you just want to execute a command but are not concerned with\ncapturing its output or controlling it in other ways.The parameters have the same\nmeaning as with Popen().\ncheck_call(args, **parms)\nThe same as call() except that if the exit code is non-zero, the CalledProcessError\nexception is raised.This exception has the exit code stored in its returncode attribute.\nThe Popen object p returned by Popen() has a variety of methods and attributes\nthat can be used for interacting with the subprocess.\np.communicate([input])\nCommunicates with the child process by sending the data supplied in input to the\nstandard input of the process. Once data is sent, the method waits for the process to ter-\nminate while collecting output received on standard output and standard error. Returns\na tuple (stdout, stderr) where stdout and stderr are strings. If no data is sent to\nthe child process, input is set to None (the default).\np.kill()\nKills the subprocess by sending it a SIGKILL signal on UNIX or calling the \np.terminate() method on Windows.\np.poll()\nChecks to see if p has terminated. If so, the return code of the subprocess is returned.\nOtherwise, None is returned.\np.send_signal(signal)\nSends a signal to the subprocess. signal is a signal number as defined in the signal\nmodule. On Windows, the only supported signal is SIGTERM.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2520,
      "extraction_method": "Direct"
    },
    {
      "page_number": 429,
      "chapter": null,
      "content": "404\nChapter 19 Operating System Services\np.terminate()\nTerminates the subprocess by sending it a SIGTERM signal on UNIX or calling the\nWin32 API TerminateProcess function on Windows.\np.wait()\nWaits for p to terminate and returns the return code.\np.pid\nProcess ID of the child process.\np.returncode\nNumeric return code of the process. If None, the process has not terminated yet. If neg-\native, it indicates the process was terminated by a signal (UNIX).\np.stdin, p.stdout, p.stderr\nThese three attributes are set to open file objects whenever the corresponding I/O\nstream is opened as a pipe (for example, setting the stdout argument in Popen() to\nPIPE).These file objects are provided so that the pipe can be connected to other sub-\nprocesses.These attributes are set to None if pipes are not in use.\nExamples\n# Execute a basic system command.  Like os.system()\nret = subprocess.call(\"ls -l\", shell=True)\n# Silently execute a basic system command\nret = subprocess.call(\"rm –f *.java\",shell=True,\nstdout=open(\"/dev/null\"))\n# Execute a system command, but capture the output\np = subprocess.Popen(\"ls -l\", shell=True, stdout=subprocess.PIPE)\nout = p.stdout.read()\n# Execute a command, but send input and receive output\np = subprocess.Popen(\"wc\", shell=True, stdin=subprocess.PIPE,\nstdout=subprocess.PIPE, stderr=subprocess.PIPE)\nout, err = p.communicate(s)    #  Send string s to the process\n# Create two subprocesses and link them together via a pipe\np1 = subprocess.Popen(\"ls -l\", shell=True, stdout=subprocess.PIPE)\np2 = subprocess.Popen(\"wc\",shell=True, stdin=p1.stdout,\nstdout=subprocess.PIPE)\nout = p2.stdout.read()\nNotes\nn As a general rule, it is better to supply the command line as a list of \nstrings instead of a single string with a shell command (for example,\n['wc','filename'] instead of 'wc filename'). On many systems, it is com-\nmon for filenames to include funny characters and spaces (for example, the\n“Documents and Settings” folder on Windows). If you stick to supplying com-\nmand arguments as a list, everything will work normally. If you try to form a\nshell command, you will have to take additional steps to make sure special charac-\nters and spaces are properly escaped.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2216,
      "extraction_method": "Direct"
    },
    {
      "page_number": 430,
      "chapter": null,
      "content": "405\ntime\nn On Windows, pipes are opened in binary file mode.Thus, if you are reading text\noutput from a subprocess, line endings will include the extra carriage return \ncharacter ('\\r\\n' instead of '\\n'). If this is a concern, supply the\nuniversal_newlines option to Popen().\nn The subprocess module can not be used to control processes that expect to be\nrunning in a terminal or TTY.The most common example is any program that\nexpects a user to enter a password (such as ssh, ftp, svn, and so on).To control\nthese programs, look for third-party modules based on the popular “Expect”\nUNIX utility.\ntime\nThe time module provides various time-related functions. In Python, time is measured\nas the number of seconds since the epoch.The epoch is the beginning of time (the point\nat which time = 0 seconds).The epoch is January 1, 1970, on UNIX and can be deter-\nmined by calling time.gmtime(0) on other systems.\nThe following variables are defined:\naccept2dyear\nA Boolean value that indicates whether two-digit years are accepted. Normally this is\nTrue, but it’s set to False if the environment variable $PYTHONY2K is set to a non-\nempty string.The value can be changed manually as well.\naltzone\nThe time zone used during daylight saving time (DST), if applicable.\ndaylight\nIs set to a nonzero value if a DST time zone has been defined.\ntimezone\nThe local (non-DST) time zone.\ntzname\nA tuple containing the name of the local time zone and the name of the local daylight\nsaving time zone (if defined).\nThe following functions can be used:\nasctime([tuple])\nConverts a tuple representing a time as returned by gmtime() or localtime() to a\nstring of the form 'Mon Jul 12 14:45:23 1999'. If no arguments are supplied, the\ncurrent time is used.\nclock()\nReturns the current CPU time in seconds as a floating-point number.\nctime([secs])\nConverts a time expressed in seconds since the epoch to a string representing local\ntime. ctime(secs) is the same as asctime(localtime(secs)). If secs is omitted or\nNone, the current time is used.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2044,
      "extraction_method": "Direct"
    },
    {
      "page_number": 431,
      "chapter": null,
      "content": "406\nChapter 19 Operating System Services\ngmtime([secs])\nConverts a time expressed in seconds since the epoch to a time in UTC Coordinated\nUniversal Time (a.k.a. Greenwich Mean Time).This function returns a struct_time\nobject with the following attributes:\nAttribute\nValue\ntm_year\nA four-digit value such as 1998\ntm_mon\n1-12\ntm_mday\n1-31\ntm_hour\n0-23\ntm_min\n0-59\ntm_sec\n0-61\ntm_wday\n0-6 (0=Monday)\ntm_yday\n1-366\ntm_isdst\n-1, 0, 1\nThe tm_isdst attribute is 1 if DST is in effect, 0 if not, and -1 if no information is\navailable. If secs is omitted or None, the current time is used. For backward compatibil-\nity, the returned struct_time object also behaves like a 9-tuple containing the preced-\ning attribute values in the same order as listed.\nlocaltime([secs])\nReturns a struct_time object as with gmtime(), but corresponding to the local time\nzone. If secs is omitted or None, the current time is used.\nmktime(tuple)\nThis function takes a struct_time object or tuple representing a time in the local time\nzone (in the same format as returned by localtime()) and returns a floating-point\nnumber representing the number of seconds since the epoch.An OverflowError\nexception is raised if the input value is not a valid time.\nsleep(secs)\nPuts the current process to sleep for secs seconds. secs is a floating-point number.\nstrftime(format [, tm])\nConverts a struct_time object tm representing a time as returned by gmtime() or\nlocaltime() to a string (for backwards compatibility, tm may also be a tuple represent-\ning a time value). format is a format string in which the following format codes can be\nembedded:\nDirective\nMeaning\n%a\nLocale’s abbreviated weekday name\n%A\nLocale’s full weekday name\n%b\nLocale’s abbreviated month name\n%B\nLocale’s full month name\n%c\nLocale’s appropriate date and time representation\n%d\nDay of the month as a decimal number [01-31]\n%H\nHour (24-hour clock) as a decimal number [00-23]\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1934,
      "extraction_method": "Direct"
    },
    {
      "page_number": 432,
      "chapter": null,
      "content": "407\ntime\nDirective\nMeaning\n%I\nHour (12-hour clock) as a decimal number [01-12]\n%j\nDay of the year as a decimal number [001-366]\n%m\nMonth as a decimal number [01-12]\n%M\nMinute as a decimal number [00-59]\n%p\nLocale’s equivalent of either AM or PM\n%S\nSeconds as a decimal number [00-61]\n%U\nWeek number of the year [00-53] (Sunday as first day)\n%w\nWeekday as a decimal number [0-6] (0 = Sunday)\n%W\nWeek number of the year (Monday as first day)\n%x\nLocale’s appropriate date representation\n%X\nLocale’s appropriate time representation\n%y\nYear without century as a decimal number [00-99]\n%Y\nYear with century as a decimal number\n%Z\nTime zone name (or by no characters if no time zone exists)\n%%\nThe % character\nThe format codes can include a width and precision in the same manner as used with\nthe % operator on strings. ValueError is raised if any of the tuple fields are out of\nrange. If tuple is omitted, the time tuple corresponding to the current time is used.\nstrptime(string [, format])\nParses a string representing a time and returns a struct_time object as returned by\nlocaltime() or gmtime().The format parameter uses the same specifiers as used by\nstrftime() and defaults to '%a %b %d %H:%M:%S %Y'.This is the same format as\nproduced by the ctime() function. If the string cannot be parsed, a ValueError\nexception is raised.\ntime()\nReturns the current time as the number of seconds since the epoch in UTC\n(Coordinated Universal Time).\ntzset()\nResets the time zone setting based on the value of the TZ environment variable on\nUNIX. For example:\nos.environ['TZ'] = 'US/Mountain'\ntime.tzset()\nos.environ['TZ'] = \"CST+06CDT,M4.1.0,M10.5.0\"\ntime.tzset()\nNotes\nn When two-digit years are accepted, they’re converted to four-digit years accord-\ning to the POSIX X/Open standard, where the values 69-99 are mapped to\n1969-1999 and the values 0-68 are mapped to 2000-2068.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1889,
      "extraction_method": "Direct"
    },
    {
      "page_number": 433,
      "chapter": null,
      "content": "408\nChapter 19 Operating System Services\nn The accuracy of the time functions is often much less than what might be sug-\ngested by the units in which time is represented. For example, the operating sys-\ntem might only update the time 50–100 times a second.\nSee Also:\ndatetime (p. 336)\nwinreg\nThe winreg module (_winreg in Python 2) provides a low-level interface to the\nWindows registry.The registry is a large hierarchical tree in which each node is called a\nkey.The children of a particular key are known as subkeys and may contain additional\nsubkeys or values. For example, the setting of the Python sys.path variable is typically\ncontained in the registry as follows:\n\\HKEY_LOCAL_MACHINE\\Software\\Python\\PythonCore\\2.6\\PythonPath\nIn this case, Software is a subkey of HKEY_LOCAL_MACHINE, Python is a subkey of\nSoftware, and so forth.The value of the PythonPath key contains the actual path set-\nting.\nKeys are accessed through open and close operations. Open keys are represented by\nspecial handles (which are wrappers around the integer handle identifiers normally used\nby Windows).\nCloseKey(key)\nCloses a previously opened registry key with handle key.\nConnectRegistry(computer_name, key)\nReturns a handle to a predefined registry key on another computer. computer_name is\nthe name of the remote machine as a string of the \\\\computername. If\ncomputer_name is None, the local registry is used. key is a predefined handle such as\nHKEY_CURRENT_USER or HKEY_ USERS. Raises EnvironmentError on failure.The fol-\nlowing list shows all HKEY_* values defined in the _winreg module:\nn HKEY_CLASSES_ROOT\nn HKEY_CURRENT_CONFIG\nn HKEY_CURRENT_USER\nn HKEY_DYN_DATA\nn HKEY_LOCAL_MACHINE\nn HKEY_PERFORMANCE_DATA\nn HKEY_USERS\nCreateKey(key, sub_key)\nCreates or opens a key and returns a handle. key is a previously opened key or a prede-\nfined key defined by the HKEY_* constants. sub_key is the name of the key that will be\nopened or created. If key is a predefined key, sub_key may be None, in which case key\nis returned.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2035,
      "extraction_method": "Direct"
    },
    {
      "page_number": 434,
      "chapter": null,
      "content": "409\nwinreg\nDeleteKey(key, sub_key)\nDeletes sub_key. key is an open key or one of the predefined HKEY_* constants.\nsub_key is a string that identifies the key to delete. sub_key must not have any sub-\nkeys; otherwise, EnvironmentError is raised.\nDeleteValue(key, value)\nDeletes a named value from a registry key. key is an open key or one of the predefined\nHKEY_* constants. value is a string containing the name of the value to remove.\nEnumKey(key, index)\nReturns the name of a subkey by index. key is an open key or one of the predefined\nHKEY_* constants. index is an integer that specifies the key to retrieve. If index is out\nof range, an EnvironmentError is raised.\nEnumValue(key, index)\nReturns a value of an open key. key is an open key or a predefined HKEY_* constant.\nindex is an integer specifying the value to retrieve.The function returns a tuple\n(name, data, type) in which name is the value name, data is an object holding the\nvalue data, and type is an integer that specifies the type of the value data.The following\ntype codes are currently defined:\nCode\nDescription\nREG_BINARY\nBinary data\nREG_DWORD\n32-bit number\nREG_DWORD_LITTLE_ENDIAN\n32-bit little-endian number\nREG_DWORD_BIG_ENDIAN\n32-bit number in big-endian format\nREG_EXPAND_SZ\nNull-terminated string with unexpanded references\nto environment variables\nREG_LINK\nUnicode symbolic link\nREG_MULTI_SZ\nSequence of null-terminated strings\nREG_NONE\nNo defined value type\nREG_RESOURCE_LIST\nDevice driver resource list\nREG_SZ\nNull-terminated string\nExpandEnvironmentStrings(s)\nExpands environment strings of the form %name% in Unicode string s.\nFlushKey(key)\nWrites the attributes of key to the registry, forcing changes to disk.This function\nshould only be called if an application requires absolute certainty that registry data is\nstored on disk. It does not return until data is written. It is not necessary to use this\nfunction under normal circumstances.\nRegLoadKey(key, sub_key, filename)\nCreates a subkey and stores registration information from a file into it. key is an open\nkey or a predefined HKEY_* constant. sub_key is a string identifying the subkey to load.\nfilename is the name of the file from which to load data.The contents of this file must\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2247,
      "extraction_method": "Direct"
    },
    {
      "page_number": 435,
      "chapter": null,
      "content": "410\nChapter 19 Operating System Services\nbe created with the SaveKey() function, and the calling process must have SE_RESTORE_\nPRIVILEGE for this to work. If key was returned by ConnectRegistry(), filename\nshould be a path that’s relative to the remote computer.\nOpenKey(key, sub_key[, res [, sam]])\nOpens a key. key is an open key or an HKEY_* constant. sub_key is a string identifying\nthe subkey to open. res is a reserved integer that must be zero (the default). sam is an\ninteger defining the security access mask for the key.The default is KEY_READ. Here are\nthe other possible values for sam:\nn KEY_ALL_ACCESS\nn KEY_CREATE_LINK\nn KEY_CREATE_SUB_KEY\nn KEY_ENUMERATE_SUB_KEYS\nn KEY_EXECUTE\nn KEY_NOTIFY\nn KEY_QUERY_VALUE\nn KEY_READ\nn KEY_SET_VALUE\nn KEY_WRITE\nOpenKeyEx()\nSame as OpenKey().\nQueryInfoKey(key)\nReturns information about a key as a tuple (num_subkeys, num_values,\nlast_modified) in which num_subkeys is the number of subkeys, num_values is the\nnumber of values, and last_modified is a long integer containing the time of last\nmodification.Time is measured from January 1, 1601, in units of 100 nanoseconds.\nQueryValue(key,sub_key)\nReturns the unnamed value for a key as a string. key is an open key or an HKEY_* con-\nstant. sub_key is the name of the subkey to use, if any. If omitted, the function returns\nthe value associated with key instead.This function returns the data for the first value\nwith a null name. However, the type is returned (use QueryValueEx instead).\nQueryValueEx(key, value_name)\nReturns a tuple (value, type) containing the data value and type for a key. key is an\nopen key or HKEY_* constant. value_name is the name of the value to return.The\nreturned type is one of the integer codes as described for the EnumValue() function.\nSaveKey(key, filename)\nSaves key and all its subkeys to a file. key is an open key or a predefined HKEY_* con-\nstant. filename must not already exist and should not include a filename extension.\nFurthermore, the caller must have backup privileges for the operation to succeed.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2069,
      "extraction_method": "Direct"
    },
    {
      "page_number": 436,
      "chapter": null,
      "content": "411\nwinreg\nSetValue(key, sub_key, type, value)\nSets the value of a key. key is an open key or HKEY_* constant. sub_key is the name of\nthe subkey with which to associate the value. type is an integer type code, currently\nlimited to REG_SZ. value is a string containing the value data. If sub_key does not\nexist, it is created. key must have been opened with KEY_SET_VALUE access for this\nfunction to succeed.\nSetValueEx(key, value_name, reserved, type, value)\nSets the value field of a key. key is an open key or an HKEY_* constant. value_name is\nthe name of the value. type is an integer type code as described for the EnumValue()\nfunction. value is a string containing the new value.When the values of numeric types\n(for example, REG_DWORD) are being set, value is still a string containing the raw data.\nThis string can be created using the struct module. reserved is currently ignored\nand can be set to anything (the value is not used).\nNotes\nn Functions that return a Windows HKEY object return a special registry handle\nobject described by the class PyHKEY.This object can be converted into a\nWindows handle value using int().This object can also be used with the \ncontext-management protocol to automatically close the underlying handle—for\nexample:\nwith winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, \"spam\") as key:\nstatements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1352,
      "extraction_method": "Direct"
    },
    {
      "page_number": 437,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 438,
      "chapter": null,
      "content": "20\nThreads and Concurrency\nThis chapter describes library modules and programming strategies for writing con-\ncurrent programs in Python.Topics include threads, message passing, multiprocessing,\nand coroutines. Before covering specific library modules, some basic concepts are first\ndescribed.\nBasic Concepts\nA running program is called a process. Each process has its own system state, which\nincludes memory, lists of open files, a program counter that keeps track of the instruc-\ntion being executed, and a call stack used to hold the local variables of functions.\nNormally, a process executes statements one after the other in a single sequence of con-\ntrol flow, which is sometimes called the main thread of the process.At any given time,\nthe program is only doing one thing.\nA program can create new processes using library functions such as those found in\nthe os or subprocess modules (e.g., os.fork(), subprocess.Popen(), etc.).\nHowever, these processes, known as subprocesses, run as completely independent \nentities—each with their own private system state and main thread of execution.\nBecause a subprocess is independent, it executes concurrently with the original process.\nThat is, the process that created the subprocess can go on to work on other things\nwhile the subprocess carries out its own work behind the scenes.\nAlthough processes are isolated, they can communicate with each other—something\nknown as interprocess communication (IPC). One of the most common forms of IPC is\nbased on message passing.A message is simply a buffer of raw bytes. Primitive operations\nsuch as send() and recv() are then used to transmit or receive messages through an\nI/O channel such as a pipe or network socket.Another somewhat less common IPC\nmechanism relies upon memory-mapped regions (see the mmap module).With memory\nmapping, processes can create shared regions of memory. Modifications to these regions\nare then visible in all processes that happen to be viewing them.\nMultiple processes can be used by an application if it wants to work on multiple\ntasks at the same time—with each process responsible for part of the processing.\nHowever, another approach for subdividing work into tasks is to use threads.A thread is\nsimilar to a process in that it has its own control flow and execution stack. However, a\nthread runs inside the process that created it, sharing all of the data and system\nresources.Threads are useful when an application wants to perform tasks concurrently,\nbut there is a potentially large amount of system state that needs to be shared by the\ntasks.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2600,
      "extraction_method": "Direct"
    },
    {
      "page_number": 439,
      "chapter": null,
      "content": "414\nChapter 20 Threads and Concurrency\nWhen multiple processes or threads are used, the host operating system is responsible\nfor scheduling their work.This is done by giving each process (or thread) a small time\nslice and rapidly cycling between all of the active tasks—giving each a portion of the\navailable CPU cycles. For example, if your system had 10 active processes running, the\noperating system would allocate approximately 1/10th of its CPU time to each process\nand cycle between processes in rapid succession. On systems with more than one CPU\ncore, the operating system can schedule processes so that each CPU is kept busy, exe-\ncuting processes in parallel.\nWriting programs that take advantage of concurrent execution is something that is\nintrinsically complicated.A major source of complexity concerns synchronization and\naccess to shared data. In particular, attempts to update a data structure by multiple tasks\nat approximately the same time can lead to a corrupted and inconsistent program state\n(a problem formally known as a race condition).To fix these problems, concurrent pro-\ngrams must identify critical sections of code and protect them using mutual-exclusion\nlocks and other similar synchronization primitives. For example, if different threads were\ntrying to write data to the same file at the same time, you might use a mutual exclusion\nlock to synchronize their operation so that once one of the threads starts writing, the\nother threads have to wait until it has finished before they are allowed to start writing.\nThe code for this scenario typically looks like this:\nwrite_lock = Lock()\n...\n# Critical section where writing occurs\nwrite_lock.acquire()\nf.write(\"Here's some data.\\n\")\nf.write(\"Here's more data.\\n\")\n...\nwrite_lock.release()\nThere’s a joke attributed to Jason Whittington that goes as like this:“Why did the mul-\ntithreaded chicken cross the road? to To other side. get the”.This joke typifies the kinds\nof problems that arise with task synchronization and concurrent programming. If you’re\nscratching your head saying,“I don’t get it,” then it might be wise to do a bit more\nreading before diving into the rest of this chapter.\nConcurrent Programming and Python\nPython supports both message passing and thread-based concurrent programming on\nmost systems.Although most programmers tend to be familiar with the thread interface,\nPython threads are actually rather restricted.Although minimally thread-safe, the Python\ninterpreter uses an internal global interpreter lock (the GIL) that only allows a single\nPython thread to execute at any given moment.This restricts Python programs to run\non a single processor regardless of how many CPU cores might be available on the sys-\ntem.Although the GIL is often a heated source of debate in the Python community, it\nis unlikely to be removed at any time in the foreseeable future.\nThe presence of the GIL has a direct impact on how many Python programmers\naddress concurrent programming problems. If an application is mostly I/O bound, it is\ngenerally fine to use threads because extra processors aren’t going to do much to help a\nprogram that spends most of its time waiting for events. For applications that involve\nheavy amounts of CPU processing, using threads to subdivide work doesn’t provide any\nbenefit and will make the program run slower (often much slower than you would\nguess). For this, you’ll want to rely on subprocesses and message passing.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3469,
      "extraction_method": "Direct"
    },
    {
      "page_number": 440,
      "chapter": null,
      "content": "415\nmultiprocessing\nEven when threads are used, many programmers find their scaling properties to be\nrather mysterious. For example, a threaded network server that works fine with 100\nthreads may have horrible performance if it’s scaled up to 10,000 threads.As a general\nrule, you really don’t want to be writing programs with 10,000 threads because each\nthread requires its own system resources and the overhead associated with thread con-\ntext switching, locking, and other matters starts to become significant (not to mention\nthe fact that all threads are constrained to run on a single CPU).To deal with this, it is\nsomewhat common to see such applications restructured as asynchronous event-\nhandling systems. For example, a central event loop might monitor all of the I/O\nsources using the select module and dispatch asynchronous events to a large collec-\ntion of I/O handlers.This is the basis for library modules such as asyncore as well as\npopular third-party modules such as Twisted (http://twistedmatrix/com).\nLooking forward, message passing is a concept that you should probably embrace for\nany kind of concurrent programming in Python. Even when working with threads, an\noften-recommended approach is to structure your application as a collection of inde-\npendent threads that exchange data through message queues.This particular approach\ntends to be less error-prone because it greatly reduces the need to use locks and other\nsynchronization primitives. Message passing also naturally extends into networking and\ndistributed systems. For example, if part of a program starts out as a thread to which you\nsend messages, that component can later be migrated to a separate process or onto a dif-\nferent machine by sending the messages over a network connection.The message pass-\ning abstraction is also tied to advanced Python features such as coroutines. For example,\na coroutine is a function that can receive and processe messages that are sent to it. So, by\nembracing message passing, you will find that you can write programs that have a great\ndeal of flexibility.\nThe remainder of this chapter looks at different library modules for supporting con-\ncurrent programming.At the end, more detailed information on common programming\nidioms is provided.\nmultiprocessing\nThe multiprocessing module provides support for launching tasks in a subprocess,\ncommunicating and sharing data, and performing various forms of synchronization.The\nprogramming interface is meant to mimic the programming interface for threads in the\nthreading module. However, unlike threads, it is important to emphasize that processes\ndo not have any shared state.Thus, if a process modifies data, that change is local only to\nthat process.\nThe features of the multiprocessing module are vast, making it one of the larger\nand most advanced built-in libraries. Covering every detail of the module is impossible\nhere, but the essential parts of it along with examples will be given. Experienced pro-\ngrammers should be able to take the examples and expand them to larger problems.\nProcesses\nAll of the features of the multiprocessing module are focused on processes.They are\ndescribed by the following class.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3214,
      "extraction_method": "Direct"
    },
    {
      "page_number": 441,
      "chapter": null,
      "content": "416\nChapter 20 Threads and Concurrency\nProcess([group [, target [, name [, args [, kwargs]]]]])\nA class that represents a task running in a subprocess.The arguments in the constructor\nshould always been specified using keyword arguments. target is a callable object that\nwill execute when the process starts, args is a tuple of positional arguments passed to\ntarget, and kwargs is a dictionary of keyword arguments passed to target. If args\nand kwargs are omitted, target is called with no arguments. name is a string that gives\na descriptive name to the process. group is unused and is always set to None. Its pres-\nence here is simply to make the construction of a Process mimic the creation of a\nthread in the threading module.\nAn instance p of Process has the following methods:\np.is_alive()\nReturns True if p is still running.\np.join([timeout])\nWaits for process p to terminate. timeout specifies an optional timeout period.A\nprocess can be joined as many times as you wish, but it is an error for a process to try\nand join itself.\np.run()\nThe method that runs when the process starts. By default, this invokes target that was\npassed to the Process constructor.As an alternative, a process can be defined by inher-\niting from Process and reimplementing run().\np.start()\nStarts the process.This launches the subprocess that represents the process and invokes\np.run() in that subprocess.\np.terminate()\nForcefully terminates the process. If this is invoked, the process p is terminated immedi-\nately without performing any kind of cleanup actions. If the process p created sub-\nprocesses of its own, those processes will turn into zombies. Some care is required when\nusing this method. If p holds a lock or is involved with interprocess communication,\nterminating it might cause a deadlock or corrupted I/O.\nA Process instance p also has the following data attributes:\np.authkey\nThe process’ authentication key. Unless explicitly set, this is a 32-character string gener-\nated by os.urandom().The purpose of this key is to provide security for low-level\ninterprocess communication involving network connections. Such connections only\nwork if both ends have the same authentication key.\np.daemon\nA Boolean flag that indicates whether or not the process is daemonic.A daemonic\nprocess is automatically terminated when the Python process that created it terminates.\nIn addition, a daemonic process is prohibited from creating new processes on its own.\nThe value of p.daemon must be set before a process is started using p.start().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2552,
      "extraction_method": "Direct"
    },
    {
      "page_number": 442,
      "chapter": null,
      "content": "417\nmultiprocessing\np.exitcode\nThe integer exit code of the process. If the process is still running, this is None. If the\nvalue is negative, a value of –N means the process was terminated by signal N.\np.name\nThe name of the process.\np.pid\nThe integer process ID of the process.\nHere is an example that shows how to create and launch a function (or other\ncallable) as a separate process:\nimport multiprocessing\nimport time\ndef clock(interval):\nwhile True:\nprint(\"The time is %s\" % time.ctime())\ntime.sleep(interval)\nif _ _name_ _ == '_ _main_ _':\np = multiprocessing.Process(target=clock, args=(15,))\np.start()\nHere is an example that shows how to define this process as a class that inherits from\nProcess:\nimport multiprocessing\nimport time\nclass ClockProcess(multiprocessing.Process):\ndef _ _init_ _(self,interval):\nmultiprocessing.Process._ _init__(self)\nself.interval = interval\ndef run(self):\nwhile True:\nprint(\"The time is %s\" % time.ctime())\ntime.sleep(self.interval)\nif _ _name_ _ == '_ _main_ _':\np = ClockProcess(15)\np.start()\nIn both examples, the time should be printed by the subprocess every 15 seconds. It is\nimportant to emphasize that for cross-platform portability, new processes should only be\ncreated by the main program as shown.Although this is optional on UNIX, it is\nrequired on Windows. It should also be noted that on Windows, you will probably need\nto run the preceding examples in the command shell (command.exe) instead of a\nPython IDE, such as IDLE.\nInterprocess Communication\nTwo primary forms of interprocess communication are supported by the \nmultiprocessing module: pipes and queues. Both methods are implemented using\nmessage passing. However, the queue interface is meant to mimic the use of queues\ncommonly used with thread programs.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1794,
      "extraction_method": "Direct"
    },
    {
      "page_number": 443,
      "chapter": null,
      "content": "418\nChapter 20 Threads and Concurrency\nQueue([maxsize])\nCreates a shared process queue. maxsize is the maximum number of items allowed in\nthe queue. If omitted, there is no size limit.The underlying queue is implemented using\npipes and locks. In addition, a support thread is launched in order to feed queued data\ninto the underlying pipe.\nAn instance q of Queue has the following methods:\nq.cancel_join_thread()\nDon’t automatically join the background thread on process exit.This prevents the\njoin_thread() method from blocking.\nq.close()\nCloses the queue, preventing any more data from being added to it.When this is called,\nthe background thread will continue to write any queued data not yet written but will\nshut down as soon as this is complete.This method is called automatically if q is\ngarbage-collected. Closing a queue does not generate any kind of end-of-data signal or\nexception in queue consumers. For example, if a consumer is blocking on a get()\noperation, closing the queue in the producer does not cause the get() to return with\nan error.\nq.empty()\nReturns True if q is empty at the time of the call. If other processes or threads are being\nused to add queue items, be aware that the result is not reliable (e.g., new items could\nhave been added to the queue in between the time that the result is returned and used).\nq.full()\nReturns True if q is full.The result is also not reliable due to threads (see q.empty()).\nq.get([block [, timeout]])\nReturns an item from q. If q is empty, blocks until a queue item becomes available.\nblock controls the blocking behavior and is True by default. If set to False, a\nQueue.Empty exception (defined in the Queue library module) is raised if the queue is\nempty. timeout is an optional timeout to use in blocking mode. If no items become\navailable in the specified time interval, a Queue.Empty exception is raised.\nq.get_nowait()\nThe same as q.get(False).\nq.join_thread()\nJoins the queue’s background thread.This is used to wait for all queue items to be con-\nsumed after q.close() has been called.This method gets called by default in all\nprocesses that are not the original creator of q.This behavior can be disabled by called\nq.cancel_join_thread().\nq.put(item [, block [, timeout]])\nPuts item onto the queue. If the queue is full, block until space becomes available.\nblock controls the blocking behavior and is True by default. If set to False, a\nQueue.Full exception (defined in the Queue library module) is raised if the queue is\nfull. timeout specifies how long to wait for space to become available in blocking\nmode.A Queue.Full exception is raised on timeout.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2648,
      "extraction_method": "Direct"
    },
    {
      "page_number": 444,
      "chapter": null,
      "content": "419\nmultiprocessing\nq.put_nowait(item)\nThe same as q.put(item, False).\nq.qsize()\nReturns the approximate number of items currently in the queue.The result of this\nfunction is not reliable because items may have been added or removed from the queue\nin between the time the result is returned and later used in a program. On some sys-\ntems, this method may raise an NotImplementedError.\nJoinableQueue([maxsize])\nCreates a joinable shared process queue.This is just like a Queue except that the queue\nallows a consumer of items to notify the producer that the items have been successfully\nbeen processed.The notification process is implemented using a shared semaphore and\ncondition variable.\nAn instance q of JoinableQueue has the same methods as Queue, but it has the fol-\nlowing additional methods:\nq.task_done()\nUsed by a consumer to signal that an enqueued item returned by q.get() has been\nprocessed.A ValueError exception is raised if this is called more times than have been\nremoved from the queue.\nq.join()\nUsed by a producer to block until all items placed in a queue have been processed.This\nblocks until q.task_done() is called for every item placed into the queue.\nThe following example shows how you set up a process that runs forever, consuming\nand processing items on a queue.The producer feeds items into the queue and waits for\nthem to be processed.\nimport multiprocessing\ndef consumer(input_q):\nwhile True:\nitem = input_q.get()\n# Process item\nprint(item)        # Replace with useful work\n# Signal task completion\ninput_q.task_done()\ndef producer(sequence, output_q):\nfor item in sequence:\n# Put the item on the queue\noutput_q.put(item)\n# Set up\nif _ _name_ _ == '_ _main_ _':\nq = multiprocessing.JoinableQueue()\n# Launch the consumer process\ncons_p = multiprocessing.Process(target=consumer,args=(q,))\ncons_p.daemon=True\ncons_p.start()\n# Produce items.  sequence represents a sequence of items to\n# be sent to the consumer.  In practice, this could be the output\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2002,
      "extraction_method": "Direct"
    },
    {
      "page_number": 445,
      "chapter": null,
      "content": "420\nChapter 20 Threads and Concurrency\n# of a generator or produced in some other manner.\nsequence = [1,2,3,4]\nproducer(sequence, q)\n# Wait for all items to be processed\nq.join()\nIn this example, the consumer process is set to daemonic because it runs forever and we\nwant it to terminate when the main program finishes (if you forget this, the program\nwill hang).A JoinableQueue is being used so that the producer actually knows when\nall of the items put in the queue have been successfully processed.The join() opera-\ntion ensures this; if you forget this step, the consumer will be terminated before it has\nhad time to complete all of its work.\nIf desired, multiple processes can put and get items from the same queue. For exam-\nple, if you wanted to have a pool of consumer processes, you could just write code like\nthis:\nif _ _name_ _ == '_ _main_ _':\nq = multiprocessing.JoinableQueue()\n# Launch some consumer processes\ncons_p1 = multiprocessing.Process(target=consumer,args=(q,))\ncons_p1.daemon=True\ncons_p1.start()\ncons_p2 = multiprocessing.Process(target=consumer,args=(q,))\ncons_p2.daemon=True\ncons_p2.start()\n# Produce items.  sequence represents a sequence of items to\n# be sent to the consumer.  In practice, this could be the output\n# of a generator or produced in some other manner.\nsequence = [1,2,3,4]\nproducer(sequence, q)\n# Wait for all items to be processed\nq.join()\nWhen writing code such as this, be aware that every item placed into the queue is pick-\nled and sent to the process over a pipe or socket connection.As a general rule, it is bet-\nter to send fewer large objects than many small objects.\nIn certain applications, a producer may want to signal consumers that no more items\nwill be produced and that they should shut down.To do this, you should write code\nthat uses a sentinel—a special value that indicates completion. Here is an example that\nillustrates this concept using None as a sentinel:\nimport multiprocessing\ndef consumer(input_q):\nwhile True:\nitem = input_q.get()\nif item is None:\nbreak\n# Process item\nprint(item)        # Replace with useful work\n# Shutdown\nprint(\"Consumer done\")\ndef producer(sequence, output_q):\nfor item in sequence:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2202,
      "extraction_method": "Direct"
    },
    {
      "page_number": 446,
      "chapter": null,
      "content": "421\nmultiprocessing\n# Put the item on the queue\noutput_q.put(item)\nif _ _name_ _ == '_ _main_ _':\nq = multiprocessing.Queue()\n# Launch the consumer process\ncons_p = multiprocessing.Process(target=consumer,args=(q,))\ncons_p.start()\n# Produce items\nsequence = [1,2,3,4]\nproducer(sequence, q)\n# Signal completion by putting the sentinel on the queue\nq.put(None)\n# Wait for the consumer process to shutdown\ncons_p.join()\nIf you are using sentinels as shown in this example, be aware that you will need to put a\nsentinel on the queue for every single consumer. For example, if there were three con-\nsumer processes consuming items on the queue, the producer needs to put three sen-\ntinels on the queue to get all of the consumers to shut down.\nAs an alternative to using queues, a pipe can be used to perform message passing\nbetween processes.\nPipe([duplex])\nCreates a pipe between processes and returns a tuple (conn1, conn2) where conn1\nand conn2 are Connection objects representing the ends of the pipe. By default, the\npipe is bidirectional. If duplex is set False, then conn1 can only be used for receiving\nand conn2 can only be used for sending. Pipe() must be called prior to creating and\nlaunching any Process objects that use the pipe.\nAn instance c of a Connection object returned by Pipe() has the following meth-\nods and attributes:\nc.close()\nCloses the connection. Called automatically if c is garbage collected.\nc.fileno()\nReturns the integer file descriptor used by the connection.\nc.poll([timeout])\nReturns True if data is available on the connection. timeout specifies the maximum\namount of time to wait. If omitted, the method returns immediately with a result. If\ntimeout is set to None, then the operation will wait indefinitely for data to arrive.\nc.recv()\nReceives an object sent by c.send(). Raises EOFError if the other end of the connec-\ntion has been closed and there is no more data.\nc.recv_bytes([maxlength])\nReceives a complete byte message sent by c.send_bytes(). maxlength specifies the\nmaximum number of bytes to receive. If an incoming message exceeds this, an IOError\nis raised and no further reads can be made on the connection. Raises EOFError if the\nother end of the connection has been closed and there is no more data.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2275,
      "extraction_method": "Direct"
    },
    {
      "page_number": 447,
      "chapter": null,
      "content": "422\nChapter 20 Threads and Concurrency\nc.recv_bytes_into(buffer [, offset])\nReceives a complete byte message and stores it in the object buffer, which supports\nthe writable buffer interface (e.g., a bytearray object or similar). offset specifies the\nbyte offset into the buffer where to place the message. Returns the number of bytes\nreceived. Raises BufferTooShort if the length of the message exceeds available buffer\nspace.\nc.send(obj)\nSends an object through the connection. obj is any object that is compatible with pickle.\nc.send_bytes(buffer [, offset [, size]])\nSends a buffer of byte data through the connection. buffer is any object that supports\nthe buffer interface, offset is the byte offset into the buffer, and size is the number of\nbytes to send.The resulting data is sent as a single message to be received using a single\ncall to c.recv_bytes().\nPipes can be used in a similar manner as queues. Here is an example that shows the\nprevious producer-consumer problem implemented using pipes:\nimport multiprocessing\n# Consume items on a pipe.\ndef consumer(pipe):\noutput_p, input_p = pipe\ninput_p.close()      # Close the input end of the pipe\nwhile True:\ntry:\nitem = output_p.recv()\nexcept EOFError:\nbreak\n# Process item\nprint(item)        # Replace with useful work\n# Shutdown\nprint(\"Consumer done\")\n# Produce items and put on a queue.  sequence is an\n# iterable representing items to be processed. \ndef producer(sequence, input_p):\nfor item in sequence:\n# Put the item on the queue\ninput_p.send(item)\nif _ _name_ _ == '_ _main_ _':\n(output_p, input_p) = multiprocessing.Pipe()\n# Launch the consumer process\ncons_p = multiprocessing.Process(target=consumer,args=((output_p, input_p),))\ncons_p.start()\n# Close the output pipe in the producer\noutput_p.close()\n# Produce items\nsequence = [1,2,3,4]\nproducer(sequence, input_p)\n# Signal completion by closing the input pipe\ninput_p.close()\n# Wait for the consumer process to shutdown\ncons_p.join()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1979,
      "extraction_method": "Direct"
    },
    {
      "page_number": 448,
      "chapter": null,
      "content": "423\nmultiprocessing\nGreat attention should be given to proper management of the pipe endpoints. If one of\nthe ends of the pipe is not used in either the producer or consumer, it should be closed.\nThis explains, for instance, why the output end of the pipe is closed in the producer and\nthe input end of the pipe is closed in the consumer. If you forget one of these steps, the\nprogram may hang on the recv() operation in the consumer. Pipes are reference\ncounted by the operating system and have to be closed in all processes to produce the\nEOFError exception.Thus, closing the pipe in the producer doesn’t have any effect\nunless the consumer also closes the same end of the pipe.\nPipes can be used for bidirectional communication.This can be used to write pro-\ngrams that interact with a process using a request/response model typically associated\nwith client/server computing or remote procedure call. Here is an example:\nimport multiprocessing\n# A server process\ndef adder(pipe):\nserver_p, client_p = pipe\nclient_p.close()\nwhile True:\ntry:\nx,y = server_p.recv()\nexcept EOFError:\nbreak\nresult = x + y\nserver_p.send(result)\n# Shutdown\nprint(\"Server done\")\nif _ _name_ _ == '_ _main_ _':\n(server_p, client_p) = multiprocessing.Pipe()\n# Launch the server process\nadder_p = multiprocessing.Process(target=adder,args=((server_p, client_p),))\nadder_p.start()\n# Close the server pipe in the client\nserver_p.close()\n# Make some requests on the server\nclient_p.send((3,4))\nprint(client_p.recv())\nclient_p.send(('Hello','World'))\nprint(client_p.recv())\n# Done. Close the pipe\nclient_p.close()\n# Wait for the consumer process to shutdown\nadder_p.join()\nIn this example, the adder() function runs as a server waiting for messages to arrive on\nits end of the pipe.When received, it performs some processing and sends the result\nback on the pipe. Keep in mind that send() and recv() use the pickle module to\nserialize objects. In the example, the server receives a tuple (x, y) as input and returns\nthe result x + y. For more advanced applications that use remote procedure call, how-\never, you should use a process pool as described next.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2150,
      "extraction_method": "Direct"
    },
    {
      "page_number": 449,
      "chapter": null,
      "content": "424\nChapter 20 Threads and Concurrency\nProcess Pools\nThe following class allows you to create a pool of processes to which various kind of\ndata processing tasks can be submitted.The functionality provided by a pool is some-\nwhat similar to that provided by list comprehensions and functional programming oper-\nations such as map-reduce.\nPool([numprocess [,initializer [, initargs]]])\nCreates a pool of worker processes. numprocess is the number of processes to create. If\nomitted, the value of cpu_count() is used. initializer is a callable object that will\nbe executed in each worker process upon startup. initargs is a tuple of arguments to\npass to initializer. By default, initializer is None.\nAn instance p of Pool supports the following operations:\np.apply(func [, args [, kwargs]])\nExecutes func(*args, **kwargs) in one of the pool workers and returns the result.\nIt is important to emphasize this does not execute func in parallel in all pool workers.\nIf you want func to execute concurrently with different arguments, you either have to\ncall p.apply() from different threads or use p.apply_async().\np.apply_async(func [, args [, kwargs [, callback]]])\nExecutes func(*args, **kwargs) in one of the pool workers and returns the result\nasynchronously.The result of this method is an instance of AsyncResult which can be\nused to obtain the final result at a later time. callback is a callable object that accepts a\nsingle input argument.When the result of func becomes available, it is immediately\npassed to callback. callback should not perform any blocking operations or else it\nwill block the reception of results in other asynchronous operations.\np.close()\nCloses the process pool, preventing any further operations. If any operations are still\npending, they will be completed before the worker processes terminate.\np.join()\nWaits for all worker processes to exit.This can only be called after close() or\nterminate().\np.imap(func, iterable [, chunksize])\nA version of map() that returns an iterator instead of a list of results.\np.imap_unordered(func, iterable [, chunksize]])\nThe same as imap() except that the results are returned in an arbitrary order based on\nwhen they are received from the worker processes.\np.map(func, iterable [, chunksize])\nApplies the callable object func to all of the items in iterable and returns the result\nas a list.The operation is carried out in parallel by splitting iterable into chunks and\nfarming out the work to the worker processes. chunksize specifies the number of\nitems in each chunk. For large amounts of data, increasing the chunksize will improve\nperformance.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2636,
      "extraction_method": "Direct"
    },
    {
      "page_number": 450,
      "chapter": null,
      "content": "425\nmultiprocessing\np.map_async(func, iterable [, chunksize [, callback]])\nThe same as map() except that the result is returned asynchronously.The return value is\nan instance of AsyncResult that can be used to later obtain the result. callback is a\ncallable object accepting a single argument. If supplied, callback is called with the\nresult when it becomes available.\np.terminate()\nImmediately terminates all of the worker processes without performing any cleanup or\nfinishing any pending work. If p is garbage-collected, this is called.\nThe methods apply_async() and map_async() return an AsyncResult instance\nas a result.An instance a of AsyncResult has the following methods:\na.get([timeout])\nReturns the result, waiting for it to arrive if necessary. timeout is an optional timeout.\nIf the result does not arrive in the given time, a multiprocessing.TimeoutError\nexception is raised. If an exception was raised in the remote operation, it is reraised\nwhen this method is called.\na.ready()\nReturns True if the call has completed.\na.sucessful()\nReturns True if the call completed without any exceptions.An AssertionError is\nraised if this method is called prior to the result being ready.\na.wait([timeout])\nWaits for the result to become available. timeout is an optional timeout.\nThe following example illustrates the use of a process pool to build a dictionary\nmapping filenames to SHA512 digest values for an entire directory of files:\nimport os\nimport multiprocessing\nimport hashlib\n# Some parameters you can tweak\nBUFSIZE  = 8192            # Read buffer size\nPOOLSIZE = 2               # Number of workers\ndef compute_digest(filename):\ntry:\nf = open(filename,\"rb\")\nexcept IOError:\nreturn None\ndigest = hashlib.sha512()\nwhile True:\nchunk = f.read(BUFSIZE)\nif not chunk: break\ndigest.update(chunk)\nf.close()\nreturn filename, digest.digest()\ndef build_digest_map(topdir):\ndigest_pool = multiprocessing.Pool(POOLSIZE)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1945,
      "extraction_method": "Direct"
    },
    {
      "page_number": 451,
      "chapter": null,
      "content": "426\nChapter 20 Threads and Concurrency\nallfiles = (os.path.join(path,name) \nfor path, dirs, files in os.walk(topdir)\nfor name in files)\ndigest_map = dict(digest_pool.imap_unordered(compute_digest,allfiles,20))\ndigest_pool.close()\nreturn digest_map\n# Try it out.  Change the directory name as desired.\nif _ _name_ _ == '_ _main_ _':\ndigest_map = build_digest_map(\"/Users/beazley/Software/Python-3.0\")\nprint(len(digest_map))\nIn the example, a sequence of pathnames for all files in a directory tree is specified using\na generator expression.This sequence is then chopped up and farmed out to a process\npool using the imap_unordered() function. Each pool worker computes a SHA512\ndigest value for its files using the compute_digest() function.The results are sent back\nto the master and collected into a Python dictionary.Although it’s by no means a scien-\ntific result, this example gives a 75 percent speedup over a single-process solution when\nrun on the author’s dual-core Macbook.\nKeep in mind that it only makes sense to use a process pool if the pool workers per-\nform enough work to justify the extra communication overhead.As a general rule, it\nwould not make sense to use a pool for simple calculations such as just adding two\nnumbers together.\nShared Data and Synchronization\nNormally, processes are completed isolated from each other with the only means of\ncommunication being queues or pipes. However, two objects can be used to represent\nshared data. Underneath the covers, these objects use shared memory (via mmap) to\nmake access possible in multiple processes.\nValue(typecode, arg1, ... argN, lock)\nCreates a ctypes object in shared memory. typecode is either a string containing a\ntype code as used by the array module (e.g., 'i', 'd', etc.) or a type object from the\nctypes module (e.g., ctypes.c_int, ctypes.c_double, etc.).All extra positional\narguments arg1, arg2, ... argN are passed to the constructor for the given type.\nlock is a keyword-only argument that if set to True (the default), a new lock is created\nto protect access to the value. If you pass in an existing lock such as a Lock or RLock\ninstance, then that lock is used for synchronization. If v is an instance of a shared value\ncreated by Value, then the underlying value is accessed used v.value. For example,\nreading v.value will get the value and assigning v.value will change the value.\nRawValue(typecode, arg1, ..., argN)\nThe same as Value except that there is no locking.\nArray(typecode, initializer, lock)\nCreates a ctypes array in shared memory. typecode describes the contents of the array\nand has the same meaning as described for Value(). initializer is either an integer\nthat sets the initial size of the array or a sequence of items whose values and size are\nused to initialize the array. lock is a keyword-only argument with the same meaning as\ndescribed for Value(). If a is an instance of a shared array created by Array, then you\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2953,
      "extraction_method": "Direct"
    },
    {
      "page_number": 452,
      "chapter": null,
      "content": "427\nmultiprocessing\naccess its contents using the standard Python indexing, slicing, and iteration operations,\neach of which are synchronized by the lock. For byte strings, a will also have an\na.value attribute to access the entire array as a single string.\nRawArray(typecode, initializer)\nThe same as Array except that there is no locking. If you are writing programs that\nmust manipulate a large number of array items all at once, the performance will be sig-\nnificantly better if you use this datatype along with a separate lock for synchronization\n(if needed).\nIn addition to shared values created using Value() and Array(), the \nmultiprocessing module provides shared versions of the following synchronization\nprimitives:\nPrimitive\nDescription\nLock\nMutual exclusion lock\nRLock\nReentrant mutual exclusion lock (can be acquired multiple\ntimes by the same process without blocking)\nSemaphore\nSemaphore\nBoundedSemaphore\nBounded semaphore\nEvent\nEvent\nCondition\nCondition variable\nThe behavior of these objects mimics the synchronization primitives defined in the\nthreading module with identical names. Please refer to the threading documentation\nfor further details.\nIt should be noted that with multiprocessing, it is not normally necessary to worry\nabout low-level synchronization with locks, semaphores, or similar constructs to the\nsame degree as with threads. In part, send() and receive() operations on pipes and\nput() and get() operations on queues already provide synchronization. However,\nshared values and locks can have uses in certain specialized settings. Here is an example\nthat sends a Python list of floats to another process using a shared array instead of a\npipe:\nimport multiprocessing\nclass FloatChannel(object):\ndef _ _init_ _(self, maxsize):\nself.buffer     = multiprocessing.RawArray('d',maxsize)\nself.buffer_len = multiprocessing.Value('i')\nself.empty      = multiprocessing.Semaphore(1)\nself.full       = multiprocessing.Semaphore(0)\ndef send(self,values):\nself.empty.acquire()             # Only proceed if buffer empty\nnitems = len(values)\nself.buffer_len = nitems         # Set the buffer size\nself.buffer[:nitems] = values    # Copy values into the buffer\nself.full.release()              # Signal that buffer is full\ndef recv(self):\nself.full.acquire()              # Only proceed if buffer full\nvalues = self.buffer[:self.buffer_len.value]   # Copy values\nself.empty.release()             # Signal that buffer is empty\nreturn values\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2486,
      "extraction_method": "Direct"
    },
    {
      "page_number": 453,
      "chapter": null,
      "content": "428\nChapter 20 Threads and Concurrency\n# Performance test.  Receive a bunch of messages\ndef consume_test(count, ch):\nfor i in xrange(count):\nvalues = ch.recv()\n# Performance test. Send a bunch of messages\ndef produce_test(count, values, ch):\nfor i in xrange(count):\nch.send(values)\nif _ _name_ _ == '_ _main_ _':\nch = FloatChannel(100000)\np = multiprocessing.Process(target=consume_test,\nargs=(1000,ch))\np.start()\nvalues = [float(x) for x in xrange(100000)]\nproduce_test(1000, values, ch)\nprint(\"Done\")\np.join()\nFurther study of this example is left to the reader. However, in a performance test on\nthe author’s machine, sending a large list of floats through the FloatChannel is about\n80 percent faster than sending the list through a Pipe (which has to pickle and unpick-\nle all of the values).\nManaged Objects\nUnlike threads, processes do not support shared objects.Although you can create shared\nvalues and arrays as shown in the previous section, this doesn’t work for more advanced\nPython objects such as dictionaries, lists, or instances of user-defined classes.The \nmultiprocessing module does, however, provide a way to work with shared objects if\nthey run under the control of a so-called manager.A manager is a separate subprocess\nwhere the real objects exist and which operates as a server. Other processes access the\nshared objects through the use of proxies that operate as clients of the manager server.\nThe most straightforward way to work with simple managed objects is to use the\nManager() function.\nManager()\nCreates a running manager server in a separate process. Returns an instance of type\nSyncManager which is defined in the multiprocessing.managers submodule.\nAn instance m of SyncManager as returned by Manager() has a series of methods\nfor creating shared objects and returning a proxy which can be used to access them.\nNormally, you would create a manager and use these methods to create shared objects\nbefore launching any new processes.The following methods are defined:\nm.Array(typecode, sequence)\nCreates a shared Array instance on the server and returns a proxy to it. See the “Shared\nData and Synchronization” section for a description of the arguments.\nm.BoundedSemaphore([value])\nCreates a shared threading.BoundedSemaphore instance on the server and returns a\nproxy to it.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2331,
      "extraction_method": "Direct"
    },
    {
      "page_number": 454,
      "chapter": null,
      "content": "429\nmultiprocessing\nm.Condition([lock])\nCreates a shared threading.Condition instance on the server and returns a proxy to\nit. lock is a proxy instance created by m.Lock() or m.Rlock().\nm.dict([args])\nCreates a shared dict instance on the server and returns a proxy to it.The arguments\nto this method are the same as for the built-in dict() function.\nm.Event()\nCreates a shared threading.Event instance on the server and returns a proxy to it.\nm.list([sequence])\nCreates a shared list instance on the server and returns a proxy to it.The arguments\nto this method are the same as for the built-in list() function.\nm.Lock()\nCreates a shared threading.Lock instance on the server and returns a proxy to it.\nm.Namespace()\nCreates a shared namespace object on the server and returns a proxy to it.A namespace is\nan object that is somewhat similar to a Python module. For example, if n is a namespace\nproxy, you can assign and read attributes using (.) such as n.name = value or value\n= n.name. However, the choice of name is significant. If name starts with a letter, then\nthat value is part of the shared object held by the manager and is accessible in all other\nprocesses. If name starts with an underscore, it is only part of the proxy object and is not\nshared.\nm.Queue()\nCreates a shared Queue.Queue object on the server and returns a proxy to it.\nm.RLock()\nCreates a shared threading.Rlock object on the server and returns a proxy to it.\nm.Semaphore([value])\nCreates a shared threading.Semaphore object on the server and returns a proxy to it.\nm.Value(typecode, value)\nCreates a shared Value object on the server and returns a proxy to it. See the “Shared\nData and Synchronization” section for a description of the arguments.\nThe following example shows how you would use a manager in order to create a\ndictionary shared between processes.\nimport multiprocessing\nimport time\n# print out d whenever the passed event gets set\ndef watch(d, evt):\nwhile True:\nevt.wait()\nprint(d)\nevt.clear()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2009,
      "extraction_method": "Direct"
    },
    {
      "page_number": 455,
      "chapter": null,
      "content": "430\nChapter 20 Threads and Concurrency\nif _ _name_ _ == '_ _main_ _':\nm   = multiprocessing.Manager()\nd   = m.dict()        # Create a shared dict\nevt = m.Event()       # Create a shared Event\n# Launch a process that watches the dictionary\np = multiprocessing.Process(target=watch,args=(d,evt))\np.daemon=True\np.start()\n# Update the dictionary and notify the watcher\nd['foo'] = 42\nevt.set()\ntime.sleep(5)\n# Update the dictionary and notify the watcher\nd['bar'] = 37\nevt.set()\ntime.sleep(5)\n# Terminate the process and manager\np.terminate()\nm.shutdown()\nIf you run this example, the watch() function prints out the value of d every time the\npassed event gets set. In the main program, a shared dictionary and event are created and\nmanipulated in the main process.When you run this, you will see the child process\nprinting data.\nIf you want to have shared objects of other types such as instances of user-defined\nclasses, you have to create your custom manager object.To do this, you create a class\nthat inherits from BaseManager, which is defined in the multiprocessing.managers\nsubmodule.\nmanagers.BaseManager([address [, authkey]])\nBase class used to create custom manager servers for user-defined objects. address is an\noptional tuple (hostname, port) that specifies a network address for the server. If\nomitted, the operating system will simply assign an address corresponding to some free\nport number. authkey is a string that is used to authenticate clients connecting to the\nserver. If omitted, the value of current_process().authkey is used.\nIf mgrclass is a class that inherits from BaseManager, the following class method is\nused to create methods for returning proxies to shared objects.\nmgrclass.register(typeid [, callable [, proxytype [, exposed [, method_to_typeid\n[, create_method]]]]])\nRegisters a new data type with the manager class. typeid is a string that is used to\nname a particular kind of shared object.This string should be a valid Python identifier.\ncallable is a callable object that creates or returns the instance to be shared. proxy-\ntype is a class that provides the implementation of the proxy objects to be used in\nclients. Normally, these classes are generated by default so this is normally set to None.\nexposed is a sequence of method names on the shared object that will be exposed to\nproxy objects. If omitted, the value of proxytype._exposed_ is used and if that is\nundefined, then all public methods (all callable methods that don’t start with an under-\nscore (_) are used). method_to_typeid is a mapping from method names to type IDS\nthat is used to specify which methods should return their results using proxy objects. If\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2686,
      "extraction_method": "Direct"
    },
    {
      "page_number": 456,
      "chapter": null,
      "content": "431\nmultiprocessing\na method is not found in this mapping, the return value is copied and returned. If\nmethod_to_typeid is None, the value of proxytype._method_to_typeid_ is used if\nit is defined. create_method is a Boolean flag that specifies whether a method with the\nname typeid should be created in mgrclass. By default, this is True.\nAn instance m of a manager derived from BaseManager must be manually started to\noperate.The following attributes and methods are related to this:\nm.address\nA tuple (hostname, port) that has the address being used by the manager server.\nm.connect()\nConnects to a remote manager object, the address of which was given to the\nBaseManager constructor.\nm.serve_forever()\nRuns the manager server in the current process.\nm.shutdown()\nShuts down a manager server launched by the m.start() method.\nm.start()\nStarts a separate subprocess and starts the manager server in that process.\nThe following example shows how to create a manager for a user-defined class:\nimport multiprocessing\nfrom multiprocessing.managers import BaseManager\nclass A(object):\ndef _ _init_ _(self,value):\nself.x = value\ndef _ _repr_ _(self):\nreturn \"A(%s)\" % self.x\ndef getX(self):\nreturn self.x\ndef setX(self,value):\nself.x = value\ndef _ _iadd_ _(self,value):\nself.x += value\nreturn self\nclass MyManager(BaseManager): pass\nMyManager.register(\"A\",A)\nif _ _name_ _ == '_ _main_ _':\nm = MyManager()\nm.start()\n# Create a managed object\na = m.A(37)\n...\nIn this example, the last statement creates an instance of A that lives on the manager\nserver.The variable a in the previous code is only a proxy for this instance.The behav-\nior of this proxy is similar to (but not completely identical to) referent, the object on the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1744,
      "extraction_method": "Direct"
    },
    {
      "page_number": 457,
      "chapter": null,
      "content": "432\nChapter 20 Threads and Concurrency\nserver. First, you will find that data attributes and properties cannot be accessed. Instead,\nyou have to use access functions:\n>>> a.x\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nAttributeError: 'AutoProxy[A]' object has no attribute 'x'\n>>> a.getX()\n37\n>>> a.setX(42)\n>>>\nWith proxies, the repr() function returns a string representing the proxy, whereas\nstr() returns the output of _ _repr_ _() on the referent. For example:\n>>> a\n<AutoProxy[A] object, typeid 'A' at 0xcef230>\n>>> print(a)\nA(37)\n>>>\nSpecial methods and any method starting with an underscore (_) are not accessible on\nproxies. For example, if you tried to invoke a._ _iadd_ _(), it doesn’t work:\n>>> a += 37\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: unsupported operand type(s) for +=: 'AutoProxy[A]' and 'int'\n>>> a._ _iadd_ _(37)\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nAttributeError: 'AutoProxy[A]' object has no attribute '_ _iadd_ _'\n>>>\nIn more advanced applications, it is possible to customize proxies to more carefully con-\ntrol access.This is done by defining a class that inherits from BaseProxy, which is\ndefined in multiprocessing.managers.The following code shows how you could\nmake a custom proxy to the A class in the previous example that properly exposes the\n_ _iadd_ _() method and which uses a property to expose the x attribute:\nfrom multiprocessing.managers import BaseProxy\nclass AProxy(BaseProxy):\n# A list of all methods exposed on the referent\n_exposed_ = ['_ _iadd_ _','getX','setX']\n# Implement the public interface of the proxy\ndef _ _iadd_ _(self,value):\nself._callmethod('_ _iadd_ _',(value,))\nreturn self\n@property\ndef x(self):\nreturn self._callmethod('getX',())\n@x.setter\ndef x(self,value):\nself._callmethod('setX',(value,))\nclass MyManager(BaseManager): pass\nMyManager.register(\"A\", A, proxytype=AProxy)\nAn instance proxy of a class derived from BaseProxy has the following methods:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2047,
      "extraction_method": "Direct"
    },
    {
      "page_number": 458,
      "chapter": null,
      "content": "433\nmultiprocessing\nproxy._callmethod(name [, args [, kwargs]])\nCalls the method name on the proxy’s referent object. name is a string with the method\nname, args is a tuple containing positional arguments, and kwargs is a dictionary of\nkeyword arguments.The method name must be explicitly exposed. Normally this is\ndone by including the name in the _exposed_ class attribute of the proxy class.\nproxy._getvalue()\nReturns a copy of the referent in the caller. If this call is made in a different process, the\nreferent object is pickled, sent to the caller, and is unpickled.An exception is raised if\nthe referent can’t be pickled.\nConnections\nPrograms that use the multiprocessing module can perform message passing with\nother processes running on the same machine or with processes located on remote sys-\ntems.This can be useful if you want to take a program written to work on a single sys-\ntem and expand it work on a computing cluster.The multiprocessing.connection\nsubmodule has functions and classes for this purpose:\nconnections.Client(address [, family [, authenticate [, authkey]]])\nConnects to another process which must already be listening at address address.\naddress is a tuple (hostname , port) representing a network address, a file name\nrepresenting a UNIX domain socket, or a string of the form\nr'\\\\servername\\pipe\\pipename' representing a Windows named pipe on a remote\nsystem servername (use a servername of '.' for the local machine). family is a\nstring representing the addess format and is typically one of 'AF_INET',\n'AF_UNIX', or 'AF_PIPE'. If omitted, the family is inferred from the format of\naddress. authentication is a Boolean flag that specifies whether digest authentica-\ntion is to be used. authkey is a string containing the authentication key. If omitted,\nthen the value of current_process().authkey is used.The return value from this\nfunction is a Connection object, which was previously described in the pipes section of\n“Interprocess Communication.”\nconnections.Listener([address [, family [, backlog [, authenticate [,\nauthkey]]]]])\nA class that implements a server for listening for and handling connections made by the\nClient() function.The address, family, authenticate, and authkey arguments\nhave the same meaning as for Client(). backlog is an integer corresponding to the\nvalue passed to the listen() method of sockets if the address parameter specifies a\nnetwork connection. By default, backlog is 1. If address is omitted, then a default\naddress is chosen. If both address and family are omitted, then the fastest available\ncommunications scheme on the local system is chosen.\nAn instance s of Listener supports the following methods and attributes:\ns.accept()\nAccepts a new connection and returns a Connection object. Raises\nAuthenticationError if authentication fails.\ns.address\nThe address that the listener is using.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2888,
      "extraction_method": "Direct"
    },
    {
      "page_number": 459,
      "chapter": null,
      "content": "434\nChapter 20 Threads and Concurrency\ns.close()\nCloses the pipe or socket being used by the listener.\ns.last_accepted\nThe address of the last client that was accepted.\nHere is an example of a server program that listens for clients and implements a sim-\nple remote operation (adding):\nfrom multiprocessing.connection import Listener\nserv = Listener(('',15000),authkey='12345')\nwhile True:\nconn = serv.accept()\nwhile True:\ntry:\nx,y = conn.recv()\nexcept EOFError:\nbreak\nresult = x + y\nconn.send(result)\nconn.close()\nHere is a simple client program that connects to this server and sends some messages:\nfrom multiprocessing.connection import Client\nconn = Client(('localhost',15000), authkey=\"12345\")\nconn.send((3,4))\nr = conn.recv()\nprint(r)           # Prints '7'\nconn.send((\"Hello\",\"World\"))\nr = conn.recv()\nprint(r)           # Prints 'HelloWorld'\nconn.close()\nMiscellaneous Utility Functions\nThe following utility functions are also defined:\nactive_children()\nReturns a list of Process objects for all active child processes.\ncpu_count()\nReturns the number of CPUs on the system if it can be determined.\ncurrent_process()\nReturns the Process object for the current process.\nfreeze_support()\nA function that should be included as the first statement of the main program in an\napplication that will be “frozen” using various packaging tools such as py2exe.This is\nneeded to prevent runtime errors associated with launching subprocesses in a frozen\napplication.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1484,
      "extraction_method": "Direct"
    },
    {
      "page_number": 460,
      "chapter": null,
      "content": "435\nmultiprocessing\nget_logger()\nReturns the logging object associated with the multiprocessing module, creating it if it\ndoesn’t already exist.The returned logger does not propagate messages to the root log-\nger, has a level of logging.NOTSET, and prints all logging messages to standard error.\nset_executable(executable)\nSets the name of the Python executable used to execute subprocesses.This is only\ndefined on Windows.\nGeneral Advice on Multiprocessing\nThe multiprocessing module is one of the most advanced and powerful modules in\nthe Python library. Here are some general tips for keeping your head from exploding:\nn Carefully read the online documentation before building a large application.\nAlthough this section has covered the essential basics, the official documentation\ncovers some of the more sneaky issues that can arise.\nn Make sure that all data passed between processes is compatible with pickle.\nn Avoid shared data and learn to love message passing and queues.With message\npassing, you don’t have to worry so much about synchronization, locking, and\nother issues. It also tends to provide better scaling as the number of processes\nincreases.\nn Don’t use global variables inside functions that are meant to run in separate\nprocesses. It is better to explicitly pass parameters instead.\nn Try not to mix threads and multiprocessing together in the same program unless\nyou’re vastly trying to improve your job security (or to have it reduced depend-\ning on who is doing the code review).\nn Pay very careful attention to how processes get shut down.As a general rule, you\nwill want to explicitly close processes and have a well-defined termination\nscheme in place as opposed to just relying on garbage collection or having to\nforcefully terminate children using the terminate() operation.\nn The use of managers and proxies is closely related to a variety of concepts in dis-\ntributed computing (e.g., distributed objects).A good distributed computing\nbook might be a useful reference.\nn The multiprocessing module originated from a third-party library known as\npyprocessing. Searching for usage tips and information on this library may be a\nuseful resource.\nn Although this module works on Windows, you should carefully read the official\ndocumentation for a variety of subtle details. For example, to launch a new\nprocess on Windows, the multiprocessing module implements its own clone of\nthe UNIX fork() operation, in which process state is copied to the child\nprocess over a pipe.As a general rule, this module is much more tuned to UNIX\nsystems.\nn Above all else, try to keep things as simple as possible.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2648,
      "extraction_method": "Direct"
    },
    {
      "page_number": 461,
      "chapter": null,
      "content": "436\nChapter 20 Threads and Concurrency\nthreading\nThe threading module provides a Thread class and a variety of synchronization prim-\nitives for writing multithreaded programs.\nThread Objects\nThe Thread class is used to represent a separate thread of control.A new thread can be\ncreated as follows:\nThread(group=None, target=None, name=None, args=(), kwargs={})\nThis creates a new Thread instance. group is None and is reserved for future exten-\nsions. target is a callable object invoked by the run() method when the thread starts.\nBy default, it’s None, meaning that nothing is called. name is the thread name. By\ndefault, a unique name of the form \"Thread-N\" is created. args is a tuple of arguments\npassed to the target function. kwargs is a dictionary of keyword arguments passed to\ntarget.\nA Thread instance t supports the following methods and attributes:\nt.start()\nStarts the thread by invoking the run() method in a separate thread of control.This\nmethod can be invoked only once.\nt.run()\nThis method is called when the thread starts. By default, it calls the target function\npassed in the constructor.This method can also be redefined in subclasses of Thread.\nt.join([timeout])\nWaits until the thread terminates or a timeout occurs. timeout is a floating-point num-\nber specifying a timeout in seconds.A thread cannot join itself, and it’s an error to join\na thread before it has been started.\nt.is_alive()\nReturns True if the thread is alive and False otherwise.A thread is alive from the\nmoment the start() method returns until its run() method terminates. t.isAlive()\nis an alias for this method in older code.\nt.name\nThe thread name.This is a string that is used for identification only and which can be\nchanged to a more meaningful value if desired (which may simplify debugging). In\nolder code, t.getName() and t.setName(name) are used to manipulate the thread\nname.\nt.ident\nAn integer thread identifier. If the thread has not yet started, the value is None.\nt.daemon\nThe thread’s Boolean daemonic flag.This must be set prior to calling start() and the\ninitial value is inherited from daemonic status of the creating thread.The entire Python\nprogram exits when no active non-daemon threads are left.All programs have a main\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2261,
      "extraction_method": "Direct"
    },
    {
      "page_number": 462,
      "chapter": null,
      "content": "437\nthreading\nthread that represents the initial thread of control and which is not daemonic. In older\ncode, t.setDaemon(flag) and t.isDaemon() are used to manipulate this value.\nHere is an example that shows how to create and launch a function (or other\ncallable) as a thread:\nimport threading\nimport time\ndef clock(interval):\nwhile True:\nprint(\"The time is %s\" % time.ctime())\ntime.sleep(interval)\nt = threading.Thread(target=clock, args=(15,))\nt.daemon = True\nt.start()\nHere is an example that shows how to define the same thread as a class:\nimport threading\nimport time\nclass ClockThread(threading.Thread):\ndef _ _init_ _(self,interval):\nthreading.Thread._ _init_ _(self)\nself.daemon = True\nself.interval = interval\ndef run(self):\nwhile True:\nprint(\"The time is %s\" % time.ctime())\ntime.sleep(self.interval)\nt = ClockProcess(15)\nt.start()\nIf you define a thread as a class and define your own _ _init_ _() method, it is criti-\ncally important to call the base class constructor Thread._ _init_ _() as shown. If you\nforget this, you will get a nasty error. Other than run(), it is an error to override any of\nthe other methods already defined for a thread.\nThe setting of the daemon attribute in these examples is a common feature of\nthreads that will run forever in the background. Normally, Python waits for all threads\nto terminate before the interpreter exits. However, for nonterminating background\ntasks, this behavior is often undesirable. Setting the daemon flag makes the interpreter\nquit immediately after the main program exits. In this case, the daemonic threads are\nsimply destroyed.\nTimer Objects\nA Timer object is used to execute a function at some later time.\nTimer(interval, func [, args [, kwargs]])\nCreates a timer object that runs the function func after interval seconds have\nelapsed. args and kwargs provide the arguments and keyword arguments passed to\nfunc.The timer does not start until the start() method is called.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1967,
      "extraction_method": "Direct"
    },
    {
      "page_number": 463,
      "chapter": null,
      "content": "438\nChapter 20 Threads and Concurrency\nA Timer object, t, has the following methods:\nt.start()\nStarts the timer.The function func supplied to Timer() will be executed after the\nspecified timer interval.\nt.cancel()\nCancels the timer if the function has not executed yet.\nLock Objects\nA primitive lock (or mutual exclusion lock) is a synchronization primitive that’s in either a\n“locked” or “unlocked” state.Two methods, acquire() and release(), are used to\nchange the state of the lock. If the state is locked, attempts to acquire the lock are\nblocked until the lock is released. If more than one thread is waiting to acquire the\nlock, only one is allowed to proceed when the lock is released.The order in which\nwaiting threads proceed is undefined.\nA new Lock instance is created using the following constructor:\nLock()\nCreates a new Lock object that’s initially unlocked.\nA Lock instance, lock, supports the following methods:\nlock.acquire([blocking ])\nAcquires the lock, blocking until the lock is released if necessary. If blocking is supplied\nand set to False, the function returns immediately with a value of False if the lock\ncould not be acquired or True if locking was successful.\nlock.release()\nReleases a lock. It’s an error to call this method when the lock is in an unlocked state\nor from a different thread than the one that originally called acquire().\nRLock\nA reentrant lock is a synchronization primitive that’s similar to a Lock object, but it can\nbe acquired multiple times by the same thread.This allows the thread owning the lock\nto perform nested acquire() and release() operations. In this case, only the outer-\nmost release() operation resets the lock to its unlocked state.\nA new RLock object is created using the following constructor:\nRLock()\nCreates a new reentrant lock object.An RLock object, rlock, supports the following\nmethods:\nrlock.acquire([blocking ])\nAcquires the lock, blocking until the lock is released if necessary. If no thread owns the\nlock, it’s locked and the recursion level is set to 1. If this thread already owns the lock,\nthe recursion level of the lock is increased by one and the function returns immediately.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2184,
      "extraction_method": "Direct"
    },
    {
      "page_number": 464,
      "chapter": null,
      "content": "439\nthreading\nrlock.release()\nReleases a lock by decrementing its recursion level. If the recursion level is zero after\nthe decrement, the lock is reset to the unlocked state. Otherwise, the lock remains\nlocked.This function should only be called by the thread that currently owns the lock.\nSemaphore and Bounded Semaphore\nA semaphore is a synchronization primitive based on a counter that’s decremented by\neach acquire() call and incremented by each release() call. If the counter ever\nreaches zero, the acquire() method blocks until some other thread calls release().\nSemaphore([value])\nCreates a new semaphore. value is the initial value for the counter. If omitted, the\ncounter is set to a value of 1.\nA Semaphore instance, s, supports the following methods:\ns.acquire([blocking])\nAcquires the semaphore. If the internal counter is larger than zero on entry, this method\ndecrements it by 1 and returns immediately. If it’s zero, this method blocks until another\nthread calls release().The blocking argument has the same behavior as described for\nLock and RLock objects.\ns.release()\nReleases a semaphore by incrementing the internal counter by 1. If the counter is zero\nand another thread is waiting, that thread is awakened. If multiple threads are waiting,\nonly one will be returned from its acquire() call.The order in which threads are\nreleased is not deterministic.\nBoundedSemaphore([value])\nCreates a new semaphore. value is the initial value for the counter. If value is omitted,\nthe counter is set to a value of 1.A BoundedSemaphore works exactly like a\nSemaphore except the number of release() operations cannot exceed the number of\nacquire() operations.\nA subtle difference between a semaphore and a mutex lock is that a semaphore can\nbe used for signaling. For example, the acquire() and release() methods can be\ncalled from different threads to communicate between producer and consumer threads.\nproduced = threading.Semaphore(0)\nconsumed = threading.Semaphore(1)\ndef producer():\nwhile True:\nconsumed.acquire()\nproduce_item()\nproduced.release()\ndef consumer():\nwhile True:\nproduced.acquire()\nitem = get_item()\nconsumed.release()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2166,
      "extraction_method": "Direct"
    },
    {
      "page_number": 465,
      "chapter": null,
      "content": "440\nChapter 20 Threads and Concurrency\nThe kind of signaling shown in this example is often instead carried out using condi-\ntion variables, which will be described shortly.\nEvents\nEvents are used to communicate between threads. One thread signals an “event,” and\none or more other threads wait for it.An Event instance manages an internal flag that\ncan be set to true with the set() method and reset to false with the clear() method.\nThe wait() method blocks until the flag is true.\nEvent()\nCreates a new Event instance with the internal flag set to false.An Event instance, e,\nsupports the following methods:\ne.is_set()\nReturns true only if the internal flag is true.This method is called isSet() in older\ncode.\ne.set()\nSets the internal flag to true.All threads waiting for it to become true are awakened.\ne.clear()\nResets the internal flag to false.\ne.wait([timeout])\nBlocks until the internal flag is true. If the internal flag is true on entry, this method\nreturns immediately. Otherwise, it blocks until another thread calls set() to set the flag\nto true or until the optional timeout occurs. timeout is a floating-point number speci-\nfying a timeout period in seconds.\nAlthough Event objects can be used to signal other threads, they should not be used\nto implement the kind of notification that is typical in producer/consumer problems.\nFor example, you should avoid code like this:\nevt = Event()\ndef producer():\nwhile True:\n# produce item\n...\nevt.signal()\ndef consumer():\nwhile True:\n# Wait for an item\nevt.wait()\n# Consume the item\n...\n# Clear the event and wait again\nevt.clear()\nThis code does not work reliably because the producer might produce a new item in\nbetween the evt.wait() and evt.clear() operations. However, by clearing the\nevent, this new item won’t be seen by the consumer until the producer creates a new\nitem. In the best case, the program will experience a minor hiccup where the processing\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1944,
      "extraction_method": "Direct"
    },
    {
      "page_number": 466,
      "chapter": null,
      "content": "441\nthreading\nof an item is inexplicably delayed. In the worst case, the whole program will hang due\nto the loss of an event signal. For these types of problems, you are better off using con-\ndition variables.\nCondition Variables\nA condition variable is a synchronization primitive, built on top of another lock that’s used\nwhen a thread is interested in a particular change of state or event occurring.A typical\nuse is a producer-consumer problem where one thread is producing data to be con-\nsumed by another thread.A new Condition instance is created using the following\nconstructor:\nCondition([lock])\nCreates a new condition variable. lock is an optional Lock or RLock instance. If not\nsupplied, a new RLock instance is created for use with the condition variable.\nA condition variable, cv, supports the following methods:\ncv.acquire(*args)\nAcquires the underlying lock.This method calls the corresponding acquire(*args)\nmethod on the underlying lock and returns the result.\ncv.release()\nReleases the underlying lock.This method calls the corresponding release() method\non the underlying lock.\ncv.wait([timeout])\nWaits until notified or until a timeout occurs.This method is called after the calling\nthread has already acquired the lock.When called, the underlying lock is released, and\nthe thread goes to sleep until it’s awakened by a notify() or notifyAll() call per-\nformed on the condition variable by another thread. Once awakened, the thread reac-\nquires the lock and the method returns. timeout is a floating-point number in seconds.\nIf this time expires, the thread is awakened, the lock reacquired, and control returned.\ncv.notify([n])\nWakes up one or more threads waiting on this condition variable.This method is called\nonly after the calling thread has acquired the lock, and it does nothing if no threads are\nwaiting. n specifies the number of threads to awaken and defaults to 1.Awakened\nthreads don’t return from the wait() call until they can reacquire the lock.\ncv.notify_all()\nWakes up all threads waiting on this condition.This method is called notifyAll() in\nolder code.\nHere is an example that provides a template of using condition variables:\ncv = threading.Condition()\ndef producer():\nwhile True:\ncv.acquire()\nproduce_item()\ncv.notify()\ncv.release()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2300,
      "extraction_method": "Direct"
    },
    {
      "page_number": 467,
      "chapter": null,
      "content": "442\nChapter 20 Threads and Concurrency\ndef consumer():\nwhile True:\ncv.acquire()\nwhile not item_is_available():\ncv.wait()     # Wait for an item to show up\ncv.release()\nconsume_item()\nA subtle aspect of using condition variables is that if there are multiple threads waiting\non the same condition, the notify() operation may awaken one or more of them (this\nbehavior often depends on the underlying operating system). Because of this, there is\nalways a possibility that a thread will awaken only to find that the condition of \ninterest no longer holds.This explains, for instance, why a while loop is used in the\nconsumer() function. If the thread awakens, but the produced item is already gone, it\njust goes back to waiting for the next signal.\nWorking with Locks\nGreat care must be taken when working with any of the locking primitives such as\nLock, RLock, or Semaphore. Mismanagement of locks is a frequent source of deadlock\nor race conditions. Code that relies on a lock should always make sure locks get proper-\nly released even when exceptions occur.Typical code looks like this:\ntry:\nlock.acquire()\n# critical section\nstatements\n...\nfinally:\nlock.release()\nAlternatively, all of the locks also support the context management protocol which is a\nlittle cleaner:\nwith lock:\n# critical section\nstatements\n...\nIn this last example, the lock is automatically acquired by the with statement and\nreleased when control flow leaves the context.\nAlso, as a general rule you should avoid writing code where more than one lock is\nacquired at any given time. For example:\nwith lock_A:\n# critical section\nstatements\n...\nwith lock_B:\n# critical section on B\nstatements\n...\nThis is usually a good way to have your application mysteriously deadlock.Although\nthere are strategies for avoiding this (for example, hierarchical locking), you’re often bet-\nter off writing code that avoids this altogether.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1914,
      "extraction_method": "Direct"
    },
    {
      "page_number": 468,
      "chapter": null,
      "content": "443\nthreading\nThread Termination and Suspension\nThreads do not have any methods for forceful termination or suspension.This omission\nis by design and due to the intrinsic complexity of writing threaded programs. For\nexample, if a thread has acquired a lock, forcefully terminating or suspending it before it\nis able to release the lock may cause the entire application to deadlock. Moreover, it is\ngenerally not possible to simply “release all locks” on termination either because com-\nplicated thread synchronization often involves locking and unlocking operations that\nmust be carried out in a very precise sequence to work.\nIf you want to support termination or suspension, you need to build these features\nyourself.Typically, it’s done by making a thread run in a loop that periodically checks its\nstatus to see if it should terminate. For example:\nclass StoppableThread(threading.Thread):\ndef _ _init_ _(self):\nthreading.Thread._ _init_ _()\nself._terminate     = False\nself._suspend_lock  = threading.Lock()\ndef terminate(self):\nself._terminate = True\ndef suspend(self):\nself._suspend_lock.acquire()\ndef resume(self):\nself._suspend_lock.release()\ndef run(self):\nwhile True:\nif self._terminate:\nbreak\nself._suspend_lock.acquire()\nself._suspend_lock.release()\nstatements\n...\nKeep in mind that to make this approach work reliability, the thread should take great\ncare not to perform any kind of blocking I/O operation. For example, if the thread\nblocks waiting for data to arrive, it won’t terminate until it wakes up from that opera-\ntion. Because of this, you would probably want to make the implementation use \ntimeouts, non-blocking I/O, and other advanced features to make sure that that the \ntermination check executes every so often.\nUtility Functions\nThe following utility functions are available:\nactive_count()\nReturns the number of currently active Thread objects.\ncurrent_thread()\nReturns the Thread object corresponding to the caller’s thread of control.\nenumerate()\nReturns a list of all currently active Thread objects.\nlocal()\nReturns a local object that allows for the storage of thread-local data.This object is\nguaranteed to be unique in each thread.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2194,
      "extraction_method": "Direct"
    },
    {
      "page_number": 469,
      "chapter": null,
      "content": "444\nChapter 20 Threads and Concurrency\nsetprofile(func)\nSets a profile function that will be used for all threads created. func is passed to\nsys.setprofile() before each thread starts running.\nsettrace(func)\nSets a tracing function that will be used for all threads created. func is passed to\nsys.settrace() before each thread starts running.\nstack_size([size])\nReturns the stack size used when creating new threads. If an optional integer size is\ngiven, it sets the stack size to be used for creating new threads. size can be a value that\nis 32768 (32KB) or greater and a multiple of 4096 (4KB) for maximum portability.A\nThreadError exception is raised if this operation isn’t supported on the system.\nThe Global Interpreter Lock\nThe Python interpreter is protected by a lock that only allows one thread to execute at\na time even if there are multiple processors available.This severely limits the usefulness\nof threads in compute-intensive programs—in fact, the use of threads will often make\nCPU-bound programs run significantly worse than would be the case if they just\nsequentially carried out the same work.Thus, threads should really only be reserved for\nprograms that are primarily concerned with I/O such as network servers. For more\ncompute-intensive tasks, consider using C extension modules or the multiprocessing\nmodule instead. C extensions have the option of releasing the interpreter lock and run-\nning in parallel, provided that they don’t interact with the interpreter when the lock is\nreleased.The multiprocessing module farms work out to independent subprocesses\nthat aren’t restricted by the lock.\nProgramming with Threads\nAlthough it is possible to write very traditional multithreaded programs in Python using\nvarious combinations of locks and synchronization primitives, there is one style of pro-\ngramming that is recommended over all others—and that’s to try and organize multi-\nthreaded programs as a collection of independent tasks that communicate through \nmessage queues.This is described in the next section (the queue module) along with \nan example.\nqueue, Queue\nThe queue module (named Queue in Python 2) implements various multiproducer,\nmulticonsumer queues that can be used to safely exchange information between multi-\nple threads of execution.\nThe queue module defines three different queue classes:\nQueue([maxsize])\nCreates a FIFO (first-in first-out) queue. maxsize is the maximum number of items\nthat can be placed in the queue. If maxsize omitted or 0, the queue size is infinite.\nLifoQueue([maxsize])\nCreates a LIFO (last-in, first-out) queue (also known as a stack).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2633,
      "extraction_method": "Direct"
    },
    {
      "page_number": 470,
      "chapter": null,
      "content": "445\nQueue, queue\nPriorityQueue([maxsize])\nCreates a priority queue in which items are ordered from lowest to highest priority.\nWhen working with this queue, items should be tuples of the form (priority,\ndata) where priority is a number.\nAn instance q of any of the queue classes has the following methods:\nq.qsize()\nReturns the approximate size of the queue. Because other threads may be updating the\nqueue, this number is not entirely reliable.\nq.empty()\nReturns True if the queue is empty and returns False otherwise.\nq.full()\nReturns True if the queue is full and returns False otherwise.\nq.put(item [, block [, timeout]])\nPuts item into the queue. If optional argument block is True (the default), the caller\nblocks until a free slot is available. Otherwise (block is False), the Full exception is\nraised if the queue is full. timeout supplies an optional timeout value in seconds. If a\ntimeout occurs, the Full exception is raised.\nq.put_nowait(item)\nEquivalent to q.put(item, False).\nq.get([block [, timeout]])\nRemoves and returns an item from the queue. If optional argument block is True (the\ndefault), the caller blocks until an item is available. Otherwise (block is False), the\nEmpty exception is raised if the queue is empty. timeout supplies an optional timeout\nvalue in seconds. If a timeout occurs, the Empty exception is raised.\nq.get_nowait()\nEquivalent to get(0).\nq.task_done()\nUsed by consumers of queued data to indicate that processing of an item has been fin-\nished. If this is used, it should be called once for every item removed from the queue.\nq.join()\nBlocks until all items on the queue have been removed and processed.This will only\nreturn once q.task_done() has been called for every item placed on the queue.\nQueue Example with Threads\nMultithreaded programs are often simplified with the use of queues. For example,\ninstead of relying upon shared state that must be protected by locks, threads can be\nlinked together using shared queues. In this model, worker threads typically operate as\nconsumers of data. Here is an example that illustrates the concept:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2111,
      "extraction_method": "Direct"
    },
    {
      "page_number": 471,
      "chapter": null,
      "content": "446\nChapter 20 Threads and Concurrency\nimport threading\nfrom queue import Queue  # Use from Queue on Python 2\nclass WorkerThread(threading.Thread):\ndef _ _init_ _(self,*args,**kwargs):\nthreading.Thread._ _init_ _(self,*args,**kwargs)\nself.input_queue = Queue()\ndef send(self,item):\nself.input_queue.put(item)\ndef close(self):\nself.input_queue.put(None)\nself.input_queue.join()\ndef run(self):\nwhile True:\nitem = self.input_queue.get()\nif item is None:\nbreak\n# Process the item (replace with useful work)\nprint(item)\nself.input_queue.task_done()\n# Done.  Indicate that sentinel was received and return\nself.input_queue.task_done()\nreturn\n# Example use\nw = WorkerThread()\nw.start()\nw.send(\"hello\")     # Send items to the worker (via queue)\nw.send(\"world\")\nw.close()\nThe design of this class has been chosen very carefully. First, you will notice that the\nprogramming API is a subset of the Connection objects that get created by pipes in the\nmultiprocessing module.This allows for future expansion. For example, workers\ncould later be migrated into a separate process without breaking the code that sends\nthem data.\nSecond, the programming interface allows for thread termination.The close()\nmethod places a sentinel onto the queue which, in turn, causes the thread to shut down\nwhen processed.\nFinally, the programming API is also almost identical to a coroutine. If the work to\nbe performed doesn’t involve any blocking operations, you could reimplement the\nrun() method as a coroutine and dispense with threads altogether.This latter approach\nmight run faster because there would no longer be any overhead due to thread context\nswitching.\nCoroutines and Microthreading\nIn certain kinds of applications, it is possible to implement cooperative user-space mul-\ntithreading using a task scheduler and a collection of generators or coroutines.This is\nsometimes called microthreading, although the terminology varies—sometimes this is\ndescribed in the context of tasklets, green threads, greenlets, etc.A common use of this\ntechnique is in programs that need to manage a large collection of open files or sockets.\nFor example, a network server that wants to simultaneously manage 1,000 client con-\nnections. Instead of creating 1,000 threads to do that, asynchronous I/O or polling\n(using the select module) is used in conjunction with a task scheduler that processes\nI/O events.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2398,
      "extraction_method": "Direct"
    },
    {
      "page_number": 472,
      "chapter": null,
      "content": "447\nCoroutines and Microthreading\nThe underlying concept that drives this programming technique is the fact that the\nyield statement in a generator or coroutine function suspends the execution of the\nfunction until it is later resumed with a next() or send() operation.This makes it\npossible to cooperatively multitask between a set of generator functions using a sched-\nuler loop. Here is an example that illustrates the idea:\ndef foo():\nfor n in xrange(5):\nprint(\"I'm foo %d\" % n)\nyield\ndef bar():\nfor n in xrange(10):\nprint(\"I'm bar %d\" % n)\nyield\ndef spam():\nfor n in xrange(7):\nprint(\"I'm spam %d\" % n)\nyield\n# Create and populate a task queue\nfrom collections import deque\ntaskqueue = deque()\ntaskqueue.append(foo())       # Add some tasks (generators)\ntaskqueue.append(bar())\ntaskqueue.append(spam())\n# Run all of the tasks\nwhile taskqueue:\n# Get the next task\ntask = taskqueue.pop()\ntry:\n# Run it to the next yield and enqueue\nnext(task)\ntaskqueue.appendleft(task)\nexcept StopIteration:\n# Task is done\npass\nIt is uncommon for a program to define a series of CPU-bound coroutines and sched-\nule them as shown. Instead, you are more likely to see this technique used with I/O\nbound tasks, polling, or event handling.An advanced example showing this technique is\nfound in the select module section of Chapter 21,“Network Programming and\nSockets.”\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1374,
      "extraction_method": "Direct"
    },
    {
      "page_number": 473,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 474,
      "chapter": null,
      "content": "21\nNetwork Programming and\nSockets\nThis chapter describes the modules used to implement low-level network servers and\nclients. Python provides extensive network support, ranging from programming directly\nwith sockets to working with high-level application protocols such as HTTP.To begin,\na very brief (and admittedly terse) introduction to network programming is presented.\nReaders are advised to consult a book such as UNIX Network Programming,Volume 1:\nNetworking APIs: Sockets and XTI by W. Richard Stevens (Prentice Hall, 1997, ISBN \n0-13-490012-X) for many of the advanced details. Chapter 22,“Internet Application\nProgramming,” describes modules related to application-level protocols.\nNetwork Programming Basics\nPython’s network programming modules primarily support two Internet protocols:TCP\nand UDP.The TCP protocol is a reliable connection-oriented protocol used to establish a\ntwo-way communications stream between machines. UDP is a lower-level packet-based\nprotocol (connectionless) in which machines send and receive discrete packets of infor-\nmation without formally establishing a connection. Unlike TCP, UDP communication\nis unreliable and thus inherently more complicated to manage in applications that\nrequire reliable communications. Consequently, most Internet applications utilize TCP\nconnections.\nBoth network protocols are handled through a programming abstraction known as a\nsocket.A socket is an object similar to a file that allows a program to accept incoming\nconnections, make outgoing connections, and send and receive data. Before two\nmachines can communicate, both must create a socket object.\nThe machine receiving the connection (the server) must bind its socket object to a\nknown port number.A port is a 16-bit number in the range 0–65535 that’s managed by\nthe operating system and used by clients to uniquely identify servers. Ports 0–1023 are\nreserved by the system and used by common network protocols.The following table\nshows the port assignments for a couple of common protocols (a more complete list can\nbe found at http://www.iana.org/assignments/port-numbers):\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2129,
      "extraction_method": "Direct"
    },
    {
      "page_number": 475,
      "chapter": null,
      "content": "450\nChapter 21 Network Programming and Sockets\nService\nPort Number\nFTP-Data\n20\nFTP-Control\n21\nSSH\n22\nTelnet\n23\nSMTP (Mail)\n25\nHTTP (WWW)\n80\nPOP3\n110\nIMAP\n143\nHTTPS (Secure WWW)\n443\nThe process of establishing a TCP connection involves a precise sequence of steps on\nboth the server and client, as shown in Figure 21.1.\nFigure 21.1\nTCP connection protocol.\nFor TCP servers, the socket object used to receive connections is not the same socket\nused to perform subsequent communication with the client. In particular, the accept()\nsystem call returns a new socket object that’s actually used for the connection.This\nallows a server to manage connections from a large number of clients simultaneously.\nServer\nsocket()\nsocket()\nlisten()\nwait for connection\nprocess request\nestablish connection\nrequest\nClient\nconnect()   \nwrite()\nresponse\nbind()\nread()\naccept()\nread()\nwrite()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 894,
      "extraction_method": "Direct"
    },
    {
      "page_number": 476,
      "chapter": null,
      "content": "451\nNetwork Programming Basics\nUDP communication is performed in a similar manner, except that clients and\nservers don’t establish a “connection” with each other, as shown in Figure 21.2.\nFigure 21.2\nUDP connection protocol.\nThe following example illustrates the TCP protocol with a client and server written\nusing the socket module. In this case, the server simply returns the current time to the\nclient as a string.\n# Time server program\nfrom socket import *\nimport time\ns = socket(AF_INET, SOCK_STREAM)  # Create a TCP socket\ns.bind(('',8888))                 # Bind to port 8888\ns.listen(5)                       # Listen, but allow no more than\n# 5 pending connections.\nwhile True:\nclient,addr = s.accept()    # Get a connection\nprint(\"Got a connection from %s\" % str(addr))\ntimestr = time.ctime(time.time()) + \"\\r\\n\"\nclient.send(timestr.encode('ascii'))\nclient.close()\nHere’s the client program:\n# Time client program\nfrom socket import *\ns = socket(AF_INET,SOCK_STREAM)   # Create a TCP socket\ns.connect(('localhost', 8888))    # Connect to the server\ntm = s.recv(1024)                 # Receive no more than 1024 bytes\ns.close()\nprint(\"The time is %s\" % tm.decode('ascii'))\nServer\nsocket()\nsocket()\nrecvfrom()\nwait for data\nprocess request\nrequest\nClient\nsendto()\nresponse\nbind()\nrecvfrom()\nsendto()\nbind()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1337,
      "extraction_method": "Direct"
    },
    {
      "page_number": 477,
      "chapter": null,
      "content": "452\nChapter 21 Network Programming and Sockets\nAn example of establishing a UDP connection appears in the socket module section\nlater in this chapter.\nIt is common for network protocols to exchange data in the form of text. However,\ngreat attention needs to be given to text encoding. In Python 3, all strings are Unicode.\nTherefore, if any kind of text string is to be sent across the network, it needs to be\nencoded.This is why the server is using the encode('ascii') method on the data it\ntransmits. Likewise, when a client receives network data, that data is first received as raw\nunencoded bytes. If you print it out or try to process it as text, you’re unlikely to get\nwhat you expected. Instead, you need to decode it first.This is why the client code is\nusing decode('ascii') on the result.\nThe remainder of this chapter describes modules that are related to socket program-\nming. Chapter 22 describes higher-level modules that provide support for various\nInternet applications such as email and the Web.\nasynchat\nThe asynchat module simplifies the implementation of applications that implement\nasynchronous networking using the asyncore module. It does this by wrapping the\nlow-level I/O functionality of asyncore with a higher-level programming interface\nthat is designed for network protocols based on simple request/response mechanisms\n(for example, HTTP).\nTo use this module, you must define a class that inherits from async_chat.Within\nthis class, you must define two methods: collect_incoming_data() and\nfound_terminator().The first method is invoked whenever data is received on the\nnetwork connection.Typically, it would simply take the data and store it someplace.The\nfound_terminator() method is called when the end of a request has been detected.\nFor example, in HTTP, requests are terminated by a blank line.\nFor data output, async_chat maintains a producer FIFO queue. If you need to out-\nput data, it is simply added to this queue.Then, whenever writes are possible on the\nnetwork connection, data is transparently taken from this queue.\nasync_chat([sock])\nBase class used to define new handlers. async_chat inherits from \nasyncore.dispatcher and provides the same methods. sock is a socket object that’s\nused for communication.\nAn instance, a, of async_chat has the following methods in addition to those\nalready provided by the asyncore.dispatcher base class:\na.close_when_done()\nSignals an end-of-file on the outgoing data stream by pushing None onto the producer\nFIFO queue.When this is reached by the writer, the channel will be closed.\na.collect_incoming_data(data)\nCalled whenever data is received on the channel. data is the received data and is typi-\ncally stored for later processing.This method must be implemented by the user.\na.discard_buffers()\nDiscards all data held in input/output buffers and the producer FIFO queue.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2880,
      "extraction_method": "Direct"
    },
    {
      "page_number": 478,
      "chapter": null,
      "content": "453\nasynchat\na.found_terminator()\nCalled when the termination condition set by set_terminator() holds.This method\nmust be implemented by the user.Typically, it would process data previously collected\nby the collect_incoming_data() method.\na.get_terminator()\nReturns the terminator for the channel.\na.push(data)\nPushes data onto the channel’s outgoing producer FIFO queue. data is a string con-\ntaining the data to be sent.\na.push_with_producer(producer)\nPushes a producer object, producer, onto the producer FIFO queue. producer may be\nany object that has a simple method, more().The more() method should produce a\nstring each time it is invoked.An empty string is returned to signal the end of data.\nInternally, the async_chat class repeatedly calls more() to obtain data to write on the\noutgoing channel. More than one producer object can be pushed onto the FIFO by\ncalling push_with_producer() repeatedly.\ns.set_terminator(term)\nSets the termination condition on the channel. term may either be a string, an integer,\nor None. If term is a string, the method found_terminator() is called whenever that\nstring appears in the input stream. If term is an integer, it specifies a byte count.After\nmany bytes have been read, found_terminator() will be called. If term is None, data\nis collected forever.\nThe module defines one class that can produce data for the \na.push_with_producer() method.\nsimple_producer(data [, buffer_size])\nCreates a simple producer object that produces chunks from a byte string data.\nbuffer_size specifies the chunk size and is 512 by default.\nThe asynchat module is always used in conjunction with the asyncore module.\nFor instance, asyncore is used to set up the high-level server, which accepts incoming\nconnections. asynchat is then used to implement handlers for each connection.The\nfollowing example shows how this works by implementing a minimalistic web server\nthat handles GET requests.The example omits a lot of error checking and details but\nshould be enough to get you started. Readers should compare this example to the\nexample in the asyncore module, which is covered next.\n# An asynchronous HTTP server using asynchat\nimport asynchat, asyncore, socket\nimport os\nimport mimetypes\ntry:\nfrom http.client import responses         # Python 3\nexcept ImportError:\nfrom httplib import responses             # Python 2\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2372,
      "extraction_method": "Direct"
    },
    {
      "page_number": 479,
      "chapter": null,
      "content": "454\nChapter 21 Network Programming and Sockets\n# This class plugs into the asyncore module and merely handles accept events\nclass async_http(asyncore.dispatcher):\ndef _ _init_ _(self,port):\nasyncore.dispatcher._ _init_ _(self)\nself.create_socket(socket.AF_INET,socket.SOCK_STREAM)\nself.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\nself.bind(('',port))\nself.listen(5)\ndef handle_accept(self):\nclient,addr = self.accept()\nreturn async_http_handler(client)\n# Class that handles asynchronous HTTP requests.\nclass async_http_handler(asynchat.async_chat):\ndef _ _init_ _(self,conn=None):\nasynchat.async_chat._ _init_ _(self,conn)\nself.data = []\nself.got_header = False\nself.set_terminator(b\"\\r\\n\\r\\n\")\n# Get incoming data and append to data buffer\ndef collect_incoming_data(self,data):\nif not self.got_header:\nself.data.append(data)\n# Got a terminator (the blank line)\ndef found_terminator(self):\nself.got_header = True\nheader_data      = b\"\".join(self.data)\n# Decode header data (binary) into text for further processing\nheader_text      = header_data.decode('latin-1')\nheader_lines     = header_text.splitlines()\nrequest          = header_lines[0].split()\nop               = request[0]\nurl              = request[1][1:]\nself.process_request(op,url)\n# Push text onto the outgoing stream, but encode it first\ndef push_text(self,text):\nself.push(text.encode('latin-1'))\n# Process the request\ndef process_request(self, op, url):\nif op == \"GET\":\nif not os.path.exists(url):\nself.send_error(404,\"File %s not found\\r\\n\")\nelse:\ntype, encoding = mimetypes.guess_type(url)\nsize = os.path.getsize(url)\nself.push_text(\"HTTP/1.0 200 OK\\r\\n\")\nself.push_text(\"Content-length: %s\\r\\n\" % size)\nself.push_text(\"Content-type: %s\\r\\n\" % type)\nself.push_text(\"\\r\\n\")\nself.push_with_producer(file_producer(url))\nelse:\nself.send_error(501,\"%s method not implemented\" % op)\nself.close_when_done()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1900,
      "extraction_method": "Direct"
    },
    {
      "page_number": 480,
      "chapter": null,
      "content": "455\nasyncore\n# Error handling\ndef send_error(self,code,message):\nself.push_text(\"HTTP/1.0 %s %s\\r\\n\" % (code, responses[code]))\nself.push_text(\"Content-type: text/plain\\r\\n\")\nself.push_text(\"\\r\\n\")\nself.push_text(message)\nclass file_producer(object):\ndef _ _init_ _(self,filename,buffer_size=512):\nself.f = open(filename,\"rb\")\nself.buffer_size = buffer_size\ndef more(self):\ndata = self.f.read(self.buffer_size)\nif not data:\nself.f.close()\nreturn data\na = async_http(8080)\nasyncore.loop()\nTo test this example, you will need to supply a URL corresponding to a file in the same\ndirectory as where you are running the server.\nasyncore\nThe asyncore module is used to build network applications in which network activity\nis handled asynchronously as a series of events dispatched by an event loop, built using\nthe select() system call. Such an approach is useful in network programs that want to\nprovide concurrency, but without the use of threads or processes.This method can also\nprovide high performance for short transactions.All the functionality of this module is\nprovided by the dispatcher class, which is a thin wrapper around an ordinary socket\nobject.\ndispatcher([sock])\nBase class defining an event-driven nonblocking socket object. sock is an existing sock-\net object. If omitted, a socket must be created using the create_socket() method\n(described shortly). Once it’s created, network events are handled by special handler\nmethods. In addition, all open dispatcher objects are saved in an internal list that’s used\nby a number of polling functions.\nThe following methods of the dispatcher class are called to handle network\nevents.They should be defined in classes derived from dispatcher.\nd.handle_accept()\nCalled on listening sockets when a new connection arrives.\nd.handle_close()\nCalled when the socket is closed.\nd.handle_connect()\nCalled when a connection is made.\nd.handle_error()\nCalled when an uncaught Python exception occurs.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1968,
      "extraction_method": "Direct"
    },
    {
      "page_number": 481,
      "chapter": null,
      "content": "456\nChapter 21 Network Programming and Sockets\nd.handle_expt()\nCalled when out-of-band data for a socket is received.\nd.handle_read()\nCalled when new data is available to be read from a socket.\nd.handle_write()\nCalled when an attempt to write data is made.\nd.readable()\nThis function is used by the select() loop to see whether the object is willing to read\ndata. Returns True if so, False if not.This method is called to see if the\nhandle_read() method should be called with new data.\nd.writable()\nCalled by the select() loop to see if the object wants to write data. Returns True if\nso, False otherwise.This method is always called to see whether the handle_write()\nmethod should be called to produce output.\nIn addition to the preceding methods, the following methods are used to perform\nlow-level socket operations.They’re similar to those available on a socket object.\nd.accept()\nAccepts a connection. Returns a pair (client, addr) where client is a socket object\nused to send and receive data on the connection and addr is the address of the client.\nd.bind(address)\nBinds the socket to address. address is typically a tuple (host, port), but this\ndepends the address family being used.\nd.close()\nCloses the socket.\nd.connect(address)\nMakes a connection. address is a tuple (host, port).\nd.create_socket(family, type)\nCreates a new socket.Arguments are the same as for socket.socket().\nd.listen([backlog])\nListens for incoming connections. backlog is an integer that is passed to the underlying\nsocket.listen() function.\nd.recv(size)\nReceives at most size bytes.An empty string indicates the client has closed the chan-\nnel.\nd.send(data)\nSends data. data is a byte string.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1700,
      "extraction_method": "Direct"
    },
    {
      "page_number": 482,
      "chapter": null,
      "content": "457\nasyncore\nThe following function is used to start the event loop and process events:\nloop([timeout [, use_poll [, map [, count]]]])\nPolls for events indefinitely.The select() function is used for polling unless the\nuse_poll parameter is True, in which case poll() is used instead. timeout is the\ntimeout period and is set to 30 seconds by default. map is a dictionary containing all the\nchannels to monitor. count specifies how many polling operations to perform before\nreturning. If count is None (the default), loop() polls forever until all channels are\nclosed. If count is 1, the function will execute a single poll for events and return.\nExample\nThe following example implements a minimalistic web server using asyncore. It\nimplements two classes—asynhttp for accepting connections and asynclient for\nprocessing client requests.This should be compared with the example in the asynchat\nmodule.The main difference is that this example is somewhat lower-level—requiring us\nto worry about breaking the input stream into lines, buffering excess data, and identify-\ning the blank line that terminates the request header.\n# An asynchronous HTTP server\nimport asyncore, socket\nimport os\nimport mimetypes\nimport collections\ntry:\nfrom http.client import responses       # Python 3\nexcept ImportError:\nfrom httplib import responses           # Python 2\n# This class merely handles accept events\nclass async_http(asyncore.dispatcher):\ndef _ _init_ _(self,port):\nasyncore.dispatcher._ _init_ _(self)\nself.create_socket(socket.AF_INET,socket.SOCK_STREAM)\nself.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\nself.bind(('',port))\nself.listen(5)\ndef handle_accept(self):\nclient,addr = self.accept()\nreturn async_http_handler(client)\n# Handle clients\nclass async_http_handler(asyncore.dispatcher):\ndef _ _init_ _(self, sock = None):\nasyncore.dispatcher._ _init_ _(self,sock)\nself.got_request    = False                # Read HTTP request?\nself.request_data   = b\"\"\nself.write_queue    = collections.deque()\nself.responding     = False\n# Only readable if request header not read\ndef readable(self):\nreturn not self.got_request\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2145,
      "extraction_method": "Direct"
    },
    {
      "page_number": 483,
      "chapter": null,
      "content": "458\nChapter 21 Network Programming and Sockets\n# Read incoming request data\ndef handle_read(self):\nchunk = self.recv(8192)\nself.request_data += chunk\nif b'\\r\\n\\r\\n' in self.request_data:\nself.handle_request()\n# Handle an incoming request\ndef handle_request(self):\nself.got_request = True\nheader_data  = self.request_data[:self.request_data.find(b'\\r\\n\\r\\n')]\nheader_text  = header_data.decode('latin-1')\nheader_lines = header_text.splitlines()\nrequest      = header_lines[0].split()\nop      = request[0]\nurl     = request[1][1:]\nself.process_request(op,url)\n# Process the request\ndef process_request(self,op,url):\nself.responding = True\nif op == \"GET\":\nif not os.path.exists(url):\nself.send_error(404,\"File %s not found\\r\\n\" % url)\nelse:\ntype, encoding = mimetypes.guess_type(url)\nsize = os.path.getsize(url)\nself.push_text('HTTP/1.0 200 OK\\r\\n')\nself.push_text('Content-length: %d\\r\\n' % size)\nself.push_text('Content-type: %s\\r\\n' % type)\nself.push_text('\\r\\n')\nself.push(open(url,\"rb\").read())\nelse:\nself.send_error(501,\"%s method not implemented\" % self.op)\n# Error handling\ndef send_error(self,code,message):\nself.push_text('HTTP/1.0 %s %s\\r\\n' % (code, responses[code]))\nself.push_text('Content-type: text/plain\\r\\n')\nself.push_text('\\r\\n')\nself.push_text(message)\n# Add binary data to the output queue\ndef push(self,data):\nself.write_queue.append(data)\n# Add text data to the output queue\ndef push_text(self,text):\nself.push(text.encode('latin-1'))\n# Only writable if a response is ready\ndef writable(self):\nreturn self.responding and self.write_queue\n# Write response data\ndef handle_write(self):\nchunk = self.write_queue.popleft()\nbytes_sent = self.send(chunk)\nif bytes_sent != len(chunk):\nself.write_queue.appendleft(chunk[bytes_sent:])\nif not self.write_queue:\nself.close()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1807,
      "extraction_method": "Direct"
    },
    {
      "page_number": 484,
      "chapter": null,
      "content": "459\nselect\n# Create the server\na = async_http(8080)\n# Poll forever\nasyncore.loop()\nSee Also:\nsocket (p. 469), select (p. 459), http (p. 500), SocketServer (p. 489)\nselect\nThe select module provides access to the select() and poll() system calls.\nselect() is typically used to implement polling or to multiplex processing across mul-\ntiple input/output streams without using threads or subprocesses. On UNIX, it works\nfor files, sockets, pipes, and most other file types. On Windows, it only works for sock-\nets.\nselect(iwtd, owtd, ewtd [, timeout])\nQueries the input, output, and exceptional status of a group of file descriptors.The first\nthree arguments are lists containing either integer file descriptors or objects with a\nmethod, fileno(), that can be used to return a file descriptor.The iwtd parameter\nspecifies objects waiting for input, owtd specifies objects waiting for output, and ewtd\nspecifies objects waiting for an exceptional condition. Each list may be empty. timeout\nis a floating-point number specifying a timeout period in seconds. If timeout is omit-\nted, the function waits until at least one file descriptor is ready. If it’s 0, the function\nmerely performs a poll and returns immediately.The return value is a tuple of lists con-\ntaining the objects that are ready.These are subsets of the first three arguments. If none\nof the objects is ready before the timeout occurs, three empty lists are returned. If an\nerror occurs, a select.error exception raised. Its value is the same as that returned by\nIOError and OSError.\npoll()\nCreates a polling object that utilizes the poll() system call.This is only available on\nsystems that support poll().\nA polling object, p, returned by poll() supports the following methods:\np.register(fd [, eventmask])\nRegisters a new file descriptor, fd. fd is either an integer file descriptor or an object\nthat provides the fileno() method from which the descriptor can be obtained.\neventmask is the bitwise OR of the following flags, which indicate events of interest:\nConstant\nDescription\nPOLLIN\nData is available for reading.\nPOLLPRI\nUrgent data is available for reading.\nPOLLOUT\nReady for writing.\nPOLLERR\nError condition.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2203,
      "extraction_method": "Direct"
    },
    {
      "page_number": 485,
      "chapter": null,
      "content": "460\nChapter 21 Network Programming and Sockets\nConstant\nDescription\nPOLLHUP\nHang up.\nPOLLNVAL\nInvalid request.\nIf eventmask is omitted, the POLLIN, POLLPRI, and POLLOUT events are checked.\np.unregister(fd)\nRemoves the file descriptor fd from the polling object. Raises KeyError if the file is\nnot registered.\np.poll([timeout])\nPolls for events on all the registered file descriptors. timeout is an optional timeout\nspecified in milliseconds. Returns a list of tuples (fd, event), where fd is a file\ndescriptor and event is a bitmask indicating events.The fields of this bitmask corre-\nspond to the constants POLLIN, POLLOUT, and so on. For example, to check for the\nPOLLIN event, simply test the value using event & POLLIN. If an empty list is\nreturned, it means a timeout occurred and no events occurred.\nAdvanced Module Features\nThe select() and poll() functions are the most generally portable functions defined\nby this module. On Linux systems, the select module also provides an interface to the\nedge and level trigger polling (epoll) interface which can offer significantly better per-\nformance. On BSD systems, access to kernel queue and event objects is provided.These\nprogramming interfaces are described in the online documentation for select at\nhttp://docs.python.org/library/select.\nAdvanced Asynchronous I/O Example\nThe select module is sometimes used to implement servers based on tasklets or\ncoroutines—a technique that can be used to provide concurrent execution without\nthreads or processes.The following advanced example illustrates this concept by imple-\nmenting an I/O-based task scheduler for coroutines. Be forewarned—this is the most\nadvanced example in the book and it will require some study for it to make sense.You\nmight also want to consult my PyCON’09 tutorial “A Curious Course on Coroutines\nand Concurrency” (http://www.dabeaz.com/coroutines) for additional reference \nmaterial.\nimport select\nimport types\nimport collections\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1978,
      "extraction_method": "Direct"
    },
    {
      "page_number": 486,
      "chapter": null,
      "content": "461\nselect\n# Object that represents a running task\nclass Task(object):\ndef _ _init_ _(self,target):\nself.target  = target    # A coroutine\nself.sendval = None      # Value to send when resuming\nself.stack   = []        # Call stack\ndef run(self):\ntry:\nresult = self.target.send(self.sendval)\nif isinstance(result,SystemCall):\nreturn result\nif isinstance(result,types.GeneratorType):\nself.stack.append(self.target)\nself.sendval = None\nself.target = result\nelse:\nif not self.stack: return\nself.sendval = result\nself.target = self.stack.pop()\nexcept StopIteration:\nif not self.stack: raise\nself.sendval = None\nself.target = self.stack.pop()\n# Object that represents a \"system call\"\nclass SystemCall(object):\ndef handle(self,sched,task):\npass\n# Scheduler object\nclass Scheduler(object):\ndef _ _init_ _(self): \nself.task_queue     = collections.deque()\nself.read_waiting   = {}\nself.write_waiting  = {}\nself.numtasks       = 0\n# Create a new task out of a coroutine\ndef new(self,target):\nnewtask = Task(target)\nself.schedule(newtask)\nself.numtasks += 1\n# Put a task on the task queue\ndef schedule(self,task):\nself.task_queue.append(task)\n# Have a task wait for data on a file descriptor\ndef readwait(self,task,fd):\nself.read_waiting[fd] = task\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1261,
      "extraction_method": "Direct"
    },
    {
      "page_number": 487,
      "chapter": null,
      "content": "462\nChapter 21 Network Programming and Sockets\n# Have a task wait for writing on a file descriptor\ndef writewait(self,task,fd):\nself.write_waiting[fd] = task\n# Main scheduler loop\ndef mainloop(self,count=-1,timeout=None):\nwhile self.numtasks:\n# Check for I/O events to handle\nif self.read_waiting or self.write_waiting:\nwait = 0 if self.task_queue else timeout\nr,w,e = select.select(self.read_waiting, self.write_waiting, [],\nwait)\nfor fileno in r:\nself.schedule(self.read_waiting.pop(fileno))\nfor fileno in w:\nself.schedule(self.write_waiting.pop(fileno))\n# Run all of the tasks on the queue that are ready to run\nwhile self.task_queue:\ntask = self.task_queue.popleft()\ntry:\nresult = task.run()\nif isinstance(result,SystemCall):\nresult.handle(self,task)\nelse:\nself.schedule(task)\nexcept StopIteration:\nself.numtasks -= 1\n# If no tasks can run, we decide if we wait or return\nelse:\nif count > 0: count -= 1\nif count == 0:\nreturn\n# Implementation of different system calls\nclass ReadWait(SystemCall):\ndef _ _init_ _(self,f):\nself.f = f\ndef handle(self,sched,task):\nfileno = self.f.fileno()\nsched.readwait(task,fileno)\nclass WriteWait(SystemCall):\ndef _ _init_ _(self,f):\nself.f = f\ndef handle(self,sched,task):\nfileno = self.f.fileno()\nsched.writewait(task,fileno)\nclass NewTask(SystemCall):\ndef _ _init_ _(self,target):\nself.target = target\ndef handle(self,sched,task):\nsched.new(self.target)\nsched.schedule(task)\nThe code in this example implements a very tiny “operating system.” Here are some\ndetails concerning its operation:\nn All work is carried out by coroutine functions. Recall that a coroutine uses the\nyield statement like a generator except that instead of iterating on it, you send it\nvalues using a send(value) method.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1755,
      "extraction_method": "Direct"
    },
    {
      "page_number": 488,
      "chapter": null,
      "content": "463\nselect\nn The Task class represents a running task and is just a thin layer on top of a\ncoroutine.A Task object task has only one operation, task.run().This\nresumes the task and runs it until it hits the next yield statement, at which point\nthe task suspends.When running a task, the task.sendval attribute contains the\nvalue that is to be sent into the task’s corresponding yield expression.Tasks run\nuntil they encounter the next yield statement.The value produced by this\nyield controls what happens next in the task:\nn If the value is another coroutine (type.GeneratorType), it means that the\ntask wants to temporarily transfer control to that coroutine.The stack\nattribute of Task objects represents a call-stack of coroutines that is built up\nwhen this happens.The next time the task runs, control will be transferred\ninto this new coroutine.\nn If the value is a SystemCall instance, it means that the task wants the\nscheduler to do something on its behalf (such as launch a new task, wait for\nI/O, and so on).The purpose of this object is described shortly.\nn If the value is any other value, one of two things happens. If the currently\nexecuting coroutine was running as a subroutine, it is popped from the task\ncall stack and the value saved so that it can be sent to the caller.The caller\nwill receive this value the next time the task executes. If the coroutine is the\nonly executing coroutine, the return value is simply discarded.\nn The handling of StopIteration is to deal with coroutines that have termi-\nnated.When this happens, control is returned to the previous coroutine (if\nthere was one) or the exception is propagated to the scheduler so that it\nknows that the task terminated.\nn The SystemCall class represents a system call in the scheduler.When a running\ntask wants the scheduler to carry out an operation on its behalf, it yields a\nSystemCall instance.This object is called a “system call” because it mimics the\nbehavior of how programs request the services of a real multitasking operating\nsystem such as UNIX or Windows. In particular, if a program wants the services\nof the operating system, it yields control and provides some information back to\nthe system so that it knows what to do. In this respect, yielding a SystemCall is\nsimilar to executing a kind of system “trap.”\nn The Scheduler class represents a collection of Task objects that are being man-\naged.At its core, the scheduler is built around a task queue (the task_queue\nattribute) that keeps track of tasks that are ready to run.There are four basic\noperations concerning the task queue. new() takes a new coroutine, wraps it with\na Task object, and places it on the work queue. schedule() takes an existing\nTask and puts it back on the work queue. mainloop() runs the scheduler in a\nloop, processing tasks one by one until there are no more tasks.The readwait()\nand writewait() methods put a Task object into temporary staging areas where\nit will wait for I/O events. In this case, the Task isn’t running, but it’s not dead\neither—it’s just sitting around biding its time.\nn The mainloop() method is the heart of the scheduler.This method first checks\nto see if any tasks are waiting for I/O events. If so, it arranges a call to select()\nin order to poll for I/O activity. If there are any events of interest, the associated\ntasks are placed back onto the task queue so that they can run. Next, the \nmainloop() method pops tasks off of the task queue and calls their run()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3494,
      "extraction_method": "Direct"
    },
    {
      "page_number": 489,
      "chapter": null,
      "content": "464\nChapter 21 Network Programming and Sockets\nmethod. If any task exits (StopIteration), it is discarded. If a task merely yields,\nit is just placed back onto the task queue so that it can run again.This continues\nuntil there are either no more tasks or all tasks are blocked, waiting for more I/O\nevents.As an option, the mainloop() function accepts a count parameter that\ncan be used to make it return after a specified number of I/O polling operations.\nThis might be useful if the scheduler is to be integrated into another event loop.\nn Perhaps the most subtle aspect of the scheduler is the handling of SystemCall\ninstances in the mainloop() method. If a task yields a SystemCall instance, the\nscheduler invokes its handle() method, passing in the associated Scheduler and\nTask objects as parameters.The purpose of a system call is to carry out some\nkind of internal operation concerning tasks or the scheduler itself.The\nReadWait(), WriteWait(), and NewTask() classes are examples of system calls\nthat suspend a task for I/O or create a new task. For example, ReadWait() takes\na task and invokes the readwait() method on the scheduler.The scheduler then\ntakes the task and places it into an appropriate holding area.Again, there is a criti-\ncal decoupling of objects going on here.Tasks yield SystemCall objects to\nrequest service, but do not directly interact with the scheduler. SystemCall\nobjects, in turn, can perform operations on tasks and schedulers but are not tied\nto any specific scheduler or task implementation. So, in theory, you could write a\ncompletely different scheduler implementation (maybe using threads) that could\njust be plugged into this whole framework and it would still work.\nHere is an example of a simple network time server implemented using this I/O task\nscheduler. It will illuminate many of the concepts described in the previous list:\nfrom socket import socket, AF_INET, SOCK_STREAM\ndef time_server(address):\nimport time\ns = socket(AF_INET,SOCK_STREAM)\ns.bind(address)\ns.listen(5)\nwhile True:\nyield ReadWait(s)\nconn,addr = s.accept()\nprint(\"Connection from %s\" % str(addr))\nyield WriteWait(conn)\nresp = time.ctime() + \"\\r\\n\"\nconn.send(resp.encode('latin-1'))\nconn.close()\nsched = Scheduler()\nsched.new(time_server(('',10000)))   # Server on port 10000 \nsched.new(time_server(('',11000)))   # Server on port 11000\nsched.run()\nIn this example, two different servers are running concurrently—each listening on a dif-\nferent port number (use telnet to connect and test).The yield ReadWait() and\nyield WriteWait() statements cause the coroutine running each server to suspend\nuntil I/O is possible on the associated socket.When these statements return, the code\nimmediately proceeds with an I/O operation such as accept() or send().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2791,
      "extraction_method": "Direct"
    },
    {
      "page_number": 490,
      "chapter": null,
      "content": "465\nselect\nThe use of ReadWait and WriteWait might look rather low-level. Fortunately, our\ndesign allows these operations to be hidden behind library functions and methods—\nprovided that they are also coroutines. Consider the following object that wraps a socket\nobject and mimics its interface:\nclass CoSocket(object):\ndef _ _init_ _(self,sock):\nself.sock = sock\ndef close(self):\nyield self.sock.close()\ndef bind(self,addr):\nyield self.sock.bind(addr)\ndef listen(self,backlog):\nyield self.sock.listen(backlog)\ndef connect(self,addr):\nyield WriteWait(self.sock)\nyield self.sock.connect(addr)\ndef accept(self):\nyield ReadWait(self.sock)\nconn, addr = self.sock.accept()\nyield CoSocket(conn), addr\ndef send(self,bytes):\nwhile bytes:\nevt = yield WriteWait(self.sock)\nnsent = self.sock.send(bytes)\nbytes = bytes[nsent:]\ndef recv(self,maxsize):\nyield ReadWait(self.sock)\nyield self.sock.recv(maxsize)\nHere is a reimplementation of the time server using the CoSocket class:\nfrom socket import socket, AF_INET, SOCK_STREAM\ndef time_server(address):\nimport time\ns = CoSocket(socket(AF_INET,SOCK_STREAM))\nyield s.bind(address)\nyield s.listen(5)\nwhile True:\nconn,addr = yield s.accept()\nprint(conn)\nprint(\"Connection from %s\" % str(addr))\nresp = time.ctime()+\"\\r\\n\"\nyield conn.send(resp.encode('latin-1'))\nyield conn.close()\nsched = Scheduler()\nsched.new(time_server(('',10000)))   # Server on port 10000 \nsched.new(time_server(('',11000)))   # Server on port 11000\nsched.run()\nIn this example, the programming interface of a CoSocket object looks a lot like a nor-\nmal socket.The only difference is that every operation must be prefaced with yield\n(since every method is defined as a coroutine).At first, it looks crazy so you might ask\nwhat does all of this madness buy you? If you run the above server, you will find that it\nis able to run concurrently without using threads or subprocesses. Not only that, it has\n“normal” looking control flow as long as you ignore all of the yield keywords.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2007,
      "extraction_method": "Direct"
    },
    {
      "page_number": 491,
      "chapter": null,
      "content": "466\nChapter 21 Network Programming and Sockets\nHere is an asynchronous web server that concurrently handles multiple client con-\nnections, but which does not use callback functions, threads, or processes.This should be\ncompared to examples in the asynchat and asyncore modules.\nimport os\nimport mimetypes\ntry:\nfrom http.client import responses    # Python 3\nexcept ImportError:\nfrom httplib import responses           # Python 2\nfrom socket import *\ndef http_server(address):\ns = CoSocket(socket(AF_INET,SOCK_STREAM))\nyield s.bind(address)\nyield s.listen(50)\nwhile True:\nconn,addr = yield s.accept()\nyield NewTask(http_request(conn,addr))\ndel conn, addr\ndef http_request(conn,addr):\nrequest = b\"\"\nwhile True:\ndata = yield conn.recv(8192)\nrequest += data\nif b'\\r\\n\\r\\n' in request: break\nheader_data    = request[:request.find(b'\\r\\n\\r\\n')]\nheader_text    = header_data.decode('latin-1')\nheader_lines   = header_text.splitlines()\nmethod, url, proto = header_lines[0].split()\nif method == 'GET':\nif os.path.exists(url[1:]):\nyield serve_file(conn,url[1:])\nelse:\nyield error_response(conn,404,\"File %s not found\" % url)\nelse:\nyield error_response(conn,501,\"%s method not implemented\" % method)\nyield conn.close()\ndef serve_file(conn,filename):\ncontent,encoding = mimetypes.guess_type(filename)\nyield conn.send(b\"HTTP/1.0 200 OK\\r\\n\")\nyield conn.send((\"Content-type: %s\\r\\n\" % content).encode('latin-1'))\nyield conn.send((\"Content-length: %d\\r\\n\" % \nos.path.getsize(filename)).encode('latin-1'))\nyield conn.send(b\"\\r\\n\")\nf = open(filename,\"rb\")\nwhile True:\ndata = f.read(8192)\nif not data: break\nyield conn.send(data)\ndef error_response(conn,code,message):\nyield conn.send((\"HTTP/1.0 %d %s\\r\\n\" % \n(code, responses[code])).encode('latin-1'))\nyield conn.send(b\"Content-type: text/plain\\r\\n\")\nyield conn.send(b\"\\r\\n\")\nyield conn.send(message.encode('latin-1'))\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1876,
      "extraction_method": "Direct"
    },
    {
      "page_number": 492,
      "chapter": null,
      "content": "467\nselect\nsched = Scheduler()\nsched.new(http_server(('',8080)))\nsched.mainloop()\nCareful study of this example will yield tremendous insight into coroutines and concur-\nrent programming techniques used by some very advanced third-party modules.\nHowever, excessive usage of these techniques might get you fired after your next code\nreview.\nWhen to Consider Asynchronous Networking\nUse of asynchronous I/O (asyncore and asynchat), polling, and coroutines as shown\nin previous examples remains one of the most mysterious aspects of Python develop-\nment.Yet, these techniques are used more often than you might think.An often-cited\nreason for using asynchronous I/O is to minimize the perceived overhead of program-\nming with a large number of threads, especially when managing a large number of\nclients and in light of restrictions related to the global interpreter lock (refer to Chapter\n20,“Threads and Concurrency”).\nHistorically, the asyncore module was one of the first library modules to support\nasynchronous I/O.The asynchat module followed some time later with the aim of\nsimplifying much of the coding. However, both of these modules take the approach of\nprocessing I/O as events. For example, when an I/O event occurs, a callback function is\ntriggered.The callback then reacts in response to the I/O event and carries out some\nprocessing. If you build a large application in this style, you will find that event handling\ninfects almost every part of the application (e.g., I/O events trigger callbacks, which\ntrigger more callbacks, which trigger other callbacks, ad nauseum). One of the more\npopular networking packages,Twisted (http://twistedmatrix.com), takes this approach\nand significantly builds upon it.\nCoroutines are more modern but less commonly understood and used since they\nwere only first introduced in Python 2.5.An important feature of coroutines is that you\ncan write programs that look more like threaded programs in their overall control flow.\nFor instance, the web server in the example does not use any callback functions and\nlooks almost identical to what you would write if you were using threads—you just\nhave to become comfortable with the use of the yield statement. Stackless Python\n(http://www.stackless.com) takes this idea even further.\nAs a general rule, you probably should resist the urge to use asynchronous I/O tech-\nniques for most network applications. For instance, if you need to write a server that\nconstantly transmits data over hundreds or even thousands of simultaneous network\nconnections, threads will tend to have superior performance.This is because the per-\nformance of select() degrades significantly as the number of connections it must\nmonitor increases. On Linux, this penalty can be reduced using special functions such as\nepoll(), but this limits the portability of your code. Perhaps the main benefit of asyn-\nchronous I/O is in applications where networking needs to be integrated with other\nevent loops (e.g., GUIs) or in applications where networking is added into code that\nalso performs a significant amount of CPU processing. In these cases, the use of asyn-\nchronous networking may result in quicker response time.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3207,
      "extraction_method": "Direct"
    },
    {
      "page_number": 493,
      "chapter": null,
      "content": "468\nChapter 21 Network Programming and Sockets\nJust to illustrate, consider the following program that carries out the task described\nin the song “10 million bottles of beer on the wall”:\nbottles = 10000000\ndef drink_beer():\nremaining = 12.0\nwhile remaining > 0.0:\nremaining -= 0.1\ndef drink_bottles():\nglobal bottles\nwhile bottles > 0:\ndrink_beer()\nbottles -= 1\nNow, suppose you wanted to add a remote monitoring capability to this code that\nallows clients to connect and see how many bottles are remaining. One approach is to\nlaunch a server in its own thread and have it run alongside the main application like\nthis:\ndef server(port):\ns = socket.socket(socket.AF_INET,socket.SOCK_STREAM)\ns.bind(('',port))\ns.listen(5)\nwhile True:\nclient,addr = s.accept()\nclient.send((\"%d bottles\\r\\n\" % bottles).encode('latin-1')\nclient.close()\n# Launch the monitor server\nthr = threading.Thread(target=server,args=(10000,))\nthr.daemon=True\nthr.start()\ndrink_bottles()\nThe other approach is to write a server based on I/O polling and embed a polling\noperation directly into the main computation loop. Here is an example that uses the\ncoroutine scheduler developed earlier:\ndef drink_bottles():\nglobal bottles\nwhile bottles > 0:\ndrink_beer()\nbottles -= 1\nscheduler.mainloop(count=1,timeout=0)  # Poll for connections\n# An asynchronous server based on coroutines.\ndef server(port):\ns = CoSocket(socket.socket(socket.AF_INET,socket.SOCK_STREAM))\nyield s.bind(('',port))\nyield s.listen(5)\nwhile True:\nclient,addr = yield s.accept()\nyield client.send((\"%d bottles\\r\\n\" % bottles).encode('latin-1')\nyield client.close()\nscheduler = Scheduler()\nscheduler.new(server(10000))\ndrink_bottles()\nIf you write a separate program that periodically connects to the bottles of beer pro-\ngram and measures the response time required to receive a status message, the results are\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1869,
      "extraction_method": "Direct"
    },
    {
      "page_number": 494,
      "chapter": null,
      "content": "469\nsocket\nsurprising. On the author’s machine (a dual-core 2 GHZ MacBook), the average\nresponse time (measured over 1,000 requests) for the coroutine-based server is about\n1ms versus 5ms for threads.This difference is explained by the fact that the coroutine-\nbased code is able to respond as soon as it detects a connection whereas the threaded\nserver doesn’t get to run until it is scheduled by the operating system. In the presence of\na CPU-bound thread and the Python global interpreter lock, the server may be delayed\nuntil the CPU-bound thread exceeds its allotted time slice. On many systems, the time\nslice is about 10ms so the above rough measurement of thread response time is exactly\nthe average time you might expect to wait for a CPU-bound task to be preempted by\nthe operating system.\nThe downside to polling is that it introduces significant overhead if it occurs too\noften. For instance, even though the response time is lower in this example, the program\ninstrumented with polling takes more than 50% longer to run to completion. If you\nchange the code to only poll after every six-pack of beer, the response time increases\nslightly to 1.2ms whereas the run time of the program is only 3% greater than the pro-\ngram without any polling. Unfortunately, there is often no clear-cut way to know how\noften to poll other than to make measurements of your application.\nEven though this improved response time might look like a win, there are still horri-\nble problems associated with trying to implement your own concurrency. For example,\ntasks need to be especially careful when performing any kind of blocking operation. In\nthe web server example, there is a fragment of code that opens and reads data from a\nfile.When this operation occurs, the entire program will be frozen—potentially for a\nlong period of time if the file access involves a disk seek.The only way to fix this would\nbe to additionally implement asynchronous file access and add it as a feature to the\nscheduler. For more complicated operations such as performing a database query, figur-\ning out how to carry out the work in an asynchronous manner becomes rather com-\nplex. One way to do it would be to carry out the work in a separate thread and to\ncommunicate the results back to the task scheduler when available—something that\ncould be carried out with careful use of message queues. On some systems, there are\nlow-level system calls for asynchronous I/O (such as the aio_* family of functions on\nUNIX).As of this writing, the Python library provides no access to those functions,\nalthough you can probably find bindings through third-party modules. In the author’s\nexperience, using such functionality is a lot trickier than it looks and is not really worth\nthe added complexity that gets introduced into your program—you’re often better off\nletting the thread library deal with such matters.\nsocket\nThe socket module provides access to the standard BSD socket interface.Although it’s\nbased on UNIX, this module is available on all platforms.The socket interface is\ndesigned to be generic and is capable of supporting a wide variety of networking pro-\ntocols (Internet,TIPC, Bluetooth, and so on). However, the most common protocol is\nthe Internet Protocol (IP), which includes both TCP and UDP. Python supports both\nIPv4 and IPv6, although IPv4 is far more common.\nIt should be noted that this module is relatively low-level, providing direct access to\nthe network functions provided by the operating system. If you are writing a network\napplication, it may be easier to use the modules described in Chapter 22 or the\nSocketServer module described at the end of this chapter.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3687,
      "extraction_method": "Direct"
    },
    {
      "page_number": 495,
      "chapter": null,
      "content": "470\nChapter 21 Network Programming and Sockets\nAddress Families\nSome of the socket functions require the specification of an address family.The family\nspecifies the network protocol being used.The following constants are defined for this\npurpose:\nConstant\nDescription\nAF_BLUETOOTH\nBluetooth protocol\nAF_INET\nIPv4 protocols (TCP, UDP)\nAF_INET6\nIPv6 protocols (TCP, UDP)\nAF_NETLINK\nNetlink Interprocess Communication\nAF_PACKET\nLink-level packets\nAF_TIPC\nTransparent Inter-Process Communication protocol\nAF_UNIX\nUNIX domain protocols\nOf these, AF_INET and AF_INET6 are the most commonly used because they represent\nstandard Internet connections. AF_BLUETOOTH is only available on systems that support\nit (typically embedded systems). AF_NETLINK, AF_PACKET, and AF_TIPC are only sup-\nported on Linux. AF_NETLINK is used for fast interprocess communication between user\napplications and the Linux kernel. AF_PACKET is used for working directly at the data-\nlink layer (e.g., raw ethernet packets). AF_TIPC is a protocol used for high-performance\nIPC on Linux clusters (http://tipc.sourceforge.net/).\nSocket Types\nSome socket functions also require the specification of a socket type.The socket type\nspecifies the type of communications (streams or packets) to be used within a given\nprotocol family.The following constants are used for this purpose:\nConstant\nDescription\nSOCK_STREAM\nA reliable connection-oriented byte stream (TCP)\nSOCK_DGRAM\nDatagrams (UDP)\nSOCK_RAW\nRaw socket\nSOCK_RDM\nReliable datagrams\nSOCK_SEQPACKET\nSequenced connection-mode transfer of records\nThe most common socket types are SOCK_STREAM and SOCK_DGRAM because they cor-\nrespond to TCP and UDP in the Internet Protocol suite. SOCK_RDM is a reliable form of\nUDP that guarantees the delivery of a datagram but doesn’t preserve ordering (data-\ngrams might be received in a different order than sent). SOCK_SEQPACKET is used to\nsend packets through a stream-oriented connection in a manner that preserves their\norder and packet boundaries. Neither SOCK_RDM or SOCK_SEQPACKET are widely sup-\nported, so it’s best not to use them if you care about portability. SOCK_RAW is used to\nprovide low-level access to the raw protocol and is used if you want to carry out \nspecial-purpose operations such as sending control messages (e.g., ICMP messages). Use\nof SOCK_RAW is usually restricted to programs running with superuser or administrator\naccess.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2431,
      "extraction_method": "Direct"
    },
    {
      "page_number": 496,
      "chapter": null,
      "content": "471\nsocket\nNot every socket type is supported by every protocol family. For example, if you’re\nusing AF_PACKET to sniff ethernet packets on Linux, you can’t establish a stream-\noriented connection using SOCK_STREAM. Instead, you have to use SOCK_DGRAM or\nSOCK_RAW. For AF_NETLINK sockets, SOCK_RAW is the only supported type.\nAddressing\nIn order to perform any communication on a socket, you have to specify a destination\naddress.The form of the address depends on the address family of the socket.\nAF_INET (IPv4)\nFor Internet applications using IPv4, addresses are specified as a tuple (host, port).\nHere are two examples:\n('www.python.org', 80)\n('66.113.130.182', 25)\nIf host is the empty string, it has the same meaning as INADDR_ANY, which means any\naddress.This is typically used by servers when creating sockets that any client can con-\nnect to. If host is set to '<broadcast>', it has the same meaning as the\nINADDR_BROADCAST constant in the socket API.\nBe aware that when host names such as 'www.python.org' are used, Python uses\nDNS to resolve the host name into an IP address. Depending on how DNS has been\nconfigured, you may get a different IP address each time. Use a raw IP address such as\n'66.113.130.182' to avoid this behavior, if needed.\nAF_INET6 (IPv6)\nFor IPv6, addresses are specified as a 4-tuple (host, port, flowinfo, scopeid).\nWith IPv6, the host and port components work in the same way as IPv4, except that\nthe numerical form of an IPv6 host address is typically specified by a string of eight\ncolon-separated hexadecimal numbers, such as\n'FEDC:BA98:7654:3210:FEDC:BA98:7654:3210' or '080A::4:1' (in this case, the\ndouble colon fills in a range of address components with 0s).\nThe flowinfo parameter is a 32-bit number consisting of a 24-bit flow label (the\nlow 24 bits), a 4-bit priority (the next 4 bits), and four reserved bits (the high 4 bits).A\nflow label is typically only used when a sender wants to enable special handling by\nrouters. Otherwise, flowinfo is set to 0.\nThe scopeid parameter is a 32-bit number that’s only needed when working with\nlink-local and site-local addresses.A link-local address always starts with the prefix\n'FE80:...' and is used between machines on the same LAN (routers will not forward\nlink-local packets). In this case, scopeid an interface index that identifies a specific net-\nwork interface on the host.This information can be viewed using a command such as\n'ifconfig' on UNIX or 'ipv6 if' on Windows.A site-local address always starts\nwith the prefix 'FEC0:...' and is used between machines within the same site (for\nexample, all machines on a given subnet). In this case, scopeid is a site-identifier num-\nber.\nIf no data is given for flowinfo or scopeid, an IPv6 address can be given as the\ntuple (host, port), as with IPv4.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2819,
      "extraction_method": "Direct"
    },
    {
      "page_number": 497,
      "chapter": null,
      "content": "472\nChapter 21 Network Programming and Sockets\nAF_UNIX\nFor UNIX domain sockets, the address is a string containing a path name—for example,\n'/tmp/myserver'.\nAF_PACKET\nFor the Linux packet protocol, the address is a tuple (device, protonum [, pkttype\n[, hatype [, addr]]]) where device is a string specifying the device name such as\n\"eth0\" and protonum is an integer specifying the ethernet protocol number as defined\nin the <linux/if_ether.h> header file (e.g., 0x0800 for an IP packet). packet_type is\nan integer specifying the packet type and is one of the following constants:\nConstant\nDescription\nPACKET_HOST\nPacket address to the local host.\nPACKET_BROADCAST\nPhysical layer broadcast packet.\nPACKET_MULTICAST\nPhysical layer multicast.\nPACKET_OTHERHOST\nPacket destined for a different host, but caught by a device\ndriver in promiscuous mode.\nPACKET_OUTGOING\nPacket originating on the machine, but which has looped back\nto a packet socket.\nhatype is an integer specifying the hardware address type as used in the ARP protocol\nand defined in the <linux/if_arp.h> header file. addr is a byte string containing a\nhardware address, the structure of which depends on the value of hatype. For ethernet,\naddr will be a 6-byte string holding the hardware address.\nAF_NETLINK\nFor the Linux Netlink protocol, the address is a tuple (pid, groups) where pid and\ngroups are both unsigned integers. pid is the unicast address of the socket and is usually\nthe same as the process ID of the process that created the socket or 0 for the kernel.\ngroups is a bit mask used to specify multicast groups to join. Refer to the Netlink doc-\numentation for more information.\nAF_BLUETOOTH\nBluetooth addresses depend on the protocol being used. For L2CAP, the address is a\ntuple (addr, psm) where addr is a string such as '01:23:45:67:89:ab' and psm is\nan unsigned integer. For RFCOMM, the address is a tuple (addr, channel) where\naddr is an address string and channel is an integer. For HCI, the address is a 1-tuple\n(deviceno,) where deviceno is an integer device number. For SCO, the address is a\nstring host.\nThe constant BDADDR_ANY represents any address and is a string '00:00:00:00:00:00'.\nThe constant BDADDR_LOCAL is a string '00:00:00:ff:ff:ff'.\nAF_TIPC\nFor TIPC sockets, the address is a tuple (addr_type, v1, v2, v3 [, scope]) where\nall fields are unsigned integers. addr_type is one of the following values, which also\ndetermines the values of v1, v2, and v3:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2471,
      "extraction_method": "Direct"
    },
    {
      "page_number": 498,
      "chapter": null,
      "content": "473\nsocket\nAddress Type\nDescription\nTIPC_ADDR_NAMESEQ\nv1 is the server type, v2 is the port identifier, and v3 is 0.\nTIPC_ADDR_NAME\nv1 is the server type, v2 is the lower port number, and v3 is\nthe upper port number.\nTIPC_ADDR_ID\nv1 is the node, v2 is the reference, and v3 is 0.\nThe optional scope field is one of TIPC_ZONE_SCOPE, TIPC_CLUSTER_SCOPE, or\nTIPC_NODE_SCOPE.\nFunctions\nThe socket module defines the following functions:\ncreate_connection(address [, timeout])\nEstablishes a SOCK_STREAM connection to address and returns an already connected\nsocket object. address is tuple of the form (host, port), and timeout specifies an\noptional timeout.This function works by first calling getaddrinfo() and then trying\nto connect to each of the tuples that gets returned.\nfromfd(fd, family, socktype [, proto])\nCreates a socket object from an integer file descriptor, fd.The address family, socket\ntype, and protocol number are the same as for socket().The file descriptor must refer\nto a previously created socket. It returns an instance of SocketType.\ngetaddrinfo(host, port [,family [, socktype [, proto [, flags]]]])\nGiven host and port information about a host, this function returns a list of tuples\ncontaining information needed to open up a socket connection. host is a string con-\ntaining a host name or numerical IP address. port is a number or a string representing a\nservice name (for example, \"http\", \"ftp\", \"smtp\"). Each returned tuple consists of\nfive elements (family, socktype, proto, canonname, sockaddr).The family,\nsocktype, and proto items have the same values as would be passed to the socket()\nfunction. canonname is a string representing the canonical name of the host. sockaddr\nis a tuple containing a socket address as described in the earlier section on Internet\naddresses. Here’s an example:\n>>> getaddrinfo(\"www.python.org\",80)\n[(2,2,17,'',('194.109.137.226',80)), (2,1,6,'',('194.109.137.226'),80))]\nIn this example, getaddrinfo() has returned information about two possible socket\nconnections.The first one (proto=17) is a UDP connection, and the second one\n(proto=6) is a TCP connection.The additional parameters to getaddrinfo() can be\nused to narrow the selection. For instance, this example returns information about\nestablishing an IPv4 TCP connection:\n>>> getaddrinfo(\"www.python.org\",80,AF_INET,SOCK_STREAM)\n[(2,1,6,'',('194.109.137.226',80))]\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2405,
      "extraction_method": "Direct"
    },
    {
      "page_number": 499,
      "chapter": null,
      "content": "474\nChapter 21 Network Programming and Sockets\nThe special constant AF_UNSPEC can be used for the address family to look for any kind\nof connection. For example, this code gets information about any TCP-like connection\nand may return information for either IPv4 or IPv6:\n>>> getaddrinfo(\"www.python.org\",\"http\", AF_UNSPEC, SOCK_STREAM)\n[(2,1,6,'',('194.109.137.226',80))]\ngetaddrinfo() is intended for a very generic purpose and is applicable to all support-\ned network protocols (IPv4, IPv6, and so on). Use it if you are concerned about com-\npatibility and supporting future protocols, especially if you intend to support IPv6.\ngetdefaulttimeout()\nReturns the default socket timeout in seconds.A value of None indicates that no time-\nout has been set.\ngetfqdn([name])\nReturns the fully qualified domain name of name. If name is omitted, the local machine\nis assumed. For example, getfqdn(\"foo\") might return \"foo.quasievil.org\".\ngethostbyname(hostname)\nTranslates a host name such as 'www.python.org' to an IPv4 address.The IP address is\nreturned as a string, such as '132.151.1.90'. It does not support IPv6.\ngethostbyname_ex(hostname)\nTranslates a host name to an IPv4 address but returns a tuple (hostname, aliaslist,\nipaddrlist) in which hostname is the primary host name, aliaslist is a list \nof alternative host names for the same address, and ipaddrlist is a list of IPv4 address-\nes for the same interface on the same host. For example,\ngethostbyname_ex('www.python.org') returns something like\n('fang.python.org', ['www.python.org'], ['194.109.137.226']).This func-\ntion does not support IPv6.\ngethostname()\nReturns the host name of the local machine.\ngethostbyaddr(ip_address)\nReturns the same information as gethostbyname_ex(), given an IP address \nsuch as '132.151.1.90'. If ip_address is an IPv6 address such as\n'FEDC:BA98:7654:3210:FEDC:BA98:7654:3210', information regarding IPv6 will be\nreturned.\ngetnameinfo(address, flags)\nGiven a socket address, address, this function translates the address into a 2-tuple\n(host, port), depending on the value of flags.The address parameter is a tuple\nspecifying an address—for example, ('www.python.org',80). flags is the bitwise\nOR of the following constants:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2239,
      "extraction_method": "Direct"
    },
    {
      "page_number": 500,
      "chapter": null,
      "content": "475\nsocket\nConstant\nDescription\nNI_NOFQDN\nDon’t use fully qualified name for local hosts.\nNI_NUMERICHOST\nReturns the address in numeric form.\nNI_NAMEREQD\nRequires a host name. Returns an error if address has no DNS\nentry.\nNI_NUMERICSERV\nThe returned port is returned as a string containing a port num-\nber.\nNI_DGRAM\nSpecifies that the service being looked up is a datagram service\n(UDP) instead of TCP (the default).\nThe main purpose of this function is to get additional information about an address.\nHere’s an example:\n>>> getnameinfo(('194.109.137.226',80),0)\n('fang.python.org', 'http')\n>>> getnameinfo(('194.109.137.226',80),NI_NUMERICSERV)\n('fang.python.org','80')\ngetprotobyname(protocolname)\nTranslates an Internet protocol name (such as 'icmp') to a protocol number (such as\nthe value of IPPROTO_ICMP) that can be passed to the third argument of the socket()\nfunction. Raises socket.error if the protocol name isn’t recognized. Normally, this is\nonly used with raw sockets.\ngetservbyname(servicename [, protocolname])\nTranslates an Internet service name and protocol name to a port number for that serv-\nice. For example, getservbyname('ftp', 'tcp') returns 21.The protocol name, if\nsupplied, should be 'tcp' or 'udp’. Raises socket.error if servicename doesn’t\nmatch any known service.\ngetservbyport(port [, protocolname])\nThis is the opposite of getservbyname(). Given a numeric port number, port,\nthis function returns a string giving the service name, if any. For example,\ngetservbyport(21, 'tcp') returns 'ftp'.The protocol name, if supplied, should be\n'tcp' or 'udp'. Raises socket.error if no service name is available for port.\nhas_ipv6\nBoolean constant that is True if IPv6 support is available.\nhtonl(x)\nConverts 32-bit integers from host to network byte order (big-endian).\nhtons(x)\nConverts 16-bit integers from host to network byte order (big-endian).\ninet_aton(ip_string)\nConverts an IPv4 address provided as a string (for example, '135.128.11.209') to a\n32-bit packed binary format for use as the raw-encoding of the address.The returned\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2084,
      "extraction_method": "Direct"
    },
    {
      "page_number": 501,
      "chapter": null,
      "content": "476\nChapter 21 Network Programming and Sockets\nvalue is a four-character string containing the binary encoding.This may be useful if\npassing the address to C or if the address must be packed into a data structure passed to\nother programs. Does not support IPv6.\ninet_ntoa(packedip)\nConverts a binary-packaged IPv4 address into a string that uses the standard dotted rep-\nresentation (for example, '135.128.11.209'). packedip is a four-character string con-\ntaining the raw 32-bit encoding of an IP address.The function may be useful if an\naddress has been received from C or is being unpacked from a data structure. It does\nnot support IPv6.\ninet_ntop(address_family, packed_ip)\nConverts a packed binary string packed_ip representing an IP network address into a\nstring such as '123.45.67.89'. address_family is the address family and is usually\nAF_INET or AF_INET6.This can be used to obtain a network address string from a\nbuffer of raw bytes (for instance, from the contents of a low-level network packet).\ninet_pton(address_family, ip_string)\nConverts an IP address such as '123.45.67.89' into a packed byte string.\naddress_family is the address family and is usually AF_INET or AF_INET6.This can\nbe used if you’re trying to encode a network address into a raw binary data packet.\nntohl(x)\nConverts 32-bit integers from network (big-endian) to host byte order.\nntohs(x)\nConverts 16-bit integers from network (big-endian) to host byte order.\nsetdefaulttimeout(timeout)\nSets the default timeout for newly created socket objects. timeout is a floating-point\nnumber specified in seconds.A value of None may be supplied to indicate no timeout\n(this is the default).\nsocket(family, type [, proto])\nCreates a new socket using the given address family, socket type, and protocol number.\nfamily is the address family and type is the socket type as discussed in the first part of\nthis section.To open a TCP connection, use socket(AF_INET, SOCK_STREAM).To\nopen a UDP connection, use socket(AF_INET, SOCK_DGRAM).The function returns\nan instance of SocketType (described shortly).\nThe protocol number is usually omitted (and defaults to 0).This is typically only\nused with raw sockets (SOCK_RAW) and is set to a constant that depends on the address\nfamily being used.The following list shows all of the protocol numbers that Python\nmay define for AF_INET and AF_INET6, depending on their availability on the host \nsystem:\nConstant\nDescription\nIPPROTO_AH\nIPv6 authentication header\nIPPROTO_BIP\nBanyan VINES\nIPPROTO_DSTOPTS\nIPv6 destination options\nIPPROTO_EGP\nExterior gateway protocol\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2598,
      "extraction_method": "Direct"
    },
    {
      "page_number": 502,
      "chapter": null,
      "content": "477\nsocket\nConstant\nDescription\nIPPROTO_EON\nISO CNLP (Connectionless Network Protocol)\nIPPROTO_ESP\nIPv6 encapsulating security payload\nIPPROTO_FRAGMENT\nIPv6 fragmentation header\nIPPROTO_GGP\nGateway to Gateway Protocol (RFC823)\nIPPROTO_GRE\nGeneric Routing Encapsulation (RFC1701)\nIPPROTO_HELLO\nFuzzball HELLO protocol\nIPPROTO_HOPOPTS\nIPv6 hop-by-hop options\nIPPROTO_ICMP\nIPv4 ICMP\nIPPROTO_ICMPV6\nIPv6 ICMP\nIPPROTO_IDP\nXNS IDP\nIPPROTO_IGMP\nGroup management protocol\nIPPROTO_IP\nIPv4\nIPPROTO_IPCOMP\nIP Payload compression protocol\nIPPROTO_IPIP\nIP inside IP\nIPPROTO_IPV4\nIPv4 header\nIPPROTO_IPV6\nIPv6 header\nIPPROTO_MOBILE\nIP Mobility\nIPPROTO_ND\nNetdisk protocol\nIPPROTO_NONE\nIPv6 no next header\nIPPROTO_PIM\nProtocol Independent Multicast\nIPPROTO_PUP\nXerox PARC Universal Packet (PUP)\nIPPROTO_RAW\nRaw IP packet\nIPPROTO_ROUTING\nIPv6 routing header\nIPPROTO_RSVP\nResource reservation\nIPPROTO_TCP\nTCP\nIPPROTO_TP\nOSI Transport Protocol (TP-4)\nIPPROTO_UDP\nUDP\nIPPROTO_VRRP\nVirtual Router Redundancy Protocol\nIPPROTO_XTP\neXpress Transfer Protocol\nThe following protocol numbers are used with AF_BLUETOOTH:\nConstant\nDescription\nBTPROTO_L2CAP\nLogical Link Control and Adaption Protocol\nBTPROTO_HCI\nHost/Controller Interface\nBTPROTO_RFCOMM\nCable replacement protocol\nBTPROTO_SCO\nSynchronous Connection Oriented Link\nsocketpair([family [, type [, proto ]]])\nCreates a pair of connected socket objects using the given family, type, and proto\noptions, which have the same meaning as for the socket() function.This function\nonly applies to UNIX domain sockets (family=AF_UNIX). type may be either\nSOCK_DGRAM or SOCK_STREAM. If type is SOCK_STREAM, an object known as a stream\npipe is created. proto is usually 0 (the default).The primary use of this function would\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1768,
      "extraction_method": "Direct"
    },
    {
      "page_number": 503,
      "chapter": null,
      "content": "478\nChapter 21 Network Programming and Sockets\nbe to set up interprocess communication between processes created by os.fork(). For\nexample, the parent process would call socketpair() to create a pair of sockets and\ncall os.fork().The parent and child processes would then communicate with each\nother using these sockets.\nSockets are represented by an instance of type SocketType.The following methods\nare available on a socket, s:\ns.accept()\nAccepts a connection and returns a pair (conn, address), where conn is a new socket\nobject that can be used to send and receive data on the connection and address is the\naddress of the socket on the other end of the connection.\ns.bind(address)\nBinds the socket to an address.The format of address depends on the address family.\nIn most cases, it’s a tuple of the form (hostname, port). For IP addresses, the empty\nstring represents INADDR_ANY and the string '<broadcast>' represents\nINADDR_BROADCAST.The INADDR_ANY host name (the empty string) is used to indicate\nthat the server allows connections on any Internet interface on the system.This is often\nused when a server is multihomed.The INADDR_BROADCAST host name \n('<broadcast>') is used when a socket is being used to send a broadcast message.\ns.close()\nCloses the socket. Sockets are also closed when they’re garbage-collected.\ns.connect(address)\nConnects to a remote socket at address.The format of address depends on the\naddress family, but it’s normally a tuple (hostname, port). It raises socket.error if\nan error occurs. If you’re connecting to a server on the same computer, you can use the\nname 'localhost' as hostname.\ns.connect_ex(address)\nLike connect(address), but returns 0 on success or the value of errno on failure.\ns.fileno()\nReturns the socket’s file descriptor.\ns.getpeername()\nReturns the remote address to which the socket is connected. Usually the return value\nis a tuple (ipaddr, port), but this depends on the address family being used.This is\nnot supported on all systems.\ns.getsockname()\nReturns the socket’s own address. Usually this is a tuple (ipaddr, port).\ns.getsockopt(level, optname [, buflen])\nReturns the value of a socket option. level defines the level of the option and is\nSOL_SOCKET for socket-level options or a protocol number such as IPPROTO_IP for\nprotocol-related options. optname selects a specific option. If buflen is omitted, an\ninteger option is assumed and its integer value is returned. If buflen is given, it speci-\nfies the maximum length of the buffer used to receive the option.This buffer is\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2567,
      "extraction_method": "Direct"
    },
    {
      "page_number": 504,
      "chapter": null,
      "content": "479\nsocket\nreturned as a byte string, where it’s up to the caller to decode its contents using the\nstruct module or other means.\nThe following tables list the socket options defined by Python. Most of these options\nare considered part of the Advanced Sockets API and control low-level details of the\nnetwork.You will need to consult other documentation to find more detailed descrip-\ntions.When type names are listed in the value column, that name is same as the \nstandard C data structure associated with the value and used in the standard socket \nprogramming interface. Not all options are available on all machines.\nThe following are commonly used option names for level SOL_SOCKET:\nOption Name\nValue\nDescription\nSO_ACCEPTCONN\n0, 1\nDetermines whether or not the socket is accept-\ning connections.\nSO_BROADCAST\n0, 1\nAllows sending of broadcast datagrams.\nSO_DEBUG\n0, 1\nDetermines whether or not debugging informa-\ntion is being recorded.\nSO_DONTROUTE\n0, 1\nBypasses routing table lookups.\nSO_ERROR\nint\nGets error status.\nSO_EXCLUSIVEADDRUSE\n0,1\nPrevents other sockets from being forcibly bound\nto the same address and port. This disables the\nSO_REUSEADDR option.\nSO_KEEPALIVE\n0, 1\nPeriodically probes the other end of the connec-\ntion and terminates if it’s half-open.\nSO_LINGER\nlinger\nLingers on close() if the send buffer contains\ndata. linger is a packed binary string contain-\ning two 32-bit integers (onoff, seconds).\nSO_OOBINLINE\n0, 1\nPlaces out-of-band data into the input queue.\nSO_RCVBUF\nint\nSize of receive buffer (in bytes).\nSO_RCVLOWAT\nint\nNumber of bytes read before select() returns\nthe socket as readable.\nSO_RCVTIMEO\ntimeval\nTimeout on receive calls in seconds. timeval is\na packed binary string containing two 32-bit\nunsigned integers (seconds,\nmicroseconds).\nSO_REUSEADDR\n0, 1\nAllows local address reuse.\nSO_REUSEPORT\n0, 1\nAllows multiple processes to bind to the same\naddress as long as this socket option is set in\nall processes.\nSO_SNDBUF\nint\nSize of send buffer (in bytes).\nSO_SNDLOWAT\nint\nNumber of bytes available in send buffer before\nselect() returns the socket as writable.\nSO_SNDTIMEO\ntimeval\nTimeout on send calls in seconds. See \nSO_RCVTIMEO for a description of timeval.\nSO_TYPE\nint\nGets socket type.\nSO_USELOOPBACK\n0, 1\nRouting socket gets copy of what it sends.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2318,
      "extraction_method": "Direct"
    },
    {
      "page_number": 505,
      "chapter": null,
      "content": "480\nChapter 21 Network Programming and Sockets\nThe following options are available for level IPPROTO_IP:\nOption Name\nValue\nDescription\nIP_ADD_MEMBERSHIP\nip_mreg\nJoin a multicast group (set only). ip_mreg\nis a packed binary string containing two 32-\nbit IP addresses (multiaddr,\nlocaladdr), where multiaddr is the\nmulticast address and localaddr is the IP\nof the local interface being used.\nIP_DROP_MEMBERSHIP\nip_mreg\nLeave a multicast group (set only).\nip_mreg is described above. \nIP_HDRINCL\nint\nIP header included with data.\nIP_MAX_MEMBERSHIPS\nint\nMaximum number of multicast groups.\nIP_MULTICAST_IF\nin_addr\nOutgoing interface. in_addr is a packed\nbinary string containing a 32-bit IP address.\nIP_MULTICAST_LOOP\n0,1\nLoopback.\nIP_MULTICAST_TTL\nuint8\nTime to live. uint8 is a packed binary\nstring containing a 1-byte unsigned char.\nIP_OPTIONS\nipopts\nIP header options. ipopts is a packed\nbinary string of no more than 44 bytes. The\ncontents of this string are described in RFC\n791.\nIP_RECVDSTADDR\n0,1\nReceive IP destination address with data-\ngram.\nIP_RECVOPTS\n0,1\nReceive all IP options with datagram.\nIP_RECVRETOPTS\n0,1\nReceive IP options with response.\nIP_RETOPTS\n0,1\nSame as IP_RECVOPTS, leaves the options\nunprocessed with no timestamp or route\nrecord options filled in. \nIP_TOS\nint\nType of service.\nIP_TTL\nint\nTime to live.\nThe following options are available for level IPPROTO_IPV6:\nOption Name\nValue\nDescription\nIPV6_CHECKSUM\n0,1\nHave system compute checksum.\nIPV6_DONTFRAG\n0,1\nDon’t fragment packets if they exceed the\nMTU size.\nIPV6_DSTOPTS\nip6_dest\nDestination options. ip6_dest is a packed\nbinary string of the form (next, len,\noptions) where next is an 8-bit integer\ngiving the option type of the next header;\nlen is an 8-bit integer specifying the length\nof the header in units of 8 bytes, not includ-\ning the first 8 bytes; and options is the\nencoded options.\nIPV6_HOPLIMIT\nint\nHop limit.\nIPV6_HOPOPTS\nip6_hbh\nHop-by-hop options. ip6_hbh has the\nsame encoding as ip6_dest.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2010,
      "extraction_method": "Direct"
    },
    {
      "page_number": 506,
      "chapter": null,
      "content": "481\nsocket\nOption Name\nValue\nDescription\nIPV6_JOIN_GROUP\nip6_mreq\nJoin multicast group. ip6_mreq is a\npacked binary string containing \n(multiaddr, index) where multiaddr\nis a 128-bit IPv6 multicast address and\nindex is a 32-bit unsigned integer inter-\nface index for the local interface.\nIPV6_LEAVE_GROUP\nip6_mreq\nLeave multicast group.\nIPV6_MULTICAST_HOPS int\nHop-limit for multicast packets.\nIPV6_MULTICAST_IF\nint\nInterface index for outgoing multicast pack-\nets.\nIPV6_MULTICAST_LOOP 0,1\nDeliver outgoing multicast packets back to\nlocal application.\nIPV6_NEXTHOP\nsockaddr_in6\nSet the next hop address for outgoing pack-\nets. sockaddr_in6 is a packed binary\nstring containing the C sockaddr_in6\nstructure as typically defined in\n<netinet/in.h>.\nIPV6_PKTINFO\nip6_pktinfo\nPacket information structure. \nip6_pktinfo is a packed binary string\ncontaining (addr, index) where addr is\na 128-bit IPv6 address and index is a 32-\nbit unsigned integer with the interface\nindex.\nIPV6_RECVDSTOPTS\n0,1\nReceive destination options.\nIPV6_RECVHOPLIMIT\n0,1\nReceive the hop limit.\nIPV6_RECVHOPOPTS\n0,1\nReceive hop-by-hop options.\nIPV6_RECVPKTINFO\n0,1\nReceive packet information.\nIPV6_RECVRTHDR\n0,1\nReceive routing header.\nIPV6_RECVTCLASS\n0,1\nReceive the traffic class.\nIPV6_RTHDR\nip6_rthdr\nRouting header. ip6_rthdr is a packed\nbinary string containing (next, len,\ntype, segleft, data) where next,\nlen, type, and segleft are all 8-bit\nunsigned integers and data is routing\ndata. See RFC 2460.\nIPV6_RTHDRDSTOPTS\nip6_dest\nDestination options header before the rout-\ning options header.\nIPV6_RECVPATHMTU\n0,1\nEnable the receipt of IPV6_PATHMTU ancil-\nlary data items.\nIPV6_TCLASS\nint\nTraffic class.\nIPV6_UNICAST_HOPS\nint\nHop limit for unicast packets.\nIPV6_USE_MIN_MTU\n-1,0,1\nPath MTU discovery. 1 disables it for all\ndesinations. -1 disables it only for multicast\ndestinations.\nIPV6_V6ONLY\n0,1\nOnly connect to other IPV6 nodes.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1929,
      "extraction_method": "Direct"
    },
    {
      "page_number": 507,
      "chapter": null,
      "content": "482\nChapter 21 Network Programming and Sockets\nThe following options are available for level SOL_TCP:\nOption Name\nValue\nDescription\nTCP_CORK\n0,1\nDon’t send out partial frames if set.\nTCP_DEFER_ACCEPT\n0,1\nAwake listener only when data arrives on\nsocket.\nTCP_INFO\ntcp_info\nReturns a structure containing information\nabout the socket. tcp_info is implemen-\ntation specific.\nTCP_KEEPCNT\nint\nMaximum number of keepalive probes TCP\nshould send before dropping a connection.\nTCP_KEEPIDLE\nint\nTime in seconds the connection should be\nidle before TCP starts sending keepalive\nprobes if the TCP_KEEPALIVE option has\nbeen set.\nTCP_KEEPINTVL\nint\nTime in seconds between keepalive probes.\nTCP_LINGER2\nint\nLifetime of orphaned FIN_WAIT2 state\nsockets.\nTCP_MAXSEG\nint\nMaximum segment size for outgoing TCP\npackets.\nTCP_NODELAY\n0,1\nIf set, disables the Nagle algorithm.\nTCP_QUICKACK\n0,1\nIf set, ACKs are sent immediately. Disables\nthe TCP delayed ACK algorithm.\nTCP_SYNCNT\nint\nNumber of SYN retransmits before aborting\na connection request.\nTCP_WINDOW_CLAMP\nint\nSets an upper bound on the advertised TCP\nwindow size.\ns.gettimeout()\nReturns the current timeout value if any. Returns a floating-point number in seconds\nor None if no timeout is set.\ns.ioctl(control, option)\nProvides limited access to the WSAIoctl interface on Windows.The only supported\nvalue for control is SIO_RCVALL which is used to capture all received IP packets on\nthe network.This requires Administrator access.The following values can be used for\noptions:\nOption\nDescription\nRCVALL_OFF\nPrevent the socket from receiving all IPv4 or IPv6 packets.\nRCVALL_ON\nEnable promiscuous mode, allowing the socket to receive all IPv4\nor IPv6 packets on the network. The type of packet received\ndepends on the socket address family. This does not capture\npackets associated with other network protocols such as ARP.\nRCVALL_IPLEVEL\nReceive all IP packets received on the network, but do not enable\npromiscuous mode. This will capture all IP packets directed at the\nhost for any configured IP address.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2065,
      "extraction_method": "Direct"
    },
    {
      "page_number": 508,
      "chapter": null,
      "content": "483\nsocket\ns.listen(backlog)\nStarts listening for incoming connections. backlog specifies the maximum number of\npending connections the operating system should queue before connections are refused.\nThe value should be at least 1, with 5 being sufficient for most applications.\ns.makefile([mode [, bufsize]])\nCreates a file object associated with the socket. mode and bufsize have the same\nmeaning as with the built-in open() function.The file object uses a duplicated version\nof the socket file descriptor, created using os.dup(), so the file object and socket object\ncan be closed or garbage-collected independently.The socket s should not have a time-\nout and should not be configured in nonblocking mode.\ns.recv(bufsize [, flags])\nReceives data from the socket.The data is returned as a string.The maximum amount\nof data to be received is specified by bufsize. flags provides additional information\nabout the message and is usually omitted (in which case it defaults to zero). If used, it’s\nusually set to one of the following constants (system-dependent):\nConstant\nDescription\nMSG_DONTROUTE\nBypasses routing table lookup (sends only).\nMSG_DONTWAIT\nNon-blocking operation.\nMSG_EOR\nIndicates that the message is last in a record. Usually only used\nwhen sending data on SOCK_SEQPACKET sockets.\nMSG_PEEK\nLooks at data but doesn’t discard (receives only).\nMSG_OOB\nReceives/sends out-of-band data.\nMSG_WAITALL\nDoesn’t return until the requested number of bytes have been read\n(receives only).\ns.recv_into(buffer [, nbytes [, flags]])\nThe same as recv() except that data is written into a an object buffer supporting the\nbuffer interface. nbytes is the maximum number of bytes to receive. If omitted, the\nmaximum size is taken from the buffer size. flags has the same meaning as for recv().\ns.recvfrom(bufsize [, flags])\nLike the recv() method except that the return value is a pair (data, address) in\nwhich data is a string containing the data received and address is the address of the\nsocket sending the data.The optional flags argument has the same meaning as for\nrecv().This function is primarily used in conjunction with the UDP protocol.\ns.recvfrom_info(buffer [, nbytes [, flags]])\nThe same as recvfrom() but the received data is stored in the buffer object buffer.\nnbytes specifies the maximum number of bytes of receive. If omitted, the maximum\nsize is taken from the size of buffer. flags has the same meaning as for recv().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2455,
      "extraction_method": "Direct"
    },
    {
      "page_number": 509,
      "chapter": null,
      "content": "484\nChapter 21 Network Programming and Sockets\ns.send(string [, flags])\nSends data in string to a connected socket.The optional flags argument has the\nsame meaning as for recv(), described earlier. Returns the number of bytes sent, which\nmay be fewer than the number of bytes in string. Raises an exception if an error\noccurs.\ns.sendall(string [, flags])\nSends data in string to a connected socket, except that an attempt is made to send all\nof the data before returning. Returns None on success; raises an exception on failure.\nflags has the same meaning as for send().\ns.sendto(string [, flags], address)\nSends data to the socket. flags has the same meaning as for recv(). address is a\ntuple of the form (host, port), which specifies the remote address.The socket should\nnot already be connected. Returns the number of bytes sent.This function is primarily\nused in conjunction with the UDP protocol.\ns.setblocking(flag)\nIf flag is zero, the socket is set to nonblocking mode. Otherwise, the socket is set to\nblocking mode (the default). In nonblocking mode, if a recv() call doesn’t find any\ndata or if a send() call cannot immediately send the data, the socket.error excep-\ntion is raised. In blocking mode, these calls block until they can proceed.\ns.setsockopt(level, optname, value)\nSets the value of the given socket option. level and optname have the same meaning\nas for getsockopt().The value can be an integer or a string representing the contents\nof a buffer. In the latter case, it’s up to the caller to ensure that the string contains the\nproper data. See getsockopt() for socket option names, values, and descriptions.\ns.settimeout(timeout)\nSets a timeout on socket operations. timeout is a floating-point number in seconds.A\nvalue of None means no timeout. If a timeout occurs, a socket.timeout exception is\nraised.As a general rule, timeouts should be set as soon as a socket is created because\nthey can be applied to operations involved in establishing a connection (such as \nconnect()).\ns.shutdown(how)\nShuts down one or both halves of the connection. If how is 0, further receives are dis-\nallowed. If how is 1, further sends are disallowed. If how is 2, further sends and receives\nare disallowed.\nIn addition to these methods, a socket instance s also has the following read-only\nproperties which correspond to the arguments passed to the socket() function.\nProperty\nDescription\ns.family\nThe socket address family (e.g., AF_INET)\ns.proto\nThe socket protocol\ns.type\nThe socket type (e.g., SOCK_STREAM)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2543,
      "extraction_method": "Direct"
    },
    {
      "page_number": 510,
      "chapter": null,
      "content": "485\nsocket\nExceptions\nThe following exceptions are defined by the socket module.\nerror\nThis exception is raised for socket- or address-related errors. It returns a pair (errno,\nmesg) with the error returned by the underlying system call. Inherits from IOError.\nherror\nError raised for address-related errors. Returns a tuple (herrno, hmesg) containing an\nerror number and error message. Inherits from error.\ngaierror\nError raised for address-related errors in the getaddrinfo() and getnameinfo() func-\ntions.The error value is a tuple (errno, mesg), where errno is an error number and\nmesg is a string containing a message. errno is set to one of the following constants\ndefined in the socket module:\nConstant\nDescription\nEAI_ADDRFAMILY\nAddress family not supported.\nEAI_AGAIN\nTemporary failure in name resolution.\nEAI_BADFLAGS\nInvalid flags.\nEAI_BADHINTS\nBad hints.\nEAI_FAIL\nNonrecoverable failure in name resolution.\nEAI_FAMILY\nAddress family not supported by host.\nEAI_MEMORY\nMemory allocation failure.\nEAI_NODATA\nNo address associated with node name.\nEAI_NONAME\nNo node name or service name provided.\nEAI_PROTOCOL\nProtocol not supported.\nEAI_SERVICE\nService name not supported for socket type.\nEAI_SOCKTYPE\nSocket type not supported.\nEAI_SYSTEM\nSystem error.\ntimeout\nException raised when a socket operation times out.This only occurs if a timeout has\nbeen set using the setdefaulttimeout() function or settimeout() method of a\nsocket object. Exception value is a string, 'timeout'. Inherits from error.\nExample\nA simple example of a TCP connection is shown in the introduction to this chapter.\nThe following example illustrates a simple UDP echo server:\n# UDP message server\n# Receive small packets from anywhere and print them out\nimport socket\ns = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\ns.bind((\"\",10000))\nwhile True:\ndata, address = s.recvfrom(256)\nprint(\"Received a connection from %s\" % str(address))\ns.sendto(b\"echo:\" + data, address)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1978,
      "extraction_method": "Direct"
    },
    {
      "page_number": 511,
      "chapter": null,
      "content": "486\nChapter 21 Network Programming and Sockets\nHere a client that sends messages to the previous server:\n# UDP message client\nimport socket\ns = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\ns.sendto(b\"Hello World\", (\"\", 10000))\nresp, addr = s.recvfrom(256)\nprint(resp)\ns.sendto(b\"Spam\", (\"\", 10000))\nresp, addr = s.recvfrom(256)\nprint(resp)\ns.close()\nNotes\nn Not all constants and socket options are available on all platforms. If portability is\nyour goal, you should only rely upon options that are documented in major\nsources such as the W. Richard Stevens UNIX Network Programming book cited at\nthe beginning of this section.\nn Notable omissions from the socket module are recvmsg() and sendmsg()\nsystem calls, commonly used to work with ancillary data and advanced \nnetwork options related to packet headers, routing, and other details. For this\nfunctionality, you must install a third-party module such as PyXAPI\n(http://pypi.python.org/pypi/PyXAPI).\nn There is a subtle difference between nonblocking socket operations and opera-\ntions involving a timeout.When a socket function is used in nonblocking mode,\nit will return immediately with an error if the operation would have blocked.\nWhen a timeout is set, a function returns an error only if the operation doesn’t\ncomplete within a specified timeout.\nssl\nThe ssl module is used to wrap socket objects with the Secure Sockets Layer (SSL),\nwhich provides data encryption and peer authentication. Python uses the OpenSSL\nlibrary (http://www.openssl.org) to implement this module.A full discussion concern-\ning the theory and operation of SSL is beyond the scope of what can be covered here.\nSo, just the essential elements of using this module are covered here with the assump-\ntion that you know what you’re doing when it comes to SSL configuration, keys, cer-\ntificates, and other related matters:\nwrap_socket(sock [, **opts])\nWraps an existing socket sock (created by the socket module) with SSL support and\nreturns an instance of SSLSocket.This function should be used before subsequent \nconnect() or accept() operations are made. opts represents a number of keyword\narguments that are used to specify additional configuration data.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2218,
      "extraction_method": "Direct"
    },
    {
      "page_number": 512,
      "chapter": null,
      "content": "487\nssl\nKeyword Argument\nDescription\nserver_side\nA Boolean flag that indicates whether or not the socket\nis operating as a server (True) or a client (False). By\ndefault, this is False.\nkeyfile\nThe key file used to identify the local side of the con-\nnection. This should be a PEM-format file and usually\nonly included if the file specified with the certfile\ndoesn’t include the key.\ncertfile\nThe certificate file used to identify the local side of the\nconnection. This should be a PEM-format file.\ncert_reqs\nSpecifies whether a certificate is required from the\nother side of the connection and whether or not it will\nbe validated. A value of CERT_NONE means that certifi-\ncates are ignored, CERT_OPTIONAL means that certifi-\ncates are not required but will be validated if given, and\nCERT_REQUIRED means that certificates are required\nand will be validated. If certificates are going to be vali-\ndated, the ca_certs parameter must also be given.\nca_certs\nFilename of the file holding certificate authority certifi-\ncates used for validation.\nssl_version\nSSL protocol version to use. Possible values are \nPROTOCOL_TLSv1, PROTOCOL_SSLv2,\nPROTOCOL_SSLv23, or PROTOCOL_SSLv3. The default\nprotocol is PROTOCOL_SSLv3.\ndo_handshake_on_connect\nBoolean flag that specifies whether or not the SSL\nhandshake is performed automatically on connect. By\ndefault, this is True.\nsuppress_ragged_eofs\nSpecifies how read() handles an unexpected EOF on\nthe connection. If True (the default), a normal EOF is\nsignaled. If False, an exception is raised. \nAn instance s of SSLSocket inherits from socket.socket and additionally supports\nthe following operations:\ns.cipher()\nReturns a tuple (name, version, secretbits) where name is the cipher name\nbeing used, version is the SSL protocol, and secretbits is the number of secret bits\nbeing used.\ns.do_handshake()\nPerforms the SSL handshake. Normally this is done automatically unless the \ndo_handshake_on_connect option was set to False in the wrap_socket() function.\nIf the underlying socket s is nonblocking, an SSLError exception will be raised if the\noperation couldn’t be completed.The e.args[0] attribute of an SSLError exception e\nwill have the value SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE depending on\nthe operation that needs to be performed.To continue the handshake process once\nreading or writing can continue, simply call s.do_handshake() again.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2412,
      "extraction_method": "Direct"
    },
    {
      "page_number": 513,
      "chapter": null,
      "content": "488\nChapter 21 Network Programming and Sockets\ns.getpeercert([binary_form])\nReturns the certificate from the other end of the connection, if any. If there is no cer-\ntificate None is returned. If there was a certificate but it wasn’t validated, an empty dic-\ntionary is returned. If a validated certificate is received, a dictionary with the keys \n'subject' and 'notAfter' is returned. If binary_form is set True, the certificate is\nreturned as a DER-encoded byte sequence.\ns.read([nbytes])\nReads up to nbytes of data and returns it. If nbytes is omitted, up to 1,024 bytes are\nreturned.\ns.write(data)\nWrites the byte string data. Returns the number of bytes written.\ns.unwrap()\nShuts down the SSL connection and returns the underlying socket object on which\nfurther unencrypted communication can be carried out.\nThe following utility functions are also defined by the module:\ncert_time_to_seconds(timestring)\nConverts a string timestring from the format used in certificates to a floating-point\nnumber as compatible with the time.time() function.\nDER_cert_to_PEM_cert(derbytes)\nGiven a byte string derbytes containing a DER-encoded certificate, returns a PEM-\nencoded string version of the certificate.\nPEM_cert_to_DER_cert(pemstring)\nGiven a string pemstring containing a PEM-encoded string version of a certificate,\nreturns a DER-encoded byte string version of the certificate.\nget_server_certificate(addr [, ssl_version [, ca_certs]])\nRetrieves the certificate of an SSL server and returns it as a PEM-encoded string. addr\nis an address of the form (hostname, port). ssl_version is the SSL version num-\nber, and ca_certs is the name of a file containing certificate authority certificates as\ndescribed for the wrap_socket() function.\nRAND_status()\nReturns True or False if the SSL layer thinks that the pseudorandom number genera-\ntor has been seeded with enough randomness.\nRAND_egd(path)\nReads 256 bytes of randomness from an entropy-gathering daemon and adds it to the\npseudorandom number generator. path is the name of a UNIX-domain socket for the\ndaemon.\nRAND_add(bytes, entropy)\nAdds the bytes in byte string bytes into the pseudorandom number generator.\nentropy is a nonnegative floating-point number giving the lower bound on the\nentropy.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2273,
      "extraction_method": "Direct"
    },
    {
      "page_number": 514,
      "chapter": null,
      "content": "489\nSocketServer\nExamples\nThe following example shows how to use this module to open an SSL-client \nconnection:\nimport socket, ssl\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nssl_s = ssl.wrap_socket(s)\nssl_s.connect(('gmail.google.com',443))\nprint(ssl_s.cipher())\n# Send a request\nssl_s.write(b\"GET / HTTP/1.0\\r\\n\\r\\n\")\n# Get the response\nwhile True:\ndata = ssl_s.read()\nif not data: break\nprint(data)\nssl_s.close()\nHere is an example of an SSL-secured time server:\nimport socket, ssl, time\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\ns.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR,1)\ns.bind(('',12345))\ns.listen(5)\nwhile True:\nclient, addr = s.accept()      # Get a connection\nprint \"Connection from\", addr\nclient_ssl = ssl.wrap_socket(client,\nserver_side=True,\ncertfile=\"timecert.pem\")\nclient_ssl.sendall(b\"HTTP/1.0 200 OK\\r\\n\")\nclient_ssl.sendall(b\"Connection: Close\\r\\n\")\nclient_ssl.sendall(b\"Content-type: text/plain\\r\\n\\r\\n\")\nresp = time.ctime() + \"\\r\\n\"\nclient_ssl.sendall(resp.encode('latin-1'))\nclient_ssl.close()\nclient.close()\nIn order to run this server, you will need to have a signed server certificate in the file\ntimecert.pem. For the purposes of testing, you can create one using this UNIX \ncommand:\n% openssl req –new –x509 –days 30 –nodes –out timecert.pem –keyout timecert.pem\nTo test this server, try connecting with a browser using a URL such as\n'https://localhost:1234'. If it works, the browser will issue a warning message\nabout you using a self-signed certificate. If you agree, you should see the output of the\nserver.\nSocketServer\nThis module is called socketserver in Python 3.The SocketServer module pro-\nvides classes that simplify the implementation of TCP, UDP, and UNIX domain socket\nservers.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1774,
      "extraction_method": "Direct"
    },
    {
      "page_number": 515,
      "chapter": null,
      "content": "490\nChapter 21 Network Programming and Sockets\nHandlers\nTo use the module, you define a handler class that inherits from the base class\nBaseRequestHandler.An instance h of BaseRequestHandler implements one or\nmore of the following methods:\nh.finish()\nCalled to perform cleanup actions after the handle() method has completed. By\ndefault, it does nothing. It’s not called if either the setup() or handle() method gen-\nerates an exception.\nh.handle()\nThis method is called to perform the actual work of a request. It’s called with no argu-\nments, but several instance variables contain useful values. h.request contains the\nrequest, h.client_address contains the client address, and h.server contains an\ninstance of the server that called the handler. For stream services such as TCP, the\nh.request attribute is a socket object. For datagram services, it’s a byte string contain-\ning the received data.\nh.setup()\nThis method is called before the handle() method to perform initialization actions. By\ndefault, it does nothing. If you wanted a server to implement further connection setup\nsuch as establishing a SSL connection, you could implement it here.\nHere is an example of a handler class that implements a simple time server that\noperates with streams or datagrams:\ntry:\nfrom socketserver import BaseRequestHandler   # Python 3\nexcept ImportError:\nfrom SocketServer import BaseRequestHandler   # Python 2\nimport socket\nimport time\nclass TimeServer(BaseRequestHandler):\ndef handle(self):\nresp = time.ctime() + \"\\r\\n\"\nif isinstance(self.request,socket.socket):\n# A stream-oriented connection\nself.request.sendall(resp.encode('latin-1'))\nelse:\n# A datagram-oriented connection\nself.server.socket.sendto(resp.encode('latin-1'),self.client_address)\nIf you know that a handler is only going to operate on stream-oriented connections\nsuch as TCP, have it inherit from StreamRequestHandler instead of\nBaseRequestHandler.This class sets two attributes: h.wfile is a file-like object that\nwrites data to the client, and h.rfile is a file-like object that reads data from the\nclient. Here is an example:\ntry:\nfrom socketserver import StreamRequestHandler   # Python 3\nexcept ImportError:\nfrom SocketServer import StreamRequestHandler   # Python 2\nimport time\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2273,
      "extraction_method": "Direct"
    },
    {
      "page_number": 516,
      "chapter": null,
      "content": "491\nSocketServer\nclass TimeServer(StreamRequestHandler):\ndef handle(self):\nresp = time.ctime() + \"\\r\\n\"\nself.wfile.write(resp.encode('latin-1'))\nIf you are writing a handler that only operates with packets and always sends a response\nback to the sender, have it inherit from DatagramRequestHandler instead of\nBaseRequestHandler. It provides the same file-like interface as\nStreamRequestHandler. For example:\ntry:\nfrom socketserver import DatagramRequestHandler  # Python 3\nexcept ImportError:\nfrom SocketServer import DatagramRequestHandler  # Python 2\nimport time\nclass TimeServer(DatagramRequestHandler):\ndef handle(self):\nresp = time.ctime() + \"\\r\\n\"\nself.wfile.write(resp.encode('latin-1')\nIn this case, all of the data written to self.wfile is collected into a single packet that\nis returned after the handle() method returns.\nServers\nTo use a handler, it has to be plugged into a server object.There are four basic server\nclasses defined:\nTCPServer(address, handler)\nA server supporting the TCP protocol using IPv4. address is a tuple of the form\n(host, port). handler is an instance of a subclass of the BaseRequestHandler class\ndescribed later.\nUDPServer(address, handler)\nA server supporting the Internet UDP protocol using IPv4. address and handler are\nthe same as for TCPServer().\nUnixStreamServer(address, handler)\nA server implementing a stream-oriented protocol using UNIX domain sockets.\nInherits from TCPServer.\nUnixDatagramServer(address, handler)\nA server implementing a datagram protocol using UNIX domain sockets.This inherits\nfrom UDPServer.\nInstances of all four server classes have the following basic methods:\ns.fileno()\nReturns the integer file descriptor for the server socket.The presence of this method\nmakes it legal to use server instances with polling operations such as the select()\nfunction.\ns.serve_forever()\nHandles an infinite number of requests.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1905,
      "extraction_method": "Direct"
    },
    {
      "page_number": 517,
      "chapter": null,
      "content": "492\nChapter 21 Network Programming and Sockets\ns.shutdown()\nStops the serve_forever() loop.\nThe following attributes give some basic information about the configuration of a\nrunning server:\ns.RequestHandlerClass\nThe user-provided request handler class that was passed to the server constructor.\ns.server_address\nThe address on which the server is listening, such as the tuple ('127.0.0.1', 80).\ns.socket\nThe socket object being used for incoming requests.\nHere is an example of running the TimeHandler as a TCP server:\nfrom SocketServer import TCPServer\nserv = TCPServer(('',10000,TimeHandler)\nserv.serve_forever()\nHere is an example of running the handler as a UDP server:\nfrom SocketServer import UDPServer\nserv = UDPServer(('',10000,TimeHandler)\nserv.serve_forever()\nA key aspect of the SocketServer module is that handlers are decoupled from servers.\nThat is, once you have written a handler, you can plug it into many different kinds of\nservers without having to change its implementation.\nDefining Customized Servers\nServers often need special configuration to account for different network address fami-\nlies, timeouts, concurrency, and other features.This customization is carried out by\ninheriting from one of the four basic servers described in the previous section.The fol-\nlowing class attributes can be defined to customize basic settings of the underlying net-\nwork socket:\nServer.address_family\nThe address family used by the server socket.The default value is socket.AF_INET.\nUse socket.AF_INET6 if you want to use IPv6.\nServer.allow_reuse_address\nA Boolean flag that indicates whether or not a socket should reuse an address.This is\nuseful when you want to immediately restart a server on the same port after a program\nhas terminated (otherwise, you have to wait a few minutes).The default value is False.\nServer.request_queue_size\nThe size of the request queue that’s passed to the socket’s listen() method.The\ndefault value is 5.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1971,
      "extraction_method": "Direct"
    },
    {
      "page_number": 518,
      "chapter": null,
      "content": "493\nSocketServer\nServer.socket_type\nThe socket type used by the server, such as socket.SOCK_STREAM or\nsocket.SOCK_DGRAM.\nServer.timeout\nTimeout period in seconds that the server waits for a new request. On timeout, the\nserver calls the handle_timeout() method (described below) and goes back to wait-\ning.This timeout is not used to set a socket timeout. However, if a socket timeout has\nbeen set, its value is used instead of this value.\nHere is an example of how to create a server that allows the port number to be\nreused:\nfrom SocketServer import TCPServer\nclass TimeServer(TCPServer):\nallow_reuse_address = True\nserv = TimeServer(('',10000,TimeHandler)\nserv.serve_forever()\nIf desired, the following methods are most useful to extend in classes that inherit from\none of the servers. If you define any of these methods in your own server, make sure\nyou call the same method in the superclass.\nServer.activate()\nMethod that carries out the listen() operation on the server.The server socket is ref-\nerenced as self.socket.\nServer.bind()\nMethod that carries out the bind() operation on the server.\nServer.handle_error(request, client_address)\nMethod that handles uncaught exceptions that occur in handling.To get information\nabout the last exception, use sys.exc_info() or functions in the traceback module.\nServer.handle_timeout()\nMethod that is called when the server timeout occurs. By redefining this method and\nadjusting the timeout setting, you can integrate other processing into the server event\nloop.\nServer.verify_request(request, client_address)\nRedefine this method if you want to verify the connection before any further process-\ning.This is what you define if you wanted to implement a firewall or perform some\nother kind of a validation.\nFinally, addition server features are available through the use of mixin classes.This is\nhow concurrency via threads or processing forking is added.The following classes are\ndefined for this purpose:\nForkingMixIn\nA mixin class that adds UNIX process forking to a server, allowing it to serve multiple\nclients.The class variable max_children controls the maximum number of child\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2155,
      "extraction_method": "Direct"
    },
    {
      "page_number": 519,
      "chapter": null,
      "content": "494\nChapter 21 Network Programming and Sockets\nprocesses, and the timeout variable determines how much time elapses between\nattempts to collect zombie processes.An instance variable active_children keeps\ntrack of how many active processes are running.\nThreadingMixIn\nA mixin class that modifies a server so that it can serve multiple clients with threads.\nThere is no limit placed on the number of threads that can be created. By default,\nthreads are non-daemonic unless the class variable daemon_threads is set to True.\nTo add these features to a server, you use multiple inheritance where the mixin class\nis listed first. For example, here is a forking time server:\nfrom SocketServer import TCPServer, ForkingMixIn\nclass TimeServer(ForkingMixIn, TCPServer):\nallow_reuse_address = True\nmax_children = 10\nserv = TimeServer(('',10000,TimeHandler)\nserv.serve_forever()\nSince concurrent servers are relatively common, the SocketServer predefines the fol-\nlowing server classes for this purpose.\nn ForkingUDPServer(address, handler)\nn ForkingTCPServer(address, handler)\nn ThreadingUDPServer(address, handler)\nn ThreadingTCPServer(address, handler)\nThese classes are actually just defined in terms of the mixins and server classes. For\nexample, here is the definition of ForkingTCPServer:\nclass ForkingTCPServer(ForkingMixIn, TCPServer): pass\nCustomization of Application Servers\nOther library modules often use the SocketServer class to implement servers for\napplication-level protocols such as HTTP and XML-RPC.Those servers can also be\ncustomized via inheritance and extending the methods defined for basic server opera-\ntion. For example, here is a forking XML-RPC server that only accepts connections\noriginating on the loopback interface:\ntry:\nfrom xmlrpc.server import SimpleXMLRPCServer        # Python 3\nfrom socketserver import ForkingMixIn\nexcept ImportError:                                      # Python 2\nfrom SimpleXMLRPCServer import SimpleXMLRPCServer\nfrom SocketServer import ForkingMixIn\nclass MyXMLRPCServer(ForkingMixIn,SimpleXMLRPCServer):\ndef verify_request(self, request, client_address):\nhost, port = client_address\nif host != '127.0.0.1':\nreturn False\nreturn SimpleXMLRPCServer.verify_request(self,request,client_address)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2265,
      "extraction_method": "Direct"
    },
    {
      "page_number": 520,
      "chapter": null,
      "content": "495\nSocketServer\n# Sample use\ndef add(x,y):\nreturn x+y\nserver = MyXMLRPCServer((\"\",45000))\nserver.register_function(add)\nserver.serve_forever()\nTo test this, you will need to use the xmlrpclib module. Run the previous server and\nthen start a separate Python process:\n>>> import xmlrpclib\n>>> s = xmlrpclib.ServerProxy(\"http://localhost:45000\")\n>>> s.add(3,4)\n7\n>>>\nTo test the rejection of connections, try the same code, but from a different machine on\nthe network. For this, you will need to replace “localhost” with the hostname of the\nmachine that’s running the server.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 596,
      "extraction_method": "Direct"
    },
    {
      "page_number": 521,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 522,
      "chapter": null,
      "content": "22\nInternet Application\nProgramming\nThis chapter describes modules related to Internet application protocols including\nHTTP, XML-RPC, FTP, and SMTP.Web programming topics such as CGI scripting\nare covered in Chapter 23,“Web Programming.” Modules related to dealing with com-\nmon Internet-related data formats are covered in Chapter 24,“Internet Data Handling\nand Encoding.”\nThe organization of network-related library modules is one area where there are sig-\nnificant differences between Python 2 and 3. In the interest of looking forward, this\nchapter assumes the Python 3 library organization because it is more logical. However,\nthe functionality provided by the library modules is virtually identical between Python\nversions as of this writing.When applicable, Python 2 module names are noted in each\nsection.\nftplib\nThe ftplib module implements the client side of the FTP protocol. It’s rarely neces-\nsary to use this module directly because the urllib package provides a higher-level\ninterface. However, this module may still be useful if you want to have more control\nover the low-level details of an FTP connection. In order to use this module, it may be\nhelpful to know some of the details of the FTP protocol which is described in Internet\nRFC 959.\nA single class is defined for establishing an FTP connection:\nFTP([host [, user [, passwd [, acct [, timeout]]]]])\nCreates an object representing an FTP connection. host is a string specifying a host\nname. user, passwd, and acct optionally specify a username, password, and account. If\nno arguments are given, the connect() and login() methods must be called explicitly\nto initiate the actual connection. If host is given, connect() is automatically invoked.\nIf user, passwd, and acct are given, login() is invoked. timeout is a timeout period\nin seconds.\nAn instance f of FTP has the following methods:\nf.abort()\nAttempts to abort a file transfer that is in progress.This may or may not work depend-\ning the remote server.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2005,
      "extraction_method": "Direct"
    },
    {
      "page_number": 523,
      "chapter": null,
      "content": "498\nChapter 22 Internet Application Programming\nf.close()\nCloses the FTP connection.After this has been invoked, no further operations can be\nperformed on the FTP object f.\nf.connect(host [, port [, timeout]])\nOpens an FTP connection to a given host and port. host is a string specifying the host\nname. port is the integer port number of the FTP server and defaults to port 21.\ntimeout is the timeout period in seconds. It is not necessary to call this if a host name\nwas already given to FTP().\nf.cwd(pathname)\nChanges the current working directory on the server to pathname.\nf.delete(filename)\nRemoves the file filename from the server.\nf.dir([dirname [, ... [, callback]]])\nGenerates a directory listing as produced by the 'LIST' command. dirname optionally\nsupplies the name of a directory to list. In addition, if any additional arguments are sup-\nplied, they are simply passed as additional arguments to 'LIST’. If the last argument\ncallback is a function, it is used as a callback function to process the returned directo-\nry listing data.This callback function works in the same way as the callback used by the\nretrlines() method. By default, this method prints the directory list to sys.stdout.\nf.login([user, [passwd [, acct]]])\nLogs in to the server using the specified username, password, and account. user is a\nstring giving the username and defaults to 'anonymous'. passwd is a string containing\nthe password and defaults to the empty string ''. acct is a string and defaults to the\nempty string. It is not necessary to call this method if this information was already given\nto FTP().\nf.mkd(pathname)\nCreates a new directory on the server.\nf.ntransfercmd(command [, rest])\nThe same as transfercmd() except that a tuple (sock, size) is returned where\nsock is a socket object corresponding to the data connection and size is the expected\nsize of the data in bytes, or None if the size could not be determined.\nf.pwd()\nReturns a string containing the current working directory on the server.\nf.quit()\nCloses the FTP connection by sending the 'QUIT' command to the server.\nf.rename(oldname,newname)\nRenames a file on the server.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2161,
      "extraction_method": "Direct"
    },
    {
      "page_number": 524,
      "chapter": null,
      "content": "499\nftplib\nf.retrbinary(command, callback [, blocksize [, rest]])\nReturns the results of executing a command on the server using binary transfer mode.\ncommand is a string that specifies the appropriate file retrieval command and is almost\nalways 'RETR filename'. callback is a callback function that is invoked each time a\nblock of data is received.This callback function is invoked with a single argument\nwhich is the received data in the form of a string. blocksize is the maximum block\nsize to use and defaults to 8192 bytes. rest is an optional offset into the file. If supplied,\nthis specifies the position in the file where you want to start the transfer. However, this\nis not supported by all FTP servers so this may result in an error_reply exception.\nf.retrlines(command [, callback])\nReturns the results of executing a command on the server using text transfer mode.\ncommand is a string that specifies the command and is usually something like 'RETR\nfilename’. callback is a callback function that is invoked each time a line of data is\nreceived.This callback function is called with a single argument which is a string con-\ntaining the received data. If callback is omitted, the returned data is printed to\nsys.stdout.\nf.rmd(pathname)\nRemoves a directory from the server.\nf.sendcmd(command)\nSends a simple command to the server and returns the server response. command is a\nstring containing the command.This method should only be used for commands that\ndon’t involve the transfer of data.\nf.set_pasv(pasv)\nSets passive mode. pasv is a Boolean flag that turns passive mode on if True or off if\nFalse. By default, passive mode is on.\nf.size(filename)\nReturns the size of filename in bytes. Returns None if the size can’t be determined for\nsome reason.\nf.storbinary(command, file [, blocksize])\nExecutes a command on the server and transmits data using binary transfer mode.\ncommand is a string that specifies the low-level command. It is almost always set to\n'STOR filename', where filename is the name of a file you want to place on the\nserver. file is an open file-object from which data will be read using\nfile.read(blocksize) and transferred to the server. blocksize is the blocksize to\nuse in the transfer. By default, it is 8192 bytes.\nf.storlines(command, file)\nExecutes a command on the server and transfers data using text transfer mode. command\nis a string which specifies the low-level command. It is usually 'STOR filename'.\nfile is an open file-object from which data will be read using file.readline() and\nsent to the server.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2572,
      "extraction_method": "Direct"
    },
    {
      "page_number": 525,
      "chapter": null,
      "content": "500\nChapter 22 Internet Application Programming\nf.transfercmd(command [, rest])\nInitiates a transfer over the FTP data connection. If active mode is being used, this sends\na 'PORT' or 'EPRT' command and accepts the resulting connection from the server. If\npassive mode is being used, this sends a 'EPSV' or 'PASV' command followed by a\nconnection to the server. In either case, once the data connection has been established,\nthe FTP command in command is then issued.This function returns a socket object cor-\nresponding to the open data connection.The optional rest parameter specifies a start-\ning byte offset into files requested on the server. However, this is not supported on all\nservers and could result in an error_reply exception.\nExample\nThe following example shows how to use this module to upload a file to a FTP server:\nhost     = \"ftp.foo.com\"\nusername = \"dave\"\npassword = \"1235\"\nfilename = \"somefile.dat\"\nimport ftplib\nftp_serv = ftplib.FTP(host,username,password)\n# Open the file you want to send\nf = open(filename,\"rb\")\n# Send it to the FTP server\nresp = ftp_serv.storbinary(\"STOR \"+filename, f)\n# Close the connection\nftp_serv.close\nTo fetch documents from an FTP server, use the urllib package. For example:\ntry:\nfrom urllib.request import urlopen   # Python 3\nexcept ImportError:\nfrom urllib2 import urlopen          # Python 2\nu = urlopen(\"ftp://username:password@somehostname/somefile\")\ncontents = u.read()\nhttp Package\nThe http package consists of modules for writing HTTP clients and servers as well as\nsupport for state management (cookies).The Hypertext Transfer Protocol (HTTP) is a\nsimple text-based protocol that works as follows:\n1. A client makes a connection to an HTTP server and sends a request header of\nthe following form:\nGET /document.html HTTP/1.0\nConnection: Keep-Alive\nUser-Agent: Mozilla/4.61 [en] (X11; U; SunOS 5.6 sun4u)\nHost: rustler.cs.uchicago.edu:8000\nAccept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*\nAccept-Encoding: gzip\nAccept-Language: en\nAccept-Charset: iso-8859-1,*,utf-8\nOptional data\n...\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2094,
      "extraction_method": "Direct"
    },
    {
      "page_number": 526,
      "chapter": null,
      "content": "501\nhttp package\nThe first line defines the request type, document (the selector), and protocol ver-\nsion. Following the request line is a series of header lines containing various\ninformation about the client, such as passwords, cookies, cache preferences, and\nclient software. Following the header lines, a single blank line indicates the end of\nthe header lines.After the header, data may appear in the event that the request is\nsending information from a form or uploading a file. Each of the lines in the\nheader should be terminated by a carriage return and a newline ('\\r\\n').\n2. The server sends a response of the following form:\nHTTP/1.0  200  OK\nContent-type: text/html\nContent-length:  72883 bytes\n...\nHeader: data\nData\n...\nThe first line of the server response indicates the HTTP protocol version, a suc-\ncess code, and a return message. Following the response line is a series of header\nfields that contain information about the type of the returned document, the\ndocument size, web server software, cookies, and so forth.The header is terminat-\ned by a single blank line followed by the raw data of the requested document.\nThe following request methods are the most common:\nMethod\nDescription\nGET\nGet a document.\nPOST\nPost data to a form.\nHEAD\nReturn header information only.\nPUT\nUpload data to the server.\nThe response codes detailed in Table 22.1 are most commonly returned by servers.The\nSymbolic Constant column is the name of a predefined variable in http.client that\nholds the integer response code value and which can be used in code to improve read-\nability.\nTable 22.1\nResponse Codes Commonly Returned by Servers\nCode\nDescription\nSymbolic Constant\nSuccess Codes (2xx)\n200\nOK\nOK\n201\nCreated\nCREATED\n202\nAccepted\nACCEPTED\n204\nNo content\nNO_CONTENT\nRedirection (3xx)\n300\nMultiple choices\nMULTIPLE_CHOICES\n301\nMoved permanently\nMOVED_PERMANENTLY\n302\nMoved temporarily\nMOVED_TEMPORARILY\n303\nNot modified\nNOT_MODIFIED\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1956,
      "extraction_method": "Direct"
    },
    {
      "page_number": 527,
      "chapter": null,
      "content": "502\nChapter 22 Internet Application Programming\nTable 22.1\nContinued\nCode\nDescription\nSymbolic Constant\nClient Error (4xx)\n400\nBad request\nBAD_REQUEST\n401\nUnauthorized\nUNAUTHORIZED\n403\nForbidden\nFORBIDDEN\n404\nNot found\nNOT_FOUND\nServer Error (5xx)\n500\nInternal server error\nINTERNAL_SERVER_ERROR\n501\nNot implemented\nNOT_IMPLEMENTED\n502\nBad gateway\nBAD_GATEWAY\n503\nService unavailable\nSERVICE_UNAVAILABLE\nThe headers that appear in both requests and responses are encoded in a format widely\nknown as RFC-822.Then general form of each header is Headername: data,\nalthough further details can be found in the RFC. It is almost never necessary to parse\nthese headers as Python usually does it for you when applicable.\nhttp.client (httplib)\nThe http.client module provides low-level support for the client side of HTTP. In\nPython 2, this module is called httplib. Use functions in the urllib package instead.\nThe module supports both HTTP/1.0 and HTTP/1.1 and additionally allows connec-\ntions via SSL if Python is built with OpenSSL support. Normally, you do not use this\npackage directly; instead, you should consider using the urllib package. However,\nbecause HTTP is such an important protocol, you may encounter situations where you\nneed to work with the low-level details in a way that urllib cannot easily address—for\nexample, if you wanted to send requests with commands other than GET or POST. For\nmore details about HTTP, consult RFC 2616 (HTTP/1.1) and RFC 1945\n(HTTP/1.0).\nThe following classes can be used to establish an HTTP connection with a server:\nHTTPConnection(host [,port])\nCreates an HTTP connection. host is the host name, and port is the remote port\nnumber.The default port is 80. Returns an HTTPConnection instance.\nHTTPSConnection(host [, port [, key_file=kfile [, cert_file=cfile ]]])\nCreates an HTTP connection but uses a secure socket.The default port is 443.\nkey_file and cert_file are optional keyword arguments that specify client PEM-\nformatted private-key and certificate chain files, should they be needed for client\nauthentication. However, no validation of server certificates is performed. Returns an\nHTTPSConnection instance.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2182,
      "extraction_method": "Direct"
    },
    {
      "page_number": 528,
      "chapter": null,
      "content": "503\nhttp package\nAn instance, h, of HTTPConnection or HTTPSConnection supports the following\nmethods:\nh.connect()\nInitializes the connection to the host and port given to HTTPConnection() or\nHTTPSConnection(). Other methods call this automatically if a connection hasn’t been\nmade yet.\nh.close()\nCloses the connection.\nh.send(bytes)\nSends a byte string, bytes, to the server. Direct use of this function is discouraged\nbecause it may break the underlying response/request protocol. It’s most commonly\nused to send data to the server after h.endheaders() has been called.\nh.putrequest(method, selector [, skip_host [, skip_accept_encoding]])\nSends a request to the server. method is the HTTP method, such as 'GET' or 'POST'.\nselector specifies the object to be returned, such as '/index.html'.The skip_host\nand skip_accept_encoding parameters are flags that disable the sending of Host: and\nAccept-Encoding: headers in the HTTP request. By default, both of these arguments\nare False. Because the HTTP/1.1 protocol allows multiple requests to be sent over a\nsingle connection, a CannotSendRequest exception may be raised if the connection is\nin a state that prohibits new requests from being issued.\nh.putheader(header, value, ...)\nSends an RFC-822–style header to the server. It sends a line to the server, consisting of\nthe header, a colon and a space, and the value.Additional arguments are encoded as\ncontinuation lines in the header. Raises a CannotSendHeader exception if h is not in a\nstate that allows headers to be sent.\nh.endheaders()\nSends a blank line to the server, indicating the end of the header lines.\nh.request(method, url [, body [, headers]])\nSends a complete HTTP request to the server. method and url have the same meaning\nas for h.putrequest(). body is an optional string containing data to upload to the\nserver after the request has been sent. If body is supplied, the Context-length: header\nwill automatically be set to an appropriate value. headers is a dictionary containing\nheader:value pairs to be given to the h.putheader() method.\nh.getresponse()\nGets a response from the server and returns an HTTPResponse instance that can be used\nto read data. Raises a ResponseNotReady exception if h is not in a state where a\nresponse would be received.\nAn HTTPResponse instance, r, as returned by the getresponse() method, supports\nthe following methods:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2395,
      "extraction_method": "Direct"
    },
    {
      "page_number": 529,
      "chapter": null,
      "content": "504\nChapter 22 Internet Application Programming\nr.read([size])\nReads up to size bytes from the server. If size is omitted, all the data for this request\nis returned.\nr.getheader(name [,default])\nGets a response header. name is the name of the header. default is the default value to\nreturn if the header is not found.\nr.getheaders()\nReturns a list of (header, value) tuples.\nAn HTTPResponse instance r also has the following attributes:\nr.version\nHTTP version used by the server.\nr.status\nHTTP status code returned by the server.\nr.reason\nHTTP error message returned by the server.\nr.length\nNumber of bytes left in the response.\nExceptions\nThe following exceptions may be raised in the course of handling HTTP connections:\nException\nDescription\nHTTPException\nBase class of all HTTP-related errors.\nNotConnected\nRequest was made but not connected.\nInvalidURL\nBad URL or port number given.\nUnknownProtocol\nUnknown HTTP protocol number.\nUnknownTransferEncoding\nUnknown transfer encoding.\nUnimplementedFileMode\nUnimplemented file mode.\nIncompleteRead\nIncomplete data received.\nBadStatusLine\nUnknown status code received.\nThe following exceptions are related to the state of HTTP/1.1 connections. Because\nHTTP/1.1 allows multiple requests/responses to be sent over a single connection, extra\nrules are imposed as to when requests can be sent and responses received. Performing\noperations in the wrong order will generate an exception.\nException\nDescription\nImproperConnectionState\nBase class of all HTTP-connection state errors.\nCannotSendRequest\nCan’t send a request.\nCannotSendHeader\nCan’t send headers.\nResponseNotReady\nCan’t read a response.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1663,
      "extraction_method": "Direct"
    },
    {
      "page_number": 530,
      "chapter": null,
      "content": "505\nhttp package\nExample\nThe following example shows how the HTTPConnection class can be used to perform\na memory-efficient file upload to a server using a POST request—something that is not\neasily accomplished within the urllib framework.\nimport os\ntry:\nfrom httplib import HTTPConnection      # Python 2\nexcept ImportError:\nfrom http.client import HTTPConnection  # Python 3\nBOUNDARY = \"$Python-Essential-Reference$\"\nCRLF     = '\\r\\n'\ndef upload(addr, url, formfields, filefields):\n# Create the sections for form fields\nformsections = []\nfor name in formfields:\nsection = [\n'--'+BOUNDARY,\n'Content-disposition: form-data; name=\"%s\"' % name,\n'',\nformfields[name]\n]\nformsections.append(CRLF.join(section)+CRLF)\n# Collect information about all of the files to be uploaded\nfileinfo = [(os.path.getsize(filename), formname, filename)\nfor formname, filename in filefields.items()]\n# Create the HTTP headers for each file\nfilebytes = 0\nfileheaders = []\nfor filesize, formname,filename in fileinfo:\nheaders = [\n'--'+BOUNDARY,\n'Content-Disposition: form-data; name=\"%s\"; filename=\"%s\"' % \\\n(formname, filename),\n'Content-length: %d' % filesize,\n''\n]\nfileheaders.append(CRLF.join(headers)+CRLF)\nfilebytes += filesize\n# Closing marker\nclosing = \"--\"+BOUNDARY+\"--\\r\\n\"\n# Determine the entire length of the request\ncontent_size = (sum(len(f) for f in  formsections) + \nsum(len(f) for f in  fileheaders) + \nfilebytes+len(closing))\n# Upload it\nconn = HTTPConnection(*addr)\nconn.putrequest(\"POST\",url)\nconn.putheader(\"Content-type\", 'multipart/form-data; boundary=%s' % BOUNDARY)\nconn.putheader(\"Content-length\", str(content_size))\nconn.endheaders()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1658,
      "extraction_method": "Direct"
    },
    {
      "page_number": 531,
      "chapter": null,
      "content": "506\nChapter 22 Internet Application Programming\n# Send all form sections\nfor s in formsections:\nconn.send(s.encode('latin-1'))\n# Send all files\nfor head,filename in zip(fileheaders,filefields.values()):\nconn.send(head.encode('latin-1'))\nf = open(filename,\"rb\")\nwhile True:\nchunk = f.read(16384)\nif not chunk: break\nconn.send(chunk)\nf.close()\nconn.send(closing.encode('latin-1'))\nr = conn.getresponse()\nresponsedata = r.read()\nconn.close()\nreturn responsedata\n# Sample: Upload some files.  The form fields 'name', 'email'\n# 'file_1','file_2', and so forth are what the remote server\n# is expecting (obviously this will vary).\nserver      = ('localhost', 8080)\nurl         = '/cgi-bin/upload.py'\nformfields = {\n'name' : 'Dave',\n'email' : 'dave@dabeaz.com'\n}\nfilefields = {\n'file_1' : 'IMG_1008.JPG',\n'file_2' : 'IMG_1757.JPG'\n}\nresp = upload(server, url,formfields,filefields)\nprint(resp)\nhttp.server (BaseHTTPServer, CGIHTTPServer,\nSimpleHTTPServer)\nThe http.server module provides various classes for implementing HTTP servers. In\nPython 2, the contents of this module are split across three library modules:\nBaseHTTPServer, CGIHTTPServer, and SimpleHTTPServer.\nHTTPServer\nThe following class implements a basic HTTP server. In Python 2, it is located in the\nBaseHTTPServer module.\nHTTPServer(server_address, request_handler)\nCreates a new HTTPServer object. server_address is a tuple of the form (host,\nport) on which the server will listen. request_handler is a handler class derived\nfrom BaseHTTPRequestHandler, which is described later.\nHTTPServer inherits directly from TCPServer defined in the socketserver mod-\nule.Thus, if you want to customize the operation of the HTTP server in any way, you\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1724,
      "extraction_method": "Direct"
    },
    {
      "page_number": 532,
      "chapter": null,
      "content": "507\nhttp package\ninherit from HTTPServer and extend it. Here is how you would define a multithreaded\nHTTP server that only accepts connections from a specific subnet:\ntry:\nfrom http.server import HTTPServer         # Python 3\nfrom socketserver import ThreadingMixIn\nexcept ImportError:\nfrom BaseHTTPServer import HTTPServer      # Python 2\nfrom SocketServer import ThreadingMixIn\nclass MyHTTPServer(ThreadingMixIn,HTTPServer):\ndef _ _init_ _(self,addr,handler,subnet):\nHTTPServer._ _init_ _(self,addr,handler)\nself.subnet = subnet\ndef verify_request(self, request, client_address):\nhost, port = client_address\nif not host.startswith(subnet):\nreturn False\nreturn HTTPServer.verify_request(self,request,client_address)\n# Example of how the server runs\nserv = MyHTTPServer(('',8080), SomeHandler, '192.168.69.')\nserv.serve_forever()\nThe HTTPServer class only deals with the low-level HTTP protocol.To get the server\nto actually do anything, you have to supply a handler class.There are two built-in han-\ndlers and a base class that can be used for defining your own custom handling.These are\ndescribed next.\nSimpleHTTPRequestHandler and CGIHTTPRequestHandler\nTwo prebuilt web server handler classes can be used if you want to quickly set up a\nsimple stand-alone web server.These classes operate independently of any third-party\nweb server such as Apache.\nCGIHTTPRequestHandler(request, client_address, server)\nServes files from the current directory and all its subdirectories. In addition, the handler\nwill run a file as a CGI script if it’s located in a special CGI directory (defined by the\ncgi_directories class variable which is set to ['/cgi-bin', '/htbin'] by\ndefault).The handler supports GET, HEAD, and POST methods. However, it does not sup-\nport HTTP redirects (HTTP code 302), which limits its use to only more simple CGI\napplications. For security purposes, CGI scripts are executed with a UID of nobody. In\nPython 2, this class is defined in the CGIHTTPServer module.\nSimpleHTTPRequestHandler(request, client_address, server)\nServes files from the current directory and all its subdirectories.The class provides sup-\nport for HEAD and GET requests, respectively.All IOError exceptions result in a \"404\nFile not found\" error.Attempts to access a directory result in a \"403 Directory\nlisting not supported\" error. In Python 2, this class is defined in the\nSimpleHTTPServer module.\nBoth of these handlers define the following class variables that can be changed via\ninheritance if desired:\nhandler.server_version\nServer version string returned to clients. By default, this is set to a string such as\n'SimpleHTTP/0.6'.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2648,
      "extraction_method": "Direct"
    },
    {
      "page_number": 533,
      "chapter": null,
      "content": "508\nChapter 22 Internet Application Programming\nhandler.extensions_map\nA dictionary mapping suffixes to MIME types. Unrecognized file types are considered\nto be of type 'application/octet-stream'.\nHere is an example of using these handler classes to run a stand-alone web server\ncapable of running CGI scripts:\ntry:\nfrom http.server import HTTPServer, CGIHTTPRequestHandler  # Python 3\nexcept ImportError:\nfrom BaseHTTPServer import HTTPServer             # Python 2\nfrom CGIHTTPServer import CGIHTTPRequestHandler\nimport os\n# Change to the document root\nos.chdir(\"/home/httpd/html\")\n# Start the CGIHTTP server on port 8080\nserv = HTTPServer((\"\",8080),CGIHTTPRequestHandler)\nserv.serve_forever()\nBaseHTTPRequestHandler\nThe BaseHTTPRequestHandler class is a base class that’s used if you want to \ndefine your own custom HTTP server handling.The prebuilt handlers such as\nSimpleHTTPRequestHandler and CGIHTTPRequestHandler inherit from this. In\nPython 2, this class is defined in the BaseHTTPServer module.\nBaseHTTPRequestHandler(request, client_address, server)\nBase handler class used to handle HTTP requests.When a connection is received, the\nrequest and HTTP headers are parsed.An attempt is then made to execute a method of\nthe form do_REQUEST based on the request type. For example, a 'GET' method invokes\ndo_GET() and a 'POST' method invokes do_POST. By default, this class does nothing,\nso these methods are expected to be defined in subclasses.\nThe following class variables are defined for BaseHTTPRequestHandler and can be\nredefined in subclasses.\nBaseHTTPRequestHandler.server_version\nSpecifies the server software version string that the server reports to clients—for exam-\nple, 'ServerName/1.2'.\nBaseHTTPRequestHandler.sys_version\nPython system version, such as 'Python/2.6'.\nBaseHTTPRequestHandler.error_message_format\nFormat string used to build error messages sent to the client.The format string is\napplied to a dictionary containing the attributes code, message, and explain. For\nexample:\n'''<head>\n<title>Error response</title>\n</head>\n<body>\n<h1>Error response</h1>\n<p>Error code %(code)d.\n<p>Message: %(message)s.\n<p>Error code explanation: %(code)s = %(explain)s.\n</body>'''\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2218,
      "extraction_method": "Direct"
    },
    {
      "page_number": 534,
      "chapter": null,
      "content": "509\nhttp package\nBaseHTTPRequestHandler.protocol_version\nHTTP protocol version used in responses.The default is 'HTTP/1.0'.\nBaseHTTPRequestHandler.responses\nMapping of integer HTTP error codes to two-element tuples (message, explain)\nthat describe the problem. For example, the integer code 404 is mapped to (\"Not\nFound\", \"Nothing matches the given URI\").The integer code and strings \nin this mapping are use when creating error messages as defined in the \nerror_message_format attribute shown previously.\nWhen created to handle a connection, an instance, b, of BaseHTTPRequestHandler\nhas the following attributes:\nAttribute\nDescription\nb.client_address\nClient address as a tuple (host, port).\nb.command\nRequest type, such as 'GET', 'POST', 'HEAD', and so on.\nb.path\nThe request path such as '/index.html'.\nb.request_version\nHTTP version string from the request, such as 'HTTP/1.0'.\nb.headers\nHTTP headers stored in a mapping object. To test for or\nextract the contents of a header, use dictionary operations\nsuch as headername in b.headers or headerval =\nb.headers[headername].\nb.rfile\nInput stream for reading optional input data. This is used\nwhen a client is uploading data (for example, during a POST\nrequest).\nb.wfile\nOutput stream for writing a response back to the client.\nThe following methods are commonly used or redefined in subclasses:\nb.send_error(code [, message])\nSends a response for an unsuccessful request. code is the numeric HTTP response code.\nmessage is an optional error message. log_error() is called to record the error.This\nmethod creates a complete error response using the error_message_format class vari-\nable, sends it to the client, and closes the connection. No further operations should be\nperformed after calling this.\nb.send_response(code [, message])\nSends a response for a successful request.The HTTP response line is sent, followed by\nServer and Date headers. code is an HTTP response code, and message is an optional\nmessage. log_request() is called to record the request.\nb.send_header(keyword, value)\nWrites a MIME header entry to the output stream. keyword is the header keyword,\nand value is its value.This should only be called after send_response().\nb.end_headers()\nSends a blank line to signal the end of the MIME headers.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2292,
      "extraction_method": "Direct"
    },
    {
      "page_number": 535,
      "chapter": null,
      "content": "510\nChapter 22 Internet Application Programming\nb.log_request([code [, size]])\nLogs a successful request. code is the HTTP code, and size is the size of the response\nin bytes (if available). By default, log_message() is called for logging.\nb.log_error(format, ...)\nLogs an error message. By default, log_message() is called for logging.\nb.log_message(format, ...)\nLogs an arbitrary message to sys.stderr. format is a format string applied to any\nadditional arguments passed.The client address and current time are prefixed to every\nmessage.\nHere is an example of creating a custom HTTP server that runs in a separate thread\nand lets you monitor the contents of a dictionary, interpreting the request path as a key.\ntry:\nfrom http.server import BaseHTTPRequestHandler, HTTPServer      # Py 3\nexcept ImportError:\nfrom BaseHTTPServer import BaseHTTPRequestHandler, HTTPServer   # Py 2\nclass DictRequestHandler(BaseHTTPRequestHandler):\ndef _ _init_ _(self,thedict,*args,**kwargs):\nself.thedict = thedict\nBaseHTTPRequestHandler._ _init_ _(self,*args,**kwargs)\ndef do_GET(self):\nkey = self.path[1:]       # Strip the leading '/'\nif not key in self.thedict:\nself.send_error(404, \"No such key\")\nelse:\nself.send_response(200)\nself.send_header('content-type','text/plain')\nself.end_headers()\nresp  = \"Key  : %s\\n\" % key\nresp += \"Value: %s\\n\" % self.thedict[key]\nself.wfile.write(resp.encode('latin-1'))\n# Example use\nd = {\n'name' : 'Dave',\n'values' : [1,2,3,4,5],\n'email' : 'dave@dabeaz.com'\n}\nfrom functools import partial\nserv = HTTPServer((\"\",9000), partial(DictRequestHandler,d))\nimport threading\nd_mon = threading.Thread(target=serv.serve_forever)\nd_mon.start()\nTo test this example, run the server and then enter a URL such as http://localhost:\n9000/name or http://localhost:9000/values into a browser. If it works, you’ll see the\ncontents of the dictionary being displayed.\nThis example also shows a technique for how to get servers to instantiate handler\nclasses with extra parameters. Normally, servers create handlers using a predefined set of\narguments that are passed to _ _init_ _(). If you want to add additional parameters, use\nthe functools.partial() function as shown.This creates a callable object that\nincludes your extra parameter but preserves the calling signature expected by the server.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2323,
      "extraction_method": "Direct"
    },
    {
      "page_number": 536,
      "chapter": null,
      "content": "511\nhttp package\nhttp.cookies (Cookie)\nThe http.cookies module provides server-side support for working with HTTP\ncookies. In Python 2, the module is called Cookie.\nCookies are used to provide state management in servers that implement sessions,\nuser logins, and related features.To drop a cookie on a user’s browser, an HTTP server\ntypically adds an HTTP header similar to the following to an HTTP response:\nSet-Cookie: session=8273612; expires=Sun, 18-Feb-2001 15:00:00 GMT; \\\npath=/; domain=foo.bar.com\nAlternatively, a cookie can be set by embedding JavaScript in the <head> section of an\nHTML document:\n<SCRIPT LANGUAGE=\"JavaScript\">\ndocument.cookie = \"session=8273612; expires=Sun, 18-Feb-2001 15:00:00 GMT; \\\nFeb 17; Path=/; Domain=foo.bar.com;\"\n</SCRIPT>\nThe http.cookies module simplifies the task of generating cookie values by providing\na special dictionary-like object which stores and manages collections of cookie values\nknown as morsels. Each morsel has a name, a value, and a set of optional attributes con-\ntaining metadata to be supplied to the browser {expires, path, comment, domain,\nmax-age, secure, version, httponly}.The name is usually a simple identifier such as\n\"name\" and must not be the same as one of the metadata names such as \"expires\" or\n\"path\".The value is usually a short string.To create a cookie, simply create a cookie\nobject like this:\nc = SimpleCookie()\nNext, cookie values (morsels) can be set using ordinary dictionary assignment:\nc[\"session\"] = 8273612\nc[\"user\"] = \"beazley\"\nAdditional attributes of a specific morsel are set as follows:\nc[\"session\"][\"path\"] = \"/\"\nc[\"session\"][\"domain\"] = \"foo.bar.com\"\nc[\"session\"][\"expires\"] = \"18-Feb-2001 15:00:00 GMT\"\nTo create output representing the cookie data as a set of HTTP headers, use the\nc.output() method. For example:\nprint(c.output())\n# Produces two lines of output\n# Set-Cookie: session=8273612; expires=...; path=/; domain=...\n# Set-Cookie: user=beazley\nWhen a browser sends a cookie back to an HTTP server, it is encoded as a string of\nkey=value pairs, such as \"session=8273612; user=beazley\". Optional attributes\nsuch as expires, path, and domain are not returned.The cookie string can usually be\nfound in the HTTP_COOKIE environment variable, which can be read by CGI applica-\ntions.To recover cookie values, use code similar to the following:\nc = SimpleCookie(os.environ[\"HTTP_COOKIE\"])\nsession = c[\"session\"].value\nuser    = c[\"user\"].value\nThe following documentation describes the SimpleCookie object in more detail.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2542,
      "extraction_method": "Direct"
    },
    {
      "page_number": 537,
      "chapter": null,
      "content": "512\nChapter 22 Internet Application Programming\nSimpleCookie([input])\nDefines a cookie object in which cookie values are stored as simple strings.\nA cookie instance, c, provides the following methods:\nc.output([attrs [,header [,sep]]])\nGenerates a string suitable for use in setting cookie values in HTTP headers. attrs is\nan optional list of the optional attributes to include (\"expires\", \"path\", \"domain\",\nand so on). By default, all cookie attributes are included. header is the HTTP header\nto use ('Set-Cookie:' by default). sep is the character used to join the headers\ntogether and is a newline by default.\nc.js_output([attrs])\nGenerates a string containing JavaScript code that will set the cookie if executed on a\nbrowser supporting JavaScript. attrs is an optional list of the attributes to include.\nc.load(rawdata)\nLoads the cookie c with data found in rawdata. If rawdata is a string, it’s assumed to\nbe in the same format as the HTTP_COOKIE environment variable in a CGI program. If\nrawdata is a dictionary, each key-value pair is interpreted by setting c[key]=value.\nInternally, the key/value pairs used to store a cookie value are instances of a\nMorsel class.An instance, m, of Morsel behaves like a dictionary and allows the option-\nal \"expires\", \"path\", \"comment\", \"domain\", \"max-age\", \"secure\", \"version\", and\n\"httponly\" keys to be set. In addition, the morsel m has the following methods and\nattributes:\nm.value\nA string containing the raw value of the cookie.\nm.coded_value\nA string containing the encoded value of the cookie that would be sent to or received\nfrom the browser.\nm.key\nThe cookie name.\nm.set(key,value,coded_value)\nSets the values of m.key, m.value, and m.coded_value shown previously.\nm.isReservedKey(k)\nTests whether k is a reserved keyword, such as \"expires\", \"path\", \"domain\", and so\non.\nm.output([attrs [,header]])\nProduces the HTTP header string for this morsel. attrs is an optional list of the addi-\ntional attributes to include (\"expires\", \"path\", and so on). header is the header\nstring to use ('Set-Cookie:' by default).\nm.js_output([attrs])\nOutputs JavaScript code that sets the cookie when executed.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2169,
      "extraction_method": "Direct"
    },
    {
      "page_number": 538,
      "chapter": null,
      "content": "513\nsmtplib\nm.OutputString([attrs])\nReturns the cookie string without any HTTP headers or JavaScript code.\nExceptions\nIf an error occurs during the parsing or generation of cookie values, a CookieError\nexception is raised.\nhttp.cookiejar (cookielib)\nThe http.cookiejar module provides client-side support for storing and managing\nHTTP cookies. In Python 2, the module is called cookielib.\nThe primary role of this module is to provide objects in which HTTP cookies can\nbe stored so that they can be used in conjunction with the urllib package, which is\nused to access documents on the Internet. For instance, the http.cookiejar module\ncan be used to capture cookies and to retransmit them on subsequent connection\nrequests. It can also be used to work with files containing cookie data such as files creat-\ned by various browsers.\nThe following objects are defined by the module:\nCookieJar()\nAn object that manages HTTP cookie values, storing cookies received as a result of\nHTTP requests, and adding cookies to outgoing HTTP requests. Cookies are stored\nentirely in memory and lost when the CookieJar instance is garbage-collected.\nFileCookieJar(filename [, delayload ])\nCreates a FileCookieJar instance that retrieves and stores cookie information to a file.\nfilename is the name of the file. delayload, if True, enables lazy access to the file.\nThat is, the file won’t be read or stored except by demand.\nMozillaCookieJar(filename [, delayload ])\nCreates a FileCookieJar instance that is compatible with the Mozilla cookies.txt\nfile.\nLWPCookieJar(filename [, delayload ])\nCreates a FileCookieJar instance that is compatible with the libwww-perl \nSet-Cookie3 file format.\nIt is somewhat rare to work with the methods and attributes of these objects directly.\nIf you need to know their low-level programming interface, consult the online docu-\nmentation. Instead, it is more common to simply instantiate one of the cookie jar\nobjects and plug it into something else that wants to work with cookies.An example of\nthis is shown in the urllib.request section of this chapter.\nsmtplib\nThe smtplib module provides a low-level SMTP client interface that can be used to\nsend mail using the SMTP protocol described in RFC 821 and RFC 1869.This mod-\nule contains a number of low-level functions and methods that are described in detail in\nthe online documentation. However, the following covers the most useful parts of this\nmodule:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2447,
      "extraction_method": "Direct"
    },
    {
      "page_number": 539,
      "chapter": null,
      "content": "514\nChapter 22 Internet Application Programming\nSMTP([host [, port]])\nCreates an object representing a connection to an SMTP server. If host is given, it\nspecifies the name of the SMTP server. port is an optional port number.The default\nport is 25. If host is supplied, the connect() method is called automatically.\nOtherwise, you will need to manually call connect() on the returned object to estab-\nlish the connection.\nAn instance s of SMTP has the following methods:\ns.connect([host [, port]])\nConnects to the SMTP server on host. If host is omitted, a connection is made to the\nlocal host ('127.0.0.1'). port is an optional port number that defaults to 25 if omit-\nted. It is not necessary to call connect() if a host name was given to SMTP().\ns.login(user, password)\nLogs into the server if authentication is required. user is a username, and password is a\npassword.\ns.quit()\nTerminates the session by sending a 'QUIT' command to the server.\ns.sendmail(fromaddr, toaddrs, message)\nSends a mail message to the server. fromaddr is a string containing the email address of\nthe sender. toaddrs is a list of strings containing the email addresses of recipients.\nmessage is a string containing a completely formatted RFC-822 compliant message.\nThe email package is commonly used to create such messages. It is important to note\nthat although message can be given as a text string, it should only contain valid ASCII\ncharacters with values in the range 0 to 127. Otherwise, you will get an encoding error.\nIf you need to send a message in a different encoding such as UTF-8, encode it into a\nbyte string first and supply the byte string as message.\nExample\nThe following example shows how the module can be used to send a message:\nimport smtplib\nfromaddr = \"someone@some.com\"\ntoaddrs = [\"recipient@other.com\"]\nmsg = \"From: %s\\r\\nTo: %s\\r\\n\\r\\n\" % (fromaddr, \",\".join(toaddrs))\nmsg += \"\"\"\nRefinance your mortgage to buy stocks and Viagra!\n\"\"\"\nserver = smtplib.SMTP('localhost')\nserver.sendmail(fromaddr, toaddrs, msg)\nserver.quit()\nurllib Package\nThe urllib package provides a high-level interface for writing clients that need to\ninteract with HTTP servers, FTP servers, and local files.Typical applications include\nscraping data from web pages, automation, proxies, web crawlers, and so forth.This is\none of the most highly configurable library modules, so every last detail is not presented\nhere. Instead, the most common uses of the package are described.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2480,
      "extraction_method": "Direct"
    },
    {
      "page_number": 540,
      "chapter": null,
      "content": "515\nurllib Package\nIn Python 2, the urllib functionality is spread across several different library mod-\nules including urllib, urllib2, urlparse, and robotparser. In Python 3, all of this\nfunctionality has been consolidated and reorganized under the urllib package.\nurllib.request (urllib2)\nThe urllib.request module provides functions and classes to open and fetch data\nfrom URLs. In Python 2, this functionality is found in a module urllib2.\nThe most common use of this module is to fetch data from web servers using\nHTTP. For example, this code shows the easiest way to simply fetch a web page:\ntry:\nfrom urllib.request import urlopen    # Python 3\nexcept ImportError:\nfrom urllib2 import urlopen           # Python 2\nu = urlopen(\"http://docs.python.org/3.0/library/urllib.request.html\")\ndata = u.read()\nOf course, many complexities arise when interacting with servers in the real world. For\nexample, you might have to worry about proxy servers, authentication, cookies, user\nagents, and other matters.All of these are supported, but the code is more complicated\n(keep reading).\nurlopen() and Requests\nThe most straightforward way to make a request is to use the urlopen() function.\nurlopen(url [, data [, timeout]])\nOpens the URL url and returns a file-like object that can be used to read the returned\ndata. url may either be a string containing a URL or an instance of the Request class,\ndescribed shortly. data is a URL-encoded string containing form data to be uploaded\nto the server.When supplied, the HTTP 'POST' method is used instead of \n'GET' (the default). Data is generally created using a function such as\nurllib.parse.urlencode(). timeout is an optional timeout in seconds for all \nblocking operations used internally.\nThe file-like object u returned by urlopen() supports the following methods:\nMethod\nDescription\nu.read([nbytes])\nReads nbytes of data as a byte string.\nu.readline()\nReads a single line of text as a byte string.\nu.readlines()\nReads all input lines and returns a list.\nu.fileno()\nReturns the integer file descriptor.\nu.close()\nCloses the connection.\nu.info()\nReturns a mapping object with meta-information associated\nwith the URL. For HTTP, the HTTP headers included with the\nserver response are returned. For FTP, the headers include\n'content-length'. For local files, the headers include a\ndate, 'content-length', and 'content-type' field.\nu.getcode()\nReturns the HTTP response code as an integer—for example,\n200 for success or 404 for file not found.\nu.geturl()\nReturns the real URL of the returned data, taking into account\nany redirection that may have occurred. \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2627,
      "extraction_method": "Direct"
    },
    {
      "page_number": 541,
      "chapter": null,
      "content": "516\nChapter 22 Internet Application Programming\nIt is important to emphasize that the file-like object u operates in binary mode. If you\nneed to process the response data as text, you will need to decode it using the codecs\nmodule or some other means.\nIf an error occurs during download, an URLError exception is raised.This includes\nerrors related to the HTTP protocol itself such as forbidden access or requests for\nauthentication. For these kinds of errors, a server typically returns content that gives\nmore descriptive information.To get this content, the exception instance itself operates\nas a file-like object that can be read. For example:\ntry:\nu = urlopen(\"http://www.python.org/perl.html\")\nresp = u.read()\nexcept HTTPError as e:\nresp = e.read()\nA very common error that arises with urlopen() is accessing web pages through a\nproxy server. For example, if your organization routes all web traffic through a proxy,\nrequests may fail. If the proxy server doesn’t require any kind of authentication, you\nmay be able to fix this by merely setting the HTTP_PROXY environment variable in the\nos.environ dictionary. For example, os.environ['HTTP_PROXY'] =\n'http://example.com:12345'.\nFor simple requests, the url parameter to urlopen() is a string such as\n'http://www.python.org'. If you need to do anything more complicated such as\nmake modifications to HTTP request headers, create a Request instance and use that as\nthe url parameter.\nRequest(url [, data [, headers [, origin_req_host [, unverifiable]]]])\nCreates a new Request instance. url specifies the URL (for example,\n'http://www.foo.bar/spam.html'). data is URL-encoded data to be uploaded to\nthe server in HTTP requests.When this is supplied, it changes the HTTP request type\nfrom 'GET' to 'POST'. headers is a dictionary containing key-value mappings repre-\nsenting the contents of the HTTP headers. origin_req_host is set to the request-host\nof the transaction—typically it’s the host name from which the request is originating.\nunverifiable is set to True if the request is for an unverifiable URL.An unverifiable\nURL is informally defined as a URL not directly entered by the user—for instance, a\nURL embedded within a page that loads an image.The default value of unverifiable\nis False.\nAn instance r of Request has the following methods:\nr.add_data(data)\nAdds data to a request. If the request is an HTTP request, the method is changed to\n'POST'. data is URL-encoded data as described for Request().This does not append\ndata to any previously set data; it simply replaces the old data with data.\nr.add_header(key, val)\nAdds header information to the request. key is the header name, and val is the header\nvalue. Both arguments are strings.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2732,
      "extraction_method": "Direct"
    },
    {
      "page_number": 542,
      "chapter": null,
      "content": "517\nurllib Package\nr.add_unredirected_header(key, val)\nAdds header information to a request that will not be added to redirected requests. key\nand val have the same meaning as for add_header().\nr.get_data()\nReturns the request data (if any).\nr.get_full_url()\nReturns the full URL of a request.\nr.get_host()\nReturns the host to which the request will be sent.\nr.get_method()\nReturns the HTTP method, which is either 'GET' or 'POST'.\nr.get_origin_req_host()\nReturns the request-host of the originating transaction.\nr.get_selector()\nReturns the selector part of the URL (for example, '/index.html').\nr.get_type()\nReturns the URL type (for example, 'http').\nr.has_data()\nReturns True if data is part of the request.\nr.is_unverifiable()\nReturns True if the request is unverifiable.\nr.has_header(header)\nReturns True if the request has header header.\nr.set_proxy(host, type)\nPrepares the request for connecting to a proxy server.This replaces the original host\nwith host and the original type of the request with type.The selector part of the\nURL is set to the original URL.\nHere is an example that uses a Request object to change the 'User-Agent' header\nused by urlopen().You might use this if you wanted a server to think you were mak-\ning a connection from Internet Explorer, Firefox, or some other browser.\nheaders = {\n'User-Agent':\n'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727)'\n}\nr = Request(\"http://somedomain.com/\",headers=headers)\nu = urlopen(r)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1497,
      "extraction_method": "Direct"
    },
    {
      "page_number": 543,
      "chapter": null,
      "content": "518\nChapter 22 Internet Application Programming\nCustom Openers\nThe basic urlopen() function does not provide support for authentication, cookies, or\nother advanced features of HTTP. To add support, you must create your own custom\nopener object using the build_opener() function:\nbuild_opener([handler1 [, handler2, ... ]])\nBuilds a custom opener object for opening URLs.The arguments handler1,\nhandler2, and so on are all instances of special handler objects.The purpose of these\nhandlers is to add various capabilities to the resulting opener object.The following lists\nall the available handler objects:\nHandler\nDescription\nCacheFTPHandler\nFTP handler with persistent FTP connections\nFileHandler\nOpens local files\nFTPHandler\nOpens URLs via FTP\nHTTPBasicAuthHandler\nBasic HTTP authentication handling\nHTTPCookieProcessor\nProcessing of HTTP cookies\nHTTPDefaultErrorHandler\nHandles HTTP errors by raising an HTTPError excep-\ntion\nHTTPDigestAuthHandler\nHTTP digest authentication handling\nHTTPHandler\nOpens URLs via HTTP\nHTTPRedirectHandler\nHandles HTTP redirects\nHTTPSHandler\nOpens URLs via secure HTTP\nProxyHandler\nRedirects requests through a proxy\nProxyBasicAuthHandler\nBasic proxy authentication\nProxyDigestAuthHandler\nDigest proxy authentication\nUnknownHandler\nHandler that deals with all unknown URLs\nBy default, an opener is always created with the handlers ProxyHandler,\nUnknownHandler, HTTPHandler, HTTPSHandler, HTTPDefaultErrorHandler,\nHTTPRedirectHandler, FTPHandler, FileHandler, and HTTPErrorProcessor.These\nhandlers provide a basic level of functionality. Extra handlers supplied as arguments are\nadded to this list. However, if any of the extra handlers are of the same type as the\ndefaults, they take precedence. For example, if you added an instance of HTTPHandler\nor some class that derived from HTTPHandler, it would be used instead of the default.\nThe object returned by build_opener() has a method, open(url [, data [,\ntimeout]]), that is used to open URLs according to all the rules provided by the vari-\nous handlers.The arguments to open() are the same as what are passed to the\nurlopen() function.\ninstall_opener(opener)\nInstalls a different opener object for use as the global URL opener used by urlopen().\nopener is usually of an opener object created by build_opener().\nThe next few sections show how to create custom openers for some of the more\ncommon scenarios that arise when using urlib.request module.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2458,
      "extraction_method": "Direct"
    },
    {
      "page_number": 544,
      "chapter": null,
      "content": "519\nurllib Package\nPassword Authentication\nTo handle requests involving password authentication, you create an opener with \nsome combination of HTTPBasicAuthHandler, HTTPDigestAuthHandler,\nProxyBasicAuthHandler, or ProxyDigestAuthHandler handlers added to it. Each of\nthese handlers has the following method which can be used to set password:\nh.add_password(realm, uri, user, passwd)\nAdds user and password information for a given realm and URI.All parameters are\nstrings. uri can optionally be a sequence of URIs, in which case the user and password\ninformation is applied to all the URIs in the sequence.The realm is a name or descrip-\ntion associated with the authentication. Its value depends on the remote server.\nHowever, it’s usually a common name associated with a collection of related web pages.\nuri is a base URL associated with the authentication. Typical values for realm and uri\nmight be something like ('Administrator', 'http://www.somesite.com'). user\nand password specify a username and password, respectively.\nHere is an example of how to set up an opener with basic authentication:\nauth = HTTPBasicAuthHandler()\nauth.add_password(\"Administrator\",\"http://www.secretlair.com\",\"drevil\",\"12345\")\n# Create opener with authentication added\nopener = build_opener(auth)\n# Open URL\nu = opener.open(\"http://www.secretlair.com/evilplan.html\")\nHTTP Cookies\nTo manage HTTP cookies, create an opener object with an HTTPCookieProcessor\nhandler added to it. For example:\ncookiehand = HTTPCookieProcessor()\nopener = build_opener(cookiehand)\nu = opener.open(\"http://www.example.com/\")\nBy default, the HTTPCookieProcessor uses the CookieJar object found in the\nhttp.cookiejar module. Different types of cookie processing can be supported by\nsupplying a different CookieJar object as an argument to HTTPCookieProcessor. For\nexample:\ncookiehand = HTTPCookieProcessor(\nhttp.cookiejar.MozillaCookieJar(\"cookies.txt\")\n)\nopener = build_opener(cookiehand)\nu = opener.open(\"http://www.example.com/\")\nProxies\nIf requests need to be redirected through a proxy, create an instance of ProxyHandler.\nProxyHandler([proxies])\nCreates a proxy handler that routes requests through a proxy.The argument proxies is\na dictionary that maps protocol names (for example, 'http', 'ftp', and so on) to the\nURLs of the corresponding proxy server.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2343,
      "extraction_method": "Direct"
    },
    {
      "page_number": 545,
      "chapter": null,
      "content": "520\nChapter 22 Internet Application Programming\nThe following example shows how to use this:\nproxy = ProxyHandler({'http': 'http://someproxy.com:8080/'}\nauth  = HTTPBasicAuthHandler()\nauth.add_password(\"realm\",\"host\", \"username\", \"password\")\nopener = build_opener(proxy, auth)\nu = opener.open(\"http://www.example.com/doc.html\")\nurllib.response\nThis is an internal module that implements the file-like objects returned by functions in\nthe urllib.request module.There is no public API.\nurllib.parse\nThe urllib.parse module is used to manipulate URL strings such as\n\"http://www.python.org\".\nURL Parsing (urlparse Module in Python 2)\nThe general form of a URL is \"scheme://netloc/\npath;parameters?query#fragment\". In addition, the netloc part of a URL may\ninclude a port number such as \"hostname:port\" or user authentication information\nsuch as \"user:pass@hostname\".The following function is used to parse a URL:\nurlparse(urlstring [, default_scheme [, allow_fragments]])\nParses the URL in urlstring and returns a ParseResult instance. default_scheme\nspecifies the scheme (\"http\", \"ftp\", and so on) to be used if none is present in the\nURL. If allow_fragments is zero, fragment identifiers are not allowed.A\nParseResult instance r is a named tuple the form (scheme, netloc, path,\nparameters, query, fragment). However, the following read-only attributes are\nalso defined:\nAttribute\nDescription\nr.scheme\nURL scheme specifier (for example, 'http')\nr.netloc\nNetloc specifier (for example, 'www.python.org')\nr.path\nHierarchical path (for example, '/index.html')\nr.params\nParameters for the last path element\nr.query\nQuery string (for example, 'name=Dave&id=42')\nr.fragment\nFragment identifier without the leading '#'\nr.username\nUsername component if the netloc specifier is of the form\n'username:password@hostname'\nr.password\nPassword component from the netloc specifier\nr.hostname\nHost name component from the netloc specifier\nr.port\nPort number from the netloc specifier if it is of the form\n'hostname:port'\nA ParseResult instance can be turned back into a URL string using r.geturl().\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2102,
      "extraction_method": "Direct"
    },
    {
      "page_number": 546,
      "chapter": null,
      "content": "521\nurllib Package\nurlunparse(parts)\nConstructs a URL string from a tuple-representation of a URL as returned by \nurlparse(). parts must be a tuple or iterable with six components.\nurlsplit(url [, default_scheme [, allow_fragments]])\nThe same as urlparse() except that the parameters portion of a URL is left\nunmodified in the path.This allows for parsing of URLs where parameters might be\nattached to individual path components such as\n'scheme://netloc/path1;param1/path2;param2/path3?query#fragment'.The\nresult is an instance of SplitResult, which is a named tuple containing (scheme,\nnetloc, path, query, fragment).The following read-only attributes are also\ndefined:\nAttribute\nDescription\nr.scheme\nURL scheme specifier (for example, 'http')\nr.netloc\nNetloc specifier (for example, 'www.python.org')\nr.path\nHierarchical path (for example, '/index.html')\nr.query\nQuery string (for example, 'name=Dave&id=42')\nr.fragment\nFragment identifier without the leading '#'\nr.username\nUsername component if the netloc specifier is of the form\n'username:password@hostname'\nr.password\nPassword component from the netloc specifier\nr.hostname\nHost name component from the netloc specifier\nr.port\nPort number from the netloc specifier if it is of the form\n'hostname:port'\nA SplitResult instance can be turned back into a URL string using r.geturl().\nurlunsplit(parts)\nConstructs a URL from the tuple-representation created by urlsplit(). parts is a\ntuple or iterable with the five URL components.\nurldefrag(url)\nReturns a tuple (newurl, fragment) where newurl is url stripped of fragments and\nfragment is a string containing the fragment part (if any). If there are no fragments in\nurl, then newurl is the same as url and fragment is an empty string.\nurljoin(base, url [, allow_fragments])\nConstructs an absolute URL by combining a base URL, base, with a relative URL.\nurl. allow_fragments has the same meaning as for urlparse(). If the last compo-\nnent of the base URL is not a directory, it’s stripped.\nparse_qs(qs [, keep_blank_values [, strict_parsing]])\nParses a URL-encoded (MIME type application/x-www-form-urlencoded) query\nstring qs and returns a dictionary where the keys are the query variable names and the\nvalues are lists of values defined for each name. keep_blank_values is a Boolean flag\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2314,
      "extraction_method": "Direct"
    },
    {
      "page_number": 547,
      "chapter": null,
      "content": "522\nChapter 22 Internet Application Programming\nthat controls how blank values are handled. If True, they are included in the dictionary\nwith a value set to the empty string. If False (the default), they are discarded.\nstrict_parsing is a Boolean flag that if True, turns parsing errors into a ValueError\nexception. By default, errors are silently ignored.\nparse_qsl(qs [, keep_blank_values [, strict_parsing]])\nThe same as parse_qs() except that the result is a list of pairs (name, value) where\nname is the name of a query variable and value is the value.\nURL Encoding (urllib Module in Python 2)\nThe following functions are used to encode and decode data that make up URLs.\nquote(string [, safe [, encoding [, errors]]])\nReplaces special characters in string with escape sequences suitable for including in a\nURL. Letters, digits, and the underscore ( _ ), comma (,), period (.), and hyphen ( - )\ncharacters are unchanged.All other characters are converted into escape sequences of\nthe form '%xx'. safe provides a string of additional characters that should not be\nquoted and is '/' by default. encoding specifies the encoding to use for non-ASCII\ncharacters. By default, it is 'utf-8'. errors specifies what to do when encoding errors\nare encountered and is 'strict' by default.The encoding and errors parameters are\nonly available in Python 3.\nquote_plus(string [, safe [, encoding [, errors]]])\nCalls quote() and additionally replaces all spaces with plus signs. string and safe are\nthe same as in quote(). encoding and errors are the same as with quote().\nquote_from_bytes(bytes [, safe])\nThe same as quote() but accepts a byte-string and performs no encoding.The return\nresult is a text string. Python 3 only.\nunquote(string [, encoding [, errors]])\nReplaces escape sequences of the form '%xx' with their single-character equivalent.\nencoding and errors specify the encoding and error handling for decoding data in\n'%xx' escapes.The default encoding is 'utf-8', and the default errors policy is\n'replace'. encoding and errors are Python 3 only.\nunquote_plus(string [, encoding\n[, errors]])\nLike unquote() but also replaces plus signs with spaces.\nunquote_to_bytes(string)\nThe same as unquote() but performs no decoding and returns a byte string.\nurlencode(query [, doseq])\nConverts query values in query to a URL-encoded string suitable for inclusion as the\nquery parameter of a URL or for uploading as part of a POST request. query is either a\ndictionary or a sequence of (key, value) pairs.The resulting string is a series of\n'key=value' pairs separated by '&' characters, where both key and value are quoted\nusing quote_plus().The doseq parameter is a Boolean flag that should be set to True\nif any value in query is a sequence, representing multiple values for the same key. In\nthis case, a separate 'key=v' string is created for each v in value.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2881,
      "extraction_method": "Direct"
    },
    {
      "page_number": 548,
      "chapter": null,
      "content": "523\nurllib Package\nExamples\nThe following examples show how to turn a dictionary of query variables into a URL\nsuitable for use in an HTTP GET request and how you can parse a URL:\ntry:\nfrom urllib.parse import urlparse, urlencode, parse_qsl   # Python 3\nexcept ImportError:\nfrom urlparse import urlparse, parse_qsl                  # Python 2\nfrom urllib import urlencode\n# Example of creating a URL with properly encoded query varibles\nform_fields = {\n'name'  : 'Dave',\n'email' : 'dave@dabeaz.com',\n'uid'   : '12345'\n}\nform_data = urlencode(form_fields)\nurl = \"http://www.somehost.com/cgi-bin/view.py?\"+form_data\n# Example of parsing a URL into components\nr = urlparse(url)\nprint(r.scheme)       # 'http'\nprint(r.netloc)       # 'www.somehost.com'\nprint(r.path)         # '/cgi-bin/view.py'\nprint(r.params)       # ''\nprint(r.query)        # 'uid=12345&name=Dave&email=dave%40dabeaz.com'\nprint(r.fragment)     # ''\n# Extract query data\nparsed_fields = dict(parse_qsl(r.query))\nassert form_fields == parsed_fields\nurllib.error\nThe urllib.error module defines exceptions used by the urllib package.\nContentTooShort\nRaised when the amount of downloaded data is less than the expected amount (as\ndefined by the 'Content-Length' header). Defined in the urllib module in Python 2.\nHTTPError\nRaised to indicate problems with the HTTP protocol.This error may be used to signal\nevents such as authentication required.This exception can also be used as a file object to\nread the data returned by the server that’s associated with the error.This is a subclass of\nURLError. It is defined in the urllib2 module in Python 2.\nURLError\nError raised by handlers when a problem is detected.This is a subclass of IOError.The\nreason attribute of the exception instance has more information about the problem.\nThis is defined in the urllib2 module in Python 2.\nurllib.robotparser (robotparser)\nThe urllib.robotparser module (robotparser in Python 2) is used to fetch and\nparse the contents of 'robots.txt' files used to instruct web crawlers. Consult the\nonline documentation for further usage information.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2109,
      "extraction_method": "Direct"
    },
    {
      "page_number": 549,
      "chapter": null,
      "content": "524\nChapter 22 Internet Application Programming\nNotes\nn Advanced users of the urllib package can customize its behavior in almost every\nway imaginable.This includes creating new kinds of openers, handlers, requests,\nprotocols, etc.This topic is beyond the scope of what can be covered here, but the\nonline documentation has some further details.\nn Users of Python 2 should take note that the urllib.urlopen() function, which is\nin widespread use, is officially deprecated in Python 2.6 and eliminated in Python 3.\nInstead of using urllib.urlopen(), you should use urllib2.urlopen(), which\nprovides the same functionality as urllib.request.urlopen() described here.\nxmlrpc Package\nThe xmlrpc package contains modules for implement XML-RPC servers and clients.\nXML-RPC is a remote procedure call mechanism that uses XML for data encoding and\nHTTP as a transport mechanism.The underlying protocol is not specific to Python so\nprograms using these modules can potentially interact with programs written in other\nlanguages. More information about XML-RPC can be obtained at http://www.\nxmlrpc.com.\nxmlrpc.client (xmlrpclib)\nThe xmlrpc.client module is used to write XML-RPC clients. In Python 2, this\nmodule is called xmlrpclib.To operate as a client, you create an instance of\nServerProxy:\nServerProxy(uri [, transport [, encoding [, verbose [, allow_none [,\nuse_datetime]]]])\nuri is the location of the remote XML-RPC server—for example, \"http://www.\nfoo.com/RPC2\". If necessary, basic authentication information can be added to the URI\nusing the format \"http://user:pass@host:port/path\", where user:pass is the\nusername and password.This information is base-64 encoded and put in an\n'Authorization:' header on transport. If Python is configured with OpenSSL sup-\nport, HTTPS can also be used. transport specifies a factory function for creating an\ninternal transport object used for low-level communication.This argument is only used\nif XML-RPC is being used over some kind of connection other than HTTP or\nHTTPS. It is almost never necessary to supply this argument in normal use (consult the\nonline documentation for details). encoding specifies the encoding, which is UTF-8 by\ndefault. verbose displays some debugging information if True. allow_none, if True,\nallows the value None to be sent to remote servers. By default, this is disabled because it’s\nnot universally supported. use_datetime is a Boolean flag that if set to True, uses the\ndatetime module to represent dates and times. By default, this is False.\nAn instance, s, of ServerProxy transparently exposes all the methods on the remote\nserver.The methods are accessed as attributes of s. For example, this code gets the cur-\nrent time from a remote server providing that service:\n>>> s = ServerProxy(\"http://www.xmlrpc.com/RPC2\")\n>>> s.currentTime.getCurrentTime()\n<DateTime u'20051102T20:08:24' at 2c77d8>\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2896,
      "extraction_method": "Direct"
    },
    {
      "page_number": 550,
      "chapter": null,
      "content": "525\nxmlrpc Package\nFor the most part, RPC calls work just like ordinary Python functions. However, only a\nlimited number of argument types and return values are supported by the XML-RPC\nprotocol:\nXML-RPC Type\nPython Equivalent\nboolean\nTrue and False\ninteger\nint\nfloat\nfloat\nstring\nstring or unicode (must only contain characters valid in XML)\narray\nAny sequence containing valid XML-RPC types\nstructure\nDictionary containing string keys and values of valid types\ndates\nDate and time (xmlrpc.client.DateTime)\nbinary\nBinary data (xmlrpc.client.Binary)\nWhen dates are received, they are stored in an xmlrpc.client.DateTime instance d.\nThe d.value attribute contains the date as an ISO 8601 time/date string.To convert it\ninto a time tuple compatible with the time module, use d.timetuple().When binary\ndata is received, it is stored in an xmlrpc.client.Binary instance b.The b.data\nattribute contains the data as a byte string. Be aware that strings are assumed to be\nUnicode and that you will have to worry about using proper encodings. Sending raw\nPython 2 byte strings will work if they contain ASCII but will break otherwise.To deal\nwith this, convert to a Unicode string first.\nIf you make an RPC call with arguments involving invalid types, you may get a\nTypeError or an xmlrpclib.Fault exception.\nIf the remote XML-RPC server supports introspection, the following methods may\nbe available:\ns.system.listMethods()\nReturns a list of strings listing all the methods provided by the XML-RPC server.\ns.methodSignatures(name)\nGiven the name of a method, name, returns a list of possible calling signatures for the\nmethod. Each signature is a list of types in the form of a comma-separated string (for\nexample, 'string, int, int'), where the first item is the return type and the\nremaining items are argument types. Multiple signatures may be returned due to over-\nloading. In XML-RPC servers implemented in Python, signatures are typically empty\nbecause functions and methods are dynamically typed.\ns.methodHelp(name)\nGiven the name of a method, name, returns a documentation string describing the use\nof that method. Documentation strings may contain HTML markup.An empty string is\nreturned if no documentation is available.\nThe following utility functions are available in the xmlrpclib module:\nboolean(value)\nCreates an XML-RPC Boolean object from value.This function predates the exis-\ntence of the Python Boolean type, so you may see it used in older code.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2482,
      "extraction_method": "Direct"
    },
    {
      "page_number": 551,
      "chapter": null,
      "content": "526\nChapter 22 Internet Application Programming\nBinary(data)\nCreates an XML-RPC object containing binary data. data is a string containing the\nraw data. Returns a Binary instance.The returned Binary instance is transparently\nencoded/decoded using base 64 during transmission.To extract binary from Binary\ninstance b, use b.data.\nDateTime(daytime)\nCreates an XML-RPC object containing a date. daytime is either an ISO 8601 format\ndate string, a time tuple or struct as returned by time.localtime(), or a datetime\ninstance from the datetime module.\ndumps(params [, methodname [, methodresponse [, encoding [, allow_none]]]])\nConverts params into an XML-RPC request or response, where params is either a\ntuple of arguments or an instance of the Fault exception. methodname is the name of\nthe method as a string. methodresponse is a Boolean flag. If True, then the result is an\nXML-RPC response. In this case, only one value can be supplied in params. encoding\nspecifies the text encoding in the generated XML and defaults to UTF-8. allow_none\nis a flag that specifies whether or not None is supported as a parameter type. None is not\nexplicitly mentioned by the XML-RPC specification, but many servers support it. By\ndefault, allow_none is False.\nloads(data)\nConverts data containing an XML-RPC request or response into a tuple (params,\nmethodname) where params is a tuple of parameters and methodname is a string con-\ntaining the method name. If the request represents a fault condition instead of an actual\nvalue, then the Fault exception is raised.\nMultiCall(server)\nCreates a MultiCall object that allows multiple XML-RPC requests to be packaged\ntogether and sent as a single request.This can be a useful performance optimization if\nmany different RPC requests need to be made on the same server. server is an\ninstance of ServerProxy, representing a connection to a remote server.The returned\nMultiCall object is used in exactly the same way as ServerProxy. However, instead\nof immediately executing the remote methods, the method calls as queued until the\nMultiCall object is called as a function. Once this occurs, the RPC requests are trans-\nmitted.The return value of this operation is a generator that yields the return result of\neach RPC operation in sequence. Note that MultiCall() only works if the remote\nserver provides a system.multicall() method.\nHere is an example that illustrates the use of MultiCall:\nmulti = MultiCall(server)\nmulti.foo(4,6,7)                # Remote method foo\nmulti.bar(\"hello world\")        # Remote method bar\nmulti.spam()                    # Remote method spam\n# Now, actually send the XML-RPC request and get return results\nfoo_result, bar_result, spam_result = multi()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2733,
      "extraction_method": "Direct"
    },
    {
      "page_number": 552,
      "chapter": null,
      "content": "527\nxmlrpc Package\nExceptions\nThe following exceptions are defined in xmlrpc.client:\nFault\nIndicates an XML-RPC fault.The faultCode attribute contains a string with the fault\ntype.The faultString attribute contains a descriptive message related to the fault.\nProtocolError\nIndicates a problem with the underlying networking—for example, a bad URL or a\nconnection problem of some kind.The url attribute contains the URI that triggered\nthe error.The errcode attribute contains an error code.The errmsg attribute contains\na descriptive string.The headers attribute contains all the HTTP headers of the request\nthat triggered the error.\nxmlrpc.server (SimpleXMLRPCServer,\nDocXMLRPCServer)\nThe xmlrpc.server module contains classes for implementing different variants of\nXML-RPC servers. In Python 2, this functionality is found in two separate modules:\nSimpleXMLRPCServer and DocXMLRPCServer.\nSimpleXMLRPCServer(addr [, requestHandler [, logRequests]])\nCreates an XML-RPC server listening on the socket address addr (for example,\n('localhost',8080)). requestHandler is factory function that creates handler\nrequest objects when connections are received. By default, it is set to\nSimpleXMLRPCRequestHandler, which is currently the only available handler.\nlogRequests is a Boolean flag that indicates whether or not to log incoming requests.\nThe default value is True.\nDocXMLRPCServer(addr [, requestHandler [, logRequest])\nCreates a documenting XML-RPC that additionally responds to HTTP GET requests\n(normally sent by a browser). If received, the server generates documentation from the\ndocumentation strings found in all of the registered methods and objects.The arguments\nhave the same meaning as for SimpleXMLRPCServer.\nAn instance, s, of SimpleXMLRPCServer or DocXMLRPCServer has the following\nmethods:\ns.register_function(func [, name])\nRegisters a new function, func, with the XML-RPC server. name is an optional name\nto use for the function. If name is supplied, it’s the name clients will use to access the\nfunction.This name may contain characters that are not part of valid Python identifiers,\nincluding periods (.). If name is not supplied, then the actual function name of func is\nused instead.\ns.register_instance(instance [, allow_dotted_names])\nRegisters an object that’s used to resolve method names not registered with the \nregister_function() method. If the instance instance defines the method \n_dispatch(self, methodname, params), it is called to process requests. methodname is\nthe name of the method, and params is a tuple containing arguments.The return value of\n_dispatch() is returned to clients. If no _dispatch() method is defined, the instance is\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2693,
      "extraction_method": "Direct"
    },
    {
      "page_number": 553,
      "chapter": null,
      "content": "528\nChapter 22 Internet Application Programming\nchecked to see if the method name matches the names of any methods defined for\ninstance. If so, the method is called directly.The allow_dotted_names parameter is a\nflag that indicates whether a hierarchical search should be performed when checking for\nmethod names. For example, if a request for method 'foo.bar.spam' is received, this\ndetermines whether or not a search for instance.foo.bar.spam is made. By default, this\nis False. It should not be set to True unless the client has been verified. Otherwise, it\nopens up a security hole that can allow intruders to execute arbitrary Python code. Note\nthat, at most, only one instance can be registered at a time.\ns.register_introspection_functions()\nAdds XML-RPC introspection functions system.listMethods(),\nsystem.methodHelp(), and system.methodSignature() to the XML-RPC server.\nsystem.methodHelp() returns the documentation string for a method (if any).The\nsystem.methodSignature() function simply returns a message indicating that the\noperation is unsupported (because Python is dynamically typed, type information is\navailable).\ns.register_multicall_functions()\nAdds XML-RPC multicall function support by adding the system.multicall()\nfunction to the server.\nAn instance of DocXMLRPCServer additionally provides these methods:\ns.set_server_title(server_title)\nSets the title of the server in HTML documentation.The string is placed in the HTML\n<title> tag.\ns.set_server_name(server_name)\nSets the name of the server in HTML documentation.The string appears at the top of\nthe page in an <h1> tag.\ns.set_server_documentation(server_documentation)\nAdds a descriptive paragraph to the generated HTML output.This string is added right\nafter the server name, but before a description of the XML-RPC functions.\nAlthough it is common for an XML-RPC server to operate as a stand-alone process,\nit can also run inside a CGI script.The following classes are used for this:\nCGIXMLRPCRequestHandler([allow_none [, encoding]])\nA CGI Request handler that operates in the same manner as SimpleXMLRPCServer.\nThe arguments have the same meaning as described for SimpleXMLRPCServer.\nDocCGIXMLRPCRequestHandler()\nA CGI Request handler that operates in the same manner as DocXMLRPCServer.\nPlease note that as of this writing, the calling arguments are different than\nCGIXMLRPCRequestHandler().This might be a Python bug so you should consult the\nonline documentation in future releases.\nAn instance, c, of either CGI handler has the same methods as a normal XML-RPC\nserver for registering functions and instances. However, they additionally define the fol-\nlowing method:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2678,
      "extraction_method": "Direct"
    },
    {
      "page_number": 554,
      "chapter": null,
      "content": "529\nxmlrpc Package\nc.handle_request([request_text])\nProcesses an XML-RPC request. By default, the request is read from standard input. If\nrequest_text is supplied, it contains the request data in the form received by an\nHTTP POST request.\nExamples\nHere is a very simple example of writing a standalone server. It adds a single function,\nadd. In addition, it adds the entire contents of the math module as an instance, exposing\nall the functions it contains.\ntry:\nfrom xmlrpc.server import SimpleXMLRPCServer      # Python 3\nexcept ImportError:\nfrom SimpleXMLRPCServer import SimpleXMLRPCServer # Python 2\nimport math\ndef add(x,y):\n\"Adds two numbers\"\nreturn x+y\ns = SimpleXMLRPCServer(('',8080))\ns.register_function(add)\ns.register_instance(math)\ns.register_introspection_functions()\ns.serve_forever()\nHere is the same functionality implemented as CGI-script:\ntry:\nfrom xmlrpc.server import CGIXMLRPCRequestHandler      # Python 3\nexcept ImportError:\nfrom SimpleXMLRPCServer import CGIXMLRPCRequestHandler # Python 2\nimport math\ndef add(x,y):\n\"Adds two numbers\"\nreturn x+y\ns = CGIXMLRPCRequestHandler()\ns.register_function(add)\ns.register_instance(math)\ns.register_introspection_functions()\ns.handle_request()\nTo access XML-RPC functions from other Python programs, use the xmlrpc.client\nor xmlrpclib module. Here is a short interactive session that shows how it works:\n>>> from xmlrpc.client import ServerProxy\n>>> s = ServerProxy(\"http://localhost:8080\")\n>>> s.add(3,5)\n8\n>>> s.system.listMethods()\n['acos', 'add', 'asin', 'atan', 'atan2', 'ceil', 'cos', 'cosh', 'degrees', 'exp',\n'fabs', 'floor', 'fmod', 'frexp', 'hypot', 'ldexp', 'log', 'log10', 'modf',\n'pow', 'radians', 'sin', 'sinh', 'sqrt', 'system.listMethods',\n'system.methodHelp', 'system.methodSignature', 'tan', 'tanh']\n>>> s.tan(4.5)\n4.6373320545511847\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1843,
      "extraction_method": "Direct"
    },
    {
      "page_number": 555,
      "chapter": null,
      "content": "530\nChapter 22 Internet Application Programming\nAdvanced Server Customization\nThe XML-RPC server modules are easy to use for basic kinds of distributed comput-\ning. For example, XML-RPC could be used as a protocol for high-level control of\nother systems on the network, provided they were all running a suitable XML-RPC\nserver. More interesting objects can also be passed between systems if you additionally\nuse the pickle module.\nOne concern with XML-RPC is that of security. By default, an XML-RPC server\nruns as an open service on the network, so anyone who knows the address and port of\nthe server can connect to it (unless it’s shielded by a firewall). In addition, XML-RPC\nservers place no limit on the amount of data that can be sent in a request.An attacker\ncould potentially crash the server by sending an HTTP POST request with a payload so\nlarge as to exhaust memory.\nIf you want to address any of these issues, you will need to customize the XML-\nRPC server classes or request handlers.All of the server classes inherit from TCPServer\nin the socketserver module.Thus, the servers can be customized in the same manner\nas other socket server classes (for example, adding threading, forking, or validating client\naddresses).A validation wrapper can be placed around the request handlers by inheriting\nfrom SimpleXMLRPCRequestHandler or DocXMLRPCRequestHandler and extending\nthe do_POST() method. Here is an example that limits the size of incoming requests:\ntry:\nfrom xmlrpc.server import (SimpleXMLRPCServer,\nSimpleXMLRPCRequestHandler)\nexcept ImportError:\nfrom SimpleXMLRPCServer import (SimpleXMLRPCServer,\nSimpleXMLRPCRequestHandler)\nclass MaxSizeXMLRPCHandler(SimpleXMLRPCRequestHandler):\nMAXSIZE = 1024*1024   # 1MB\ndef do_POST(self):\nsize = int(self.headers.get('content-length',0))\nif size >= self.MAXSIZE:\nself.send_error(400,\"Bad request\")\nelse:\nSimpleXMLRPCRequestHandler.do_POST(self)\ns = SimpleXMLRPCServer(('',8080),MaxSizeXMLRPCHandler)\nIf you wanted to add any kind of HTTP-based authentication, it could also be imple-\nmented in a similar manner.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2095,
      "extraction_method": "Direct"
    },
    {
      "page_number": 556,
      "chapter": null,
      "content": "23\nWeb Programming\nPython is widely used when building websites and serves several different roles in this\ncapacity. First, Python scripts are often a useful way to simply generate a set of static\nHTML pages to be delivered by a web server. For example, a script can be used to take\nraw content and decorate it with additional features that you typically see on a website\n(navigation bars, sidebars, advertisements, stylesheets, etc.).This is mainly just a matter of\nfile handling and text processing—topics that have been covered in other sections of the\nbook.\nSecond, Python scripts are used to generate dynamic content. For example, a website\nmight operate using a standard webserver such as Apache but would use Python scripts\nto dynamically handle certain kinds of requests.This use of Python is primarily associat-\ned with form processing. For example, an HTML page might include a form like this:\n<FORM ACTION='/cgi-bin/subscribe.py' METHOD='GET'>\nYour name : <INPUT type='Text' name='name' size='30'>\nYour email address: <INPUT type='Text' name='email' size='30'>\n<INPUT type='Submit' name='submit-button' value='Subscribe'>\n</FORM>\nWithin the form, the ACTION attribute names a Python script 'subscribe.py' that\nwill execute on the server when the form is submitted.\nAnother common scenario involving dynamic content generation is with AJAX\n(Asynchronous Javascript and XML).With AJAX, JavaScript event handlers are associat-\ned with certain HTML elements on a page. For example, when the mouse hovers over\na specific document element, a JavaScript function might execute and send an HTTP\nrequest to the webserver that gets processed (possibly by a Python script).When the\nassociated response is received, another JavaScript function executes to process the\nresponse data and displays the result.There are many ways in which results might be\nreturned. For example, a server might return data as plaintext, XML, JSON, or any\nnumber of other formats. Here is an example HTML document that illustrates one way\nto implement a hover popup where moving the mouse over selected elements causes a\npopup window to appear.\n<html>\n<head>\n<title>ACME Officials Quiet After Corruption Probe</title>\n<style type=\"text/css\">\n.popup { border-bottom:1px dashed green; }\n.popup:hover { background-color: #c0c0ff; }\n</style>\n</head>\n<body>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2352,
      "extraction_method": "Direct"
    },
    {
      "page_number": 557,
      "chapter": null,
      "content": "532\nChapter 23 Web Programming\n<span id=\"popupbox\" \nstyle=\"visibility:hidden; position:absolute; background-color:\n#ffffff;\">\n<span id=\"popupcontent\"></span>\n</span>\n<script>\n/* Get a reference to the popup box element */\nvar popup = document.getElementById(\"popupbox\");\nvar popupcontent = document.getElementById(\"popupcontent\");\n/* Get pop-up data from the server and display when received */\nfunction ShowPopup(hoveritem,name) {\nvar request = new XMLHttpRequest();\nrequest.open(\"GET\",\"cgi-bin/popupdata.py?name=\"+name, true);\nrequest.onreadystatechange = function() {\nvar done = 4, ok = 200;\nif (request.readyState == done && request.status == ok) {\nif (request.responseText) {\npopupcontent.innerHTML = request.responseText;\npopup.style.left = hoveritem.offsetLeft+10;\npopup.style.top  = hoveritem.offsetTop+20;\npopup.style.visibility = \"Visible\";\n}\n}\n};\nrequest.send();\n}\n/* Hide the popup box */\nfunction HidePopup() {\npopup.style.visibility = \"Hidden\";\n}\n</script>\n<h3>ACME Officials Quiet After Corruption Probe</h3>\n<p>\nToday, shares of ACME corporation \n(<span class=\"popup\" onMouseOver=\"ShowPopup(this,'ACME');\"\nonMouseOut=\"HidePopup();\">ACME</span>)\nplummetted by more than 75% after federal investigators revealed that\nthe board of directors is the target of a corruption probe involving\nthe Governor, state lottery officials, and the archbishop.\n</p>\n</body>\n</html>\nIn this example, the JavaScript function ShowPopup() initiates a request to a Python\nscript popupdata.py on the server.The result of this script is just a fragment of\nHTML, which is then displayed in a popup window. Figure 23.1 shows what this might\nlook like in the browser.\nFinally, the entire website might run under the control of Python within the context\nof a framework written in Python. It has been humorously noted that Python has\n“more web programming frameworks than language keywords.”The topics of web\nframeworks is far beyond the scope of this book, but http://wiki.python.org/\nmoin/WebFrameworks is a good starting point for finding more information.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2068,
      "extraction_method": "Direct"
    },
    {
      "page_number": 558,
      "chapter": null,
      "content": "533\ncgi\nFigure 23.1\nPossible browser display where the background text is\njust an ordinary HTML document and the pop-up window is dynamically\ngenerated by the popupdata.py script.\nThe rest of this chapter describes built-in modules related to the low-level interface\nby which Python interfaces with webservers and frameworks.Topics include CGI\nscripting, a technique used to access Python from third-party web servers and WSGI, a\nmiddleware layer used for writing components that integrate with Python’s various web\nframeworks.\ncgi\nThe cgi module is used to implement CGI scripts, which are programs typically execut-\ned by a webserver when it wants to process user input from a form or generate dynam-\nic content of some kind.\nWhen a request corresponding to a CGI script is submitted, the webserver executes\nthe CGI program as a subprocess. CGI programs receive input from two sources:\nsys.stdin and environment variables set by the server.The following list details com-\nmon environment variables set by webservers:\nVariable\nDescription\nAUTH_TYPE\nAuthentication method\nCONTENT_LENGTH\nLength of data passed in sys.stdin\nCONTENT_TYPE\nType of query data\nDOCUMENT_ROOT\nDocument root directory\nGATEWAY_INTERFACE\nCGI revision string\nHTTP_ACCEPT\nMIME types accepted by the client\nHTTP_COOKIE\nNetscape persistent cookie value\nHTTP_FROM\nEmail address of client (often disabled)\nHTTP_REFERER\nReferring URL\nHTTP_USER_AGENT\nClient browser\nPATH_INFO\nExtra path information passed\nPATH_TRANSLATED\nTranslated version of PATH_INFO\nQUERY_STRING\nQuery string\nREMOTE_ADDR\nRemote IP address of the client\nREMOTE_HOST\nRemote host name of the client\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1653,
      "extraction_method": "Direct"
    },
    {
      "page_number": 559,
      "chapter": null,
      "content": "534\nChapter 23 Web Programming\nVariable\nDescription\nREMOTE_IDENT\nUser making the request\nREMOTE_USER\nAuthenticated username\nREQUEST_METHOD\nMethod ('GET' or 'POST')\nSCRIPT_NAME\nName of the program\nSERVER_NAME\nServer host name\nSERVER_PORT\nServer port number\nSERVER_PROTOCOL\nServer protocol\nSERVER_SOFTWARE\nName and version of the server software\nAs output, a CGI program writes to standard output sys.stdout.The gory details of\nCGI programming can be found in a book such as CGI Programming with Perl, 2nd\nEdition, by Shishir Gundavaram (O’Reilly & Associates, 2000). For our purposes, there\nare really only two things to know. First, the contents of an HTML form are passed to a\nCGI program in a sequence of text known as a query string. In Python, the contents of\nthe query string are accessed using the FieldStorage class. For example:\nimport cgi\nform = cgi.FieldStorage()\nname = form.getvalue('name')     # Get 'name' field from a form\nemail = form.getvalue('email')   # Get 'email' field from a form\nSecond, the output of a CGI program consists of two parts: an HTTP header and the\nraw data (which is typically HTML).A blank line always separates these two compo-\nnents.A simple HTTP header looks like this:\nprint 'Content-type: text/html\\r'     # HTML Output\nprint '\\r'                            # Blank line (required!)\nThe rest of the output is the raw output. For example:\nprint '<TITLE>My CGI Script</TITLE>'\nprint '<H1>Hello World!</H1>'\nprint 'You are %s (%s)' % (name, email)\nIt is standard practice that HTTP headers are terminated using the Windows line-\nending convention of '\\r\\n'.That is why the '\\r' appears in the example. If you\nneed to signal an error, include a special 'Status:' header in the output. For example:\nprint 'Status: 401 Forbidden\\r'     # HTTP Error code\nprint 'Content-type: text/plain\\r'\nprint '\\r'                          # Blank line (required)\nprint 'You're not worthy of accessing this page!'\nIf you need to redirect the client to a different page, create output like this:\nprint 'Status: 302 Moved\\r'\nprint 'Location: http://www.foo.com/orderconfirm.html\\r'\nprint '\\r'\nMost of the work in the cgi module is performed by creating an instance of the\nFieldStorage class.\nFieldStorage([input [, headers [, outerboundary [, environ [, keep_blank_values [,\nstrict_parsing]]]]]])\nRead the contents of a form by reading and parsing the query string passed in an envi-\nronment variable or standard input. input specifies a file-like object from which form\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2513,
      "extraction_method": "Direct"
    },
    {
      "page_number": 560,
      "chapter": null,
      "content": "535\ncgi\ndata will be read in a POST request. By default, sys.stdin is used. headers and\nouterboundary are used internally and should not be given. environ is a dictionary\nfrom which CGI environment variables are read. keep_blank_values is a Boolean flag\nthat controls whether blank values are retained or not. By default, it is False.\nstrict_parsing is a Boolean flag that causes an exception to be raised if there is any\nkind of parsing problem. By default, it is False.\nA FieldStorage instance form works similarly to a dictionary. For example, f =\nform[key] will extract an entry for a given parameter key.An instance f extracted in\nthis manner is either another instance of FieldStorage or an instance of\nMiniFieldStorage.The following attributes are defined on f:\nAttribute\nDescription\nf.name\nThe field name, if specified\nf.filename\nClient-side filename used in uploads\nf.value\nValue as a string\nf.file\nFile-like object from which data can be read\nf.type\nContent type\nf.type_options\nDictionary of options specified on the content-type line of\nthe HTTP request\nf.disposition\nThe 'content-disposition' field; None if not speci-\nfied\nf.disposition_options\nDictionary of disposition options\nf.headers\nA dictionary-like object containing all the HTTP header\ncontents\nValues from a form can be extracted using the following methods:\nform.getvalue(fieldname [, default])\nReturns the value of a given field with the name fieldname. If a field is defined twice,\nthis function will return a list of all values defined. If default is supplied, it specifies\nthe value to return if the field is not present. One caution with this method is that if\nthe same form field name is included twice in the request, the returned value will be a\nlist containing both values.To simplify programming, you can use form.getfirst(),\nwhich simply returns the first value found.\nform.getfirst(fieldname [, default])\nReturns the first value defined for a field with the name fieldname. If default is sup-\nplied, it specifies the value to return if the field is not present.\nform.getlist(fieldname)\nReturns a list of all values defined for fieldname. It always returns a list, even if only\none value is defined, and returns an empty list if no values exist.\nIn addition, the cgi module defines a class, MiniFieldStorage, that contains only\nthe attribute’s name and value.This class is used to represent individual fields of a form\npassed in the query string, whereas FieldStorage is used to contain multiple fields and\nmultipart data.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2530,
      "extraction_method": "Direct"
    },
    {
      "page_number": 561,
      "chapter": null,
      "content": "536\nChapter 23 Web Programming\nInstances of FieldStorage are accessed like a Python dictionary, where the keys are\nthe field names on the form.When accessed in this manner, the objects returned are\nthemselves an instance of FieldStorage for multipart data (content type is \n'multipart/form-data') or file uploads, an instance of MiniFieldStorage for sim-\nple fields (content type is 'application/x-www-form-urlencoded'), or a list of such\ninstances in cases where a form contains multiple fields with the same name. For \nexample:\nform = cgi.FieldStorage()\nif \"name\" not in form:\nerror(\"Name is missing\")\nreturn\nname = form['name'].value     # Get 'name' field from a form\nemail = form['email'].value   # Get 'email' field from a form\nIf a field represents an uploaded file, accessing the value attribute reads the entire file\ninto memory as a byte string. Because this may consume a large amount of memory on\nthe server, it may be preferable to read uploaded data in smaller pieces by reading from\nthe file attribute directly. For instance, the following example reads uploaded data line\nby line:\nfileitem = form['userfile']\nif fileitem.file:\n# It's an uploaded file; count lines\nlinecount = 0\nwhile True:\nline = fileitem.file.readline()\nif not line: break\nlinecount = linecount + 1\nThe following utility functions are often used in CGI scripts:\nescape(s [, quote])\nConverts the characters '&', '<', and '>' in string s to HTML-safe sequences such as\n'&amp;', '&lt;', and '&gt;'. If the optional flag quote is true, the double-quote\ncharacter (\") is also translated to '&quot;'.\nparse_header(string)\nParses the data supplied after an HTTP header field such as 'content-type'.The data\nis split into a primary value and a dictionary of secondary parameters that are returned\nin a tuple. For example, the command\nparse_header('text/html; a=hello; b=\"world\"')\nreturns this result:\n('text/html', {'a':'hello', 'b':'world'}).\nparse_multipart(fp, pdict)\nparse_multipart(fp,pdict)\nParses input of type 'multipart/form-data' as is commonly used with file uploads.\nfp is the input file, and pdict is a dictionary containing parameters of the content-type\nheader. It returns a dictionary mapping field names to lists of values.This function\ndoesn’t work with nested multipart data.The FieldStorage class should be used\ninstead.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2339,
      "extraction_method": "Direct"
    },
    {
      "page_number": 562,
      "chapter": null,
      "content": "537\ncgi\nprint_directory()\nFormats the name of the current working directory in HTML and prints it out.The\nresulting output will be sent back to the browser, which can be useful for debugging.\nprint_environ()\nCreates a list of all environment variables formatted in HTML and is used for debug-\nging.\nprint_environ_usage()\nPrints a more selected list of useful environment variables in HTML and is used for\ndebugging.\nprint_form(form)\nFormats the data supplied on a form in HTML. form must be an instance of\nFieldStorage. Used for debugging.\ntest()\nWrites a minimal HTTP header and prints all the information provided to the script in\nHTML format. Primarily used for debugging to make sure your CGI environment is\nset up correctly.\nCGI Programming Advice\nIn the current age of web frameworks, CGI scripting seems to have fallen out of fash-\nion. However, if you are going to use it, there are a couple of programming tips that can\nsimplify your life.\nFirst, don’t write CGI scripts where you are using a huge number of print state-\nments to produce hard-coded HTML output.The resulting program will be a horrible\ntangled mess of Python and HTML that is not only impossible to read, but also impos-\nsible to maintain.A better approach is to rely on templates. Minimally, the\nstring.Template object can be used for this. Here is an example that outlines the\nconcept:\nimport cgi\nfrom string import Template\ndef error(message):\ntemp = Template(open(\"errormsg.html\").read())\nprint 'Content-type: text/html\\r'\nprint '\\r'\nprint temp.substitute({'message' : message})\nform = cgi.FieldStorage()\nname  = form.getfirst('name')\nemail = form.getfirst('email')\nif not name:\nerror(\"name not specified\")\nraise SystemExit\nelif not email:\nerror(\"email not specified\")\nraise SystemExit\n# Do various processing\nconfirmation = subscribe(name, email)\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1849,
      "extraction_method": "Direct"
    },
    {
      "page_number": 563,
      "chapter": null,
      "content": "538\nChapter 23 Web Programming\n# Print the output page\nvalues = {\n'name' : name,\n'email' : email,\n'confirmation: ': confirmation,\n# Add other values here...\n}\ntemp = Template(open(\"success.html\").read()\nprint temp.substitute(values)\nIn this example, the files 'error.html' and 'success.html' are HTML pages that\nhave all of the output but include $variable substitutions corresponding to dynami-\ncally generated values used in the CGI script. For example, the 'success.html' file\nmight look like this:\n<HTML>\n<HEAD>\n<TITLE>Success</TITLE>\n</HEAD>\n<BODY>\nWelcome $name.  You have successfully subscribed to our\nnewsletter.  Your confirmation code is $confirmation.\n</BODY>\n</HTML>\nThe temp.substitute() operation in the script is simply filling in the variables in this\nfile.An obvious benefit of this approach is that if you want to change the appearance of\nthe output, you just modify the template files, not the CGI script.There are many third-\nparty template engines available for Python—maybe in even greater numbers than web\nframeworks.These take the templating concept and build upon it in substantial ways.\nSee http://wiki.python.org/moin/Templating more details.\nSecond, if you need to save data from a CGI script, try to use a database.Although it\nis easy enough to write data directly to files, webservers operate concurrently, and unless\nyou’ve taken steps to properly lock and synchronize resources, it is possible that files will\nget corrupted. Database servers and their associated Python interface usually don’t have\nthis problem. So if you need to save data, try to use a module such as sqlite3 or a\nthird-party module for something like MySQL.\nFinally, if you find yourself writing dozens of CGI scripts and code that has to deal\nwith low-level details of HTTP such as cookies, authentication, encoding, and so forth,\nyou may want to consider a web framework instead.The whole point of using a frame-\nwork is so that you don’t have to worry about those details—well, at least not as much.\nSo, don’t reinvent the wheel.\nNotes\nn The process of installing a CGI program varies widely according to the type of\nwebserver being used.Typically programs are placed in a special cgi-bin directo-\nry.A server may also require additional configuration.You should consult the doc-\numentation for the server or the server’s administrator for more details.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2382,
      "extraction_method": "Direct"
    },
    {
      "page_number": 564,
      "chapter": null,
      "content": "539\ncgitb\nn On UNIX, Python CGI programs may require appropriate execute permissions\nto be set and a line such as the following to appear as the first line of the \nprogram:\n#!/usr/bin/env python\nimport cgi\n...\nn To simplify debugging, import the cgitb module—for example, import cgitb;\ncgitb.enable().This modifies exception handling so that errors are displayed\nin the web browser.\nn If you invoke an external program—for example, via the os.system() or\nos.popen() function—be careful not to pass arbitrary strings received from the\nclient to the shell.This is a well-known security hole that hackers can use to exe-\ncute arbitrary shell commands on the server (because the command passed to\nthese functions is first interpreted by the UNIX shell as opposed to being execut-\ned directly). In particular, never pass any part of a URL or form data to a shell\ncommand unless it has first been thoroughly checked by making sure that the\nstring contains only alphanumeric characters, dashes, underscores, and periods.\nn On UNIX, don’t give a CGI program setuid mode.This is a security liability\nand not supported on all machines.\nn Don’t use 'from cgi import *' with this module.The cgi module defines a\nwide variety of names and symbols that you probably don’t want in your name-\nspace.\ncgitb\nThis module provides an alternative exception handler that displays a detailed report\nwhenever an uncaught exception occurs.The report contains source code, values of\nparameters, and local variables. Originally, this module was developed to help debug\nCGI scripts, but it can be used in any application.\nenable([display [, logdir [, context [, format]]]])\nEnables special exception handling. display is a flag that determines whether any\ninformation is displayed when an error occurs.The default value is 1. logdir specifies a\ndirectory in which error reports will be written to files instead of printed to standard\noutput.When logdir is given, each error report is written to a unique file created by\nthe tempfile.mkstemp() function. context is an integer specifying the number of\nlines of source code to display around lines upon which the exception occurred.\nformat is a string that specifies the output format.A format of 'html' specifies HTML\n(the default).Any other value results in plain-text format.\nhandle([info])\nHandles an exception using the default settings of the enable() function. info is a\ntuple (exctype, excvalue, tb) where exctype is an exception type, excvalue is\nan exception value, and tb is a traceback object.This tuple is normally obtained using\nsys.exc_info(). If info is omitted, the current exception is used.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2651,
      "extraction_method": "Direct"
    },
    {
      "page_number": 565,
      "chapter": null,
      "content": "540\nChapter 23 Web Programming\nNote\nTo enable special exception handling in CGI scripts, include the line import cgitb;\nenable() at the beginning of the script.\nwsgiref\nWSGI (Python Web Server Gateway Interface) is a standardized interface between web-\nservers and web applications that is designed to promote portability of applications\nacross different webservers and frameworks.An official description of the standard is\nfound in PEP 333 (http://www.python.org/dev/peps/pep-0333). More information\nabout the standard and its use can also be found at http://www.wsgi.org.The wsgiref\npackage is a reference implementation that can be used for testing, validation, and simple\ndeployments.\nThe WSGI Specification\nWith WSGI, a web application is implemented as a function or callable object\nwebapp(environ, start_response) that accepts two arguments. environ is a dic-\ntionary of environment settings that is minimally required to have the following values\nwhich have the same meaning and names as is used in CGI scripting:\nenviron Variables\nDescription\nCONTENT_LENGTH\nLength of data passed\nCONTENT_TYPE\nType of query data\nHTTP_ACCEPT\nMIME types accepted by the client\nHTTP_COOKIE\nNetscape persistent cookie value\nHTTP_REFERER\nReferring URL\nHTTP_USER_AGENT\nClient browser\nPATH_INFO\nExtra path information passed\nQUERY_STRING\nQuery string\nREQUEST_METHOD\nMethod ('GET' or 'POST')\nSCRIPT_NAME\nName of the program\nSERVER_NAME\nServer host name\nSERVER_PORT\nServer port number\nSERVER_PROTOCOL\nServer protocol\nIn addition, the environ dictionary is required to contain the following WSGI-specific\nvalues:\nenviron Variables\nDescription\nwsgi.version\nTuple representing the WSGI version (e.g., (1,0) for WSGI 1.0).\nwsgi.url_scheme\nString representing the scheme component of the URL. For\nexample, 'http' or 'https'.\nwsgi.input\nA file-like object representing the input stream. Additional data\nsuch as form data or uploads are read from this.\nwsgi.errors\nA file-like object opened in text mode for writing error output.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2028,
      "extraction_method": "Direct"
    },
    {
      "page_number": 566,
      "chapter": null,
      "content": "541\nwsgiref\nenviron Variables\nDescription\nwsgi.multithread\nA Boolean flag that’s True if the application can be executed\nconcurrently by another thread in the same process.\nwsgi.multiprocess\nA Boolean flag that’s True if the application can be executed\nconcurrently by another process.\nwsgi.run_once\nA Boolean flag that’s True if the application will only be exe-\ncuted once during the lifetime of the executing process. \nThe start_response parameter is a callable object of the form\nstart_response(status, headers) that is used by the application to start a\nresponse. status is a string such as '200 OK' or '404 Not Found'. headers is a list\nof tuples, each of the form (name, value) corresponding to a HTTP header to be\nincluded in the response—for example, ('Content-type','text/html').\nThe data or body of a response is returned by the web application function as an\niterable object that produces a sequence of byte strings or text strings that only contain\ncharacters which can be encoded as a single byte (e.g., compatible with the ISO-8859-1\nor Latin-1 character set). Examples include a list of byte strings or a generator function\nproducing byte strings. If an application needs to do any kind of character encoding\nsuch as UTF-8, it must do this itself.\nHere is an example of a simple WSGI application that reads form fields and produces\nsome output, similar to what was shown in the cgi module section:\nimport cgi\ndef subscribe_app(environ, start_response):\nfields = cgi.FieldStorage(environ['wsgi.input'],\nenviron=environ)\nname = fields.getvalue(\"name\")\nemail = fields.getvalue(\"email\")\n# Various processing\nstatus = \"200 OK\"\nheaders = [('Content-type','text/plain')]\nstart_response(status, headers)\nresponse = [\n'Hi %s. Thank you for subscribing.' % name,\n'You should expect a response soon.'\n]\nreturn (line.encode('utf-8') for line in response)\nThere are a few critical details in this example. First,WSGI application components are\nnot tied to specific framework, webserver, or set of library modules. In the example,\nwe’re only using one library module, cgi, simply because it has some convenience\nfunctions for parsing query variables.The example shows how the start_response()\nfunction is used to initiate a response and supply headers.The response itself is con-\nstructed as a list of strings.The final statement in this application is a generator expres-\nsion that turns all strings into byte strings. If you’re using Python 3, this is a critical\nstep—all WSGI applications are expected to return encoded bytes, not unencoded\nUnicode data.\nTo deploy a WSGI application, it has to be registered with the web programming\nframework you happen to be using. For this, you’ll have to read the manual.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2737,
      "extraction_method": "Direct"
    },
    {
      "page_number": 567,
      "chapter": null,
      "content": "542\nChapter 23 Web Programming\nwsgiref Package\nThe wsgiref package provides a reference implementation of the WSGI standard that\nallows applications to be tested in stand-alone servers or executed as normal CGI\nscripts.\nwsgiref.simple_server\nThe wsgiref.simple_server module implements a simple stand-alone HTTP server\nthat runs a single WSGI application.There are just two functions of interest:\nmake_server(host, port, app)\nCreates an HTTP server that accepts connections on the given host name host and\nport  number port. app is a function or callable object that implements a WSGI appli-\ncation.To run the server, use s.serve_forever() where s is an instance of the server\nthat is returned.\ndemo_app(environ, start_response)\nA complete WSGI application that returns a page with a “Hello World” message on it.\nThis can be used as the app argument to make_server() to verify that the server is\nworking correctly.\nHere is an example of running a simple WSGI server:\ndef my_app(environ, start_response):\n# Some application\nstart_response(\"200 OK\",[('Content-type','text/plain')])\nreturn ['Hello World']\nif _ _name_ _ == '_ _main_ _':\nfrom wsgiref.simple_server import make_server\nserv = make_server('',8080, my_app)\nserv.serve_forever()\nwsgiref.handlers\nThe wsgiref.handlers module contains handler objects for setting up a WSGI exe-\ncution environment so that applications can run within another webserver (e.g., CGI\nscripting under Apache).There are few different objects.\nCGIHandler()\nCreates a WSGI handler object that runs inside a standard CGI environment.This han-\ndler collects information from the standard environment variables and I/O streams as\ndescribed in the cgi library module.\nBaseCGIHandler(stdin, stdout, stderr, environ [, multithread [, multiprocess]])\nCreates a WSGI handler that operates within a CGI environment, but where the stan-\ndard I/O streams and environment variables might be set up in a different way. stdin,\nstdout, and stderr specify file-like objects for the standard I/O streams. environ is a\ndictionary of environment variables that is expected to already contain the standard\nCGI environment variables. multithread and multiprocess are Boolean flags that\nare used to set the wsgi.multithread and wsgi.multiprocess environment vari-\nables. By default, multithread is True and multiprocess is False.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2360,
      "extraction_method": "Direct"
    },
    {
      "page_number": 568,
      "chapter": null,
      "content": "543\nwsgiref\nSimpleHandler(stdin, stdout, stderr, environ [, multithread [, multiprocess]])\nCreates a WSGI handler that is similar to BaseCGIHandler, but which gives the under-\nlying application direct access to stdin, stdout, stderr, and environ.This is slightly\ndifferent than BaseCGIHandler that provides extra logic to process certain features cor-\nrectly (e.g., in BaseCGIHandler, response codes are translated into Status: headers).\nAll of these handlers have a method run(app) that is used to run a WSGI applica-\ntion within the handler. Here is an example of a WSGI application running as a tradi-\ntional CGI script:\n#!/usr/bin/env python\ndef my_app(environ, start_response):\n# Some application\nstart_response(\"200 OK\",[('Content-type','text/plain')])\nreturn ['Hello World']\nfrom wgiref.handlers import CGIHandler\nhand = CGIHandler()\nhand.run(my_app)\nwsgiref.validate\nThe wsgiref.validate module has a function that wraps a WSGI application with a\nvalidation wrapper to ensure that both it and the server are operating according to the\nstandard.\nvalidator(app)\nCreates a new WSGI application that wraps the WSGI application app.The new appli-\ncation transparently works in the same way as app except that extensive error-checking\nis added to make sure the application and the server are following the WSGI standard.\nAny violation results in an AssertionError exception.\nHere is an example of using the validator:\ndef my_app(environ, start_response):\n# Some application\nstart_response(\"200 OK\",[('Content-type','text/plain')])\nreturn ['Hello World']\nif _ _name_ _ == '_ _main_ _':\nfrom wsgiref.simple_server import make_server\nfrom wsgiref.validate import validator\nserv = make_server('',8080, validator(my_app))\nserv.serve_forever()\nNote\nThe material in this section is primarily aimed at users of WSGI who want to create\napplication objects. If, on the other hand, you are implementing yet another web frame-\nwork for Python, you should consult PEP 333 for official details on precisely what is\nneeded to make your framework support WSGI. If you are using a third-party web frame-\nwork, you will need to consult the framework documentation for details concerning its\nsupport for WSGI objects. Given that WSGI is an officially blessed specification with a\nreference implementation in the standard library, it is increasingly common for frame-\nworks to provide some level of support for it.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2419,
      "extraction_method": "Direct"
    },
    {
      "page_number": 569,
      "chapter": null,
      "content": "544\nChapter 23 Web Programming\nwebbrowser\nThe webbrowser module provides utility functions for opening documents in a web\nbrowser in a platform-independent manner.The main use of this module is in develop-\nment and testing situations. For example, if you wrote a script that generated HTML\noutput, you could use the functions in this module to automatically direct your system’s\nbrowser to view the results.\nopen(url [, new [, autoraise]])\nDisplays url with the default browser on the system. If new is 0, the URL is opened in\nthe same window as a running browser, if possible. If new is 1, a new browser window is\ncreated. If new is 2, the URL is opened within a new tab within the browser. If\nautoraise is True, the browser window is raised.\nopen_new(url)\nDisplays url in a new window of the default browser.The same as open(url, 1).\nopen_new_tab(url)\nDisplays url in a new tab of the default browser.The same as open(url, 2).\nget([name])\nReturns a controller object for manipulating a browser. name is the name of the brows-\ner type and is typically a string such as  'netscape', 'mozilla', 'kfm', 'grail',\n'windows-default', 'internet-config', or 'command-line'.The returned con-\ntroller object has methods open() and open_new() that accept the same arguments\nand perform the same operation as the two previous functions. If name is omitted, a\ncontroller object for the default browser is returned.\nregister(name, constructor[, controller])\nRegisters a new browser type for use with the get() function. name is the name of the\nbrowser. constructor is called without arguments to create a controller object for\nopening pages in the browser. controller is a controller instance to use instead. If sup-\nplied, constructor is ignored and may be None.\nA controller instance, c, returned by the get() function has the following methods:\nc.open(url[, new])\nSame as the open() function.\nc.open_new(url)\nSame as the open_new() function.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1954,
      "extraction_method": "Direct"
    },
    {
      "page_number": 570,
      "chapter": null,
      "content": "24\nInternet Data Handling and\nEncoding\nThis chapter describes modules related to processing common Internet data formats\nand encodings such as base 64, HTML, XML, and JSON.\nbase64\nThe base64 module is used to encode and decode binary data into text using base 64,\nbase 32, or base 16 encoding. Base 64 is commonly used to embed binary data in mail\nattachments and with parts of the HTTP protocol. Official details can be found in\nRFC-3548 and RFC-1421.\nBase 64 encoding works by grouping the data to be encoded into groups of 24 bits\n(3 bytes). Each 24-bit group is then subdivided into four 6-bit components. Each 6-bit\nvalue is then represented by a printable ASCII character from the following alphabet:\nValue\nEncoding\n0–25\nABCDEFGHIJKLMNOPQRSTUVWXYZ\n26–51\nabcdefghijklmnopqrstuvwxyz\n52–61\n0123456789\n62\n+\n63\n/\npad\n=\nIf the number of bytes in the input stream is not a multiple of 3 (24 bits), the data is\npadded to form a complete 24-bit group.The extra padding is then indicated by special\n'=' characters that appear at the end of the encoding. For example, if you encode a 16-\nbyte character sequence, there are five 3-byte groups with 1 byte left over.The remain-\ning byte is padded to form a 3-byte group.This group then produces two characters\nfrom the base 64 alphabet (the first 12 bits, which include 8 bits of real data), followed\nby the sequence '==', representing the bits of extra padding.A valid base 64 encoding\nwill only have zero, one (=), or two (==) padding characters at the end of the encod-\ning.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1543,
      "extraction_method": "Direct"
    },
    {
      "page_number": 571,
      "chapter": null,
      "content": "546\nChapter 24 Internet Data Handling and Encoding\nBase 32 encoding works by grouping binary data into groups of 40 bits (5 bytes).\nEach 40-bit group is subdivided into eight 5-bit components. Each 5-bit value is then\nencoded using the following alphabet:\nValue\nEncoding\n0–25\nABCDEFGHIJKLMNOPQRSTUVWXYZ\n26–31\n2–7\nAs with base 64, if the end of the input stream does not form a 40-bit group, it is\npadded to 40 bits and the '=' character is used to represent the extra padding in the\noutput.At most, there will be six padding characters ('======'), which occurs if the\nfinal group only includes 1 byte of data.\nBase 16 encoding is the standard hexadecimal encoding of data. Each 4-bit group is\nrepresented by the digits '0'–'9' and the letters 'A'–'F'.There is no extra padding or\npad characters for base 16 encoding.\nb64encode(s [, altchars])\nEncodes a byte string s using base 64 encoding. altchars, if given, is a two-character\nstring that specifies alternative characters to use for '+' and '/' characters that normal-\nly appear in base 64 output.This is useful if base 64 encoding is being used with file-\nnames or URLs.\nb64decode(s [, altchars])\nDecodes string s, which is encoded as base 64 and returns a byte string with the\ndecoded data. altchars, if given, is a two-character string that specifies the alternative\ncharacters for '+' and '/' that normally appear in base 64–encoded data. TypeError is\nraised if the input s contains extraneous characters or is incorrectly padded.\nstandard_b64encode(s)\nEncodes a byte string s using the standard base 64 encoding.\nstandard_b64decode(s)\nDecodes string s using standard base 64 encoding.\nurlsafe_b64encode(s)\nEncodes a byte string s using base 64 but uses the characters '-' and '_' instead of\n'+' and '/', respectively.The same as b64encode(s, '-_').\nurlsafe_b64decode(s)\nDecodes string s encoded with a URL-safe base 64 encoding.\nb32encode(s)\nEncodes a byte string s using base 32 encoding.\nb32decode(s [, casefold [, map01]])\nDecodes string s using base 32 encoding. If casefold is True, both uppercase and\nlowercase letters are accepted. Otherwise, only uppercase letters may appear (the\ndefault). map01, if present, specifies which letter the digit 1 maps to (for example, the\nletter 'I' or the letter 'L'). If this argument is given, the digit '0' is also mapped to\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2349,
      "extraction_method": "Direct"
    },
    {
      "page_number": 572,
      "chapter": null,
      "content": "547\nbinascii\nthe letter 'O'.A TypeError is raised if the input string contains extraneous characters\nor is incorrectly padded.\nb16encode(s)\nEncodes a byte string s using base 16 (hex) encoding.\nb16decode(s [,casefold])\nDecodes string s using base 16 (hex) encoding. If casefold is True, letters may be\nuppercase or lowercase. Otherwise, hexadecimal letters 'A'–'F' must be uppercase (the\ndefault). Raises TypeError if the input string contains extraneous characters or is mal-\nformed in any way.\nThe following functions are part of an older base 64 module interface that you may\nsee used in existing Python code:\ndecode(input, output)\nDecodes base 64–encoded data. input is a filename or a file object open for reading.\noutput is a filename or a file object open for writing in binary mode.\ndecodestring(s)\nDecodes a base 64–encoded string, s. Returns a string containing the decoded binary\ndata.\nencode(input, output)\nEncodes data using base 64. input is a filename or a file object open for reading in\nbinary mode. output is a filename or a file object open for writing.\nencodestring(s)\nEncodes a byte string, s, using base 64.\nbinascii\nThe binascii module contains low-level functions for converting data between binary\nand a variety of ASCII encodings, such as base 64, BinHex, and UUencoding.\na2b_uu(s)\nConverts a line of uuencoded text s to binary and returns a byte string. Lines normally\ncontain 45 (binary) bytes, except for the last line that may be less. Line data may be fol-\nlowed by whitespace.\nb2a_uu(data)\nConverts a string of binary data to a line of uuencoded ASCII characters.The length of\ndata should not be more than 45 bytes. Otherwise, the Error exception is raised.\na2b_base64(string)\nConverts a string of base 64–encoded text to binary and returns a byte string.\nb2a_base64(data)\nConverts a string of binary data to a line of base 64–encoded ASCII characters.The\nlength of data should not be more than 57 bytes if the resulting output is to be trans-\nmitted through email (otherwise it might get truncated).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2055,
      "extraction_method": "Direct"
    },
    {
      "page_number": 573,
      "chapter": null,
      "content": "548\nChapter 24 Internet Data Handling and Encoding\na2b_hex(string)\nConverts a string of hexadecimal digits to binary data.This function is also called as\nunhexlify(string).\nb2a_hex(data)\nConverts a string of binary data to a hexadecimal encoding.This function is also called\nas hexlify(data).\na2b_hqx(string)\nConverts a string of BinHex 4–encoded data to binary without performing RLE (Run-\nLength Encoding) decompression.\nrledecode_hqx(data)\nPerforms an RLE decompression of the binary data in data. Returns the decompressed\ndata unless the data input is incomplete, in which case the Incomplete exception is\nraised.\nrlecode_hqx(data)\nPerforms a BinHex 4 RLE compression of data.\nb2a_hqx(data)\nConverts the binary data to a string of BinHex 4–encoded ASCII characters. data\nshould already be RLE-coded.Also, unless data is the last data fragment, the length of\ndata should be divisible by 3.\ncrc_hqx(data, crc)\nComputes the BinHex 4 CRC checksum of the byte string data. crc is a starting\nvalue of the checksum.\ncrc32(data [, crc])\nComputes the CRC-32 checksum of the byte string data. crc is an optional initial\nCRC value. If omitted, crc defaults to 0.\ncsv\nThe csv module is used to read and write files consisting of comma-separated values\n(CSV).A CSV file consists of rows of text, each row consisting of values separated by a\ndelimiter character, typically a comma (,) or a tab. Here’s an example:\nBlues,Elwood,\"1060 W Addison\",\"Chicago, IL 60613\",\"B263-1655-2187\",116,56\nVariants of this format commonly occur when working with databases and spreadsheets.\nFor instance, a database might export tables in CSV format, allowing the tables to be\nread by other programs. Subtle complexities arise when fields contain the delimiter\ncharacter. For instance, in the preceding example, one of the fields contains a comma\nand must be placed in quotes.This is why using basic string operations such as\nsplit(',') are often not enough to work with such files.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1977,
      "extraction_method": "Direct"
    },
    {
      "page_number": 574,
      "chapter": null,
      "content": "549\ncsv\nreader(csvfile [, dialect\n[, **fmtparams])\nReturns a reader object that produces the values for each line of input of the input file\ncsvfile. csvfile is any iterable object that produces a complete line of text on each\niteration.The returned reader object is an iterator that produces a list of strings on each\niteration.The dialect parameter is either a string containing the name of a dialect or a\nDialect object.The purpose of the dialect parameter is to account for differences\nbetween different CSV encodings.The only built-in dialects supported by this module\nare 'excel' (which is the default value) and 'excel-tab', but others can be defined\nby the user as described later in this section. fmtparams is a set of keyword arguments\nthat customize various aspects of the dialect.The following keyword arguments can be\ngiven:\nKeyword Argument\nDescription\ndelimiter\nCharacter used to separate fields (the default is ',').\ndoublequote\nBoolean flag that determines how the quote character\n(quotechar) is handled when it appears in a field. If True, the\ncharacter is simply doubled. If False, an escape character\n(escapechar) is used as a prefix. The default is True.\nescapechar\nCharacter used as an escape character when the delimiter\nappears in a field and quoting is QUOTE_NONE. The default\nvalue is None.\nlineterminator\nLine termination sequence ('\\r\\n' is the default).\nquotechar\nCharacter used to quote fields that contain the delimiter ('\"'\nis the default).\nskipinitialspace\nIf True, whitespace immediately following the delimiter is\nignored (False is the default).\nwriter(csvfile [, dialect [, **fmtparam]])\nReturns a writer object that can be used to create a CSV file. csvfile is any file-like\nobject that supports a write() method. dialect has the same meaning as for \nreader() and is used to handle differences between various CSV encodings. fmt-\nparams has the same meaning as for readers. However, one additional keyword argu-\nment is available:\nKeyword Argument\nDescription\nquoting\nControls the quoting behavior of output data. It’s set to one of\nQUOTE_ALL (quotes all fields), QUOTE_MINIMAL (only quote\nfields that contain the delimiter or start with the quote charac-\nter), QUOTE_NONNUMERIC (quote all nonnumeric fields), or\nQUOTE_NONE (never quote fields). The default value is\nQUOTE_MINIMAL.\nA writer instance, w, supports the following methods:\nw.writerow(row)\nWrites a single row of data to the file. row must be a sequence of strings or numbers.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2498,
      "extraction_method": "Direct"
    },
    {
      "page_number": 575,
      "chapter": null,
      "content": "550\nChapter 24 Internet Data Handling and Encoding\nw.writerows(rows)\nWrites multiple rows of data. rows must be a sequence of rows as passed to the\nwriterow() method.\nDictReader(csvfile [, fieldnames [, restkey [, restval [, dialect [,\n➥**fmtparams]]]]])\nReturns a reader object that operates like the ordinary reader but returns dictionary\nobjects instead of lists of strings when reading the file. fieldnames provides a list of\nfield names used as keys in the returned dictionary. If omitted, the dictionary key names\nare taken from the first row of the input file. restkey provides the name of a diction-\nary key that’s used to store excess data—for instance, if a row has more data fields than\nfield names. restval is a default value that’s used as the value for fields that are missing\nfrom the input—for instance, if a row does not have enough fields.The default value of\nrestkey and restval is None. dialect and fmtparams have the same meaning as for\nreader().\nDictWriter(csvfile, fieldnames [, restval [, extrasaction [, dialect [,\n➥**fmtparams]]]])\nReturns a writer object that operates like the ordinary writer but writes dictionaries\ninto output rows. fieldnames specifies the order and names of attributes that will be\nwritten to the file. restval is the value that’s written if the dictionary being written is\nmissing one of the field names in fieldnames. extrasaction is a string that specifies\nwhat to do if a dictionary being written has keys not listed in fieldnames.The default\nvalue of extrasaction is 'raise', which raises a ValueError exception.A value of\n'ignore' may be used, in which case extra values in the dictionary are ignored.\ndialect and fmtparams have the same meaning as with writer().\nA DictWriter instance, w, supports the following methods:\nw.writerow(row)\nWrites a single row of data to the file. row must be a dictionary that maps field names\nto values.\nw.writerows(rows)\nWrites multiple rows of data. rows must be a sequence of rows as passed to the\nwriterow() method.\nSniffer()\nCreates a Sniffer object that is used to try and automatically detect the format of a\nCSV file.\nA Sniffer instance, s, has the following methods:\ns.sniff(sample [, delimiters])\nLooks at data in sample and returns an appropriate Dialect object representing the\ndata format. sample is a portion of a CSV file containing at least one row of data.\ndelimiters, if supplied, is a string containing possible field delimiter characters.\ns.has_header(sample)\nLooks at the CSV data in sample and returns True if the first row looks like a collec-\ntion of column headers.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2601,
      "extraction_method": "Direct"
    },
    {
      "page_number": 576,
      "chapter": null,
      "content": "551\ncsv\nDialects\nMany of the functions and methods in the csv module involve a special dialect param-\neter.The purpose of this parameter is to accommodate different formatting conventions\nof CSV files (for which there is no official “standard” format)—for example, differences\nbetween comma-separated values and tab-delimited values, quoting conventions, and so\nforth.\nDialects are defined by inheriting from the class Dialect and defining the same set\nof attributes as the formatting parameters given to the reader() and writer() func-\ntions (delimiter, doublequote, escapechar, lineterminator, quotechar,\nquoting, skipinitialspace).\nThe following utility functions are used to manage dialects:\nregister_dialect(name, dialect)\nRegisters a new Dialect object, dialect, under the name name.\nunregister_dislect(name)\nRemoves the Dialect object with name name.\nget_dialect(name)\nReturns the Dialect object with name name.\nlist_dialects()\nReturns a list of all registered dialect names. Currently, there are only two built-in\ndialects: 'excel' and 'excel-tab'.\nExample\nimport csv\n# Read a basic CSV file\nf = open(\"scmods.csv\",\"r\")\nfor r in csv.reader(f):\nlastname, firstname, street, city, zip = r\nprint(\"{0} {1} {2} {3} {4}\".format(*r))\n# Using a DictReader instead\nf = open(\"address.csv\")\nr = csv.DictReader(f,['lastname','firstname','street','city','zip'])\nfor a in r:\nprint(\"{firstname} {lastname} {street} {city} {zip}\".format(**a))\n# Write a basic CSV file\ndata = [\n['Blues','Elwood','1060 W Addison','Chicago','IL','60613' ],\n['McGurn','Jack','4802 N Broadway','Chicago','IL','60640' ],\n]\nf = open(\"address.csv\",\"w\")\nw = csv.writer(f)\nw.writerows(data)\nf.close()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1688,
      "extraction_method": "Direct"
    },
    {
      "page_number": 577,
      "chapter": null,
      "content": "552\nChapter 24 Internet Data Handling and Encoding\nemail Package\nThe email package provides a wide variety of functions and objects for representing,\nparsing and manipulating email messages encoded according to the MIME standard.\nCovering every detail of the email package is not practical here, nor would it be of\ninterest to most readers.Thus, the rest of this section focuses on two common practical\nproblems—parsing email messages in order to extract useful information and creating\nemail messages so that they can be sent using the smtplib module.\nParsing Email\nAt the top level, the email module provides two functions for parsing messages:\nmessage_from_file(f)\nParses an email message read from the file-like object f which must be opened in text\nmode.The input message should be a complete MIME-encoded email message includ-\ning all headers, text, and attachments. Returns a Message instance.\nmessage_from_string(str)\nParses an email message by reading an email message from the text string str. Returns\na Message instance.\nA Message instance m returned by the previous functions emulates a dictionary and\nsupports the following operations for looking up message data:\nOperation\nDescription\nm[name]\nReturns the value of header name.\nm.keys()\nReturns a list of all message header names.\nm.values()\nReturns a list of message header values.\nm.items()\nReturns a list of tuples containing message header names and\nvalues.\nm.get(name [,def]) Returns a header value for header name. def specifies a\ndefault value to return if not found.\nlen(m)\nReturns the number of message headers.\nstr(m)\nTurns the message into a string. The same as the\nas_string() method.\nname in m\nReturns True if name is the name of a header in the mes-\nsage.\nIn addition to these operators, m has the following methods that can be used to extract\ninformation:\nm.get_all(name [, default])\nReturns a list of all values for a header with name name. Returns default if no such\nheader exists.\nm.get_boundary([default])\nReturns the boundary parameter found within the 'Content-type' header of a mes-\nsage.Typically the boundary is a string such as '===============0995017162=='\nthat’s used to separate the different subparts of a message. Returns default if no\nboundary parameter could be found.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2286,
      "extraction_method": "Direct"
    },
    {
      "page_number": 578,
      "chapter": null,
      "content": "553\nemail Package\nm.get_charset()\nReturns the character set associated with the message payload (for instance,\n'iso-8859-1').\nm.get_charsets([default])\nReturns a list of all character sets that appear in the message. For multipart messages, the\nlist will represent the character set of each subpart.The character set of each part is\ntaken from 'Content-type' headers that appear in the message. If no character set is\nspecified or the content-type header is missing, the character set for that part is set to\nthe value of default (which is None by default).\nm.get_content_charset([default])\nReturns the character set from the first 'Content-type' header in the message. If the\nheader is not found or no character set is specified, default is returned.\nm.get_content_maintype()\nReturns the main content type (for example, 'text' or 'multipart').\nm.get_content_subtype()\nReturns the subcontent type (for example, 'plain' or 'mixed').\nm.get_content_type()\nReturns a string containing the message content type (for example,\n'multipart/mixed' or 'text/plain').\nm.get_default_type()\nReturns the default content type (for example, 'text/plain' for simple messages).\nm.get_filename([default])\nReturns the filename parameter from a 'Content-Disposition' header, if any.\nReturns default if the header is missing or does not have a filename parameter.\nm.get_param(param [, default [, header [, unquote]]])\nEmail headers often have parameters attached to them such as the 'charset' and\n'format' parts of the header 'Content-Type: text/plain; charset=\"utf-8\";\nformat=flowed'.This method returns the value of a specific header parameter. param\nis a parameter name, default is a default value to return if the parameter is not found,\nheader is the name of the header, and unquote specifies whether or not to unquote\nthe parameter. If no value is given for header, parameters are taken from the\n'Content-type' header.The default value of unquote is True.The return value is\neither a string or a 3-tuple (charset, language, value) in the event the parameter\nwas encoded according to RFC-2231 conventions. In this case, charset is a string such\nas 'iso-8859-1', language is a string containing a language code such as 'en', and\nvalue is the parameter value.\nm.get_params([default [, header [, unquote]]])\nReturns all parameters for header as a list. default specifies the value to return if the\nheader isn’t found. If header is omitted, the 'Content-type' header is used. unquote\nis a flag that specifies whether or not to unquote values (True by default).The contents\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2573,
      "extraction_method": "Direct"
    },
    {
      "page_number": 579,
      "chapter": null,
      "content": "554\nChapter 24 Internet Data Handling and Encoding\nof the returned list are tuples (name, value) where name is the parameter name and\nvalue is the value as returned by the get_param() method.\nm.get_payload([i [, decode]])\nReturns the payload of a message. If the message is a simple message, a byte string con-\ntaining the message body is returned. If the message is a multipart message, a list con-\ntaining all the subparts is returned. For multipart messages, i specifies an optional \nindex in this list. If supplied, only that message component will be returned. If \ndecode is True, the payload is decoded according to the setting of any \n'Content-Transfer-Encoding' header that might be present (for example,\n'quoted-printable', 'base64', and so on).To decode the payload of a simple non-\nmultipart message, set i to None and decode to True or specify decode using a key-\nword argument. It should be emphasized that the payload is returned as a byte string \ncontaining the raw content. If the payload represents text encoded in UTF-8 or some\nother encoding, you will need to use the decode() method on the result to convert it.\nm.get_unixfrom()\nReturns the UNIX-style 'From ...' line, if any.\nm.is_multipart()\nReturns True if m is a multipart message.\nm.walk()\nCreates a generator that iterates over all the subparts of a message, each of which is also\nrepresented by a Message instance.The iteration is a depth-first traversal of the message.\nTypically, this function could be used to process all the components of a multipart mes-\nsage.\nFinally, Message instances have a few attributes that are related to low-level parsing\nprocess.\nm.preamble\nAny text that appears in a multipart message between the blank line that signals the end\nof the headers and the first occurrence of the multipart boundary string that marks the\nfirst subpart of the message.\nm.epilogue\nAny text in the message that appears after the last multipart boundary string and the\nend of the message.\nm.defects\nA list of all message defects found when parsing the message. Consult the online docu-\nmentation for the email.errors module for further details.\nThe following example illustrates how the Message class is used while parsing an\nemail message.The following code reads an email message, prints a short summary of\nuseful headers, prints the plain text portions of the message, and saves any attachments.\nimport email\nimport sys\nf = open(sys.argv[1],\"r\")          # Open message file\nm = email.message_from_file(f)     # Parse message\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2536,
      "extraction_method": "Direct"
    },
    {
      "page_number": 580,
      "chapter": null,
      "content": "555\nemail Package\n# Print short summary of sender/recipient\nprint(\"From    : %s\" % m[\"from\"])\nprint(\"To      : %s\" % m[\"to\"])\nprint(\"Subject : %s\" % m[\"subject\"])\nprint(\"\")\nif not m.is_multipart():\n# Simple message. Just print the payload\npayload = m.get_payload(decode=True)\ncharset = m.get_content_charset('iso-8859-1')\nprint(payload.decode(charset))\nelse:\n# Multipart message.   Walk over all subparts and\n#     1. Print text/plain fragments\n#     2. Save any attachments\nfor s in m.walk():\nfilename = s.get_filename()\nif filename:\nprint(\"Saving attachment: %s\" % filename)\ndata = s.get_payload(decode=True)\nopen(filename,\"wb\").write(data)\nelse:\nif s.get_content_type() == 'text/plain':\npayload = s.get_payload(decode=True)\ncharset = s.get_content_charset('iso-8859-1')\nprint(payload.decode(charset))\nIn this example, it is important to emphasize that operations that extract the payload of\na message always return byte strings. If the payload represents text, you also need to\ndecode it according to some character set.The m.get_content_charset() and\npayload.decode() operations in the example are carrying out this conversion.\nComposing Email\nTo compose an email message, you can either create an empty instance of a Message\nobject, which is defined in the email.message module, or you can use a Message\nobject that was created by parsing an email message (see the previous section).\nMessage()\nCreates a new message that is initially empty.\nAn instance m of Message supports the following methods for populating a message\nwith content, headers, and other information.\nm.add_header(name, value, **params)\nAdds a new message header. name is the name of the header, value is the value of the\nheader, and params is a set of keyword arguments that supply additional optional\nparameters. For example, add_header('Foo','Bar',spam='major') adds the header\nline 'Foo: Bar; spam=\"major\"' to the message.\nm.as_string([unixfrom])\nConverts the entire message to a string. unixfrom is a Boolean flag. If this is set to\nTrue, a UNIX-style 'From ...’ line appears as the first line. By default, unixfrom is\nFalse.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2125,
      "extraction_method": "Direct"
    },
    {
      "page_number": 581,
      "chapter": null,
      "content": "556\nChapter 24 Internet Data Handling and Encoding\nm.attach(payload)\nAdds an attachment to a multipart message. payload must be another Message object\n(for example, email.mime.text.MIMEText). Internally, payload is appended to a list\nthat keeps track of the different parts of the message. If the message is not a multipart\nmessage, use set_payload() to set the body of a message to a simple string.\nm.del_param(param [, header [, requote]])\nDeletes the parameter param from header header. For example, if a message has the\nheader 'Foo: Bar; spam=\"major\"', del_param('spam','Foo') would delete the\n'spam=\"major\"' portion of the header. If requote is True (the default), all remaining\nvalues are quoted when the header is rewritten. If header is omitted, the operation is\napplied to the 'Content-type' header.\nm.replace_header(name, value)\nReplaces the value of the first occurrence of the header name with value value. Raises\nKeyError if the header is not found.\nm.set_boundary(boundary)\nSets the boundary parameter of a message to the string boundary.This string gets\nadded as the boundary parameter to the 'Content-type' header in the message.\nRaises HeaderParseError if the message has no content-type header.\nm.set_charset(charset)\nSets the default character set used by a message. charset may be a string such as \n'iso-8859-1' or 'euc-jp'. Setting a character set normally adds a parameter to the\n'Content-type' header of a message (for example, 'Content-type: text/html;\ncharset=\"iso-8859-1\"').\nm.set_default_type(ctype)\nSets the default message content type to ctype. ctype is a string containing a MIME\ntype such as 'text/plain’ or 'message/rfc822'.This type is not stored in the\n'Content-type' header of the message.\nm.set_param(param, value [, header [, requote [, charset [, language]]]])\nSets the value of a header parameter. param is the parameter name, and value is\nthe parameter value. header specifies the name of the header and defaults to\n'Content-type'. requote specifies whether or not to requote all the values in the\nheader after adding the parameter. By default, this is True. charset and language\nspecify optional character set and language information. If these are supplied, the\nparameter is encoded according to RFC-2231.This produces parameter text such as\nparam*=\"'iso-8859-1'en-us'some%20value\".\nm.set_payload(payload [, charset])\nSets the entire message payload to payload. For simple messages, payload can be a\nbyte string containing the message body. For multipart messages, payload is a list of\nMessage objects. charset optionally specifies the character set that was used to encode\nthe text (see set_charset).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2667,
      "extraction_method": "Direct"
    },
    {
      "page_number": 582,
      "chapter": null,
      "content": "557\nemail Package\nm.set_type(type [, header [, requote]])\nSets the type used in the 'Content-type' header. type is a string specifying the type,\nsuch as 'text/plain' or 'multipart/mixed'. header specifies an alternative header\nother than the default 'Content-type' header. requote quotes the value of any\nparameters already attached to the header. By default, this is True.\nm.set_unixfrom(unixfrom)\nSets the text of the UNIX-style 'From ...' line. unixfrom is a string containing the\ncomplete text including the 'From' text.This text is only output if the unixfrom\nparameter of m.as_string() is set to True.\nRather than creating raw Message objects and building them up from scratch each\ntime, there are a collection of prebuilt message objects corresponding to different types\nof content.These message objects are especially useful for creating multipart MIME\nmessages. For instance, you would create a new message and attach different parts using\nthe attach() method of Message. Each of these objects is defined in a different sub-\nmodule, which is noted in each description.\nMIMEApplication(data [, subtype [, encoder [, **params]]])\nDefined in email.mime.application. Creates a message containing application data.\ndata is a byte string containing the raw data. subtype specifies the data subtype and is\n'octet-stream' by default. encoder is an optional encoding function from the\nemail.encoders subpackage. By default, data is encoded as base 64. params represents\noptional keyword arguments and values that will be added to the 'Content-type'\nheader of the message.\nMIMEAudio(data [, subtype [, encoder [, **params]]])\nDefined in email.mime.audio. Creates a message containing audio data. data is a byte\nstring containing the raw binary audio data. subtype specifies the type of the data and\nis a string such as 'mpeg' or 'wav'. If no subtype is provided, the audio type will be\nguessed by looking at the data using the sndhdr module. encoder and params have\nthe same meaning as for MIMEApplication.\nMIMEImage(data [, subtype [, encoder [, **params]]])\nDefined in email.mime.image. Creates a message containing image data. data is a\nbyte string containing the raw image data. subtype specifies the image type and is a\nstring such as 'jpg' or 'png'. If no subtype is provided, the type will be guessed\nusing a function in the imghdr module. encoder and params have the same meaning\nas for MIMEApplication.\nMIMEMessage(msg [, subtype])\nDefined in email.mime.message. Creates a new non-multipart MIME message. msg is\na message object containing the initial payload of the message. subtype is the type of\nthe message and defaults to 'rfc822'.\nMIMEMultipart([subtype [, boundary [, subparts [, **params]]]])\nDefined in email.mime.multipart. Creates a new MIME multipart message.\nsubtype specifies the optional subtype to be added to the ‘Content-type:\nmultipart/subtype' header. By default, subtype is 'mixed'. boundary is a string\nthat specifies the boundary separator used to make each message subpart. If set to None\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3043,
      "extraction_method": "Direct"
    },
    {
      "page_number": 583,
      "chapter": null,
      "content": "558\nChapter 24 Internet Data Handling and Encoding\nor omitted, a suitable boundary is determined automatically. subparts is a sequence of\nMessage objects that make up the contents of the message. params represents optional\nkeyword arguments and values that are added to the 'Content-type' header of the\nmessage. Once a multipart message has been created, additional subparts can be added\nusing the Message.attach() method.\nMIMEText(data [, subtype [, charset]])\nDefined in email.mime.text. Creates a message containing textual data. data is a\nstring containing the message payload. subtype specifies the text type and is a string\nsuch as 'plain' (the default) or 'html'. charset is the character set, which defaults\nto 'us-ascii'.The message may be encoded depending on the contents of the mes-\nsage.\nThe following example shows how to compose and send an email message using the\nclasses in this section:\nimport smtplib\nfrom email.mime.text import MIMEText\nfrom email.mime.multipart import MIMEMultipart\nfrom email.mime.audio import MIMEAudio\nsender  = \"jon@nogodiggydie.net\"\nreceiver= \"dave@dabeaz.com\"\nsubject = \"Faders up!\"\nbody    = \"I never should have moved out of Texas. -J.\\n\"\naudio   = \"TexasFuneral.mp3\"\nm = MIMEMultipart()\nm[\"to\"]      = receiver\nm[\"from\"]    = sender\nm[\"subject\"] = subject\nm.attach(MIMEText(body))\napart = MIMEAudio(open(audio,\"rb\").read(),\"mpeg\")\napart.add_header(\"Content-Disposition\",\"attachment\",filename=audio)\nm.attach(apart)\n# Send the email message\ns = smtplib.SMTP()\ns.connect()\ns.sendmail(sender, [receiver],m.as_string())\ns.close()\nNotes\nn A number of advanced customization and configuration options have not been\ndiscussed. Readers should consult the online documentation for advanced uses of\nthis module.\nn The email package has gone through at least four different versions, where the\nunderlying programming interface has been changed (i.e., submodules renamed,\nclasses moved to different locations, etc.).This section has documented version\n4.0 of the interface that is used in both Python 2.6 and Python 3.0. If you are\nworking with legacy code, the basic concepts still apply, but you may have to\nadjust the locations of classes and submodules.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2215,
      "extraction_method": "Direct"
    },
    {
      "page_number": 584,
      "chapter": null,
      "content": "559\nhmac\nhashlib\nThe hashlib module implements a variety of secure hash and message digest algo-\nrithms such as MD5 and SHA1.To compute a hash value, you start by calling one of\nthe following functions, the name of which is the same as represented algorithm:\nFunction\nDescription\nmd5()\nMD5 hash (128 bits)\nsha1()\nSHA1 hash (160 bits)\nsha224()\nSHA224 hash (224 bits)\nsha256()\nSHA256 hash (256 bits)\nsha384()\nSHA384 hash (384 bits)\nsha512()\nSHA512 hash (512 bits)\nAn instance d of the digest object returned by any of these functions has the following\ninterface:\nMethod or Attribute\nDescription\nd.update(data)\nUpdates the hash with new data. data must be a byte string.\nRepeated calls are the same as a single call with concatenated\ndata.\nd.digest()\nReturns the value of the digest as a raw byte string.\nd.hexdigest()\nReturns a text string with the value of the digest encoded as a\nseries of hex digits. \nd.copy()\nReturns a copy of the digest. The copy preserves the internal\nstate of the original digest.\nd.digest_size\nSize of the resulting hash in bytes.\nd.block_size\nInternal block size of the hash algorithm in bytes.\nAn alternative construction interface is also provided by the module:\nnew(hashname)\nCreates a new digest object. hashname is a string such as 'md5' or 'sha256' specifying\nthe name of the hashing algorithm to use.The name of the hash can minimally be any\nof the previous hashing algorithms or a hashing algorithm exposed by the OpenSSL\nlibrary (which depends on the installation).\nhmac\nThe hmac module provides support for HMAC (Keyed-Hashing for Message\nAuthentication), which is described in RFC-2104. HMAC is a mechanism used for\nmessage authentication that is built upon cryptographic hashing functions such as MD5\nand SHA-1.\nnew(key [, msg [, digest]])\nCreates a new HMAC object. Here, key is a byte string containing the starting key for\nthe hash, msg contains initial data to process, and digest is the digest constructor that\nshould be used for cryptographic hashing. By default, digest is hashlib.md5.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2052,
      "extraction_method": "Direct"
    },
    {
      "page_number": 585,
      "chapter": null,
      "content": "560\nChapter 24 Internet Data Handling and Encoding\nNormally, the initial key value is determined at random using a cryptographically strong\nrandom number generator.\nAn HMAC object, h, has the following methods:\nh.update(msg)\nAdds the string msg to the HMAC object.\nh.digest()\nReturns the digest of all data processed so far and returns a byte string containing the\ndigest value.The length of the string depends on the underlying hashing function. For\nMD5, it is 16 characters; for SHA-1, it is 20 characters.\nh.hexdigest()\nReturns the digest as a string of hexadecimal digits.\nh.copy()\nMakes a copy of the HMAC object.\nExample\nThe primary use of the hmac module is in applications that need to authenticate the\nsender of a message.To do this, the key parameter to new() is a byte string representing\na secret key known by both the sender and receiver of a message.When sending a mes-\nsage, the sender will create a new HMAC object with the given key, update the object\nwith message data to be sent, and then send the message data along with the resulting\nHMAC digest value to the receiver.The receiver can verify the message by computing\nits own HMAC digest value (using the same key and message data) and comparing the\nresult to the digest value received. Here is an example:\nimport hmac\nsecret_key = b\"peekaboo\"          # Byte string only known to me.  Typically\n# you would want to use a string of random bytes\n# computed using os.urandom() or similar.\ndata = b\"Hello World\"             # The message to send\n# Send the message somewhere.  out represents a socket or some\n# other I/O channel on which we are sending data.\nh = hmac.new(secret_key)\nh.update(data)\nout.send(data)                    # Send the data\nout.send(h.digest())              # Send the digest\n# Receive the message\n# in represents a socket or some other I/O channel\n# out which we are receiving data.\nh = hmac.new(secret_key)\ndata = in.receive()               # Get the message data\nh.update(data)\ndigest = in.receive()             # Get the digest sent by the sender\nif digest != h.digest():\nraise AuthenticationError('Message not authenticated')\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2145,
      "extraction_method": "Direct"
    },
    {
      "page_number": 586,
      "chapter": null,
      "content": "561\nHTMLParser\nHTMLParser\nIn Python 3, this module is called html.parser.The HTMLParser module defines a\nclass HTMLParser that can be used to parse HTML and XHTML documents.To use\nthis module, you define your own class that inherits from HTMLParser and redefines\nmethods as appropriate.\nHTMLParser()\nThis is a base class that is used to create HTML parsers. It is initialized without any\narguments.\nAn instance h of HTMLParser has the following methods:\nh.close()\nCloses the parser and forces the processing of any remaining unparsed data.This method\nis called after all HTML data has been fed to the parser.\nh.feed(data)\nSupplies new data to the parser.This data will be immediately parsed. However, if the\ndata is incomplete (for example, it ends with an incomplete HTML element), the\nincomplete portion will be buffered and parsed the next time feed() is called with\nmore data.\nh.getpos()\nReturns the current line number and character offset into that line as a tuple (line,\noffset).\nh.get_starttag_text()\nReturns the text corresponding to the most recently opened start tag.\nh.handle_charref(name)\nThis handler method is called whenever a character reference such as '&#ref;' is\nencountered. name is a string containing the name of the reference. For example, when\nparsing '&#229;', name will be set to '229'.\nh.handle_comment(data)\nThis handler method is called whenever a comment is encountered. data is a string\ncontaining the text of the comment. For example, when parsing the comment \n'<!--comment-->', data will contain the text 'comment'.\nh.handle_data(data)\nThis handler is called to process data that appears between tags. data is a string contain-\ning text.\nh.handle_decl(decl)\nThis handler is called to process declarations such as '<!DOCTYPE HTML ...>'. decl\nis a string containing the text of the declaration not including the leading '<!' and\ntrailing '>'.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1897,
      "extraction_method": "Direct"
    },
    {
      "page_number": 587,
      "chapter": null,
      "content": "562\nChapter 24 Internet Data Handling and Encoding\nh.handle_endtag(tag)\nThis handler is called whenever end tags are encountered. tag is the name of the tag\nconverted to lowercase. For example, if the end tag is '</BODY>', tag is the string\n'body'.\nh.handle_entityref(name)\nThis handler is called to handle entity references such as '&name;'. name is a string\ncontaining the name of the reference. For example, if parsing '&lt;', name will be set\nto 'lt'.\nh.handle_pi(data)\nThis handler is called to handle processing instructions such as '<?processing\ninstruction>'. data is a string containing the text of the processing instruction not\nincluding the leading '<?' or trailing '>'.When called on XHTML-style instructions\nof the form '<?...?>', the last '?' will be included in data.\nh.handle_startendtag(tag, attrs)\nThis handler processes XHTML-style empty tags such as '<tag name=\"value\"...\n/>'. tag is a string containing the name of the tag. attrs contains attribute informa-\ntion and is a list of tuples of the form (name, value) where name is the attribute\nname converted to lowercase and value is the attribute value.When extracting \nvalues, quotes and character entities are replaced. For example, if parsing '<a\nhref=\"http://www.foo.com\"/>', tag is 'a' and attrs is\n[('href','http://www.foo.com')]. If not defined in derived classes, the default\nimplementation of this method simply calls handle_starttag() and\nhandle_endtag().\nh.handle_starttag(tag, attrs)\nThis handler processes start tags such as '<tag name=\"value\" ...>'. tag and attrs\nhave the same meaning as described for handle_startendtag().\nh.reset()\nResets the parser, discarding any unprocessed data.\nThe following exception is provided:\nHTMLParserError\nException raised as a result of parsing errors.The exception has three attributes.The\nmsg attribute contains a message describing the error, the lineno attribute is the line\nnumber where the parsing error occurred, and the offset attribute is the character off-\nset into the line.\nExample\nThe following example fetches an HTML document using the urllib package and\nprints all links that have been specified with '<a href=\"...\">' declarations:\n# printlinks.py\ntry:\nfrom HTMLParser import HTMLParser\nfrom urllib2 import urlopen\nexcept ImportError:\nfrom html.parser import HTMLParser\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2328,
      "extraction_method": "Direct"
    },
    {
      "page_number": 588,
      "chapter": null,
      "content": "563\njson\nfrom urllib.request import urlopen\nimport sys\nclass PrintLinks(HTMLParser):\ndef handle_starttag(self,tag,attrs):\nif tag == 'a':\nfor name,value in attrs:\nif name == 'href':  print(value)\np    = PrintLinks()\nu    = urlopen(sys.argv[1])\ndata = u.read()\ncharset = u.info().getparam('charset')      # Python 2\n#charset = u.info().get_content_charset()   # Python 3\np.feed(data.decode(charset))\np.close()\nIn the example, it must be noted that any HTML fetched using urllib is returned as a\nbyte string.To properly parse it, it must be decoded into text according to the docu-\nment character set encoding.The example shows how to obtain this in Python 2 and\nPython 3.\nNote\nThe parsing capabilities of HTMLParser tend to be rather limited. In fact, with very com-\nplicated and/or malformed HTML, the parser can break. Users also find this module to\nbe lower-level than is useful. If you are writing programs that must scrape data from\nHTML pages, consider the Beautiful Soup package (http://pypi.python.org/\npypi/BeautifulSoup).\njson\nThe json module is used to serialize and unserialize objects represented using\nJavaScript Object Notation (JSON). More information about JSON is available at\nhttp://json.org, but the format is really just a subset of JavaScript syntax.\nIncidentally, it’s almost the same as Python syntax for representing lists and dictionaries.\nFor example, a JSON array is written as [value1, value2, ... ], and a JSON\nobject is written as {name:value, name:value, .... }.\nThe following list shows how JSON values and Python values are mapped.The\nPython types listed in parentheses are accepted when encoding but are not returned\nwhen decoding (instead, the first listed type is returned).\nJSON Type\nPython Type\nobject\ndict\narray\nlist (tuple)\nstring\nunicode (str, bytes)\nnumber\nint, float\ntrue\nTrue\nfalse\nFalse\nnull\nNone\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1863,
      "extraction_method": "Direct"
    },
    {
      "page_number": 589,
      "chapter": null,
      "content": "564\nChapter 24 Internet Data Handling and Encoding\nFor string data, you should assume the use of Unicode. If byte strings are encountered\nduring encoding, they will be decoded into a Unicode string using 'utf-8' by default\n(although this can be controlled). JSON strings are always returned as Unicode when\ndecoding.\nThe following functions are used to encode/decode JSON documents:\ndump(obj, f, **opts)\nSerializes obj to a file-like object f. opts represents a collection of keyword arguments\nthat can be specified to control the serialization process:\nKeyword Argument\nDescription\nskipkeys\nBoolean flag that controls what to do when dictionary keys (not\nthe values) are not a basic type such as a string or number. If\nTrue, the keys are skipped. If False (the default), a TypeError\nis raised.\nensure_ascii\nBoolean flag that determines whether or not Unicode strings can\nbe written to the file f. By default, this is False. Only set this to\nTrue if f is a file that correctly handles Unicode, such as a file\ncreated by the codecs module or opened with a specific encod-\ning set.\ncheck_circular\nBoolean flag that determines whether circular references are\nchecked for containers. By default, this is True. If set to False\nand a circular reference is encountered, an OverflowError\nexception is raised.\nallow_nan\nBoolean flag that determines whether out-of-range floating-point\nvalues are serialized (e.g., NaN, inf, -inf). By default this is True.\ncls\nA subclass of JSONEncoder to use. You would specify this if you\ncreated your own custom encoder by inheriting from\nJSONEncoder. If there are any additional keyword arguments\ngiven to dump(), they are passed as arguments to the construc-\ntor of this class.\nindent\nA non-negative integer that sets the amount indentation to use\nwhen printing array and object members. Setting this results in a\nkind of pretty-printing. By default, it is None, which causes the\nresult to be in the most compact representation. \nseparators\nA tuple of the form (item_separator, dict_separator)\nwhere item_separator is a string containing the separator\nused between array items and dict_separator is a string con-\ntaining the separator used between dictionary keys and values.\nBy default, the value is (', ', ': ').\nencoding\nEncoding to use for Unicode strings—'utf-8' by default.\ndefault\nA function used to serialize objects that are not any of the basic\nsupported types. It should either return a value that can be seri-\nalized (i.e., a string) or raise TypeError. By default, a\nTypeError is raised for unsupported types.\ndumps(obj, **opts)\nThe same as dump() except that a string containing the result is returned.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2668,
      "extraction_method": "Direct"
    },
    {
      "page_number": 590,
      "chapter": null,
      "content": "565\njson\nload(f, **opts)\nDeserializes a JSON object on the file-like object f and returns it. opts represents a set\nof keyword arguments that can be specified to control the decoding process and are\ndescribed next. Be aware that this function calls f.read() to consume the entire con-\ntents of f. Because of this, it should not be used on any kind of streaming file such as a\nsocket where JSON data might be received as part of a larger or ongoing data stream.\nKeyword Argument\nDescription\nencoding\nEncoding used to interpret any of the string values that are\ndecoded. By default, this is 'utf-8'.\nstrict\nBoolean flag that determines whether or not literal (unescaped)\nnewlines are allowed to appear in JSON strings. By default, this\nis True, which means that an exception is generated for such\nstrings.\ncls\nA subclass of JSONDecoder to use for decoding. Only speci-\nfied if you’ve created a custom decoder by inheriting from\nJSONDecoder. Any extra keyword arguments to load() are\nsupplied to the class constructor.\nobject_hook\nA function that’s called with the result of every JSON object that\nis decoded. By default, this is the built-in dict() function.\nparse_float\nA function that’s called to decode JSON floating-point values. By\ndefault, this is the built-in float() function.\nparse_int\nA function that’s called to decode JSON integer values. By\ndefault, this is the built-in int() function.\nparse_constant\nA function that’s called to decode JSON constants such as\n'NaN', 'true', 'false', etc. \nloads(s, **opts)\nThe same as load() except that an object is deserialized from the string s.\nAlthough these functions share the same names as functions from the pickle and\nmarshal modules and they serialize data, they are not used in the same way. Specifically,\nyou should not use dump() to write more than one JSON-encoded object to the same\nfile. Similarly, load() cannot be used to read more than one JSON-encoded object\nfrom the same file (if the input file has more than one object in it, you’ll get an error).\nJSON-encoded objects should be treated in the same manner as HTML or XML. For\nexample, you usually don’t take two completely separate XML documents and just con-\ncatenate them together in the same file.\nIf you want to customize the encoding or decoding process, inherit from these base\nclasses:\nJSONDecoder(**opts)\nA class that decodes JSON data. opts represents a set of keyword arguments that are\nidentical to those used by the load() function.An instance d of JSONDecoder has the\nfollowing two methods:\nd.decode(s)\nReturns the Python representation of the JSON object in s. s is a string.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2631,
      "extraction_method": "Direct"
    },
    {
      "page_number": 591,
      "chapter": null,
      "content": "566\nChapter 24 Internet Data Handling and Encoding\nd.raw_decode(s)\nReturns a tuple (pyobj, index) where pyobj is the Python representation of a\nJSON object in s and index is the position in s where the JSON object ended.This\ncan be used if you are trying to parse an object out of an input stream where there is\nextra data at the end.\nJSONEncoder(**opts)\nA class that encodes a Python object into JSON. opts represents a set of keyword argu-\nments that are identical to those used by the dump() function.An instance e of\nJSONEncoder has the following methods:\ne.default(obj)\nMethod called when a Python object obj can’t be encoded according to any of the\nnormal encoding rules.The method should return a result which is one of the types\nthat can be encoded (for example, a string, list, or dictionary).\ne.encode(obj)\nMethod that’s called to create a JSON representation of Python object obj.\ne.iterencode(obj)\nCreates an iterator that produces the strings making up the JSON representation of\nPython object obj as they are computed.The process of creating a JSON string is high-\nly recursive in nature. For instance, it involves iterating over the keys of a dictionary and\ntraversing down into other dictionaries and lists found along the way. If you use this\nmethod, you can process the output in a piecemeal manner as opposed to having every-\nthing collected into a huge in-memory string.\nIf you define subclasses that inherit from JSONDecoder or JSONEncoder, you need\nto exercise caution if your class also defines _ _init_ _().To deal with all of the key-\nword arguments, here is how you should define it:\nclass MyJSONDecoder(JSONDecoder):\ndef _ _init_ _(self, **kwargs):\n# Get my own arguments\nfoo = kwargs.pop('foo',None) \nbar = kwargs.pop('bar',None)\n# Initialize the parent with everything left over\nJSONDecoder._ _init_ _(self,**kwargs)\nmimetypes\nThe mimetypes module is used to guess the MIME type associated with a file, based\non its filename extension. It also converts MIME types to their standard filename exten-\nsions. MIME types consist of a type/subtype pair—for example 'text/html',\n'image/png', or 'audio/mpeg'.\nguess_type(filename [, strict])\nGuesses the MIME type of a file based on its filename or URL. Returns a tuple\n(type, encoding) in which type is a string of the form \"type/subtype\" and\nencoding is the program used to encode the data for transfer (for example, compress\nor gzip). Returns (None, None) if the type cannot be guessed. If strict is True (the\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2506,
      "extraction_method": "Direct"
    },
    {
      "page_number": 592,
      "chapter": null,
      "content": "567\nquopri\ndefault), then only official MIME types registered with IANA are recognized (see\nhttp://www.iana.org/assignments/media-types). Otherwise, some common, but unoffi-\ncial MIME types are also recognized.\nguess_extension(type [, strict])\nGuesses the standard file extension for a file based on its MIME type. Returns a string\nwith the filename extension including the leading dot (.). Returns None for unknown\ntypes. If strict is True (the default), then only official MIME types are recognized.\nguess_all_extensions(type [, strict])\nThe same as guess_extension() but returns a list of all possible filename extensions.\ninit([files])\nInitializes the module. files is a sequence of filenames that are read to extract type\ninformation.These files contain lines that map a MIME type to a list of acceptable file\nsuffixes such as the following:\nimage/jpeg:   jpe jpeg jpg\ntext/html:    htm html\n...\nread_mime_types(filename)\nLoads type mapping from a given filename. Returns a dictionary mapping filename\nextensions to MIME type strings. Returns None if filename doesn’t exist or cannot be\nread.\nadd_type(type, ext [, strict])\nAdds a new MIME type to the mapping. type is a MIME type such as 'text/plain',\next is a filename extension such as '.txt', and strict is a Boolean indicating\nwhether the type is an officially registered MIME type. By default, strict is True.\nquopri\nThe quopri module performs quoted-printable transport encoding and decoding of\nbyte strings.This format is used primarily to encode 8-bit text files that are mostly read-\nable as ASCII but which may contain a small number of non-printing or special charac-\nters (for example, control characters or non-ASCII characters in the range 128-255).\nThe following rules describe how the quoted-printable encoding works:\nn Any printable non-whitespace ASCII character, with the exception of '=', is rep-\nresented as is.\nn The '=' character is used as an escape character.When followed by two hexadec-\nimal digits, it represents a character with that value (for example, '=0C').The\nequals sign is represented by '=3D'. If '=' appears at the end of a line, it denotes\na soft line break.This only occurs if a long line of input text must be split into\nmultiple output lines.\nn Spaces and tabs are left as is but may not appear at the end of line.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2335,
      "extraction_method": "Direct"
    },
    {
      "page_number": 593,
      "chapter": null,
      "content": "568\nChapter 24 Internet Data Handling and Encoding\nIt is fairly common to see this format used when documents make use of special char-\nacters in the extended ASCII character set. For example, if a document contained the\ntext “Copyright © 2009”, this might be represented by the Python byte string\nb'Copyright \\xa9 2009'.The quoted-printed version of the string is b'Copyright\n=A9 2009' where the special character '\\xa9' has been replaced by the escape\nsequence '=A9'.\ndecode(input, output [, header])\nDecodes bytes into quopri format. input and output are file objects opened in binary\nmode. If header is True, then the underscore (_) will be interpreted as a space.\nOtherwise, it is left alone.This is used when decoding MIME headers that have been\nencoded. By default, header is False.\ndecodestring(s [, header])\nDecodes a string s. s may be a Unicode or byte string, but the result is always a byte\nstring. header has the same meaning as with decode().\nencode(input, output, quotetabs [, header])\nEncodes bytes into quopri format. input and output are file objects opened in binary\nmode. quotetabs, if set to True, forces tab characters to be quoted in addition to the\nnormal quoting rules. Otherwise, tabs are left as is. By default, quotetabs is False.\nheader has the same meaning as for decode().\nencodestring(s [, quotetabs [, header]])\nEncodes byte string s.The result is also a byte string. quotetabs and header have the\nsame meaning as with encode().\nNotes\nThe quoted-printable data encoding predates Unicode and is only applicable to 8-bit\ndata. Even though it is most commonly applied to text, it really only applies to ASCII and\nextended ASCII characters represented as single bytes. When you use this module,\nmake sure all files are in binary mode and that you are working with byte strings.  \nxml Package\nPython includes a variety of modules for processing XML data.The topic of XML pro-\ncessing is large, and covering every detail is beyond the scope of this book.This section\nassumes the reader is already familiar with some basic XML concepts.A book such as\nInside XML by Steve Holzner (New Riders) or XML in a Nutshell by Elliotte Harold\nand W. Scott Means (O’Reilly and Associates) will be useful in explaining basic XML\nconcepts. Several books discuss XML processing with Python including Python & XML\nby Christopher Jones (O’Reilly and Associates) and XML Processing with Python by Sean\nMcGrath (Prentice Hall).\nPython provides two kinds of XML support. First, there is basic support for two\nindustry-standard approaches to XML parsing—SAX and DOM. SAX (Simple API for\nXML) is based on event handling where an XML document is read sequentially and as\nXML elements are encountered, handler functions get triggered to perform processing.\nDOM (Document Object Model) builds a tree structure representing an entire XML\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2861,
      "extraction_method": "Direct"
    },
    {
      "page_number": 594,
      "chapter": null,
      "content": "569\nxml Package\ndocument. Once the tree has been built, DOM provides an interface for traversing the\ntree and extracting data. Neither the SAX nor DOM APIs originate with Python.\nInstead, Python simply copies the standard programming interface that was developed\nfor Java and JavaScript.\nAlthough you can certainly process XML using the SAX and DOM interfaces, the\nmost convenient programming interface in the standard library is the ElementTree\ninterface.This is a Python-specific approach to XML parsing that takes full advantage of\nPython language features and which most users find to be significantly easier and faster\nthan SAX or DOM.The rest of this section covers all three XML parsing approaches,\nbut the ElementTree approach is given the most detail.\nReaders are advised that the coverage here is really only focused on basic parsing of\nXML data. Python also includes XML modules related to implementing new kinds of\nparsers, building XML documents from scratch, and so forth. In addition, a variety of\nthird-party extensions extend Python’s capabilities with additional XML features such as\nsupport for XSLT and XPATH. Links to further information can be found at http://\nwiki.python.org/moin/PythonXml.\nXML Example Document\nThe following example illustrates a typical XML document, in this case a description of\na recipe.\n<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n<recipe>\n<title>\nFamous Guacamole\n</title>\n<description>\nA southwest favorite!\n</description>\n<ingredients>\n<item num=\"4\"> Large avocados, chopped </item>\n<item num=\"1\"> Tomato, chopped </item>\n<item num=\"1/2\" units=\"C\"> White onion, chopped </item>\n<item num=\"2\" units=\"tbl\"> Fresh squeezed lemon juice </item>\n<item num=\"1\"> Jalapeno pepper, diced </item>\n<item num=\"1\" units=\"tbl\"> Fresh cilantro, minced </item>\n<item num=\"1\" units=\"tbl\"> Garlic, minced </item>\n<item num=\"3\" units=\"tsp\"> Salt </item>\n<item num=\"12\" units=\"bottles\"> Ice-cold beer </item>\n</ingredients>\n<directions>\nCombine all ingredients and hand whisk to desired consistency.\nServe and enjoy with ice-cold beers.\n</directions>\n</recipe>\nThe document consists of elements that start and end with tags such as\n<title>...</title>. Elements are typically nested and organized into a hierarchy—\nfor example, the <item> elements that appear under <ingredients>.Within each doc-\nument, a single element is the document root. In the example, this is the <receipe>\nelement. Elements optionally have attributes as shown for the item elements <item\nnum=\"4\">Large avocados, chopped</item>.\nWorking with XML documents typically involves all of these basic features. For\nexample, you may want to extract text and attributes from specific element types.To\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2716,
      "extraction_method": "Direct"
    },
    {
      "page_number": 595,
      "chapter": null,
      "content": "570\nChapter 24 Internet Data Handling and Encoding\nlocate elements, you have to navigate through the document hierarchy starting at the\nroot element.\nxml.dom.minidom\nThe xml.dom.minicom module provides basic support for parsing an XML document\nand storing it in memory as a tree structure according to the conventions of DOM.\nThere are two parsing functions:\nparse(file [, parser])\nParses the contents of file and returns a node representing the top of the document\ntree. ile is a filename or an already-open file object. parser is an optional SAX2-com-\npatible parser object that will be used to construct the tree. If omitted, a default parser\nwill be used.\nparseString(string [, parser])\nThe same as parse(), except that the input data is supplied in a string instead of a file.\nNodes\nThe document tree returned by the parsing functions consists of a collection of nodes\nlinked together. Each node n has the following attributes which can be used to extract\ninformation and navigate through the tree structure:\nNode Attribute\nDescription\nn.attributes\nMapping object that holds attribute values (if any).\nn.childNodes\nA list of all child nodes of n.\nn.firstChild\nThe first child of node n.\nn.lastChild\nThe last child of node n.\nn.localName\nLocal tag name of an element. If a colon appears in the tag\n(for example, '<foo:bar ...>'), then this only contains the\npart after the colon.\nn.namespaceURI\nNamespace associated with n, if any.\nn.nextSibling\nThe node that appears after n in the tree and has the same\nparent. Is None if n is the last sibling.\nn.nodeName\nThe name of the node. The meaning depends on the node\ntype.\nn.nodeType\nInteger describing the node type. It is set to one of the follow-\ning values which are class variables of the Node class:\nATTRIBUTE_NODE, CDATA_SECTION_NODE, COMMENT_NODE,\nDOCUMENT_FRAGMENT_NODE, DOCUMENT_NODE,\nDOCUMENT_TYPE_NODE, ELEMENT_NODE, ENTITY_NODE,\nENTITY_REFERENCE_NODE, NOTATION_NODE,\nPROCESSING_INSTRUCTION_NODE, or TEXT_NODE.\nn.nodeValue\nThe value of the node. The meaning depends on the node\ntype.\nn.parentNode\nA reference to the parent node.\nn.prefix\nPart of a tag name that appears before a colon. For example,\nthe element '<foo:bar ...>' would have a prefix of 'foo'.\nn.previousSibling\nThe node that appears before n in the tree and has the same\nparent.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2326,
      "extraction_method": "Direct"
    },
    {
      "page_number": 596,
      "chapter": null,
      "content": "571\nxml Package\nIn addition to these attributes, all nodes have the following methods.Typically, these are\nused to manipulate the tree structure.\nn.appendChild(child)\nAdds a new child node, child, to n.The new child is added at the end of any other\nchildren.\nn.cloneNode(deep)\nMakes a copy of the node n. If deep is True, all child nodes are also cloned.\nn.hasAttributes()\nReturns True if the node has any attributes.\nn.hasChildNodes()\nReturns True if the node has any children.\nn.insertBefore(newchild, ichild)\nInserts a new child, newchild, before another child, ichild. ichild must already be a\nchild of n.\nn.isSameNode(other)\nReturns True if the node other refers to the same DOM node as n.\nn.normalize()\nJoins adjacent text nodes into a single text node.\nn.removeChild(child)\nRemoves child child from n.\nn.replaceChild(newchild,oldchild)\nReplaces the child oldchild with newchild. oldchild must already be a child of n.\nAlthough there are many different types of nodes that might appear in a tree, it is\nmost common to work with Document, Element, and Text nodes. Each is briefly\ndescribed next.\nDocument Nodes\nA Document node d appears at the top of the entire document tree and represents the\nentire document as a whole. It has the following methods and attributes:\nd.documentElement\nContains the root element of the entire document.\nd.getElementsByTagName(tagname)\nSearches all child nodes and returns a list of elements with a given tag name tagname.\nd.getElementsByTagNameNS(namespaceuri, localname)\nSearches all child nodes and returns a list of elements with a given namespace URI and\nlocal name.The returned list is an object of type NodeList.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1679,
      "extraction_method": "Direct"
    },
    {
      "page_number": 597,
      "chapter": null,
      "content": "572\nChapter 24 Internet Data Handling and Encoding\nElement Nodes\nAn Element node e represents a single XML element such as '<foo>...</foo>'.To\nget the text from an element, you need to look for Text nodes as children.The follow-\ning attributes and methods are defined to get other information:\ne.tagName\nThe tag name of the element. For example, if the element is defined by '<foo ...>',\nthe tag name is 'foo'.\ne.getElementsByTagName(tagname)\nReturns a list of all children with a given tag name.\ne.getElementsByTagNameNS(namespaceuri, localname)\nReturns a list of all children with a given tag name in a namespace. namespaceuri and\nlocalname are strings that specify the namespace and tag name. If a namespace has\nbeen declared using a declaration such as '<foo\nxmlns:foo=\"http://www.spam.com/foo\">', namespaceuri is set to\n'http://www.spam.com/foo'. If searching for a subsequent element '<foo:bar>',\nlocalname is set to 'bar'.The returned object is of type NodeList.\ne.hasAttribute(name)\nReturns True if an element has an attribute with name name.\ne.hasAttributeNS(namespaceuri, localname)\nReturns True if an element has an attribute named by namespaceuri and localname.\nThe arguments have the same meaning as described for getElementsByTagNameNS().\ne.getAttribute(name)\nReturns the value of attribute name.The return value is a string. If the attribute doesn’t\nexist, an empty string is returned.\ne.getAttributeNS(namespaceuri, localname)\nReturns the value of the attributed named by namespaceuri and localname.The\nreturn value is a string.An empty string is returned if the attribute does not exist.The\narguments are the same as described for getElementsByTagNameNS().\nText Nodes\nText nodes are used to represent text data.Text data is stored in the t.data attribute of\na Text object t.The text associated with a given document element is always stored in\nText nodes that are children of the element.\nUtility Functions\nThe following utility methods are defined on nodes.These are not part of the DOM\nstandard, but are provided by Python for general convenience and for debugging.\nn.toprettyxml([indent [, newl]])\nCreates a nicely formatted string containing the XML represented by node n and its\nchildren. indent specifies an indentation string and defaults to a tab ('\\t'). newl spec-\nifies the newline character and defaults to '\\n'.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2363,
      "extraction_method": "Direct"
    },
    {
      "page_number": 598,
      "chapter": null,
      "content": "573\nxml Package\nn.toxml([encoding])\nCreates a string containing the XML represented by node n and its children. encoding\nspecifies the encoding (for example, 'utf-8'). If no encoding is given, none is specified\nin the output text.\nn.writexml(writer [, indent [, addindent [, newl]]])\nWrites XML to writer. writer can be any object that provides a write() method\nthat is compatible with the file interface. indent specifies the indentation of n. It is a\nstring that is prepended to the start of node n in the output. addindent is a string that\nspecifies the incremental indentation to apply to child nodes of n. newl specifies the\nnewline character.\nDOM Example\nThe following example shows how to use the xml.dom.minidom module to parse and\nextract information from an XML file:\nfrom xml.dom import minidom\ndoc = minidom.parse(\"recipe.xml\")\ningredients  = doc.getElementsByTagName(\"ingredients\")[0]\nitems        = ingredients.getElementsByTagName(\"item\")\nfor item in items:\nnum      = item.getAttribute(\"num\")\nunits    = item.getAttribute(\"units\")\ntext     = item.firstChild.data.strip()\nquantity = \"%s %s\" % (num,units)\nprint(\"%-10s %s\" % (quantity,text))\nNote\nThe xml.dom.minidom module has many more features for changing the parse tree\nand working with different kinds of XML node types. More information can be found in\nthe online documentation.\nxml.etree.ElementTree\nThe xml.etree.ElementTree module defines a flexible container object\nElementTree for storing and manipulating hierarchical data.Although this object is\ncommonly used in conjunction with XML processing, it is actually quite \ngeneral-purpose—serving a role that’s a cross between a list and dictionary.\nElementTree objects\nThe following class is used to define a new ElementTree object and represents the top\nlevel of a hierarchy.\nElementTree([element [, file]])\nCreates a new ElementTree object. element is an instance representing the root node\nof the tree.This instance supports the element interface described next. file is either a\nfilename or a file-like object from which XML data will be read to populate the tree.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2115,
      "extraction_method": "Direct"
    },
    {
      "page_number": 599,
      "chapter": null,
      "content": "574\nChapter 24 Internet Data Handling and Encoding\nAn instance tree of ElementTree has the following methods:\ntree._setroot(element)\nSets the root element to element.\ntree.find(path)\nFinds and returns the first top-level element in the tree whose type matches the given\npath. path is a string that describes the element type and its location relative to other\nelements.The following list describes the path syntax:\nPath\nDescription\n'tag'\nMatches only top-level elements with the given tag—for example,\n<tag>...</tag>. Does not match elements defined at lower levels.\nA element of type tag embedded inside another element such as\n<foo><tag>...</tag></foo> is not matched.\n'parent/tag'\nMatches an element with tag 'tag' if it’s a child of an element with\ntag 'parent'. As many path name components can be specified as\ndesired.\n'*'\nSelects all child elements. For example, '*/tag' would match all\ngrandchild elements with a tag name of 'tag'.\n'.'\nStarts the search with the current node. \n'//'\nSelects all subelements on all levels beneath an element. For exam-\nple, './/tag' matches all elements with tag 'tag' at all sublevels.\nIf you are working with a document involving XML namespaces, the tag strings in a\npath should have the form '{uri}tag' where uri is a string such as\n'http://www.w3.org/TR/html4/'.\ntree.findall(path)\nFinds all top-level elements in the tree that match the given path and returns them in\ndocument order as a list or an iterator.\ntree.findtext(path [, default])\nReturns the element text for the first top-level element in the tree matching the given\npath. default is a string to return if no matching element can be found.\ntree.getiterator([tag])\nCreates an iterator that produces all elements in the tree, in section order, whose tag\nmatches tag. If tag is omitted, then every element in the tree is returned in order.\ntree.getroot()\nReturns the root element for the tree.\ntree.parse(source [, parser])\nParses external XML data and replaces the root element with the result. source is\neither a filename or file-like object representing XML data. parser is an optional\ninstance of TreeBuilder, which is described later.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2166,
      "extraction_method": "Direct"
    },
    {
      "page_number": 600,
      "chapter": null,
      "content": "575\nxml Package\ntree.write(file [, encoding])\nWrites the entire contents of the tree to a file. file is either a filename or a file-like\nobject opened for writing. encoding is the output encoding to use and defaults to the\ninterpreter default encoding if not specified ('utf-8' or 'ascii' in most cases).\nCreating Elements\nThe types of elements held in an ElementTree are represented by instances of varying\ntypes that are either created internally by parsing a file or with the following construc-\ntion functions:\nComment([text])\nCreates a new comment element. text is a string or byte string containing the element\ntext.This element is mapped to XML comments when parsing or writing output.\nElement(tag [, attrib [, **extra]])\nCreates a new element. tag is the name of the element name. For example, if you were\ncreating an element '<foo>....</foo>', tag would be 'foo'. attrib is a dictionary\nof element attributes specified as strings or byte strings.Any extra keyword arguments\nsupplied in extra are also used to set element attributes.\nfromstring(text)\nCreates an element from a fragment of XML text in text—the same as XML()\ndescribed next.\nProcessingInstruction(target [, text])\nCreates a new element corresponding to a processing instruction. target and text are\nboth strings or byte strings.When mapped to XML, this element corresponds to\n'<?target text?>'.\nSubElement(parent, tag [, attrib [, **extra]])\nThe same as Element(), but it automatically adds the new element as a child of the\nelement in parent.\nXML(text)\nCreates an element by parsing a fragment of XML code in text. For example, if you\nset text to '<foo>....</foo>', this will create a standard element with a tag of\n'foo'.\nXMLID(text)\nThe same as XML(text) except that 'id' attributes are collected and used to build a\ndictionary mapping ID values to elements. Returns a tuple (elem, idmap) where\nelem is the new element and idmap is the ID mapping dictionary. For example,\nXMLID('<foo id=\"123\"><bar id=\"456\">Hello</bar></foo>') returns\n(<Element foo>, {'123': <Element foo>, '456': <Element bar>}).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2096,
      "extraction_method": "Direct"
    },
    {
      "page_number": 601,
      "chapter": null,
      "content": "576\nChapter 24 Internet Data Handling and Encoding\nThe Element Interface\nAlthough the elements stored in an ElementTree may have varying types, they all sup-\nport a common interface. If elem is any element, then the following Python operators\nare defined:\nOperator\nDescription\nelem[n]\nReturns the nth child element of elem.\nelem[n] = newelem\nChanges the nth child element of elem to a different element\nnewelem.\ndel elem[n]\nDeletes the nth child element of elem.\nlen(elem)\nNumber of child elements of elem.\nAll elements have the following basic data attributes:\nAttribute\nDescription\nelem.tag\nString identifying the element type. For example,\n<foo>...</foo> has a tag of 'foo'.\nelem.text\nData associated with the element. Usually a string containing\ntext between the start and ending tags of an XML element.\nelem.tail\nAdditional data stored with the attribute. For XML, this is usu-\nally a string containing whitespace found after the element’s\nend tag but before the next tag starts.\nelem.attrib\nDictionary containing the element attributes.\nElements support the following methods, some of which emulate methods on \ndictionaries:\nelem.append(subelement)\nAppends the element subelement to the list of children.\nelem.clear()\nClears all of the data in an element including attributes, text, and children.\nelem.find(path)\nFinds the first subelement whose type matches path.\nelem.findall(path)\nFinds all subelements whose type matches path. Returns a list or an iterable with the\nmatching elements in document order.\nelem.findtext(path [, default])\nFinds the text for the first element whose type patches path. default is a string giving\nthe value to return if there is no match.\nelem.get(key [, default])\nGets the value of attribute key. default is a default value to return if the attribute\ndoesn’t exist. If XML namespaces are involved, then key will be a string of the form\n'{uri}key}' where uri is a string such as 'http://www.w3.org/TR/html4/'.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1969,
      "extraction_method": "Direct"
    },
    {
      "page_number": 602,
      "chapter": null,
      "content": "577\nxml Package\nelem.getchildren()\nReturns all subelements in document order.\nelem.getiterator([tag])\nReturns an iterator that produces all subelements whose type matches tag.\nelem.insert(index, subelement)\nInserts a subelement at position index in the list of children.\nelem.items()\nReturns all element attributes as a list of (name, value) pairs.\nelem.keys()\nReturns a list of all of the attribute names.\nelem.remove(subelement)\nRemoves element subelement from the list of children.\nelem.set(key, value)\nSets attribute key to value value.\nTree Building\nAn ElementTree object is easy to create from other tree-like structures.The following\nobject is used for this purpose.\nTreeBuilder([element_factory])\nA class that builds an ElementTree structure using a series of start(), end(), and\ndata() calls as would be triggered while parsing a file or traversing another tree struc-\nture. element_factory is an operation function that is called to create new element\ninstances.\nAn instance t of TreeBuilder has these methods:\nt.close()\nCloses the tree builder and returns the top-level ElementTree object that has been cre-\nated.\nt.data(data)\nAdds text data to the current element being processed.\nt.end(tag)\nCloses the current element being processed and returns the final element object.\nt.start(tag, attrs)\nCreates a new element. tag is the element name, and attrs is a dictionary with the\nattribute values.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1428,
      "extraction_method": "Direct"
    },
    {
      "page_number": 603,
      "chapter": null,
      "content": "578\nChapter 24 Internet Data Handling and Encoding\nUtility Functions\nThe following utility functions are defined:\ndump(elem)\nDumps the element structure of elem to sys.stdout for debugging.The output is\nusually XML.\niselement(elem)\nChecks if elem is a valid element object.\niterparse(source [, events])\nIncrementally parses XML from source. source is a filename or a file-like object\nreferring to XML data. events is a list of event types to produce. Possible event types\nare 'start', 'end', 'start-ns', and 'end-ns'. If omitted, only 'end' events are\nproduced.The value returned by this function is an iterator that produces tuples\n(event, elem) where event is a string such as 'start' or 'end' and elem is the\nelement being processed. For 'start' events, the element is newly created and initially\nempty except for attributes. For 'end' events, the element is fully populated and\nincludes all subelements.\nparse(source)\nFully parses an XML source into an ElementTree object. source is a filename or file-\nlike object with XML data.\ntostring(elem)\nCreates an XML string representing elem and all of its subelements.\nXML Examples\nHere is an example of using ElementTree to parse the sample recipe file and print an\ningredient list. It is similar to the example shown for DOM.\nfrom xml.etree.ElementTree import ElementTree\ndoc = ElementTree(file=\"recipe.xml\")\ningredients = doc.find('ingredients')\nfor item in ingredients.findall('item'):\nnum   = item.get('num')\nunits = item.get('units','')\ntext  = item.text.strip()\nquantity = \"%s %s\" % (num, units)\nprint(\"%-10s %s\" % (quantity, text))\nThe path syntax of ElementTree makes it easier to simplify certain tasks and to take\nshortcuts as necessary. For example, here is a different version of the previous code that\nuses the path syntax to simply extract all <item>...</item> elements.\nfrom xml.etree.ElementTree import ElementTree\ndoc = ElementTree(file=\"recipe.xml\")\nfor item in doc.findall(\".//item\"):\nnum   = item.get('num')\nunits = item.get('units','')\ntext  = item.text.strip()\nquantity = \"%s %s\" % (num, units)\nprint(\"%-10s %s\" % (quantity, text))\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2125,
      "extraction_method": "Direct"
    },
    {
      "page_number": 604,
      "chapter": null,
      "content": "579\nxml Package\nConsider an XML file 'recipens.xml' that makes use of namespaces:\n<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n<recipe xmlns:r=\"http://www.dabeaz.com/namespaces/recipe\">\n<r:title>\nFamous Guacamole\n</r:title>\n<r:description>\nA southwest favorite!\n</r:description>\n<r:ingredients>\n<r:item num=\"4\"> Large avocados, chopped </r:item>\n...\n</r:ingredients>\n<r:directions>\nCombine all ingredients and hand whisk to desired consistency.\nServe and enjoy with ice-cold beers.\n</r:directions>\n</recipe>\nTo work with the namespaces, it is usually easiest to use a dictionary that maps the\nnamespace prefix to the associated namespace URI.You then use string formatting\noperators to fill in the URI as shown here:\nfrom xml.etree.ElementTree import ElementTree\ndoc = ElementTree(file=\"recipens.xml\")\nns = {\n'r' : 'http://www.dabeaz.com/namespaces/recipe'\n}\ningredients = doc.find('{%(r)s}ingredients' % ns)\nfor item in ingredients.findall('{%(r)s}item' % ns):\nnum   = item.get('num')\nunits = item.get('units','')\ntext  = item.text.strip()\nquantity = \"%s %s\" % (num, units)\nprint(\"%-10s %s\" % (quantity, text))\nFor small XML files, it is fine to use the ElementTree module to quickly load them\ninto memory so that you can work with them. However, suppose you are working with\na huge XML file with a structure such as this:\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<music>\n<album>\n<title>A Texas Funeral</title>\n<artist>Jon Wayne</artist>\n...\n</album>\n<album>\n<title>Metaphysical Graffiti</title>\n<artist>The Dead Milkmen</artist>\n...\n</album>\n... continues for 100000 more albums ...\n</music>\nReading a large XML file into memory tends to consume vast amounts of memory. For\nexample, reading a 10MB XML file may result in an in-memory data structure of more\nthan 100MB. If you’re trying to extract information from such files, the easiest way to\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1866,
      "extraction_method": "Direct"
    },
    {
      "page_number": 605,
      "chapter": null,
      "content": "580\nChapter 24 Internet Data Handling and Encoding\ndo it is to use the ElementTree.iterparse() function. Here is an example of itera-\ntively processing <album> nodes in the previous file:\nfrom xml.etree.ElementTree import iterparse\niparse = iterparse(\"music.xml\", ['start','end'])\n# Find the top-level music element\nfor event, elem in iparse:\nif event == 'start' and elem.tag == 'music':\nmusicNode = elem\nbreak\n# Get all albums\nalbums = (elem for event, elem in iparse\nif event == 'end' and elem.tag == 'album')\nfor album in albums:\n# Do some kind of processing\n...\nmusicNode.remove(album)              # Throw away the album when done\nThe key to using iterparse() effectively is to get rid of data that you’re no longer\nusing.The last statement musicNode.remove(album) is throwing away each <album>\nelement after we are done processing it (by removing it from its parent). If you monitor\nthe memory footprint of the previous program, you will find that it stays low even if\nthe input file is massive.\nNotes\nn The ElementTree module is by far the easiest and most flexible way of handling\nsimple XML documents in Python. However, it does not provide a lot of bells\nand whistles. For example, there is no support for validation, nor does it provide\nany apparent way to handle complex aspects of XML documents such as DTDs.\nFor these things, you’ll need to install third-party packages. One such package,\nlxml.etree (at http://codespeak.net/lxml/), provides an ElementTree API to\nthe popular libxml2 and libxslt libraries and provides full support for XPATH,\nXSLT, and other features.\nn The ElementTree module itself is a third-party package maintained by Fredrik\nLundh at http://effbot.org/zone/element-index.htm.At this site you can find\nversions that are more modern than what is included in the standard library and\nwhich offer additional features.\nxml.sax\nThe xml.sax module provides support for parsing XML documents using the SAX2\nAPI.\nparse(file, handler [, error_handler])\nParses an XML document, file. file is either the name of a file or an open file\nobject. handler is a content handler object. error_handler is an optional SAX error-\nhandler object that is described further in the online documentation.\nparseString(string, handler [, error_handler])\nThe same as parse() but parses XML data contained in a string instead.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2355,
      "extraction_method": "Direct"
    },
    {
      "page_number": 606,
      "chapter": null,
      "content": "581\nxml Package\nHandler Objects\nTo perform any processing, you have to supply a content handler object to the parse()\nor parseString() functions.To define a handler, you define a class that inherits from\nContentHandler.An instance c of ContentHandler has the following methods, all of\nwhich can be overridden in your handler class as needed:\nc.characters(content)\nCalled by the parser to supply raw character data. content is a string containing the\ncharacters.\nc.endDocument()\nCalled by the parser when the end of the document is reached.\nc.endElement(name)\nCalled when the end of element name is reached. For example, if '</foo>’ is parsed,\nthis method is called with name set to 'foo'.\nc.endElementNS(name, qname)\nCalled when the end of an element involving an XML namespace is reached. name is a\ntuple of strings (uri, localname) and qname is the fully qualified name. Usually\nqname is None unless the SAX namespace-prefixes feature has been enabled. For\nexample, if the element is defined as '<foo:bar xmlns:foo=\"http://spam.com\">',\nthen the name tuple is (u'http://spam.com', u'bar').\nc.endPrefixMapping(prefix)\nCalled when the end of an XML namespace is reached. prefix is the name of the\nnamespace.\nc.ignorableWhitespace(whitespace)\nCalled when ignorable whitespace is encountered in a document. whitespace is a\nstring containing the whitespace.\nc.processingInstruction(target, data)\nCalled when an XML processing instruction enclosed in <? ... ?> is encountered.\ntarget is the type of instruction, and data is the instruction data. For example, if the\ninstruction is '<?xml-stylesheet href=\"mystyle.css\" type=\"text/css\"?>,\ntarget is set to 'xml-stylesheet' and data is the remainder of the instruction text\n'href=\"mystyle.css\" type=\"text/css\"'.\nc.setDocumentLocator(locator)\nCalled by the parser to supply a locator object that can be used for tracking line num-\nbers, columns, and other information.The primary purpose of this method is simply to\nstore the locator someplace so that you can use it later—for instance, if you needed to\nprint an error message.The locator object supplied in locator provides four \nmethods—getColumnNumber(), getLineNumber(), getPublicId(), and\ngetSystemId()—that can be used to get location information.\nc.skippedEntity(name)\nCalled whenever the parser skips an entity. name is the name of the entity that was\nskipped.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2382,
      "extraction_method": "Direct"
    },
    {
      "page_number": 607,
      "chapter": null,
      "content": "582\nChapter 24 Internet Data Handling and Encoding\nc.startDocument()\nCalled at the start of a document.\nc.startElement(name, attrs)\nCalled whenever a new XML element is encountered. name is the name of the ele-\nment, and attrs is an object containing attribute information. For example, if the\nXML element is '<foo bar=\"whatever\" spam=\"yes\">', name is set to 'foo' and\nattrs contains information about the bar and spam attributes.The attrs object pro-\nvides a number of methods for obtaining attribute information:\nMethod\nDescription\nattrs.getLength()\nReturns the number of attributes\nattrs.getNames()\nReturns a list of attribute names\nattrs.getType(name)\nGets the type of attribute name\nattrs.getValue(name)\nGets the value of attribute name\nc.startElementNS(name, qname, attrs)\nCalled when a new XML element is encountered and XML namespaces are being\nused. name is a tuple (uri, localname) and qname is a fully qualified element name\n(normally set to None unless the SAX2 namespace-prefixes feature has been\nenabled). attrs is an object containing attribute information. For example, if the XML\nelement is '<foo:bar xmlns:foo=\"http://spam.com\" blah=\"whatever\">', then\nname is (u'http://spam.com', u'bar'), qname is None, and attrs contains infor-\nmation about the attribute blah.The attrs object has the same methods as used in\nwhen accessing attributes in the startElement() method shown earlier. In addition,\nthe following additional methods are added to deal with namespaces:\nMethod\nDescription\nattrs.getValueByQName(qname)\nReturns value for qualified name.\nattrs.getNameByQName(qname)\nReturns (namespace, localname) tuple for a\nname.\nattrs.getQNameByName(name)\nReturns qualified name for name specified as a\ntuple (namespace, localname).\nattrs.getQNames()\nReturns qualified names of all attributes.\nc.startPrefixMapping(prefix, uri)\nCalled at the start of an XML namespace declaration. For example, if an element is\ndefined as '<foo:bar xmlns:foo=\"http://spam.com\">', then prefix is set to\n'foo' and uri is set to 'http://spam.com'.\nExample\nThe following example illustrates a SAX-based parser, by printing out the ingredient list\nfrom the recipe file shown earlier.This should be compared with the example in the\nxml.dom.minidom section.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2267,
      "extraction_method": "Direct"
    },
    {
      "page_number": 608,
      "chapter": null,
      "content": "583\nxml Package\nfrom xml.sax import ContentHandler, parse\nclass RecipeHandler(ContentHandler):\ndef startDocument(self):\nself.initem = False\ndef startElement(self,name,attrs):\nif name == 'item':\nself.num   = attrs.get('num','1')\nself.units = attrs.get('units','none')\nself.text = []\nself.initem = True\ndef endElement(self,name):\nif name == 'item':\ntext = \"\".join(self.text)\nif self.units == 'none': self.units = \"\"\nunitstr = \"%s %s\" % (self.num, self.units)\nprint(\"%-10s %s\" % (unitstr,text.strip()))\nself.initem = False\ndef characters(self,data):\nif self.initem:\nself.text.append(data)\nparse(\"recipe.xml\",RecipeHandler())\nNotes\nThe xml.sax module has many more features for working with different kinds of\nXML data and creating custom parsers. For example, there are handler objects that can\nbe defined to parse DTD data and other parts of the document. More information can\nbe found in the online documentation.\nxml.sax.saxutils\nThe xml.sax.saxutils module defines some utility functions and objects that are\noften used with SAX parsers, but are often generally useful elsewhere.\nescape(data [, entities])\nGiven a string, data, this function replaces certain characters with escape sequences. For\nexample, '<' gets replaced by '&lt;'. entities is an optional dictionary that maps\ncharacters to the escape sequences. For example, setting entities to { u'\\xf1' :\n'&ntilde;' } would replace occurences of ñ with '&ntilde;'.\nunescape(data [, entities])\nUnescapes special escape sequences that appear in data. For instance, '&lt;' is\nreplaced by '<'. entities is an optional dictionary mapping entities to unescaped\ncharacter values. entities is the inverse of the dictionary used with escape()—for\nexample, { '&ntilde;' : u'\\xf1' }.\nquoteattr(data [, entities])\nEscapes the string data, but performs additional processing that allows the result value\nto be used as an XML attribute value.The return value can be printed directly \nas an attribute value—for example, print \"<element attr=%s>\" %\nquoteattr(somevalue). entities is a dictionary compatible for use with the\nescape() function.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2106,
      "extraction_method": "Direct"
    },
    {
      "page_number": 609,
      "chapter": null,
      "content": "584\nChapter 24 Internet Data Handling and Encoding\nXMLGenerator([out [, encoding]])\nA ContentHandler object that merely echoes parsed XML data back to the output\nstream as an XML document.This re-creates the original XML document. out is the\noutput document and defaults to sys.stdout. encoding is the character encoding to\nuse and defaults to 'iso-8859-1'.This can be useful if you’re trying to debug your\nparsing code and use a handler that is known to work.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 483,
      "extraction_method": "Direct"
    },
    {
      "page_number": 610,
      "chapter": null,
      "content": "25\nMiscellaneous Library\nModules\nThe modules listed in this section are not covered in detail in this book but are still\nconsidered to be part of the standard library.These modules have mostly been omitted\nfrom previous chapters because they are either extremely low-level and of limited use,\nrestricted to very specific platforms, obsolete, or so complicated that coverage would\nrequire a complete book on the topic.Although these modules are have been omitted\nfrom this book, online documentation is available for each module at http://\ndocs.python.org/library/modname.An index of all modules is also available at\nhttp://docs.python.org/library/modindex.html.\nThe modules listed here represent a common subset of functionality between Python\n2 and Python 3. If you are using a module that is not listed here, chances are it has been\nofficially deprecated. Some modules have changed names in Python 3.The new name is\nshown in parentheses, if applicable.\nPython Services\nThe following modules provide additional services related to the Python language and\nexecution of the Python interpreter. Many of these modules are related to parsing and\ncompilation of Python source code.\nModule\nDescription\nbdb\nAccess to the debugger framework\ncode\nInterpreter base classes\ncodeop\nCompiles Python code\ncompileall\nByte-compiles Python files in a directory\ncopy_reg (copyreg)\nRegister built-in types for use with the pickle module\ndis\nDisassembler\ndistutils\nDistribution of Python modules\nfpectl\nFloating-point exception control\nimp\nProvides access to the implementation of the import\nstatement\nkeyword\nTests whether a string is a Python keyword\nlinecache\nRetrieves lines from source files\nmodulefinder\nFinds modules used by a script\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1743,
      "extraction_method": "Direct"
    },
    {
      "page_number": 611,
      "chapter": null,
      "content": "586\nChapter 25 Miscellaneous Library Modules\nModule\nDescription\nparser\nAccesses parse trees of Python source code\npickletools\nTools for pickle developers\npkgutil\nPackage extension utility\npprint\nPrettyprinter for objects\npyclbr\nExtracts information for class browsers\npy_compile\nCompiles Python source to bytecode files\nrepr (reprlib)\nAlternate implementation of the repr() function\nsymbol\nConstants used to represent internal nodes of parse trees\ntabnanny\nDetection of ambiguous indentation\ntest\nRegression testing package\ntoken\nTerminal nodes of the parse tree\ntokenize\nScanner for Python source code\nuser\nUser configuration file parsing\nzipimport\nImport modules from zip archives\nString Processing\nThe following modules are some older, now obsolete, modules used for string \nprocessing.\nModule\nDescription\ndifflib\nCompute deltas between strings\nfpformat\nFloating-point number formatting\nstringprep\nInternet string preparation\ntextwrap\nText wrapping\nOperating System Modules\nThese modules provide additional operating system services. In some cases, the func-\ntionality of a module listed here is already incorporated into the functionality of other\nmodules covered in Chapter 19,“Operating System Services.”\nModule\nDescription\ncrypt\nAccess to the UNIX crypt function\ncurses\nCurses library interface\ngrp\nAccess to the group database\npty\nPseudo terminal handling\npipes\nInterface to shell pipelines\nnis\nInterface to Sun’s NIS\nplatform\nAccess to platform-specific information\npwd\nAccess to the password database\nreadline\nAccess to GNU readline library\nrlcompleter\nCompletion function for GNU readline\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1622,
      "extraction_method": "Direct"
    },
    {
      "page_number": 612,
      "chapter": null,
      "content": "587\nInternationalization\nModule\nDescription\nresource\nResource usage information\nsched\nEvent scheduler\nspwd\nAccess to the shadow password database\nstat\nSupport for interpreting results of os.stat()\nsyslog\nInterface to UNIX syslog daemon\ntermios\nUNIX TTY control\ntty\nTerminal control functions\nNetwork\nThe following modules provide support for lesser-used network protocols:\nModule\nDescription\nimaplib\nIMAP protocol\nnntplib\nNNTP protocol\npoplib\nPOP3 protocol\nsmtpd\nSMTP server\ntelnetlib\nTelnet protocol\nInternet Data Handling\nThe following modules provide additional support for Internet data processing not cov-\nered in Chapter 24,“Internet Data Handling and Encoding.”\nModule\nDescription\nbinhex\nBinHex4 file format support\nformatter\nGeneric output formatting\nmailcap\nMailcap file handling\nmailbox\nReading various mailbox formats\nnetrc\nNetrc file processing\nplistlib\nMacintosh plist file processing\nuu\nUUencode file support\nxdrlib\nEncode and decode Sun XDR data\nInternationalization\nThe following modules are used for writing internationalized applications:\nModule\nDescription\ngettext\nMultilingual text handling services\nlocale\nInternationalization functions provided by the system\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1203,
      "extraction_method": "Direct"
    },
    {
      "page_number": 613,
      "chapter": null,
      "content": "588\nChapter 25 Miscellaneous Library Modules\nMultimedia Services\nThe following modules provide support for handling various kinds of multimedia files:\nModule\nDescription\naudioop\nManipulates raw audio data\naifc\nReads and writes AIFF and AIFC files\nsunau\nReads and writes Sun AU files\nwave\nReads and writes WAV files\nchunk\nReads IFF chunked data\ncolorsys\nConversions between color systems\nimghdr\nDetermines the type of an image\nsndhdr\nDetermines the type of a sound file\nossaudiodev\nAccess to OSS-compatible audio devices\nMiscellaneous\nThe following modules round out the list and don’t really neatly fall into any of the\nother categories:\nModule\nDescription\ncmd\nLine-oriented command interpreters\ncalendar\nCalendar-generation functions\nshlex\nSimple lexical analysis module\nsched\nEvent scheduler\nTkinter (tkinter)\nPython interface to Tcl/Tk\nwinsound\nPlaying sounds on Windows\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 896,
      "extraction_method": "Direct"
    },
    {
      "page_number": 614,
      "chapter": null,
      "content": "III\nExtending and Embedding\n26\nExtending and Embedding Python\nAppendix: Python 3\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 103,
      "extraction_method": "Direct"
    },
    {
      "page_number": 615,
      "chapter": null,
      "content": "This page intentionally left blank \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 58,
      "extraction_method": "Direct"
    },
    {
      "page_number": 616,
      "chapter": null,
      "content": "26\nExtending and Embedding\nPython\nOne of the most powerful features of Python is its ability to interface with software\nwritten in C.There are two common strategies for integrating Python with foreign\ncode. First, foreign functions can be packaged into a Python library module for use\nwith the import statement. Such modules are known as extension modules because they\nextend the interpreter with additional functionality not written in Python.This is, by\nfar, the most common form of Python-C integration because it gives Python applica-\ntions access to high-performance programming libraries.The other form of Python-C\nintegration is embedding.This is a process by which Python programs and the interpreter\nare accessed as a library from C.This latter approach is sometimes used by programmers\nwho want to embed the Python interpreter into an existing C application framework\nfor some reason—usually as some kind of scripting engine.\nThis chapter covers the absolute basics of the Python-C programming interface.\nFirst, the essential parts of the C API used to build extension modules and embed the\nPython interpreter are covered.This section is not intended to be a tutorial, so readers\nnew to this topic should consult the “Embedding and Extending the Python\nInterpreter” document available at http://docs.python.org/extending, as well as the\n“Python/C API Reference Manual” available at http://docs.python.org/c-api. Next, the\nctypes library module is covered.This is an extremely useful module that allows you to\naccess functions in C libraries without writing any additional C code or using a C\ncompiler.\nIt should be noted that for advanced extension and embedding applications, most\nprogrammers tend to turn to advanced code generators and programming libraries. For\nexample, the SWIG project (http://www.swig.org) is a compiler that creates Python\nextension modules by parsing the contents of C header files. References to this and\nother extension building tools can be found at http://wiki.python.org/moin/\nIntegratingPythonWithOtherLanguages.\nExtension Modules\nThis section outlines the basic process of creating a handwritten C extension module\nfor Python.When you create an extension module, you are building an interface\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2258,
      "extraction_method": "Direct"
    },
    {
      "page_number": 617,
      "chapter": null,
      "content": "592\nChapter 26 Extending and Embedding Python\nbetween Python and existing functionality written in C. For C libraries, you usually\nstart from a header file such as the following:\n/* file : example.h */\n#include <stdio.h>\n#include <string.h>\n#include <math.h>\ntypedef struct Point {\ndouble x;\ndouble y;\n} Point;\n/* Compute the GCD of two integers x and y */\nextern int    gcd(int x, int y);\n/* Replace och with nch in s and return the number of replacements */\nextern int    replace(char *s, char och, char nch);\n/* Compute the distance between two points */\nextern double distance(Point *a, Point *b);\n/* A preprocessor constant */\n#define MAGIC 0x31337\nThese function prototypes have some kind of implementation in a separate file. For\nexample:\n/* example.c */\n#include \"example.h\"\n/* Compute GCD of two positive integers x and y */\nint gcd(int x, int y) {\nint g;\ng = y;\nwhile (x > 0) {\ng = x;\nx = y % x;\ny = g;\n}\nreturn g;\n}\n/* Replace a character in a string */\nint replace(char *s, char oldch, char newch) {\nint nrep = 0;\nwhile (s = strchr(s,oldch)) {\n*(s++) = newch;\nnrep++;\n}\nreturn nrep;\n}\n/* Distance between two points */\ndouble distance(Point *a, Point *b) {\ndouble dx,dy;\ndx = a->x - b->x;\ndy = a->y - b->y;\nreturn sqrt(dx*dx + dy*dy);\n}\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1271,
      "extraction_method": "Direct"
    },
    {
      "page_number": 618,
      "chapter": null,
      "content": "593\nExtension Modules\nHere is a C main() program that illustrates the use of these functions:\n/* main.c */\n#include \"example.h\"\nint main() {\n/* Test the gcd() function */\n{\nprintf(\"%d\\n\", gcd(128,72));\nprintf(\"%d\\n\", gcd(37,42)); \n}\n/* Test the replace() function */\n{\nchar s[] = \"Skipping along unaware of the unspeakable peril.\";\nint  nrep;\nnrep = replace(s,' ','-');\nprintf(\"%d\\n\", nrep);\nprintf(\"%s\\n\",s);\n}\n/* Test the distance() function */\n{\nPoint a = { 10.0, 15.0 };\nPoint b = { 13.0, 11.0 };\nprintf(\"%0.2f\\n\", distance(&a,&b));\n}\n}\nHere is the output of the previous program:\n% a.out\n8\n1\n6\nSkipping-along-unaware-of-the-unspeakable-peril.\n5.00\nAn Extension Module Prototype\nExtension modules are built by writing a separate C source file that contains a set of\nwrapper functions which provide the glue between the Python interpreter and the\nunderlying C code. Here is an example of a basic extension module called _example:\n/* pyexample.c */\n#include \"Python.h\"\n#include \"example.h\"\nstatic char py_gcd_doc[] = \"Computes the GCD of two integers\";\nstatic PyObject *\npy_gcd(PyObject *self, PyObject *args) {\nint x,y,r;\nif (!PyArg_ParseTuple(args,\"ii:gcd\",&x,&y)) {\nreturn NULL;\n}\nr = gcd(x,y);\nreturn Py_BuildValue(\"i\",r);\n}\nstatic char py_replace_doc[] = \"Replaces all characters in a string\";\nstatic PyObject *\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1341,
      "extraction_method": "Direct"
    },
    {
      "page_number": 619,
      "chapter": null,
      "content": "594\nChapter 26 Extending and Embedding Python\npy_replace(PyObject *self, PyObject *args, PyObject *kwargs) {\nstatic char *argnames[] = {\"s\",\"och\",\"nch\",NULL};\nchar     *s,*sdup;\nchar      och, nch;\nint       nrep;\nPyObject *result;\nif (!PyArg_ParseTupleAndKeywords(args,kwargs, \"scc:replace\", \nargnames, &s, &och, &nch)) {\nreturn NULL;\n}\nsdup = (char *) malloc(strlen(s)+1);\nstrcpy(sdup,s);\nnrep = replace(sdup,och,nch);\nresult = Py_BuildValue(\"(is)\",nrep,sdup);\nfree(sdup);\nreturn result;\n}\nstatic char py_distance_doc[] = \"Computes the distance between two points\";\nstatic PyObject *\npy_distance(PyObject *self, PyObject *args) {\nPyErr_SetString(PyExc_NotImplementedError,\"distance() not implemented.\");\nreturn NULL;\n}\nstatic PyMethodDef _examplemethods[] = {\n{\"gcd\", py_gcd, METH_VARARGS, py_gcd_doc},\n{\"replace\", py_replace, METH_VARARGS | METH_KEYWORDS, py_replace_doc},\n{\"distance\",py_distance,METH_VARARGS, py_distance_doc},\n{NULL, NULL, 0, NULL}\n};\n#if PY_MAJOR_VERSION < 3\n/* Python 2 module initialization */\nvoid init_example(void) {\nPyObject *mod;\nmod = Py_InitModule(\"_example\", _examplemethods);\nPyModule_AddIntMacro(mod,MAGIC);\n}\n#else\n/* Python 3 module initialization */\nstatic struct PyModuleDef _examplemodule = {\nPyModuleDef_HEAD_INIT,\n\"_example\",   /* name of module */\nNULL,         /* module documentation, may be NULL */\n-1,\n_examplemethods\n};\nPyMODINIT_FUNC\nPyInit_ _example(void) {\nPyObject *mod;\nmod = PyModule_Create(&_examplemodule);\nPyModule_AddIntMacro(mod, MAGIC);\nreturn mod;\n}\n#endif\nExtension modules always need to include \"Python.h\". For each C function to be\naccessed, a wrapper function is written.These wrapper functions accept either two\narguments (self and args, both of type PyObject *) or three arguments (self, args,\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1784,
      "extraction_method": "Direct"
    },
    {
      "page_number": 620,
      "chapter": null,
      "content": "595\nExtension Modules\nand kwargs, all of type PyObject *).The self parameter is used when the wrapper\nfunction is implementing a built-in method to be applied to an instance of some object.\nIn this case, the instance is placed in the self parameter. Otherwise, self is set to\nNULL. args is a tuple containing the function arguments passed by the interpreter.\nkwargs is a dictionary containing keyword arguments.\nArguments are converted from Python to C using the PyArg_ParseTuple() or\nPyArg_ParseTupleAndKeywords() function. Similarly, the Py_BuildValue() func-\ntion is used to construct an acceptable return value.These functions are described in\nlater sections.\nDocumentation strings for extension functions should be placed in separate string\nvariables such as py_gcd_doc and py_replace_doc as shown.These variables are refer-\nenced during module initialization (described shortly).\nWrapper functions should never, under penalty of certain flaming death, mutate data\nreceived by reference from the interpreter.This is why the py_replace() wrapper is\nmaking a copy of the received string before passing it to the C function (which modi-\nfies it in place). If this step is omitted, the wrapper function may violate Python’s string\nimmutability.\nIf you want to raise an exception, you use the PyExc_SetString() function as\nshown in the py_distance() wrapper. NULL is returned to signal that an error has\noccurred.\nThe method table _examplemethods is used to associate Python names with the C\nwrapper functions.These are the names used to call the function from the interpreter.\nThe METH_VARARGS flag indicates the calling conventions for a wrapper. In this case,\nonly positional arguments in the form of a tuple are accepted. It can also be set to\nMETH_VARARGS | METH_KEYWORDS to indicate a wrapper function accepting keyword\narguments.The method table additionally sets the documentation strings for each wrap-\nper function.\nThe final part of an extension module performs an initialization procedure that\nvaries between Python 2 and Python 3. In Python 2, the module initialization function\ninit_example is used to initialize the contents of the module. In this case, the\nPy_InitModule(\"_example\",_examplemethods) function creates a module,\n_example, and populates it with built-in function objects corresponding to the func-\ntions listed in the method table. For Python 3, you have to create an PyModuleDef\nobject _examplemodule that describes the module.You then write a function\nPyInit_ _example() that initializes the module as shown.The module initialization\nfunction is also the place where you install constants and other parts of a module, if\nnecessary. For example, the PyModule_AddIntMacro() is adding the value of a pre-\nprocessor to the module.\nIt is important to note that naming is critically important for module initialization. If\nyou are creating a module called modname, the module initialization function must be\ncalled initmodname() in Python 2 and PyInit_modname() in Python 3. If you don’t\ndo this, the interpreter won’t be able to correctly load your module.\nNaming Extension Modules\nIt is standard practice to name C extension modules with a leading underscore such as\n'_example'.This convention is followed by the Python standard library itself. For\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3298,
      "extraction_method": "Direct"
    },
    {
      "page_number": 621,
      "chapter": null,
      "content": "596\nChapter 26 Extending and Embedding Python\ninstance, there are modules named _socket, _thread, _sre, and _fileio correspon-\nding to the C programming components of the socket, threading, re, and io mod-\nules. Generally, you do not use these C extension modules directly. Instead, you create a\nhigh-level Python module such as the following:\n# example.py\nfrom _example import *\n# Add additional support code below\n...\nThe purpose of this Python wrapper is to supply additional support code for your\nmodule or to provide a higher-level interface. In many cases, it is easier to implement\nparts of an extension module in Python instead of C.This design makes it easy to do\nthis. If you look at many standard library modules, you will find that they have been\nimplemented as a mix of C and Python in this manner.\nCompiling and Packaging Extensions\nThe preferred mechanism for compiling and packaging an extension module is to use\ndistutils.To do this, you create a setup.py file that looks like this:\n# setup.py\nfrom distutils.core import setup, Extension\nsetup(name=\"example\",\nversion=\"1.0\",\npy_modules = ['example.py'],\next_modules = [\nExtension(\"_example\",\n[\"pyexample.c\",\"example.c\"])\n]\n)\nIn this file, you need to include the high-level Python file (example.py) and the source\nfiles making up the extension module (pyexample.c, example.c).To build the module\nfor testing, type the following:\n% python setup.py build_ext --inplace\nThis will compile the extension code into a shared library and leave it in \nthe current working directory.The name of this library will be \n_examplemodule.so, _examplemodule.pyd, or some similar variant.\nIf the compilation was successful, using your module is straightforward. For example:\n% python3.0\nPython 3.0 (r30:67503, Dec  4 2008, 09:40:15) \n[GCC 4.0.1 (Apple Inc. build 5465)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import example\n>>> example.gcd(78,120)\n6\n>>> example.replace(\"Hello World\",' ','-')\n(1, 'Hello-World')\n>>> example.distance()\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nNotImplementedError: distance() not implemented.\n>>>\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2176,
      "extraction_method": "Direct"
    },
    {
      "page_number": 622,
      "chapter": null,
      "content": "597\nExtension Modules\nMore complicated extension modules may need to supply additional build information,\nsuch as include directories, libraries, and preprocessor macros.They can also be included\nin setup.py, as follows:\n# setup.py\nfrom distutils.core import setup, Extension\nsetup(name=\"example\",\nversion=\"1.0\",\npy_modules = ['example.py'],\next_modules = [\nExtension(\"_example\",\n[\"pyexample.c\",\"example.c\"],\ninclude_dirs = [\"/usr/include/X11\",\"/opt/include\"],\ndefine_macros = [('DEBUG',1'),\n('MONDO_FLAG',1)],\nundef_macros = ['HAVE_FOO','HAVE_NOT'],\nlibrary_dirs= [\"/usr/lib/X11\", \"/opt/lib\"],\nlibraries = [ \"X11\", \"Xt\", \"blah\" ])\n]\n)\nIf you want to install an extension module for general use, you simply type python\nsetup.py install. Further details about this are found in Chapter 8,“Modules,\nPackages, and Distribution.”\nIn some situations, you may want to build an extension module manually.This\nalmost always requires advanced knowledge of various compiler and linker options.The\nfollowing is an example on Linux:\nlinux % gcc -c -fpic -I/usr/local/include/python2.6 example.c pyexample.c\nlinux % gcc -shared example.o pyexample.o -o _examplemodule.so\nType Conversion from Python to C\nThe following functions are used by extension modules to convert arguments passed\nfrom Python to C.Their prototypes are defined by including the Python.h header file.\nint PyArg_ParseTuple(PyObject *args, char *format, ...);\nParses a tuple of positional arguments in args into a series of C variables. format is a\nformat string containing zero or more of the specifier strings from Tables 26.1–26.3,\nwhich describe the expected contents of args.All the remaining arguments contain the\naddresses of C variables into which the results will be placed.The order and types of\nthese arguments must match the specifiers used in format. Zero is returned if the argu-\nments could not be parsed.\nint PyArg_ParseTupleAndKeywords(PyObject *args, PyObject *kwargs,\nchar *format, char **kwlist, ...);\nParses both a tuple of positional arguments and a dictionary of keyword arguments con-\ntained in kwargs. format has the same meaning as for PyArg_ParseTuple().The\nonly difference is that kwlist is a null-terminated list of strings containing the names\nof all the arguments. Returns 1 on success, 0 on error.\nTable 26.1 lists the format codes that are placed in the format argument to convert\nnumbers.The C argument type column lists the C data type that should be passed to\nthe PyArg_Parse*() functions. For numbers, it is always a pointer to a location where\nthe result should be stored.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2588,
      "extraction_method": "Direct"
    },
    {
      "page_number": 623,
      "chapter": null,
      "content": "598\nChapter 26 Extending and Embedding Python\nTable 26.1\nNumeric Conversions and Associated C Data Types for PyArg_Parse*\nFormat\nPython Type\nC Argument Type \n\"b\"\nInteger\nsigned char *r\n\"B\"\nInteger\nunsigned char *r\n\"h\"\nInteger\nshort *r\n\"H\"\nInteger\nunsigned short *r\n\"i\"\nInteger\nint *r\n\"I\"\nInteger\nunsigned int *r\n\"l\"\nInteger\nlong int *r\n\"k\"\nInteger\nunsigned long *r\n\"L\"\nInteger\nlong long *r\n\"K\"\nInteger\nunsigned long long *r\n\"n\"\nInteger\nPy_ssize_t *r\n\"f\"\nFloat\nfloat *r\n\"d\"\nFloat\ndouble *r\n\"D\"\nComplex\nPy_complex *r\nWhen signed integer values are converted, an OverflowError exception is raised if the\nPython integer is too large to fit into the requested C data type. However, conversions\nthat accept unsigned values (e.g., 'I', 'H', 'K', and so on) do not check for overflow\nand will silently truncate the value if it exceeds the supported range. For floating-point\nconversions, a Python int or float may be supplied as input. In this case, integers will\nbe promoted to a float. User-defined classes are accepted as numbers as long as they\nprovide appropriate conversion methods such as _ _int_ _() or _ _float_ _(). For\nexample, a user-defined class that implements _ _int_ _() will be accepted as input for\nany of the previously shown integer conversions (and _ _int_ _() invoked automatical-\nly to do the conversion).\nTable 26.2 shows the conversions that apply to strings and bytes. Many of the string\nconversions return both a pointer and length as a result.\nTable 26.2\nString Conversions and Associated C Data Types for PyArg_Parse*\nFormat\nPython Type\nC Argument Type\n\"c\"\nString or byte string of length 1\nchar *r\n\"s\"\nString\nchar **r\n\"s#\"\nString, bytes, or buffer\nchar **r, int *len\n\"s*\"\nString, bytes, or buffer\nPy_buffer *r\n\"z\"\nString or None\nchar **r\n\"z#\"\nString, bytes, or None\nchar **r, int *len\n\"z*\"\nString, bytes, buffer, or None\nPy_buffer *r\n\"y\"\nBytes (null-terminated)\nchar **r\n\"y#\"\nBytes\nchar **r, int *len\n\"y*\"\nBytes or buffer\nPy_buffer *r\n\"u\"\nString (Unicode)\nPy_UNICODE **r\n\"u#\"\nString (Unicode)\nPy_UNICODE **r, int *len\n\"es\"\nString\nconst char *enc, char **r\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2101,
      "extraction_method": "Direct"
    },
    {
      "page_number": 624,
      "chapter": null,
      "content": "599\nExtension Modules\nTable 26.2\nContinued\nFormat\nPython Type\nC Argument Type\n\"es#\"\nString or bytes\nconst char *enc, char **r, int\n*len\n\"et\"\nString or null-terminated bytes\nconst char *enc, char **r, int\n*len\n\"et#\"\nString or bytes\nconst char *enc, char **r, int\n*len\n\"t#\"\nRead-only buffer\nchar **r, int *len\n\"w\"\nRead-write buffer\nchar **r\n\"w#\"\nRead-write buffer\nchar **r, int *len\n\"w*\"\nRead-write buffer\nPy_buffer *r\nString handling presents a special problem for C extensions because the char *\ndatatype is used for many different purposes. For instance, it might refer to text, a single\ncharacter, or a buffer of raw binary data.There is also the issue of what to do with\nembedded NULL characters ('\\x00') that C uses to signal the end of text strings.\nIn Table 26.2, the conversion codes of \"s\", \"z\", \"u\", \"es\", and \"et\" should be used\nif you are passing text. For these codes, Python assumes that the input text does not\ncontain any embedded NULLs—if so, a TypeError exception is raised. However, the\nresulting string in C can be safely assumed to be NULL-terminated. In Python 2, both\n8-bit and Unicode strings can be passed, but in Python 3, all conversions except for\n\"et\" require the Python str type and do not work with bytes.When Unicode strings\nare passed to C, they are always encoded using the default Unicode encoding used by\nthe interpreter (usually UTF-8).The one exception is the \"u\" conversion code that\nreturns a string using Python’s internal Unicode representation.This is an array of\nPy_UNICODE values where Unicode characters are typically represented by the wchar_t\ntype in C.\nThe \"es\" and \"et\" codes allow you to specify an alternative encoding for the text.\nFor these, you supply an encoding name such as 'utf-8' or 'iso-8859-1', and the\ntext will be encoded into a buffer and returned in that format.The \"et\" code differs\nfrom \"es\" in that if a Python byte-string is given, it is assumed to have already been\nencoded and is passed through unmodified. One caution with \"es\" and \"et\" conver-\nsions is that they dynamically allocate memory for the result and require the user to\nexplicitly release it using PyMem_Free().Thus, code that uses these conversions should\nlook similar to this:\nPyObject *py_wrapper(PyObject *self, PyObject *args) {\nchar *buffer;\nif (!PyArg_ParseTuple(args,\"es\",\"utf-8\",&buffer)) {\nreturn NULL;\n}\n/* Do something. */\n...\n/* Cleanup and return the result */\nPyMem_Free(buffer);\nreturn result;\n}\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2467,
      "extraction_method": "Direct"
    },
    {
      "page_number": 625,
      "chapter": null,
      "content": "600\nChapter 26 Extending and Embedding Python\nFor handling text or binary data, use the \"s#\", \"z#\", \"u#\", \"es#\", or \"et#\" codes.\nThese conversions work exactly the same as before except that they additionally return\na length. Because of this, the restriction on embedded NULL characters is lifted. In\naddition, these conversions add support for byte strings and any other objects that sup-\nport something known as the buffer interface.The buffer interface is a means by which a\nPython object can expose a raw binary buffer representing its contents.Typically, you\nfind it on strings, bytes, and arrays (e.g., the arrays created in the array module support\nit). In this case, if an object provides a readable buffer interface, a pointer to the buffer\nand its size is returned. Finally, if a non-NULL pointer and length are given to the\n\"es#\" and \"et#\" conversions, it is assumed that these represent a pre-allocated buffer\ninto which the result of the encoding can be placed. In this case, the interpreter does\nnot allocate new memory for the result and you don’t have to call PyMem_Free().\nThe conversion codes of \"s*\" and \"z*\" are similar to \"s#\" and \"z#\" except that\nthey populate a Py_buffer structure with information about the received data. More\ninformation about this can be found in PEP-3118, but this structure minimally has\nattributes char *buf, int len, and int itemsize that point to the buffer, the buffer\nlength (in bytes), and the size of items held in the buffer. In addition, the interpreter\nplaces a lock on the buffer that prevents it from being changed by other threads as long\nas it is held by extension code.This allows the extension to work with the buffer con-\ntents independently, possibly in a different thread than the interpreter. It is up to the\nuser to call PyBuffer_Release() on the buffer after all processing is complete.\nThe conversion codes of \"t#\", \"w\", \"w#\", and \"w*\" are just like the \"s\" family of\ncodes except that they only accept objects implementing the buffer interface. \"t#\"\nrequires the buffer to be readable.The \"w\" code requires the buffer to be both readable\nand writable.A Python object supporting a writable buffer is assumed to be mutable.\nThus, it is legal for a C extension to overwrite or modify the buffer contents.\nThe conversion codes of \"y\", \"y#\", and \"y*\" are just like the \"s\" family of codes\nexcept that they only accept byte strings. Use these to write functions that must only\ntake bytes, not Unicode strings.The \"y\" code only accepts byte strings that do not con-\ntain embedded NULL characters.\nTable 26.3 lists conversion codes that are used to accept arbitrary Python objects as\ninput and to leave the result as type PyObject *.These are sometimes used for C\nextensions that need to work with Python objects that are more complicated than sim-\nple numbers or strings—for example, if you needed a C extension function to accept an\ninstance of a Python class or dictionary.\nTable 26.3\nPython Object Conversions and Associated C Data Types for\nPyArg_Parse*\nFormat\nPython Type\nC Type\n\"O\"\nAny\nPyObject **r\n\"O!\"\nAny\nPyTypeObject *type, PyObject **r\n\"O&\"\nAny\nint (*converter)(PyObject *, void *), void *r\n\"S\"\nString\nPyObject **r\n\"U\"\nUnicode\nPyObject **r\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 3236,
      "extraction_method": "Direct"
    },
    {
      "page_number": 626,
      "chapter": null,
      "content": "601\nExtension Modules\nThe \"O\", \"S\", and \"U\" specifiers return raw Python objects of type PyObject *. \"S\"\nand \"U\" restrict this object to be a string or Unicode string, respectively.\nThe \"O!\" conversion requires two C arguments: a pointer to a Python type object\nand a pointer to a PyObject * into which a pointer to the object is placed.A\nTypeError is raised if the type of the object doesn’t match the type object. For \nexample:\n/* Parse a List Argument */\nPyObject *listobj;\nPyArg_ParseTuple(args,\"O!\", &PyList_Type, &listobj);\nThe following list shows the C type names corresponding to some Python container\ntypes that might be commonly used with this conversion.\nC Name\nPython Type\nPyList_Type\nlist\nPyDict_Type\ndict\nPySet_Type\nset\nPyFrozenSet_Type\nfrozen_set\nPyTuple_Type\ntuple\nPySlice_Type\nslice\nPyByteArray_Type\nbytearray\nThe \"O&\" conversion takes two arguments (converter, addr) and uses a function to\nconvert a PyObject * to a C data type. converter is a pointer to a function with the\nprototype int converter(PyObject *obj, void *addr), where obj is the passed\nPython object and addr is the address supplied as the second argument in\nPyArg_ParseTuple(). converter() should return 1 on success, 0 on failure. On\nerror, the converter should also raise an exception.This kind of conversion can be used\nto map Python objects such as lists or tuples into C data structures. For example, here is\na possible implementation of the distance() wrapper from our earlier code:\n/* Convert a tuple into a Point structure. */\nint convert_point(PyObject *obj, void *addr) {\nPoint *p = (Point *) addr;\nreturn PyArg_ParseTuple(obj,\"ii\", &p->x, &p->y);\n}\nPyObject *py_distance(PyObject *self, PyObject *args) {\nPoint p1, p2;\ndouble result;\nif (!PyArg_ParseTuple(args,\"O&O&\",\nconvert_point, &p1, convert_point, &p2)) {\nreturn NULL;\n}\nresult = distance(&p1,&p2);\nreturn Py_BuildValue(\"d\",result);\n}\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1909,
      "extraction_method": "Direct"
    },
    {
      "page_number": 627,
      "chapter": null,
      "content": "602\nChapter 26 Extending and Embedding Python\nFinally, argument format strings can contain a few additional modifiers related to tuple\nunpacking, documentation, error messages, and default arguments.The following is a list\nof these modifiers:\nFormat String\nDescription\n\"(items)\"\nUnpack a tuple of objects. Items consist of format conversions.\n\"|\"\nStart of optional arguments.\n\":\"\nEnd of arguments. The remaining text is the function name.\n\";\"\nEnd of arguments. The remaining text is the error message.\nThe \"(items)\" unpacks values from a Python tuple.This can be a useful way to map\ntuples into simple C structures. For example, here is another possible implementation of\nthe py_distance() wrapper function:\nPyObject *py_distance(PyObject *self, PyObject *args) {\nPoint p1, p2;\ndouble result;\nif (!PyArg_ParseTuple(args,\"(dd)(dd)\",\n&p1.x, &p1.y, &p2.x, &p2.y)) {\nreturn NULL;\n}\nresult = distance(&p1,&p2);\nreturn Py_BuildValue(\"d\",result);\n}\nThe modifier \"|\" specifies that all remaining arguments are optional.This can appear\nonly once in a format specifier and cannot be nested.The modifier \":\" indicates the\nend of the arguments.Any text that follows is used as the function name in any error\nmessages.The modifier \";\" signals the end of the arguments.Any following text is used\nas the error message. Note that only one of : and ; should be used. Here are some\nexamples:\nPyArg_ParseTuple(args,\"ii:gcd\", &x, &y);\nPyArg_ParseTuple(args,\"ii; gcd requires 2 integers\", &x, &y);\n/* Parse with optional arguments */\nPyArg_ParseTuple(args,\"s|s\", &buffer, &delimiter);\nType Conversion from C to Python\nThe following C function is used to convert the values contained in C variables to a\nPython object:\nPyObject *Py_BuildValue(char *format, ...)\nThis constructs a Python object from a series of C variables. format is a string describ-\ning the desired conversion.The remaining arguments are the values of C variables to be\nconverted.\nThe format specifier is similar to that used with the PyArg_ParseTuple* func-\ntions, as shown in Table 26.4.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2059,
      "extraction_method": "Direct"
    },
    {
      "page_number": 628,
      "chapter": null,
      "content": "603\nExtension Modules\nTable 26.4\nFormat Specifiers for Py_BuildValue()\nFormat\nPython Type\nC Type\nDescription\n\"\"\nNone\nvoid\nNothing.\n\"s\"\nString\nchar *\nNull-terminated string. If the C\nstring pointer is NULL, None is\nreturned.\n\"s#\"\nString\nchar *, int\nString and length. May contain\nnull bytes. If the C string point-\ner is NULL, None is returned.\n\"y\"\nBytes\nchar *\nSame as \"s\" except a byte\nstring is returned.\n\"y#\"\nBytes\nchar *, int\nSame as \"s# except a byte\nstring is returned.\n\"z\"\nString or None\nchar *\nSame as \"s\".\n\"z#\"\nString or None\nchar *, int\nSame as \"s#\".\n\"u\"\nUnicode\nPy_UNICODE *\nNull-terminated Unicode string.\nIf the string pointer is NULL,\nNone is returned.\n\"u#\"\nUnicode\nPy_UNICODE *\nUnicode string and length.\n\"U\"\nUnicode\nchar *\nConverts a null-terminated C\nstring into a Unicode string.\n\"U#\"\nUnicode\nchar *, int\nConverts a C string into\nUnicode.\n\"b\"\nInteger\nchar\n8-bit integer.\n\"B\"\nInteger\nunsigned char\n8-bit unsigned integer.\n\"h\"\nInteger\nshort\nShort 16-bit integer.\n\"H\"\nInteger\nunsigned short\nUnsigned short 16-bit integer.\n\"i\"\nInteger\nint\nInteger.\n\"I\"\nInteger\nunsigned int\nUnsigned integer\n\"l\"\nInteger\nlong\nLong integer.\n\"L\"\nInteger\nunsigned long\nUnsigned long integer.\n\"k\"\nInteger\nlong long\nLong long.\n\"K\"\nInteger\nunsigned long long\nUnsigned long long.\n\"n\"\nInteger\nPy_ssize_t\nPython size type.\n\"c\"\nString\nchar\nSingle character. Creates a\nPython string of length 1.\n\"f\"\nFloat\nfloat\nSingle-precision floating point.\n\"d\"\nFloat\ndouble\nDouble-precision floating point.\n\"D\"\nComplex\nPy_complex\nComplex number.\n\"O\"\nAny\nPyObject *\nAny Python object. The object\nis unchanged except for its ref-\nerence count, which is incre-\nmented by 1. If a NULL pointer\nis given, a NULL pointer is\nreturned. This is useful if an\nerror has been signaled else-\nwhere and you want it to propa-\ngate.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1810,
      "extraction_method": "Direct"
    },
    {
      "page_number": 629,
      "chapter": null,
      "content": "604\nChapter 26 Extending and Embedding Python\nTable 26.4\nContinued\nFormat\nPython Type\nC Type\nDescription\n\"O&\"\nAny\nconverter, any\nC data processed through a\nconverter function.\n\"S\"\nString\nPyObject *\nSame as \"O\".\n\"N\"\nAny\nPyObject *\nSame as \"O\" except that the\nreference count is not incre-\nmented.\n\"(items)\" Tuple\nvars\nCreates a tuple of items.\nitems is a string of format\nspecifiers from this table.\nvars is a list of C variables\ncorresponding to the items in\nitems.\n\"[items]\" List\nvars\nCreates a list of items. items\nis a string of format specifiers.\nvars is a list of C variables\ncorresponding to the items in\nitems.\n\"{items}\" Dictionary\nvars\nCreates a dictionary of items.\nHere are some examples of building different kinds of values:\nPy_BuildValue(\"\")                          None\nPy_BuildValue(\"i\",37)                      37\nPy_BuildValue(\"ids\",37,3.4,\"hello\")        (37, 3.5, \"hello\")\nPy_BuildValue(\"s#\",\"hello\",4)              \"hell\"\nPy_BuildValue(\"()\")                        ()\nPy_BuildValue(\"(i)\",37)                    (37,)\nPy_BuildValue(\"[ii]\",1,2)                  [1,2]\nPy_BuildValue(\"[i,i]\",1,2)                 [1,2]\nPy_BuildValue(\"{s:i,s:i}\",\"x\",1,\"y\",2)     {'x':1, 'y':2}\nFor Unicode string conversions involving char *, it is assumed that the data consists of\na series of bytes encoded using the default Unicode encoding (usually UTF-8).The data\nwill be automatically decoded into a Unicode string when passed to Python.The only\nexceptions are the \"y\" and \"y#\" conversions that return a raw byte string.\nAdding Values to a Module\nIn the module initialization function of an extension module, it is common to add con-\nstants and other support values.The following functions can be used to do this:\nint PyModule_AddObject(PyObject *module, const char *name, PyObject *value)\nAdds a new value to a module. name is the name of the value, and value is a Python\nobject containing the value.You can build this value using Py_BuildValue().\nint PyModule_AddIntConstant(PyObject *module, const char *name, long value)\nAdds an integer value to a module.\nvoid PyModule_AddStringConstant(PyObject *module, const char *name, const char\n*value)\nAdds a string value to a module. value must be a null-terminated string.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2248,
      "extraction_method": "Direct"
    },
    {
      "page_number": 630,
      "chapter": null,
      "content": "605\nExtension Modules\nvoid PyModule_AddIntMacro(PyObject *module, macro)\nAdds a macro value to a module as an integer. macro must be the name of preprocessor\nmacro.\nvoid PyModule_AddStringMacro(PyObject *module, macro)\nAdds a macro value to a module as a string.\nError Handling\nExtension modules indicate errors by returning NULL to the interpreter. Prior to return-\ning NULL, an exception should be set using one of the following functions:\nvoid PyErr_NoMemory()\nRaises a MemoryError exception.\nvoid PyErr_SetFromErrno(PyObject *exc)\nRaises an exception. exc is an exception object.The value of the exception is taken\nfrom the errno variable in the C library.\nvoid PyErr_SetFromErrnoWithFilename(PyObject *exc, char *filename)\nLike PyErr_SetFromErrno(), but includes the file name in the exception value as\nwell.\nvoid PyErr_SetObject(PyObject *exc, PyObject *val)\nRaises an exception. exc is an exception object, and val is an object containing the\nvalue of the exception.\nvoid PyErr_SetString(PyObject *exc, char *msg)\nRaises an exception. exc is an exception object, and msg is a message describing what\nwent wrong.\nThe exc argument in these functions can be set to one of the following:\nC Name\nPython Exception\nPyExc_ArithmeticError\nArithmeticError\nPyExc_AssertionError\nAssertionError\nPyExc_AttributeError\nAttributeError\nPyExc_EnvironmentError\nEnvironmentError\nPyExc_EOFError\nEOFError\nPyExc_Exception\nException\nPyExc_FloatingPointError\nFloatingPointError\nPyExc_ImportError\nImportError\nPyExc_IndexError\nIndexError\nPyExc_IOError\nIOError\nPyExc_KeyError\nKeyError\nPyExc_KeyboardInterrupt\nKeyboardInterrupt\nPyExc_LookupError\nLookupError\nPyExc_MemoryError\nMemoryError\nPyExc_NameError\nNameError\nPyExc_NotImplementedError\nNotImplementedError\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1759,
      "extraction_method": "Direct"
    },
    {
      "page_number": 631,
      "chapter": null,
      "content": "606\nChapter 26 Extending and Embedding Python\nC Name\nPython Exception\nPyExc_OSError\nOSError\nPyExc_OverflowError\nOverflowError\nPyExc_ReferenceError\nReferenceError\nPyExc_RuntimeError\nRuntimeError\nPyExc_StandardError\nStandardError\nPyExc_StopIteration\nStopIteration\nPyExc_SyntaxError\nSyntaxError\nPyExc_SystemError\nSystemError\nPyExc_SystemExit\nSystemExit\nPyExc_TypeError\nTypeError\nPyExc_UnicodeError\nUnicodeError\nPyExc_UnicodeEncodeError\nUnicodeEncodeError\nPyExc_UnicodeDecodeError\nUnicodeDecodeError\nPyExc_UnicodeTranslateError\nUnicodeTranslateError\nPyExc_ValueError\nValueError\nPyExc_WindowsError\nWindowsError\nPyExc_ZeroDivisionError\nZeroDivisionError\nThe following functions are used to query or clear the exception status of the \ninterpreter:\nvoid PyErr_Clear()\nClears any previously raised exceptions.\nPyObject *PyErr_Occurred()\nChecks to see whether or not an exception has been raised. If so, the current exception\nvalue is returned. Otherwise, NULL is returned.\nint PyErr_ExceptionMatches(PyObject *exc)\nChecks to see if the current exception matches the exception exc. Returns 1 if true, 0\notherwise.This function follows the same exception matching rules as in Python code.\nTherefore, exc could be a superclass of the current exception or a tuple of exception\nclasses.\nThe following prototype shows how to implement a try-except block in C:\n/* Carry out some operation involving Python objects */\nif (PyErr_Occurred()) {\nif (PyErr_ExceptionMatches(PyExc_ValueError)) {\n/* Take some kind of recovery action */\n...\nPyErr_Clear();\nreturn result;  /* A valid PyObject * */\n} else {\nreturn NULL;    /* Propagate the exception to the interpreter */\n}\n}\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1673,
      "extraction_method": "Direct"
    },
    {
      "page_number": 632,
      "chapter": null,
      "content": "607\nExtension Modules\nReference Counting\nUnlike programs written in Python, C extensions may have to manipulate the reference\ncount of Python objects.This is done using the following macros, all of which are\napplied to objects of type PyObject *.\nMacro\nDescription\nPy_INCREF(obj)\nIncrements the reference count of obj, which must be non-null.\nPy_DECREF(obj)\nDecrements the reference count of obj, which must be non-null.\nPy_XINCREF(obj) Increments the reference count of obj, which may be null.\nPy_XDECREF(obj) Decrements the reference count of obj, which may be null.\nManipulating the reference count of Python objects in C is a delicate topic, and readers\nare strongly advised to consult the “Extending and Embedding the Python Interpreter”\ndocument available at http://docs.python.org/extending before proceeding any further.\nAs a general rule, it is not necessary to worry about reference counting in C extension\nfunctions except in the following cases:\nn If you save a reference to a Python object for later use or in a C structure, you\nmust increase the reference count.\nn Similarly, to dispose of an object that was previously saved, decrease its reference\ncount.\nn If you are manipulating Python containers (lists, dicts, and so on) from C, you\nmay have to manually manipulate reference counts of the individual items. For\nexample, high-level operations that get or set items in a container typically\nincrease the reference count.\nYou will know that you have a reference counting problem if your extension code\ncrashes the interpreter (you forgot to increase the reference count) or the interpreter\nleaks memory as your extension functions are used (you forgot to decrease a reference\ncount).\nThreads\nA global interpreter lock is used to prevent more than one thread from executing in the\ninterpreter at once. If a function written in an extension module executes for a long\ntime, it will block the execution of other threads until it completes.This is because the\nlock is held whenever an extension function is invoked. If the extension module is\nthread-safe, the following macros can be used to release and reacquire the global inter-\npreter lock:\nPy_BEGIN_ALLOW_THREADS\nReleases the global interpreter lock and allows other threads to run in the interpreter.\nThe C extension must not invoke any functions in the Python C API while the lock is\nreleased.\nPy_END_ALLOW_THREADS\nReacquires the global interpreter lock.The extension will block until the lock can be\nacquired successfully in this case.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2529,
      "extraction_method": "Direct"
    },
    {
      "page_number": 633,
      "chapter": null,
      "content": "608\nChapter 26 Extending and Embedding Python\nThe following example illustrates the use of these macros:\nPyObject *py_wrapper(PyObject *self, PyObject *args) {\n...\nPyArg_ParseTuple(args, ...)\nPy_BEGIN_ALLOW_THREADS\nresult = run_long_calculation(args);\nPy_END_ALLOW_THREADS\n...\nreturn Py_BuildValue(fmt,result);\n}\nEmbedding the Python Interpreter\nThe Python interpreter can also be embedded into C applications.With embedding, the\nPython interpreter operates as a programming library where C programs can initialize\nthe interpreter, have the interpreter run scripts and code fragments, load library mod-\nules, and manipulate functions and objects implemented in Python.\nAn Embedding Template\nWith embedding, your C program is in charge of the interpreter. Here is a simple C\nprogram that illustrates the most minimal embedding possible:\n#include <Python.h>\nint main(int argc, char **argv) {\nPy_Initialize();\nPyRun_SimpleString(\"print('Hello World')\");\nPy_Finalize();\nreturn 0;\n}\nIn this example, the interpreter is initialized, a short script is executed as a string, and\nthe interpreter is shut down. Before proceeding any further, it is usually a good idea to\nget the prior example working first.\nCompilation and Linking\nTo compile an embedded interpreter on UNIX, your code must include the\n\"Python.h\" header file and link against the interpreter library such as\nlibpython2.6.a.The header file is typically found in\n/usr/local/include/python2.6, and the library is typically found in\n/usr/local/lib/python2.6/config. For Windows, you will need to locate these\nfiles in the Python installation directory. Be aware that the interpreter may depend on\nother libraries you need to include when linking. Unfortunately, this tends to be \nplatform-specific and related to how Python was configured on your machine—you\nmay have to fiddle around for a bit.\nBasic Interpreter Operation and Setup\nThe following functions are used to set up the interpreter and to run scripts:\nint PyRun_AnyFile(FILE *fp, char *filename)\nIf fp is an interactive device such as tty in UNIX, this function calls \nPyRun_InteractiveLoop(). Otherwise, PyRun_SimpleFile() is called. filename is\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2183,
      "extraction_method": "Direct"
    },
    {
      "page_number": 634,
      "chapter": null,
      "content": "609\nEmbedding the Python Interpreter\na string that gives a name for the input stream.This name will appear when the inter-\npreter reports errors. If filename is NULL, a default string of \"???\" is used as the file\nname.\nint PyRun_SimpleFile(FILE *fp, char *filename)\nSimilar to PyRun_SimpleString(), except that the program is read from the file fp.\nint PyRun_SimpleString(char *command)\nExecutes  command in the _ _main_ _ module of the interpreter. Returns 0 on success,\n-1 if an exception occurred.\nint PyRun_InteractiveOne(FILE *fp, char *filename)\nExecutes a single interactive command.\nint PyRun_InterativeLoop(FILE *fp, char *filename)\nRuns the interpreter in interactive mode.\nvoid Py_Initialize()\nInitializes the Python interpreter.This function should be called before using any other\nfunctions in the C API, with the exception of Py_SetProgramName(),\nPyEval_InitThreads(), PyEval_ReleaseLock(), and PyEval_AcquireLock().\nint Py_IsInitialized()\nReturns 1 if the interpreter has been initialized, 0 if not.\nvoid Py_Finalize()\nCleans up the interpreter by destroying all the sub-interpreters and objects that were\ncreated since calling Py_Initialize(). Normally, this function frees all the memory\nallocated by the interpreter. However, circular references and extension modules may\nintroduce memory leaks that cannot be recovered by this function.\nvoid Py_SetProgramName(char *name)\nSets the program name that’s normally found in the argv[0] argument of the sys\nmodule.This function should only be called before Py_Initialize().\nchar *Py_GetPrefix()\nReturns the prefix for installed platform-independent files.This is the same value as\nfound in sys.prefix.\nchar *Py_GetExecPrefix()\nReturns the exec-prefix for installed platform-dependent files.This is the same value\nas found in sys.exec_prefix.\nchar *Py_GetProgramFullPath()\nReturns the full path name of the Python executable.\nchar *Py_GetPath()\nReturns the default module search path.The path is returned as a string consisting of\ndirectory names separated by a platform-dependent delimiters (: on UNIX, ; on\nDOS/Windows).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2107,
      "extraction_method": "Direct"
    },
    {
      "page_number": 635,
      "chapter": null,
      "content": "610\nChapter 26 Extending and Embedding Python\nint PySys_SetArgv(int argc, char **argv)\nSets command-line options used to populate the value of sys.argv.This should only\nbe called before Py_Initialize().\nAccessing Python from C\nAlthough there are many ways that the interpreter can be accessed from C, four essen-\ntial tasks are the most common with embedding:\nn Importing Python library modules (emulating the import statement)\nn Getting references to objects defined in modules\nn Calling Python functions, classes, and methods\nn Accessing the attributes of objects (data, methods, and so on)\nAll of these operations can be carried out using these basic operations defined in the\nPython C API:\nPyObject *PyImport_ImportModule(const char *modname)\nImports a module modname and returns a reference to the associated module object.\nPyObject *PyObject_GetAttrString(PyObject *obj, const char *name)\nGets an attribute from an object.This is the same as obj.name.\nint PyObject_SetAttrString(PyObject *obj, const char *name, PyObject *value)\nSets an attribute on an object.This is the same as obj.name = value.\nPyObject *PyEval_CallObject(PyObject *func, PyObject *args)\nCalls func with arguments args. func is a Python callable object (function, method,\nclass, and so on). args is a tuple of arguments.\nPyObject *\nPyEval_CallObjectWithKeywords(PyObject *func, PyObject *args, PyObject *kwargs)\nCalls func with positional arguments args and keyword arguments kwargs. func is a\ncallable object, args is a tuple, and kwargs is a dictionary.\nThe following example illustrates the use of these functions by calling and using var-\nious parts of the re module from C.This program prints out all of the lines read from\nstdin that contain a Python regular expression supplied by the user.\n#include \"Python.h\"\nint main(int argc, char **argv) {\nPyObject *re;\nPyObject *re_compile;\nPyObject *pat;\nPyObject *pat_search;\nPyObject *args;\nchar      buffer[256];\nif (argc != 2) {\nfprintf(stderr,\"Usage: %s pattern\\n\",argv[0]);\nexit(1);\n}\nPy_Initialize();\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2054,
      "extraction_method": "Direct"
    },
    {
      "page_number": 636,
      "chapter": null,
      "content": "611\nEmbedding the Python Interpreter\n/* import re */\nre   = PyImport_ImportModule(\"re\");\n/* pat = re.compile(pat,flags) */\nre_compile = PyObject_GetAttrString(re,\"compile\");\nargs = Py_BuildValue(\"(s)\", argv[1]);\npat = PyEval_CallObject(re_compile, args);\nPy_DECREF(args);\n/* pat_search = pat.search  - bound method*/\npat_search = PyObject_GetAttrString(pat,\"search\");\n/* Read lines and perform matches */\nwhile (fgets(buffer,255,stdin)) {\nPyObject *match;\nargs = Py_BuildValue(\"(s)\", buffer);\n/* match = pat.search(buffer) */\nmatch = PyEval_CallObject(pat_search,args);\nPy_DECREF(args);\nif (match != Py_None) {\nprintf(\"%s\",buffer);\n}\nPy_XDECREF(match);\n}\nPy_DECREF(pat);\nPy_DECREF(re_compile);\nPy_DECREF(re);\nPy_Finalize();\nreturn 0;\n}\nIn any embedding code, it is critically important to properly manage reference counts.\nIn particular, you will need to decrease the reference count on any objects created from\nC or returned to C as a result of evaluating functions.\nConverting Python Objects to C\nA major problem with embedded use of the interpreter is converting the result of a\nPython function or method call into a suitable C representation.As a general rule, you\nneed to know in advance exactly what kind of data an operation is going to return.\nSadly, there is no high-level convenience function like PyArg_ParseTuple() for con-\nverting a single object value. However, the following lists some low-level conversion\nfunctions that will convert a few primitive Python data types into an appropriate C rep-\nresentation as long as you know exactly what kind of Python object you are working\nwith:\nPython-to-C Conversion Functions\nlong    PyInt_AsLong(PyObject *)\nlong    PyLong_AsLong(PyObject *)\ndouble PyFloat_AsDouble(PyObject *)\nchar  *PyString_AsString(PyObject *) (Python 2 only)\nchar  *PyBytes_AsString(PyObject *) (Python 3 only)\nFor any types more complicated than this, you will need to consult the C API docu-\nmentation (http://docs.python.org/c-api).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1988,
      "extraction_method": "Direct"
    },
    {
      "page_number": 637,
      "chapter": null,
      "content": "612\nChapter 26 Extending and Embedding Python\nctypes\nThe ctypes module provides Python with access to C functions defined in DLLs and\nshared libraries.Although you need to know some details about the underlying C\nlibrary (names, calling arguments, types, and so on), you can use ctypes to access C\ncode without having to write C extension wrapper code or compile anything with a C\ncompiler. ctypes is a sizable library module with a lot of advanced functionality. Here,\nwe cover the essential parts of it that are needed to get going.\nLoading Shared Libraries\nThe following classes are used to load a C shared library and return an instance repre-\nsenting its contents:\nCDLL(name [, mode [, handle [, use_errno [, use_last_error]]]])\nA class representing a standard C shared library. name is the name of the library such as\n'libc.so.6' or 'msvcrt.dll'. mode provides flags that determine how the library is\nloaded and are passed to the underlying dlopen() function on UNIX. It can be set to\nthe bitwise-or of RTLD_LOCAL, RTLD_GLOBAL, or RTLD_DEFAULT (the default). On\nWindows, mode is ignored. handle specifies a handle to an already loaded library (if\navailable). By default, it is None. use_errno is a Boolean flag that adds an extra layer of\nsafety around the handling of the C errno variable in the loaded library.This layer saves\na thread-local copy of errno prior to calling any foreign function and restores the value\nafterwards. By default, use_errno is False. use_last_error is a Boolean flag that\nenables a pair of functions get_last_error() and set_last_error() that can be\nused to manipulate the system error code.These are more commonly used on\nWindows. By default, use_last_error is False.\nWinDLL(name [, mode [, handle [, use_errno [, use_last_error]]]])\nThe same as CDLL() except that the functions in the library are assumed to follow the\nWindows stdcall calling conventions (Windows).\nThe following utility function can be used to locate shared libraries on the system\nand construct a name suitable for use as the name parameter in the previous classes. It is\ndefined in the ctypes.util submodule:\nfind_library(name)\nDefined in ctypes.util. Returns a path name corresponding to the library name.\nname is a library name without any file suffix such as 'libc', 'libm', and so on The\nstring returned by the function is a full path name such as '/usr/lib/libc.so.6'.\nThe behavior of this function is highly system-dependent and depends on the under-\nlying configuration of shared libraries and environment (for example, the setting of\nLD_LIBRARY_PATH and other parameters). Returns None if the library can’t be located.\nForeign Functions\nThe shared library instances created by the CDLL() class operates as a proxy to the\nunderlying C library.To access library contents, you just use attribute lookup (the oper-\nator). For example:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2868,
      "extraction_method": "Direct"
    },
    {
      "page_number": 638,
      "chapter": null,
      "content": "613\nEmbedding the Python Interpreter\n>>> import ctypes\n>>> libc = ctypes.CDLL(\"/usr/lib/libc.dylib\")\n>>> libc.rand()\n16807\n>>> libc.atoi(\"12345\")\n12345\n>>>\nIn this example, operations such as libc.rand() and libc.atoi() are directly calling\nfunctions in the loaded C library.\nctypes assumes that all functions accept parameters of type int or char * and\nreturn results of type int.Thus, even though the previous function calls “worked,” calls\nto other C library functions do not work as expected. For example:\n>>> libc.atof(\"34.5\")\n-1073746168\n>>>\nTo address this problem, the type signature and handling of any foreign function func\ncan be set by changing the following attributes:\nfunc.argtypes\nA tuple of ctypes datatypes (described here) describing the input arguments to func.\nfunc.restype\nA ctypes datatype describing the return value of func. None is used for functions\nreturning void.\nfunc.errcheck\nA Python callable object taking three parameters (result, func, args) where\nresult is the value returned by a foreign function, func is a reference to the foreign\nfunction itself, and args is a tuple of the input arguments.This function is called after a\nforeign function call and can be used to perform error checking and other actions.\nHere is an example of fixing the atof() function interface, as shown in the previous\nexample:\n>>> libc.atof.restype=ctypes.c_double\n>>> libc.atof(\"34.5\")\n34.5\n>>>\nThe ctypes.d_double is a reference to a predefined datatype.The next section\ndescribes these datatypes.\nDatatypes\nTable 26.5 shows the ctypes datatypes that can be used in the argtypes and restype\nattributes of foreign functions.The “Python Value” column describes the type of Python\ndata that is accepted for the given data type.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1761,
      "extraction_method": "Direct"
    },
    {
      "page_number": 639,
      "chapter": null,
      "content": "614\nChapter 26 Extending and Embedding Python\nTable 26.5\nctypes Datatypes\nctypes Type Name\nC Datatype\nPython Value\nc_bool\nbool\nTrue or False\nc_bytes\nsigned char\nSmall integer\nc_char\nchar\nSingle character\nc_char_p\nchar *\nNull-terminated string or bytes\nc_double\ndouble\nFloating point \nc_longdouble\nlong double\nFloating point\nc_float\nfloat\nFloating point\nc_int\nint\nInteger\nc_int8\nsigned char\n8-bit integer\nc_int16\nshort\n16-bit integer\nc_int32\nint\n32-bit integer\nc_int64\nlong long\n64-bit integer\nc_long\nlong\nInteger\nc_longlong\nlong long\nInteger\nc_short\nshort\nInteger\nc_size_t\nsize_t\nInteger\nc_ubyte\nunsigned char\nUnsigned integer\nc_uint\nunsigned int\nUnsigned integer\nc_uint8\nunsigned char\n8-bit unsigned integer\nc_uint16\nunsigned short\n16-bit unsigned integer\nc_uint32\nunsigned int\n32-bit unsigned integer\nc_uint64\nunsigned long long\n64-bit unsigned integer\nc_ulong\nunsigned long\nUnsigned integer\nc_ulonglong\nunsigned long long\nUnsigned integer\nc_ushort\nunsigned short\nUnsigned integer\nc_void_p\nvoid *\nInteger\nc_wchar\nwchar_t\nSingle Unicode character\nc_wchar_p\nwchar_t *\nNull-terminated Unicode\nTo create a type representing a C pointer, apply the following function to one of the\nother types:\nPOINTER(type)\nDefines a type that is a pointer to type type. For example, POINTER(c_int) represents\nthe C type int *.\nTo define a type representing a fixed-size C array, multiply an existing type by the\nnumber of array dimensions. For example, c_int*4 represents the C datatype int[4].\nTo define a type representing a C structure or union, you inherit from one of the\nbase classes Structure or Union.Within each derived class, you define a class variable\n_fields_ that describes the contents. _fields_ is a list of 2 or 3 tuples of the form\n(name, ctype) or (name, ctype, width), where name is an identifier for the \nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1830,
      "extraction_method": "Direct"
    },
    {
      "page_number": 640,
      "chapter": null,
      "content": "615\nEmbedding the Python Interpreter\nstructure field, ctype is a ctype class describing the type, and width is an integer bit-\nfield width. For example, consider the following C structure:\nstruct Point {\ndouble x, y;\n};\nThe ctypes description of this structure is\nclass Point(Structure):\n_fields_ = [ (\"x\", c_double),\n(\"y\", c_double) ]\nCalling Foreign Functions\nTo call functions in a library, you simply call the appropriate function with a set of\narguments that are compatible with its type signature. For simple datatypes such as\nc_int, c_double, and so forth, you can just pass compatible Python types as input\n(integers, floats, and so on). It is also possible to pass instances of c_int, c_double and\nsimilar types as input. For arrays, you can just pass a Python sequence of compatible\ntypes.\nTo pass a pointer to a foreign function, you must first create a ctypes instance that\nrepresents the value that will be pointed at and then create a pointer object using one\nof the following functions:\nbyref(cvalue [, offset])\nRepresents a lightweight pointer to cvalue. cvalue must be an instance of a ctypes\ndatatype. offset is a byte offset to add to the pointer value.The value returned by the\nfunction can only be used in function calls.\npointer(cvalue)\nCreates a pointer instance pointing to cvalue. cvalue must be an instance of a ctypes\ndatatype.This creates an instance of the POINTER type described earlier.\nHere is an example showing how you would pass a parameter of type double *\ninto a C function:\ndval = c_double(0.0)          # Create a double instance\nr = foo(byref(dval))          # Calls foo(&dval)\np_dval = pointer(dval)        # Creates a pointer variable\nr = foo(p_dval)               # Calls foo(p_dval)\n# Inspect the value of dval afterwards\nprint (dval.value)\nIt should be noted that you cannot create pointers to built-in types such as int or\nfloat. Passing pointers to such types would violate mutability if the underlying C\nfunction changed the value.\nThe cobj.value attribute of a ctypes instance cobj contains the internal data. For\nexample, the reference to dval.value in the previous code returns the floating-point\nvalue stored inside the ctypes c_double instance dval.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2225,
      "extraction_method": "Direct"
    },
    {
      "page_number": 641,
      "chapter": null,
      "content": "616\nChapter 26 Extending and Embedding Python\nTo pass a structure to a C function, you must create an instance of the structure or\nunion.To do this, you call a previous defined structure or union type StructureType\nas follows:\nStructureType(*args, **kwargs)\nCreates an instance of StructureType where StructureType is a class derived from\nStructure or Union. Positional arguments in *args are used to initialize the structure\nmembers in the same order as they are listed in _fields_. Keyword arguments in\n**kwargs initialize just the named structure members.\nAlternative Type Construction Methods\nAll instances of ctypes types such as c_int, POINTER, and so forth have some class\nmethods that are used to create instances of ctypes types from memory locations and\nother objects.\nty.from_buffer(source [,offset])\nCreates an instance of ctypes type ty that shares the same memory buffer as source.\nsource must be any other object that supports the writable buffer interface (e.g.,\nbytearray, array objects in the array module, mmap, and so on). offset is the num-\nber of bytes from the start of the buffer to use.\nty.from_buffer_copy(source [, offset])\nThe same as ty.from_buffer() except that a copy of the memory is made and that\nsource can be read-only.\nty.from_address(address)\nCreates an instance of ctypes type ty from a raw memory address address specified as\nan integer.\nty.from_param(obj)\nCreates an instance of ctypes type ty from a Python object obj.This only works if the\npassed object obj can be adapted into the appropriate type. For example, a Python inte-\nger can be adapted into a c_int instance.\nty.in_dll(library, name)\nCreates an instance of ctypes type ty from a symbol in a shared library. library is an\ninstance of the loaded library such as the object created by the CDLL class. name is the\nname of a symbol.This method can be used to put a ctypes wrapper around global vari-\nables defined in a library.\nThe following example shows how you might create a reference to a global variable\nint status defined in a library libexample.so.\nlibexample = ctypes.CDLL(\"libexample.so\")\nstatus = ctypes.c_int.in_dll(libexample,\"status\")\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2169,
      "extraction_method": "Direct"
    },
    {
      "page_number": 642,
      "chapter": null,
      "content": "617\nEmbedding the Python Interpreter\nUtility Functions\nThe following utility functions are defined by ctypes:\naddressof(cobj)\nReturns the memory address of cobj as an integer. cobj must be an instance of a\nctypes type.\nalignment(ctype_or_obj)\nReturns the integer alignment requirements of a ctypes type or object. ctype_or_obj\nmust be a ctypes type or an instance of a type.\ncast(cobj, ctype)\nCasts a ctypes object cobj to a new type given in ctype.This only works for pointers,\nso cobj must be a pointer or array and ctype must be a pointer type.\ncreate_string_buffer(init [, size])\nCreates a mutable character buffer as a ctypes array of type c_char. init is either an\ninteger size or a string representing the initial contents. size is an optional parameter\nthat specifies the size to use if init is a string. By default, the size is set to be one\ngreater than the number of characters in init. Unicode strings are encoded into bytes\nusing the default encoding.\ncreate_unicode_buffer(init [, size])\nThe same as create_string_buffer(), except that a ctypes array of type c_wchar is\ncreated.\nget_errno()\nReturns the current value of the ctypes private copy of errno.\nget_last_error()\nReturns the current value of the ctypes private copy of LastError on Windows.\nmemmove(dst, src, count)\nCopies count bytes from src to dst. src and dst are either integers representing\nmemory addresses or instances of ctypes types that can be converted to pointers.The\nsame as the C memmove() library function.\nmemset(dst, c, count)\nSets count bytes of memory starting at dst to the byte value c. dst is either an integer\nor a ctypes instance. c is an integer representing a byte in the range 0-255.\nresize(cobj, size)\nResizes the internal memory used to represent ctypes object cobj. size is the new size\nin bytes.\nset_conversion_mode(encoding, errors)\nSets the Unicode encoding used when converting from Unicode strings to 8-bit strings.\nencoding is the encoding name such as 'utf-8', and errors is the error-handling\npolicy such as 'strict' or 'ignore'. Returns a tuple (encoding, errors) with\nthe previous setting.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2125,
      "extraction_method": "Direct"
    },
    {
      "page_number": 643,
      "chapter": null,
      "content": "618\nChapter 26 Extending and Embedding Python\nset_errno(value)\nSets the ctypes-private copy of the system errno variable. Returns the previous value.\nset_last_error(value)\nSets the Windows LastError variable and returns the previous value.\nsizeof(type_or_cobj)\nReturns the size of a ctypes type or object in bytes.\nstring_at(address [, size])\nReturns a byte string representing size bytes of memory starting at address address. If\nsize is omitted, it is assumed that the byte string is NULL-terminated.\nwstring_at(address [, size])\nReturns a Unicode string representing size wide characters starting at address\naddress. If size is omitted, the character string is assumed to be NULL-terminated.\nExample\nThe following example illustrates the use of the ctypes module by building an inter-\nface to the set of C functions used in the very first part of this chapter that covered the\ndetails of creating Python extension modules by hand.\n# example.py\nimport ctypes\n_example = ctypes.CDLL(\"./libexample.so\")\n# int gcd(int, int) \ngcd = _example.gcd\ngcd.argtypes = (ctypes.c_int, \nctypes.c_int)\ngcd.restype = ctypes.c_int\n# int replace(char *s, char olcdh, char newch)\n_example.replace.argtypes = (ctypes.c_char_p,\nctypes.c_char,\nctypes.c_char)\n_example.replace.restype = ctypes.c_int\ndef replace(s, oldch, newch):\nsbuffer = ctypes.create_string_buffer(s)\nnrep = _example.replace(sbuffer,oldch,newch)\nreturn (nrep,sbuffer.value)\n# double distance(Point *p1, Point *p2) \nclass Point(ctypes.Structure):\n_fields_ = [ (\"x\", ctypes.c_double),\n(\"y\", ctypes.c_double) ]\n_example.distance.argtypes = (ctypes.POINTER(Point), \nctypes.POINTER(Point))\n_example.distance.restype = ctypes.c_double\ndef distance(a,b):\np1 = Point(*a)\np2 = Point(*b)\nreturn _example.distance(byref(p1),byref(p2))\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1794,
      "extraction_method": "Direct"
    },
    {
      "page_number": 644,
      "chapter": null,
      "content": "619\nAdvanced Extending and Embedding\nAs a general note, usage of ctypes is always going to involve a Python wrapper layer of\nvarying complexity. For example, it may be the case that you can call a C function\ndirectly. However, you may also have to implement a small wrapping layer to account for\ncertain aspects of the underlying C code. In this example, the replace() function is\ntaking extra steps to account for the fact that the C library mutates the input buffer.The\ndistance() function is performing extra steps to create Point instances from tuples\nand to pass pointers.\nNote\nThe ctypes module has a large number of advanced features not covered here. For\nexample, the library can access many different kinds of libraries on Windows, and there\nis support for callback functions, incomplete types, and other details. The online docu-\nmentation is filled with many examples so that should be a starting point for further use.\nAdvanced Extending and Embedding\nCreating handwritten extension modules or using ctypes is usually straightforward if you\nare extending Python with simple C code. However, for anything more complex, it can\nquickly become tedious. For this, you will want to look for a suitable extension building\ntool.These tools either automate much of the extension building process or provide a pro-\ngramming interface that operates at a much higher level. Links to a variety of such tools\ncan be found at http://wiki.python.org/moin/IntegratingPythonWithOtherLanguages.\nHowever, a short example with SWIG (http://www.swig.org) will be shown just to illus-\ntrate. In the interest of full disclosure, it should be noted that SWIG was originally created\nby the author.\nWith automated tools, you usually just describe the contents of an extension module\nat a high level. For example, with SWIG, you write a short interface specification that\nlooks like this:\n/* example.i : Sample Swig specification */\n%module example\n%{\n/* Preamble. Include all required header files here */\n#include \"example.h\"\n%}\n/* Module contents.  List all C declarations here */\ntypedef struct Point {\ndouble x;\ndouble y;\n} Point;\nextern int    gcd(int, int);\nextern int    replace(char *s, char oldch, char newch);\nextern double distance(Point *a, Point *b);\nUsing this specification, SWIG automatically generates everything needed to make a\nPython extension module.To run SWIG, you just invoke it like a compiler:\n% swig –python example.i\n%\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2454,
      "extraction_method": "Direct"
    },
    {
      "page_number": 645,
      "chapter": null,
      "content": "620\nChapter 26 Extending and Embedding Python\nAs output, it generates a set of .c and .py files. However, you often don’t have to\nworry much about this. If you are using distutils and include a .i file in the setup\nspecification, it will run SWIG automatically for you when building an extension. For\nexample, this setup.py file automatically runs SWIG on the listed example.i file.\n# setup.py\nfrom distutils.core import setup, Extension\nsetup(name=\"example\",\nversion=\"1.0\",\npy_modules = ['example.py'],\next_modules = [\nExtension(\"_example\",\n[\"example.i\",\"example.c\"])\n]\n)\nIt turns out that this example.i file and the setup.py file are all that are needed to\nhave a working extension module in this example. If you type python setup.py\nbuild_ext --inplace, you will find that you have a fully working extension in your\ndirectory.\nJython and IronPython\nExtending and embedding is not restricted to C programs. If you are working with Java,\nconsider the use of Jython (http://www.jython.org), a complete reimplementation of\nthe Python interpreter in Java.With jython, you can simply import Java libraries using\nthe import statement. For example:\nbash-3.2$ jython\nJython 2.2.1 on java1.5.0_16\nType \"copyright\", \"credits\" or \"license\" for more information.\n>>> from java.lang import System\n>>> System.out.println(\"Hello World\")\nHello World\n>>>\nIf you are working with the .NET framework on Windows, consider the use of\nIronPython (http://www.codeplex.com/Wiki/View.aspx?ProjectName=IronPython), a\ncomplete reimplementation of the Python interpreter in C#.With IronPython, you can\neasily access all of the .NET libraries from Python in a similar manner. For example:\n% ipy\nIronPython 1.1.2 (1.1.2) on .NET 2.0.50727.42\nCopyright (c) Microsoft Corporation. All rights reserved.\n>>> import System.Math\n>>> dir(System.Math)\n['Abs', 'Acos', 'Asin', 'Atan', 'Atan2', 'BigMul', 'Ceiling', 'Cos', 'Cosh', ...]\n>>> System.Math.Cos(3)\n-0.9899924966\n>>>\nCovering jython and IronPython in more detail is beyond the scope of this book.\nHowever, just keep in mind that they’re both Python—the most major differences are\nin their libraries.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2145,
      "extraction_method": "Direct"
    },
    {
      "page_number": 646,
      "chapter": null,
      "content": "Appendix\nPython 3\nIn December 2008, Python 3.0 was released—a major update to the Python language\nthat breaks backwards compatibility with Python 2 in a number of critical areas.A fairly\ncomplete survey of the changes made to Python 3 can be found in the “What’s New in\nPython 3.0” document available at http://docs.python.org/3.0/whatsnew/3.0.html. In\nsome sense, the first 26 chapters of this book can be viewed as the polar opposite of the\n“What’s New” document.That is, all of the material covered so far has focused on fea-\ntures that are shared by both Python 2 and Python 3.This includes all of the standard\nlibrary modules, major language features, and examples.Aside from a few minor naming\ndifferences and the fact that print() is a function, no unique Python 3 features have\nbeen described.\nThe main focus of this appendix is to describe new features to the Python language\nthat are only available in version 3 as well as some important differences to keep in\nmind if you are going to migrate existing code.At the end of this appendix, some port-\ning strategies and use of the 2to3 code conversion tool is described.\nWho Should Be Using Python 3?\nBefore going any further, it is important to address the question of who should be using\nthe Python 3.0 release.Within the Python community, it has always been known that\nthe transition to Python 3 would not happen overnight and that the Python 2 branch\nwould continue to be maintained for some time (years) into the future. So, as of this\nwriting, there is no urgent need to drop Python 2 code. I suspect that huge amounts of\nPython 2 code will continue to be in development when the 5th edition of this book is\nwritten years from now.\nA major problem facing Python 3.0 concerns the compatibility of third-party\nlibraries. Much of Python’s power comes from its large variety of frameworks and\nlibraries. However, unless these libraries are explicitly ported to Python 3, they are\nalmost certain not to work.This problem is amplified by the fact that many libraries\ndepend upon other libraries that depend on yet more libraries.As of this writing\n(2009), there are major libraries and frameworks for Python that haven’t even been\nported to Python 2.4, let alone 2.6 or 3.0. So, if you are using Python with the inten-\ntion of running third-party code, you are better off sticking with Python 2 for now. If\nyou’ve picked up this book and it’s the year 2012, then hopefully the situation will have\nimproved.\nAlthough Python 3 cleans up a lot of minor warts in the language, it is unclear if\nPython 3 is currently a wise choice for new users just trying to learn the basics.Almost\nall existing documentation, tutorials, cookbooks, and examples assume Python 2 and use\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2745,
      "extraction_method": "Direct"
    },
    {
      "page_number": 647,
      "chapter": null,
      "content": "622\nAppendix Python 3\ncoding conventions that are incompatible. Needless to say, someone is not going to have\na positive learning experience if everything appears to be broken. Even the official doc-\numentation is not entirely up-to-date with Python 3 coding requirements; while writ-\ning this book, the author submitted numerous bug reports concerning documentation\nerrors and omissions.\nFinally, even though Python 3.0 is described as the latest and greatest, it suffers from\nnumerous performance and behavioral problems. For example, the I/O system in the\ninitial release exhibits truly horrific and unacceptable runtime performance.The separa-\ntion of bytes and Unicode is also not without problem. Even some of the built-in\nlibrary modules are broken due to changes related to I/O and string handling.\nObviously these issues will improve with time as more programmers stress-test the\nrelease. However, in the opinion of this author, Python 3.0 is really only suitable for\nexperimental use by seasoned Python veterans. If you’re looking for stability and pro-\nduction quality code, stick with Python 2 until some of the kinks have had time to be\nworked out of the Python 3 series.\nNew Language Features\nThis section outlines some features of Python 3 that are not supported in Python 2.\nSource Code Encoding and Identifiers\nPython 3 assumes that source code is encoded as UTF-8. In addition, the rules on what\ncharacters are legal in an identifier have been relaxed. Specifically, identifiers can contain\nany valid Unicode character with a code point of U+0080 or greater. For example:\np = 3.141592654\nr = 4.0\nprint(2*p*r)\nJust because you can use such characters in your source code doesn’t mean that it’s a\ngood idea. Not all editors, terminals, or development tools are equally adept at Unicode\nhandling. Plus, it is extremely annoying to force programmers to type awkward key\nsequences for characters not visibly present on a standard keyboard (not to mention the\nfact that it might make some of the gray-bearded hackers in the office tell everyone\nanother amusing APL story). So, it’s probably better to reserve the use of Unicode char-\nacters for comments and string literals.\nSet Literals\nA set of items can now be defined by enclosing a collection of values in braces {\nitems }. For example:\ndays = { 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun' }\nThis syntax is the same as using the set() function:\ndays = set(['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'])\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2500,
      "extraction_method": "Direct"
    },
    {
      "page_number": 648,
      "chapter": null,
      "content": "623\nNew Language Features\nSet and Dictionary Comprehensions\nThe syntax { expr for x in s if conditional} is a set comprehension. It applies\nan operation to all of the elements of a set s and can be used in a similar manner as list\ncomprehensions. For example:\n>>> values = { 1, 2, 3, 4 }\n>>> squares = {x*x for x in values}\n>>> squares\n{16, 1, 4, 9}\n>>>\nThe syntax { kexpr:vexpr for k,v in s if condition } is a dictionary com-\nprehension. It applies an operation to all of the keys and values in sequence s of (key,\nvalue) tuples and returns a dictionary.The keys of the new dictionary are described by\nan expression kexpr, and the values are described by the expression vexpr.This can be\nviewed as a more powerful version of the dict() function.\nTo illustrate, suppose you had a file of stock prices 'prices.dat' like this:\nGOOG 509.71\nYHOO 28.34\nIBM 106.11\nMSFT 30.47\nAAPL 122.13\nHere is a program that reads this file into a dictionary mapping stock names to price\nusing a dictionary comprehension:\nfields = (line.split() for line in open(\"prices.dat\"))\nprices = {sym:float(val) for sym,val in fields}\nHere is an example that converts all of the keys of the prices dictionary to lowercase:\nd = {sym.lower():price for sym,price in prices.items()}\nHere is an example that creates a dictionary of prices for stocks over $100.00:\nd = {sym:price for sym,price in prices.items() if price >= 100.0}\nExtended Iterable Unpacking\nIn Python 2, items in an iterable can be unpacked into variables using syntax such as\nthe following:\nitems = [1,2,3,4]\na,b,c,d = items              # Unpack items into variables\nIn order for this unpacking to work, the number of variables and items to be unpacked\nmust exactly match.\nIn Python 3, you can use a wildcard variable to only unpack some of the items in a\nsequence, placing any remaining values in a list. For example:\na,*rest   = items      # a = 1, rest = [2,3,4]\na,*rest,d = items      # a = 1, rest = [2,3], d = 4\n*rest, d  = items      # rest = [1,2,3], d = 4\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2022,
      "extraction_method": "Direct"
    },
    {
      "page_number": 649,
      "chapter": null,
      "content": "624\nAppendix Python 3\nIn these examples, the variable prefixed by a * receives all of the extra values and places\nthem in a list.The list may be empty if there are no extra items. One use of this feature\nis in looping over lists of tuples (or sequences) where the tuples may have differing\nsizes. For example:\npoints = [ (1,2), (3,4,\"red\"), (4,5,\"blue\"), (6,7) ]\nfor x,y, *opt in points:\nif opt:\n# Additional fields were found\nstatements\nNo more than one starred variable can appear in any expansion.\nNonlocal Variables\nInner functions can modify variables in outer functions by using the nonlocal declara-\ntion. For example:\ndef countdown(n):\ndef decrement():\nnonlocal n\nn -= 1\nwhile n > 0:\nprint(\"T-minus\", n)\ndecrement()\nIn Python 2, inner functions can read variables in outer functions but cannot modify\nthem.The nonlocal declaration enables this.\nFunction Annotations\nThe arguments and return value of functions can be annotated with arbitrary values.\nFor example:\ndef foo(x:1,y:2) -> 3:\npass\nThe function attribute _ _annotations_ _ is a dictionary mapping argument names to\nthe annotation values.The special 'return' key is mapped to the return value annota-\ntion. For example:\n>>> foo._ _annotations_ _\n{'y': 4, 'x': 3, 'return': 5}\n>>>\nThe interpreter does not attach any significance to these annotations. In fact, they can\nbe any values whatsoever. However, it is expected that type information will be most\nuseful in the future. For example, you could write this:\ndef foo(x:int, y:int) -> str:\nstatements\nAnnotations are not limited to single values.An annotation can be any valid Python\nexpression. For variable positional and keyword arguments, the same syntax applies. For\nexample:\ndef bar(x, *args:\"additional\", **kwargs:\"options\"):\nstatements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1783,
      "extraction_method": "Direct"
    },
    {
      "page_number": 650,
      "chapter": null,
      "content": "625\nNew Language Features\nAgain, it is important to emphasize that Python does not attach any significance to\nannotations.The intended use is in third-party libraries and frameworks that may want\nto use them for various applications involving metaprogramming. Examples include, but\nare not limited to, static analysis tools, documentation, testing, function overloading,\nmarshalling, remote procedure call, IDEs, contracts, etc. Here is an example of a decora-\ntor function that enforces assertions on function arguments and return values:\ndef ensure(func):\n# Extract annotation data\nreturn_check = func._ _annotations_ _.get('return',None)\narg_checks   = [(name,func._ _annotations_ _.get(name))\nfor name in func._ _code_ _.co_varnames]\n# Create a wrapper that checks argument values and the return\n# result using the functions specified in annotations\ndef assert_call(*args,**kwargs): \nfor (name,check),value in zip(arg_checks,args):\nif check: assert check(value), \"%s %s\" % (name, check._ _doc_ _)\nfor name,check in arg_checks[len(args):]:\nif check: assert check(kwargs[name]), \"%s %s\" % (name, check._ _doc_ _)\nresult = func(*args,**kwargs)\nassert return_check(result), \"return %s\" % return_check._ _doc_ _\nreturn result\nreturn assert_call\nHere is an example of code that uses the previous decorator:\ndef positive(x):\n\"must be positive\"\nreturn x > 0\ndef negative(x):\n\"must be negative\"\nreturn x < 0\n@ensure\ndef foo(a:positive, b:negative) -> positive:\nreturn a – b\nFollowing is some sample output of using the function:\n>>> foo(3,-2)\n5\n>>> foo(-5,2)\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nFile \"meta.py\", line 19, in call\ndef assert_call(*args,**kwargs): \nAssertionError: a must be positive\n>>>\nKeyword-Only Arguments\nFunctions can specify keyword-only arguments.This is indicated by defining extra\nparameters after the first starred parameter. For example:\ndef foo(x, *args, strict=False):\nstatements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1960,
      "extraction_method": "Direct"
    },
    {
      "page_number": 651,
      "chapter": null,
      "content": "626\nAppendix Python 3\nWhen calling this function, the strict parameter can only be specified as a keyword.\nFor example:\na = foo(1, strict=True)\nAny additional positional arguments would just be placed in args and not used to set\nthe value of strict. If you don’t want to accept a variable number of arguments but\nwant keyword-only arguments, use a bare * in the parameter list. For example:\ndef foo(x, *, strict=False):\nstatements\nHere is an example of usage:\nfoo(1,True)         # Fails. TypeError: foo() takes 1 positional argument\nfoo(1,strict=True)  # Ok.\nEllipsis as an Expression\nThe Ellipsis object (...) can now appear as an expression.This allows it to be placed\nin containers and assigned to variables. For example:\n>>> x = ...\n# Assignment of Ellipsis\n>>> x\nEllipsis\n>>> a = [1,2,...]\n>>> a\n[1, 2, Ellipsis]\n>>> ... in a\nTrue\n>>> x is ...\nTrue\n>>>\nThe interpretation of the ellipsis is still left up to the application that uses it.This feature\nallows the ... to be used as an interesting piece of syntax in libraries and frameworks\n(for example, to indicate a wild-card, continuation, or some similar concept).\nChained Exceptions\nExceptions can now be chained together. Essentially this is a way for the current excep-\ntion to carry information about the previous exception.The from qualifier is used with\nthe raise statement to explicitly chain exceptions. For example:\ntry:\nstatements\nexcept ValueError as e:\nraise SyntaxError(\"Couldn't parse configuration\") from e\nWhen the SyntaxError exception is raised, a traceback message such as the following\nwill be generated—showing both exceptions:\nTraceback (most recent call last):\nFile \"<stdin>\", line 2, in <module>\nValueError: invalid literal for int() with base 10: 'nine'\nThe above exception was the direct cause of the following exception:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1828,
      "extraction_method": "Direct"
    },
    {
      "page_number": 652,
      "chapter": null,
      "content": "627\nNew Language Features\nTraceback (most recent call last):\nFile \"<stdin>\", line 4, in <module>\nSyntaxError: Couldn't parse configuration\nException objects have a _ _cause_ _ attribute, which is set to the previous exception.\nUse of the from qualifier with raise sets this attribute.\nA more subtle example of exception chaining involves exceptions raised within\nanother exception handler. For example:\ndef error(msg):\nprint(m)          # Note: typo is intentional (m undefined)\ntry:\nstatements\nexcept ValueError as e:\nerror(\"Couldn't parse configuration\")\nIf you try this in Python 2, you only get an exception related to the NameError in\nerror(). In Python 3, the previous exception being handled is chained with the result.\nFor example, you get this message:\nTraceback (most recent call last):\nFile \"<stdin>\", line 2, in <module>\nValueError: invalid literal for int() with base 10: 'nine'\nDuring handling of the above exception, another exception occurred:\nTraceback (most recent call last):\nFile \"<stdin>\", line 4, in <module>\nFile \"<stdin>\", line 2, in error\nNameError: global name 'm' is not defined\nFor implicit chaining, the _ _context_ _ attribute of an exception instance e contains a\nreference to previous exception.\nImproved super()\nThe super() function, used to look up methods in base classes, can be used without\nany arguments in Python 3. For example:\nclass C(A,B):\ndef bar(self):\nreturn super().bar()      # Call bar() in bases\nIn Python 2, you had to use super(C,self).bar().The old syntax is still supported\nbut is significantly more clunky.\nAdvanced Metaclasses\nIn Python 2, you can define metaclasses that alter the behavior of classes.A subtle facet\nof the implementation is that the processing carried out by a metaclass only occurs after\nthe body of a class has executed.That is, the interpreter executes the entire body of a\nclass and populates a dictionary. Once the dictionary has been populated, the dictionary\nis passed to the metaclass constructor (after the body of the class has executed).\nIn Python 3, metaclasses can additionally carry out extra work before the class body\nexecutes.This is done by defining a special class method called _ _prepare_ _(cls,\nname, bases, **kwargs) in the metaclass.This method must return a dictionary as a\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2294,
      "extraction_method": "Direct"
    },
    {
      "page_number": 653,
      "chapter": null,
      "content": "628\nAppendix Python 3\nresult.This dictionary is what gets populated as the body of the class definition exe-\ncutes. Here is an example that outlines the basic procedure:\nclass MyMeta(type):\n@classmethod\ndef _ _prepare_ _(cls,name,bases,**kwargs):\nprint(\"preparing\",name,bases,kwargs)\nreturn {}\ndef _ _new_ _(cls,name,bases,classdict):\nprint(\"creating\",name,bases,classdict)\nreturn type._ _new_ _(cls,name,bases,classdict)\nPython 3 uses an alternative syntax for specifying a metaclass. For example, to define a\nclass that uses MyMeta, you use this:\nclass Foo(metaclass=MyMeta):\nprint(\"About to define  methods\")\ndef _ _init_ _(self):\npass\ndef bar(self):\npass\nprint(\"Done defining methods\")\nIf you run the following code, you will see the following output that illustrates the con-\ntrol flow:\npreparing Foo () {}\nAbout to define methods\nDone defining methods\ncreating Foo () {'_ _module_ _': '_ _main_ _',\n'bar': <function bar at 0x3845d0>, \n'_ _init_ _': <function _ _init_ _ at 0x384588>}\nThe additional keyword arguments on the _ _prepare_ _() method of the metaclass\nare passed from keyword arguments used in the bases list of a class statement. For\nexample, the statement class Foo(metaclass=MyMeta,spam=42,blah=\"Hello\")\npasses the keyword arguments spam and blah to MyMeta._ _prepare_ _().This con-\nvention can be used to pass arbitrary configuration information to a metaclass.\nTo perform any kind of useful processing with the new _ _prepare_ _() method of\nmetaclasses, you generally have the method return a customized dictionary object. For\nexample, if you wanted to perform special processing as a class is defined, you define a\nclass that inherits from dict and reimplements the _ _setitem_ _() method to capture\nassignments to the class dictionary.The following example illustrates this by defining a\nmetaclass that reports errors if any method or class variable is multiply defined.\nclass MultipleDef(dict):\ndef _ _init_ _(self):\nself.multiple= set()\ndef _ _setitem_ _(self,name,value):\nif name in self:\nself.multiple.add(name)\ndict._ _setitem_ _(self,name,value)\nclass MultiMeta(type):\n@classmethod\ndef _ _prepare_ _(cls,name,bases,**kwargs):\nreturn MultipleDef()\ndef _ _new_ _(cls,name,bases,classdict):\nfor name in classdict.multiple:\nprint(name,\"multiply defined\")\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2304,
      "extraction_method": "Direct"
    },
    {
      "page_number": 654,
      "chapter": null,
      "content": "629\nCommon Pitfalls\nif classdict.multiple:\nraise TypeError(\"Multiple definitions exist\")\nreturn type._ _new_ _(cls,name,bases,classdict)\nIf you apply this metaclass to another class definition, it will report an error if any\nmethod is redefined. For example:\nclass Foo(metaclass=MultiMeta):\ndef _ _init_ _(self):\npass\ndef _ _init_ _(self,x):         # Error. _ _init_ _ multiply defined.\npass\nCommon Pitfalls\nIf you are migrating from Python 2 to 3, be aware that Python 3 is more than just new\nsyntax and language features. Major parts of the core language and library have been\nreworked in ways that are sometimes subtle.There are aspects of Python 3 that may\nseem like bugs to a Python 2 programmer. In other cases, things that used to be “easy”\nin Python 2 are now forbidden.\nThis section outlines some of the most major pitfalls that are likely to be encoun-\ntered by Python 2 programmers making the switch.\nText Versus Bytes\nPython 3 makes a very strict distinction between text strings (characters) and binary\ndata (bytes).A literal such as \"hello\" represents a text string stored as Unicode, where-\nas b\"hello\" represents a string of bytes (containing ASCII letters in this case).\nUnder no circumstances can the str and bytes type be mixed in Python 3. For\nexample, if you try to concatenate strings and bytes together, you will get a TypeError\nexception.This differs from Python 2 where byte strings would be automatically\ncoerced into Unicode as needed.\nTo convert a text string s into bytes, you must use s.encode(encoding). For\nexample, s.encode('utf-8') converts s into a UTF-8 encoded byte string.To con-\nvert a byte string t back into text, you must use t.decode(encoding).You can view\nthe encode() and decode() methods as a kind of “type cast” between strings and\nbytes.\nKeeping a clean separation between text and bytes is ultimately a good thing—the\nrules for mixing string types in Python 2 were obscure and difficult to understand at\nbest. However, one consequence of the Python 3 approach is that byte strings are much\nmore restricted in their ability to actually behave like “text.”Although there are the\nstandard string methods like split() and replace(), other aspects of byte strings are\nnot the same as in Python 2. For instance, if you print a byte string, you simply get its\nrepr() output with quotes such as b'contents'. Similarly, none of the string format-\nting operations (%, .format()) work. For example:\nx = b'Hello World'\nprint(x)                      # Produces b'Hello World'\nprint(b\"You said '%s'\" % x)   # TypeError: % operator not supported\nThe loss of text-like behavior with bytes is a potential pitfall for system programmers.\nDespite the invasion of Unicode, there are many cases where one actually does want to\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2778,
      "extraction_method": "Direct"
    },
    {
      "page_number": 655,
      "chapter": null,
      "content": "630\nAppendix Python 3\nwork with and manipulate byte-oriented data such as ASCII.You might be inclined to\nuse the bytes type to avoid all of the overhead and complexity of Unicode. However,\nthis will actually make everything related to byte-oriented text handling more difficult.\nHere is an example that illustrates the potential problems:\n>>> # Create a response message using strings (Unicode)\n>>> status = 200\n>>> msg = \"OK\"\n>>> proto = \"HTTP/1.0\"\n>>> response = \"%s %d %s\" % (proto, status, msg)\n>>> print(response)\nHTTP/1.0 200 OK\n>>> # Create a response message using only bytes (ASCII)\n>>> status = 200\n>>> msg = b\"OK\"\n>>> proto = b\"HTTP/1.0\"\n>>> response = b\"%s %d %s\" % (proto, status, msg)\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: unsupported operand type(s) for %: 'bytes' and 'tuple'\n>>> response = proto + b\" \" + str(status) + b\" \" + msg\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: can't concat bytes to str\n>>> bytes(status)\nb'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00....'\n>>> bytes(str(status))\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: string argument without an encoding\n>>> bytes(str(status),'ascii')\nb'200'\n>>> response = proto + b\" \" + bytes(str(status),'ascii') + b\" \" + msg\n>>> print(response)\nb'HTTP/1.0 200 OK'\n>>> print(response.decode('ascii'))\nHTTP/1.0 200 OK\n>>>\nIn the example, you can see how Python 3 is strictly enforcing the text/bytes separa-\ntion. Even operations that seem like they should be simple, such as converting an inte-\nger into ASCII characters, are much more complicated with bytes.\nThe bottom line is that if you’re performing any kind of text-based processing or\nformatting, you are probably always better off using standard text strings. If you need \nto obtain a byte-string after the completion of such processing, you can use\ns.encode('latin-1') to convert from Unicode.\nThe text/bytes distinction is somewhat more subtle when working with various\nlibrary modules. Some libraries work equally well with text or bytes, while some forbid\nbytes altogether. In other cases, the behavior is different depending on what kind of\ninput is received. For example, the os.listdir(dirname) function only returns file-\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2298,
      "extraction_method": "Direct"
    },
    {
      "page_number": 656,
      "chapter": null,
      "content": "631\nCommon Pitfalls\nnames that can be successfully decoded as Unicode if dirname is a string. If dirname is\na byte string, then all filenames are returned as byte strings.\nNew I/O System\nPython 3 implements an entirely new I/O system, the details of which are described in\nthe io module section of Chapter 19,“Operating System Services.”The new I/O sys-\ntem also reflects the strong distinction between text and binary data present with\nstrings.\nIf you are performing any kind of I/O with text, Python 3 forces you to open files\nin “text mode” and to supply an optional encoding if you want anything other than the\ndefault (usually UTF-8). If you are performing I/O with binary data, you must open\nfiles in “binary mode” and use byte strings.A common source of errors is passing out-\nput data to a file or I/O stream opened in the wrong mode. For example:\n>>> f = open(\"foo.txt\",\"wb\")\n>>> f.write(\"Hello World\\n\")\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nFile \"/tmp/lib/python3.0/io.py\", line 1035, in write\nraise TypeError(\"can't write str to binary stream\")\nTypeError: can't write str to binary stream\n>>>\nSockets, pipes, and other kinds of I/O channels should always be assumed to be in bina-\nry mode. One potential problem with network code in particular is that many network\nprotocols involve text-based request/response processing (e.g., HTTP, SMTP, FTP, etc.).\nGiven that sockets are binary, this mix of binary I/O and text processing can lead to\nsome of the problems related to mixing text and bytes that were described in the previ-\nous section.You’ll need to be careful.\nprint() and exec() Functions\nThe print and exec statements from Python 2 are now functions. Use of the print()\nfunction compared to its Python 2 counterpart is as follows:\nprint(x,y,z)          # Same as : print x, y, z\nprint(x,y,z,end=' ')  # Same as : print x, y, z,\nprint(a,file=f)       # Same as : print >>f, a\nThe fact that print() is a function that means you can replace it with an alternative\ndefinition if you want.\nexec() is also now a function, but its behavior in Python 3 is subtly different than\nin Python 2. For example, consider this code:\ndef foo():\nexec(\"a = 42\")\nprint(a)\nIn Python 2, calling foo() will print the number '42'. In Python 3, you get a\nNameError exception with the variable a being undefined.What has happened here is\nthat exec(), as a function, only operates on the dictionaries returned by the \nglobals() and locals() functions. However, the dictionary returned by locals() is\nactually a copy of the local variables.The assignment made in the exec() function is\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2631,
      "extraction_method": "Direct"
    },
    {
      "page_number": 657,
      "chapter": null,
      "content": "632\nAppendix Python 3\nmerely modifying this copy of the locals, not the local variables themselves. Here is one\nworkaround:\ndef foo():\n_locals = locals()\nexec(\"a = 42\",globals(),_locals)\na = _locals['a']      # Extract the set variable\nprint(a)\nAs a general rule, don’t expect Python 3 to support the same degree of “magic” that\nwas possible using exec(), eval(), and execfile() in Python 2. In fact, execfile()\nis gone entirely (you can emulate its functionality by passing an open file-like object to\nexec()).\nUse of Iterators and Views\nPython 3 makes much greater use of iterators and generators than Python 2. Built-in\nfunctions such as zip(), map(), and range() that used to return lists now return iter-\nables. If you need to make a list from the result, use the list() function.\nPython 3 takes a slightly different approach to extracting key and value information\nfrom a dictionary. In Python 2, you could use methods such as d.keys(), d.values(),\nor d.items() to obtain lists of keys, values, or key/value pairs, respectively. In Python\n3, these methods return so-called view objects. For example:\n>>> s = { 'GOOG': 490.10, 'AAPL': 123.45, 'IBM': 91.10 }\n>>> k = s.keys()\n>>> k\n<dict_keys object at 0x33d950>\n>>> v = s.values()\n>>> v\n<dict_values object at 0x33d960>\n>>>\nThese objects support iteration so if you want to view the contents, you can use a for\nloop. For example:\n>>> for x in k:\n...\nprint(x)\n...\nGOOG\nAAPL\nIBM\n>>>\nView objects are always tied back to the dictionary from which they were created.A\nsubtle aspect of this is that if the underlying dictionary changes, the items produced by\nthe view change as well. For example:\n>>> s['ACME'] = 5612.25\n>>> for x in k:\n...\nprint(x)\n...\nGOOG\nAAPL\nIBM\nACME\n>>>\nShould it be necessary to build a list of dictionary keys or values, simply use the list()\nfunction—for example, list(s.keys()).\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1878,
      "extraction_method": "Direct"
    },
    {
      "page_number": 658,
      "chapter": null,
      "content": "633\nCommon Pitfalls\nIntegers and Integer Division\nPython 3 no longer has an int type for 32-bit integers and a separate long type for\nlong integers.The int type now represents an integer of arbitrary precision (the inter-\nnal details of which are not exposed to the user).\nIn addition, integer division now always produces a floating-point result. For exam-\nple, 3/5 is 0.6, not 0.The conversion to a float applies even if the result would have\nbeen an integer. For example, 8/2 is 4.0, not 4.\nComparisons\nPython 3 is much more strict about how values are compared. In Python 2, it is the\ncase that any two objects can be compared even if it doesn’t make sense. For example:\n>>> 3 < \"Hello\"\nTrue\n>>>\nIn Python 3, this results in a TypeError. For example:\n>>> 3 < \"Hello\"\nTraceback (most recent call last):\nFile \"<stdin>\", line 1, in <module>\nTypeError: unorderable types: int() < str()\n>>>\nThis change is minor, but it means that in Python 3, you have to be much more careful\nabout making sure data is of appropriate types. For example, if you use the sort()\nmethod of a list, all of the items in the list must be compatible with the < operator, or\nyou get an error. In Python 2, the operation would be silently carried out anyways with\na usually meaningless result.\nIterators and Generators\nPython 3 has made a slight change to the iterator protocol. Instead of calling\n_ _iter_ _() and the next() method to perform iteration, the next() method has\nbeen renamed to _ _next_ _(). Most users will be unaffected by this change except if\nyou have written code that manually iterates over an iterable or if you have defined\nyour own custom iterator objects.You will need to make sure you change the name of\nthe next() method in your classes. Use the built-in next() function to invoke the\nnext() or _ _next_ _() method of an iterator in a portable manner.\nFile Names, Arguments, and Environment Variables\nIn Python 3, filenames, command-line arguments in sys.argv, and environment vari-\nables in os.environ may or may not be treated as Unicode depending on local set-\ntings.The only problem is that the usage of Unicode within the operating system envi-\nronment is not entirely universal. For example, on many systems it may be technically\npossible to specify filenames, command-line options, and environment variables that are\njust a raw sequence of bytes that don’t correspond to a valid Unicode encoding.\nAlthough these situations might be rare in practice, it may be of some concern for \nprogramming using Python to perform tasks related to systems administration.As previ-\nously noted, supplying file and directory names as byte strings will fix many of the\nproblems. For example, os.listdir(b'/foo').\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2725,
      "extraction_method": "Direct"
    },
    {
      "page_number": 659,
      "chapter": null,
      "content": "634\nAppendix Python 3\nLibrary Reorganization\nPython 3 reorganizes and changes the names of several parts of the standard library,\nmost notably modules related to networking and Internet data formats. In addition, a\nwide variety of legacy modules have been dropped from the library (e.g., gopherlib,\nrfc822, and so on).\nIt is now standard practice to use lowercase names for modules. Several modules such\nas ConfigParser, Queue, and SocketServer have been renamed to configparser,\nqueue, and socketserver, respectively.You should try to follow similar conventions in\nyour own code.\nPackages have been created to reorganize code that was formerly contained in dis-\nparate modules—for example, the http package containing all the module used to\nwrite HTTP servers, the html package has modules for parsing HTML, the xmlrpc\npackage has modules for XML-RPC, and so forth.\nAs for deprecated modules, this book has been careful to only document modules\nthat are in current use with Python 2.6 and Python 3.0. If you are working with exist-\ning Python 2 code and see it using a module not documented here, there is a good\nchance that the module has been deprecated in favor of something more modern. Just\nas an example, Python 3 doesn’t have the popen2 module commonly used in Python 2\nto launch subprocesses. Instead, you should use the subprocess module.\nAbsolute Imports\nRelated to library reorganization, all import statements appearing in submodules of a\npackage use absolute names.This is covered in more detailed in Chapter 8,“Modules,\nPackages, and Distribution,” but suppose you have a package organized like this:\nfoo/\n_ _init_ _.py\nspam.py\nbar.py\nIf the file spam.py uses the statement import bar, you get an ImportError exception\neven though bar.py is located in the same directory.To load this submodule, spam.py\neither needs to use import foo.bar or a package relative import such as from .\nimport bar.\nThis differs from Python 2 where import always checks the current directory for a\nmatch before moving onto checking other directories in sys.path.\nCode Migration and 2to3\nConverting code from Python 2 to Python 3 is a delicate topic. Just to be absolutely\nclear, there are no magic imports, flags, environment variables, or tools that will enable\nPython 3 to run an arbitrary Python 2 program. However, there are some very specific\nsteps that can be taken to migrate code, each of which is now described.\nPorting Code to Python 2.6\nIt is recommended that anyone porting code to Python 3 first port to Python 2.6.\nPython 2.6 is not only backwards-compatible with Python 2.5, but it also supports a\nsubset of new features found in Python 3. Examples include advanced string formatting,\nthe new exception syntax, byte literals, I/O library, and abstract base classes.Thus, a\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2803,
      "extraction_method": "Direct"
    },
    {
      "page_number": 660,
      "chapter": null,
      "content": "635\nCode Migration and 2to3\nPython 2 program can start to take advantage of useful Python 3 features now even if it\nis not yet ready to make the full migration.\nThe other reason to port to Python 2.6 is that Python 2.6 issues warning messages\nfor deprecated features if you run it with the -3 command-line option. For example:\nbash-3.2$ python -3\nPython 2.6 (trunk:66714:66715M, Oct  1 2008, 18:36:04) \n[GCC 4.0.1 (Apple Computer, Inc. build 5370)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> a = { }\n>>> a.has_key('foo')\n_ _main_ _:1: DeprecationWarning: dict.has_key() not supported in 3.x; use the in\noperator\nFalse\n>>\nUsing these warning messages as a guide, you should take great care to make sure that\nyour program runs warning-free on Python 2.6 before moving forward with a Python\n3 port.\nProviding Test Coverage\nPython has useful testing modules including doctest and unittest. Make sure your\napplication has thorough test coverage before attempting a Python 3 port. If your pro-\ngram has not had any tests to this point, now would be a good time to start.You will\nwant to make sure your tests cover as much as possible and that all tests pass without\nany warning messages when run on Python 2.6.\nUsing the 2to3 Tool\nPython 3 includes a tool called 2to3 that can assist with code migration from Python\n2.6 to Python 3.This tool is normally found in the Tools/scripts directory of the\nPython source distribution and is also installed in the same directory as the python3.0\nbinary on most systems. It is a command-line tool that would normally run from a\nUNIX or Windows command shell.\nAs an example, consider the following program that contains a number of deprecated\nfeatures.\n# example.py\nimport ConfigParser\nfor i in xrange(10):\nprint i, 2*i\ndef spam(d):\nif not d.has_key(\"spam\"):\nd[\"spam\"] = load_spam()\nreturn d[\"spam\"]\nTo run 2to3 on this program, type “2to3 example.py”. For example:\n% 2to3 example.py\nRefactoringTool: Skipping implicit fixer: buffer\nRefactoringTool: Skipping implicit fixer: idioms\nRefactoringTool: Skipping implicit fixer: set_literal\nRefactoringTool: Skipping implicit fixer: ws_comma\n--- example.py (original)\n+++ example.py (refactored)\n@@ -1,10 +1,10 @@\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2255,
      "extraction_method": "Direct"
    },
    {
      "page_number": 661,
      "chapter": null,
      "content": "636\nAppendix Python 3\n# example.py \n-import ConfigParser\n+import configparser\n-for i in xrange(10):\n-    print i, 2*i\n+for i in range(10):\n+    print(i, 2*i)\ndef spam(d):\n-    if not d.has_key(\"spam\"):\n+    if \"spam\" not in d:\nd[\"spam\"] = load_spam()\nreturn d[\"spam\"]\nRefactoringTool: Files that need to be modified:\nRefactoringTool: example.py\nAs output, 2to3 will identify parts of the program that it considers to be problematic\nand that might need to be changed.These are shown as context-diffs in the output.\nAlthough we have used 2to3 on a single file, if you give it the name of a directory, it\nrecursively looks for all Python files contained in the directory structure and generates a\nreport for everything.\nBy default, 2to3 does not actually fix any of the source code it scans—it merely\nreports parts of the code that might need to be changed.A challenge faced by 2to3 is\nthat it often only has incomplete information. For example, consider the spam() func-\ntion in the example code.This function calls a method d.has_key(). For dictionaries,\nhas_key() has been removed in favor of the in operator. 2to3 reports this change, but\nwithout more information, it is not clear if spam() is actually manipulating a dictionary\nor not. It might be the case that d is some other kind of object (a database perhaps) that\nhappens to provide a has_key() method, but where using the in operator would fail.\nAnother problematic area for 2to3 is in the handling of byte strings and Unicode.\nGiven that Python 2 would automatically promote byte strings to Unicode, it is some-\nwhat common to see code that carelessly mixes the two string types together.\nUnfortunately, 2to3 is unable to sort all of this out.This is one reason why it’s impor-\ntant to have good unit test coverage. Of course, all of this depends on the application.\nAs an option, 2to3 can be instructed to fix selected incompatibilities. First, a list of\n“fixers” can be obtained by typing 2to3 -l. For example:\n% 2to3 -l\nAvailable transformations for the -f/--fix option:\napply\nbasestring\nbuffer\ncallable\n...\n...\nxrange\nxreadlines\nzip\nUsing names from this list, you can see what a selected fix would actually change by\nsimply typing “2to3 -f fixname filename”. If you want to apply multiple fixes, just\nspecify each one with a separate -f option. If you actually want to apply the fix to a\nsource file, add the -w option as in 2to3 -f fixname -w filename. Here is an\nexample:\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2460,
      "extraction_method": "Direct"
    },
    {
      "page_number": 662,
      "chapter": null,
      "content": "637\nCode Migration and 2to3\n% 2to3 -f xrange -w example.py\n--- example.py (original)\n+++ example.py (refactored)\n@@ -1,7 +1,7 @@\n# example.py \nimport ConfigParser\n-for i in xrange(10):\n+for i in range(10):\nprint i, 2*i\ndef spam(d):\nRefactoringTool: Files that were modified:\nRefactoringTool: example.py\nIf you look at example.py after this operation, you will find that xrange() has been\nchanged to range() and that no other changes have been made.A backup of the origi-\nnal example.py file is found in example.py.bak.\nA counterpart to the -f option is the -x option. If you use 2to3 -x fixname\nfilename, it will run all of the fixers except for the ones you listed with the -x option.\nAlthough it is possible to instruct 2to3 to fix everything and to overwrite all of your\nfiles, this is probably something best avoided in practice. Keep in mind that code transla-\ntion is an inexact science and that 2to3 is not always going to do the “right thing.” It is\nalways better to approach code migration in a methodical calculated manner as opposed\nto crossing your fingers and hoping that it all just magically “works.”\n2to3 has a couple of additional options that may be useful.The -v option enables a\nverbose mode that prints additional information that might be useful for debugging.\nThe -p option tells 2to3 that you are already using the print statement as a function\nin your code and that it shouldn’t be converted (enabled by the from _ _future_ _\nimport print_statement statement).\nA Practical Porting Strategy\nHere is a practical strategy for porting Python 2 code to Python 3.Again, it is better to\napproach migration in a methodical manner as opposed to doing everything at once.\n1. Make sure your code has an adequate unit testing suite and that all tests pass\nunder Python 2.\n2. Port your code and testing suite to Python 2.6 and make sure that all tests still\npass.\n3. Turn on the -3 option to Python 2.6.Address all warning messages and make\nsure your program runs and passes all tests without any warning messages. If\nyou’ve done this correctly, chances are that your code will still work with Python\n2.5 and maybe even earlier releases.You’re really just cleaning out some of the\ncruft that’s accumulated in your program.\n4. Make a backup of your code (this goes without saying).\n5. Port the unit testing suite to Python 3 and make sure that the testing environ-\nment itself is working.The individual unit tests themselves will fail (because you\nhaven’t yet ported any code). However, a properly written test suite should be\nable to deal with test failures without having an internal crash of the test software\nitself.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2654,
      "extraction_method": "Direct"
    },
    {
      "page_number": 663,
      "chapter": null,
      "content": "638\nAppendix Python 3\n6. Convert the program itself to Python 3 using 2to3. Run the unit testing suite on\nthe resulting code and fix all of the issues that arise.There are varying strategies\nfor doing this. If you’re feeling lucky, you can always tell 2to3 to just fix every-\nthing and see what happens. If you’re more cautious, you might start by having\n2to3 fix the really obvious things (print, except statements, xrange(), library\nmodule names, etc.) and then proceed in a more piecemeal manner with the\nremaining issues.\nBy the end of this process, your code should pass all unit tests and operate in the same\nmanner as before.\nIn theory, it is possible to structure code in a way so that it both runs in Python 2.6\nand automatically translates to Python 3 without any user intervention. However, this\nwill require very careful adherence to modern Python coding conventions—at the very\nleast you will absolutely need to make sure there are no warnings in Python 2.6. If the\nautomatic translation process requires very specific use of 2to3 (such as running only a\nselected set of fixers), you should probably write a shell script that automatically carries\nout the required operations as opposed to requiring users to run 2to3 on their own.\nSimultaneous Python 2 and Python 3 Support\nA final question concerning Python 3 migration is whether or not it’s possible to have a\nsingle code base that works unmodified on Python 2 and Python 3.Although this is\npossible in certain cases, the resulting code runs the risk of becoming a contorted mess.\nFor instance, you will have to avoid all print statements and make sure all except\nclauses never take any exception values (extracting them from sys.exc_info()\ninstead). Other Python features can’t be made to work at all. For example, due to syntax\ndifferences, there is no possible way to use metaclasses in a way that would be portable\nbetween Python 2 and Python 3.\nThus, if you’re maintaining code that must work on Python 2 and 3, your best bet is\nto make sure your code is as clean as possible and runs under Python 2.6, make sure\nyou have a unit testing suite, and try to develop a set of 2to3 fixes to make automatic\ntranslation possible.\nOne case where it might make sense to have a single code base is with unit testing.\nA test suite that operates without modification on Python 2.6 and Python 3 could be\nuseful in verifying the correct behavior of the application after being translated by\n2to3.\nParticipate\nAs an open-source project, Python continues to be developed with the contributions of\nits users. For Python 3, especially, it is critically to report bugs, performance problems,\nand other issues.To report a bug, go to http://bugs.python.org. Don’t be shy—your\nfeedback makes Python better for everyone.\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2792,
      "extraction_method": "Direct"
    },
    {
      "page_number": 664,
      "chapter": null,
      "content": "Symbols & Numbers\n! debugger command, pdb module, 187\n!= not equal to operator, 66\n‘ single quotes, 11, 27\n‘’’ triple quotes, 11, 27\n“ double quotes, 11, 27\n“”” triple quotes, 11, 27\n# comment, 6, 26\n#! in Unix shell scripts, 6, 176\nrewriting on package installation, 153\n% modulo operator, 65\n% string formatting operator, 8, 70, 162\n%= operator, 75\n& bitwise-and operator, 65\n& set intersection operator, 15, 75\n&= operator, 75\n() function call operator, 76\n() tuple, 14, 29\n* keyword only arguments, Python 3, 625\n* multiplication operator, 65\n* passing sequences as function argu-\nments, 94\n* sequence replication operator, 67\n* variable arguments in function definition,\n94\n* wildcard\nfrom module import, 24, 145\niterable unpacking in Python 3, 623\n** passing dictionaries as keyword argu-\nments, 95\n** power operator, 65\n** variable keyword arguments in function\ndefinition, 95\n**= operator, 75\n*= operator, 75\n+ addition operator, 65\n+ list concatenation operator, 12\n+ sequence concatenation operator, 67\n+ string concatenation operator, 11\n+ unary plus operator, 65\n+= operator, 75\n- hyphen character, used as filename, 174\n- set difference operator, 15, 75\n- subtraction operator, 65\n- unary minus operator, 65\n-*- coding: comment, in source code, 31\n-= operator, 75\n. attribute binding operator, 33, 48, 76, 118\nand modules, 51\nspecial methods for, 57\n. directory reference in relative import\nstatements, 150\n... Ellipsis, 30, 54, 59\n... interpreter prompt, 175\n/ division operator, 65\n// truncating division operator, 65\n//= operator, 75\n/= operator, 75\n: colon in string formatting specifiers, 72\n; semicolon, 7, 26\n< left alignment in string format specifiers,\n73\n< less than operator, 66\n<< left shift operator, 65\n<<= operator, 75\n<= less than or equal to operator, 66\n== equal to operator, 66, 78\n> greater than operator, 66\n> right alignment in string format speci-\nfiers, 73\nIndex\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 1922,
      "extraction_method": "Direct"
    },
    {
      "page_number": 665,
      "chapter": null,
      "content": ">= greater than or equal to operator, 66\n>> file redirection modifier to print, 10,\n163\n>> right shift operator, 65\n>>= operator, 75\n>>> interpreter prompt, 5, 175\n@ decorator, 30, 101\n[::] extended slicing operator, 39-40, 67-68\n[:] slicing operator, 39-40, 67-68\n[] indexing operator, 39-40, 67\nand special methods, 58\non mappings, 45\non sequences, 68\n[] list, 12, 29\n\\ line continuation character, 9, 25, 29\n\\ string escape codes, 27\n^ bitwise-xor operator, 65\n^ centered alignment in string format spec-\nifiers, 73\n^ set symmetric difference operator, 15, 75\n^= operator, 75\n_ variable, interactive mode, 6, 176\n{} dict, 16, 29\n{} placeholder in format strings, 72\n{} set literal, Python 3, 622\n| bitwise-or operator, 65\n| set union operator, 15, 75\n|= operator, 75\n~ bitwise-negation operator, 65\n~ expanding user home directory in file-\nnames, 397\n$variables in strings, 72\n0b binary integer literal, 27\n0o octal integer literal, 27\n0x hexadecimal integer literal, 27\n2’s complement and integers, 66\n2to3 tool, 635-637\nlimitations of, 636\n-3 command line option, 173, 635\nA\n‘a’ mode, to open() function, 159\na(args) debugger command, pdb module,\n187\na2b_base64() function, binascii module,\n547\na2b_hex() function, binascii module, 548\na2b_hqx() function, binascii module, 548\na2b_uu() function, binascii module, 547\nabc module, 136, 257\nABCMeta metaclass, 136, 257\nabort() function, os module, 390\nabort() method, of FTP objects, 497\nabs() function, 66, 201\noperator module, 273\n__abs__() method, 61\nabsolute imports, 151\nPython 3, 634\ncompared to relative imports, 151\nabsolute value, 66\nabspath() function, os.path module, 396\nabstract base class, 34, 136, 257\ncalling methods in subclasses, 137\nchecking performed, 137\ncontainer objects, 265\nerror if instantiated, 137\nexample, 258\nfiles and I/O, 354\nnumeric types, 253\nregistering pre-existing classes, 137\nspecial methods for, 57\n@abstractmethod decorator, 136-137,\n257-258\n__abstractmethods__ attribute, of types,\n50\n@abstractproperty decorator, 136-137,\n257-258\naccept() method\nof Listener objects, 433\nof dispatcher objects, 456\nof socket objects, 478\naccept2dyear variable, time module, 405\naccess control specifiers, lack of, 127\n640\n>= greater than or equal to operator\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2259,
      "extraction_method": "Direct"
    },
    {
      "page_number": 666,
      "chapter": null,
      "content": "access() function, os module, 386\nacos() function, math module, 251\nacosh() function, math module, 251\nacquire() method\nof Condition objects, 441\nof Lock objects, 438\nof RLock objects, 438\nof Semaphore objects, 439\nactivate() method, of SocketServer class,\n493\nactive_children() function, multiprocessing\nmodule, 434\nactive_count() function, threading module,\n443\nActivePython, 5\nadd() function, operator module, 273\nadd() method\nof TarFile objects, 320\nof sets, 15, 46\n__add__() method, 60\nadd_data() method, of Request objects,\n516\nadd_header() method\nof Message objects, 555\nof Request objects, 516\nadd_option() method, of OptionParser\nobjects, 158, 375\nadd_password() method, of AuthHandler\nobjects, 519\nadd_section() method, of ConfigParser\nobjects, 332\nadd_type() function, mimetypes module,\n567\nadd_unredirected_header() method, of\nRequest objects, 517\naddfile() method, of TarFile objects, 320\naddFilter() method\nof Handler objects, 364\nof Logger objects, 359\naddHandler() method, of Logger objects,\n361\naddition operator +, 65\naddLevelName() function, logging module,\n366\naddress attribute\nof BaseManager objects, 431\nof Listener objects, 433\naddress families, of sockets, 470\naddress_family attribute, of SocketServer\nclass, 492\naddresses, network, 471\naddressof() function, ctypes module, 617\nadjacent string literals, concatenation of, 27\nadler32() function, zlib module, 328\nadvanced string formatting, 8, 42, 72\nAF_* constants, socket module, 470\naifc module, 588\naio_* family of system calls, lack of, 469\nAJAX, example of, 531\nalarm() function, signal module, 399\nalarms, 399\nalias debugger command, pdb module, 187\nalignment() function, ctypes module, 617\n__all__ variable\nand import statements, 145\nin packages, 150\nall() function, 40, 67, 201\nallow_reuse_address attribute, of\nSocketServer class, 492\naltsep variable, os module, 386\naltzone variable, time module, 405\nand operator, boolean expressions, 9, 77\nand_() function, operator module, 274\n__and__() method, 60\n__annotations__ attribute, of functions,\n624\nanonymous functions, 112\nany() function, 40, 67, 201\nanydbm module, 310\napi_version variable, sys module, 229\n%APPDATA% environment variable,\nWindows, 177\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n641\n%APPDATA% environment variable, Windows\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2332,
      "extraction_method": "Direct"
    },
    {
      "page_number": 667,
      "chapter": null,
      "content": "append() method\nof Element objects, 576\nof array objects, 259\nof deque objects, 262\nof lists, 12, 40\nappendChild() method, of DOM Node\nobjects, 571\nappendleft() method, of deque objects, 262\napplication logging, 355\napplications, WSGI, 540\napplicative order evaluation, 76\napply() method, of Pool objects, 424\napply_async() method, of Pool objects, 424\nargs attribute\nof Exception objects, 213\nof exceptions, 88\nof partial objects, 268\nargtypes attribute, of ctypes function\nobjects, 613\nargv variable, sys module, 13, 157, 174,\n229\nArithmeticError exception, 87, 212\narray module, 259\nArray() function, multiprocessing module,\n426\nArray() method, of Manager objects, 428\narray() function, array module, 259\narrays, creating from uniform type, 259\narraysize attribute, of Cursor objects, 299\nas qualifier\nof except statement, 22, 85\nof from-import statement, 145\nof import statement, 24, 144\nof with statement, 62, 90\nas_integer_ratio() method, of floating point,\n39\nas_string() method, of Message objects,\n555\nascii encoding, description of, 169\nascii() function, 201\nand Python 3, 201\nfuture_builtins module, 217\nASCII, and compatibility with UTF-8, 170\nascii_letters variable, string module, 287\nascii_lowercase variable, string module,\n287\nascii_uppercase variable, string module,\n287\nasctime() function, time module, 405\nasin() function, math module, 251\nasinh() function, math module, 251\nassert statement, 91\nassert_() method, of TestCase objects, 185\nassertAlmostEqual() method, of TestCase\nobjects, 185\nassertEqual() method, of TestCase objects,\n185\nAssertionError exception, 87, 91, 213\nassertions, 91\nstripping with -O option, 148\nassertNotAlmostEqual() method, of\nTestCase objects, 185\nassertNotEqual() method, of TestCase\nobjects, 185\nassertRaises() method, of TestCase objects,\n185\nassignment\nand reference counting, 34\naugmented, 61\nin-place operators, 61\nof instance attributes, 131\nof variables, 7\nto variables in nested functions, 97\nassociative array, 16, 44\nassociativity of operators, 78\nastimezone() method, of datetime objects,\n340\nasynchat class, asynchat module, 452\nasynchat module, 452\nuse of, 467\nasynchronous I/O, 415\nasynchronous networking\nand blocking operations, 469\nwhen to consider, 467\nasyncore module, 415, 455\nuse of, 467\nAsyncResult objects, multiprocessing mod-\nule, 425\n642\nappend() method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2353,
      "extraction_method": "Direct"
    },
    {
      "page_number": 668,
      "chapter": null,
      "content": "atan() function, math module, 251\natan2() function, math module, 251\natanh() function, math module, 251\natexit module, 179, 219\natomic operations, disassembly, 193\nattach() method, of Message objects, 556\nattrgetter() function, operator module, 275\nattrib attribute, of Element objects, 576\nattribute assignment, on instances, 131\nattribute binding operator ., 33, 76\noptimization of, 196\nattribute binding\nand inheritance, 119\nand methods, 48\ninstances and classes, 118\nof user-defined objects, 131\nprocess of, 57\nredefining in classes, 132\nspecial methods for, 57\nattribute deletion, on instances, 131\nattribute lookup in string formatting, 72\nAttributeError exception, 87, 213\nand attribute binding, 132\nattributes attribute, of DOM Node objects,\n570\nattributes\ncomputed as properties, 117, 124\ncreation in __init__() method, 118\ndescriptors, 58, 126\nencapsulation of, 127\nlookup in composite string formatting,\n42\nof objects, 33\nprivate, 127\nrestricting names with __slots__, 132\nuser defined on functions, 114\naudioop module, 588\naugmented assignment operators, 61, 75\nauthentication, fetching URLs, 519\nauthkey attribute, of Process objects, 416\nawk UNIX command, similarity to list com-\nprehensions, 111\nB\n-B command line option, 173\nb character, before a string literal, 29\nb(reak) debugger command, pdb module,\n187\nb16decode() function, base64 module, 547\nb16encode() function, base64 module, 547\nb2a_base64() function, binascii module,\n547\nb2a_hex() function, binascii module, 548\nb2a_hqx() function, binascii module, 548\nb2a_uu() function, binascii module, 547\nb32decode() function, base64 module, 546\nb32encode() function, base64 module, 546\nb64decode() function, base64 module, 546\nb64encode() function, base64 module, 546\nbackslash rules, and raw strings, 29\n‘backslashreplace’ error handling, Unicode\nencoding, 166\nBadStatusLine exception, http.client mod-\nule, 504\nbase class, 21\nbase-10 decimals, 243\nand floating point, 12\nbase64 encoding, description of, 545\nbase64 module, 545\nBaseCGIHandler() function, wsgiref.handlers\nmodule, 542\nBaseException class, 212\nBaseException exception, 87\nBaseHTTPRequestHandler class, http.server\nmodule, 508\nBaseHTTPserver module, see http.server,\n506\nBaseManager() function, multiprocessing\nmodule, 430\nbasename() function, os.path module, 396,\n398\nBaseProxy class, multiprocessing module,\n432\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n643\nBaseProxy class, multiprocessing module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2492,
      "extraction_method": "Direct"
    },
    {
      "page_number": 669,
      "chapter": null,
      "content": "BaseRequestHandler class, SocketServer\nmodule, 490\n__bases__ attribute\nof classes, 131\nof types, 50\nbasestring variable, 202\nbasicConfig() function, logging module, 355\nBasicContext variable, decimal module,\n248\n.bat files, Windows, 176\nbdb module, 585\nBeautiful Soup package, 563\nbetavariate() function, random module, 255\nbidirectional() function, unicodedata mod-\nule, 293\nbig endian format, 167\nbig endian, packing and unpacking, 292\nbin() function, 77, 202\nbinary data structures, packing and\nunpacking, 290\nbinary distribution, creating with distutils,\n153\nbinary file mode, 159\nbinary files, 350\nbuffered I/O, 351\ncaution on using line-oriented func-\ntions, 351-352\nbinary integer literals, 27\nBinary() function\ndatabase API, 301\nxmlrpc.client module, 526\nbinascii module, 547\nbind() method\nof SocketServer class, 493\nof dispatcher objects, 456\nof socket objects, 478\nbinhex module, 587\nbisect module, 261\nbisect() function, bisect module, 261\nbisect_left() function, bisect module, 261\nbisect_right() function, bisect module, 261\nbitwise operations and native integers, 66\nbitwise-and operator &, 65\nbitwise-negation operator ~, 65\nbitwise-or operator |, 65\nbitwise-xor operator ^, 65\nblank lines, 26\nblock_size attribute, of digest objects, 559\nblocking operations, and asynchronous net-\nworking, 469\nBluetooth protocol, 470\naddress format, 472\nBOM (byte order marker), 280\nand Unicode, 168\nBOM_* constants, codecs module, 280\nbool type, 38\nbool() function, 202\n__bool__() method, 56, 58\nboolean expressions, 9, 77\nevaluation rules, 78\nboolean operators, 66\nboolean values, 27, 38\nboolean() function, xmlrpc.client module,\n525\nbound method, 49, 125\nBoundedSemaphore object\nmultiprocessing module, 427\nthreading module, 439\nBoundedSemaphore() method, of Manager\nobjects, 428\nbreak statement, 83-84\nand generators, 103\nbreaking long statements on multiple lines,\n9\nbreakpoint\nsetting in debugger, 187\nsetting manually, 186\nbrowser, launching from Python, 544\nBSD, kqueue interface, 460\nBTPROTO_* constants, socket module, 477\nbuffer, circular, 262\nbuffer_info() method, of array objects, 259\nbuffered binary I/O, 351\nBufferedIOBase abstract base class, 354\nBufferedRandom class, io module, 352\nBufferedReader class, io module, 351\n644\nBaseRequestHandler class, SocketServer module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2310,
      "extraction_method": "Direct"
    },
    {
      "page_number": 670,
      "chapter": null,
      "content": "BufferedRWPair class, io module, 352\nBufferedWriter class, io module, 352\nbuffering, and generators, 165\nbuild_opener() function, urllib.request mod-\nule, 518\nbuilt-in exceptions, 23, 87\nbuilt-in functions and types, 201\nbuilt-in functions, using Python 3 functions\nin Python 2, 217\nbuilt-in types, 37\n__builtin__ module, 201\nbuiltin_module_names variable, sys mod-\nule, 229\nBuiltinFunctionType, 49\nBuiltinFunctionType type, 47, 237\nbuiltins module, Python 3, 201\nbyref() function, ctypes module, 615\nbyte literals, 29\nbyte strings, 41\nand WSGI, 541\nand files, 160\nand system interfaces in Python 3, 630\nas in-memory binary files, 352\ndecoding as Unicode, 165\ndifferent behavior in Python 3, 629\nlack of formatting in Python 3, 629\nmixing with Unicode strings, 70, 167\nmutable byte arrays, 202\nuse in system interfaces, 633\nbytearray() function, 202\nbyteorder variable, sys module, 229\nbytes datatype, Python 3, 29\nbytes() function, 202-203\nbytes, escape code in strings, 28\nBytesIO class, io module, 352\nbyteswap() method, of array objects, 259\nbz2 module, 313\nBZ2Compressor() function, bz2 module,\n313\nBZ2Decompressor() function, bz2 module,\n314\nBZ2File() function, bz2 module, 313\nC\nC extensions, 591\nand .egg files, 147\nand module reloading, 149\ncompiling with distutils, 596\ncreating with SWIG, 619\nexample with ctypes, 618\nreleasing global interpreter lock, 444\n-c command line option, 173-174\nC#, 620\nc(ont(inue)) debugger command, pdb mod-\nule, 188\nC++, difference in class system, 119\nC\nPython variables compared to, 7\nimplementation of functions, 49\nC/C++ code, in third-party packages, 154\nC3 linearization algorithm, and inheritance,\n121\nc_* datatypes, ctypes module, 614\nCacheFTPHandler class, urllib.request mod-\nule, 518\ncaching results of a function, 242\ncalcsize() function, struct module, 291\ncalendar module, 588\ncall() function, subprocess module, 403\n__call__() method, 50, 62\nCallable abstract base class, 265\ncallable objects\nand __call__() method, 62\nclasses, 50\ninstances, 50\ntypes of, 47\ncallback functions, 98\nand lambda, 112\ncalling Python functions from C, 610\ncalling a function, 18, 93\n_callmethod() method, of BaseProxy\nobjects, 433\ncallproc() method, of Cursor objects, 298\ncancel() method, of Timer objects, 438\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n645\ncancel() method, of Timer objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2385,
      "extraction_method": "Direct"
    },
    {
      "page_number": 671,
      "chapter": null,
      "content": "cancel_join_thread() method, of Queue\nobjects, 418\nCannotSendHeader exception, http.client\nmodule, 504\nCannotSendRequest exception, http.client\nmodule, 504\ncapitalize() method, of strings, 41-42\ncapitals attribute, of Context objects, 247\ncapwords() function, string module, 290\ncase conversion, of strings, 43-44\ncase sensitivity, of identifiers, 26\ncase statement, lack of, 9\ncast() function, ctypes module, 617\ncatching all exceptions, 85\ncatching multiple exceptions, 85\ncategory() function, unicodedata module,\n170, 293\n__cause__ attribute, of Exception objects,\n213, 627\ncaution with range() function, 17\nCDLL() function, ctypes module, 612\nceil() function, math module, 251\ncenter() method, of strings, 41-42\ncert_time_to_seconds() function, ssl mod-\nule, 488\nCGI script, 533\nadvice for writing, 537\nenvironment variables, 533\nexecuting XML-RPC server within,\n529\nrunning WSGI application, 542\nuse of databases, 538\nweb frameworks, 538\ncgi module, 533\nCGIHandler() function, wsgiref.handlers\nmodule, 542\nCGIHTTPRequestHandler class, http.server\nmodule, 507\nCGIHTTPServer module, see http.server,\n506\ncgitb module, 539\nCGIXMLRPCRequestHandler class,\nxmlrpc.server module, 528\nchain() function, itertools module, 270\nchained comparisons, 66\nchained exceptions, Python 3, 627\nchanging display of results, interactive\nmode, 176\nchanging module name on import, 144\nchanging the working directory, 379\nchanging user-agent header in HTTP\nrequests, 517\ncharacter substitution, 42\ncharacters() method, of ContentHandler\nobjects, 581\ncharacters\nescape codes, 28\nspecifying Unicode, 28\nchdir() function, os module, 379\ncheck_call() function, subprocess module,\n403\ncheck_unused_args() method, of Formatter\nobjects, 289\nchecking if running as main program, 146\nchecking multiple cases with a conditional,\n9\nchflags() function, os module, 386\nchicken, multithreaded, 414\nchildNodes attribute, of DOM Node objects,\n570\nchmod() function, os module, 387\nchoice() function, random module, 254\nchown() function, os module, 387\nchr() function, 77, 203\nchroot() function, os module, 379\nchunk module, 588\ncipher() method, of ssl objects, 487\ncircular buffer or queue with deque objects,\n262\ncl(ear) debugger command, pdb module,\n188\nclass decorators, 102, 141\nclass method, 48, 123\nattribute binding of, 124\npractical use of, 124\nclass statement, 21, 117\nand inheritance, 21, 119\nexecution of class body, 138\n646\ncancel_join_thread() method, of Queue objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2468,
      "extraction_method": "Direct"
    },
    {
      "page_number": 672,
      "chapter": null,
      "content": "class variables, 117\nsharing by all instances, 118\n__class__ attribute\nof instances, 50, 131\nof methods, 49\nclasses, 21\n__del__() method and garbage collec-\ntion, 221-222\n__init__() method, 118\n__init__() method and inheritance,\n120\n__slots__ attribute, 132\nabstract base class, 136, 257\naccess control specifiers, lack of, 127\naccessing in modules, 144\nand metaclasses, 138\nas callable, 50\nas namespaces, 117\nattribute binding rules, 118\nclass method, 203\ncreation of instances, 22, 55, 118\ncustomizing attribute access, 57-58\ndecorators applied to, 102, 141\ndefining methods, 21\ndescriptor attributes, 58, 126\ndifference from C++ or Java, 119\ninheritance, 21, 119\ninheriting from built-in types, 22\nmemory management, 128\nmixin, 122\nmultiple inheritance, 120-121\nobject base class, 119\nold-style, 139\noperating overloading, 54\noptimization of, 195\noptimization of inheritance, 233\nperformance of __slots__, 196\npickling of, 228\nprivate members, 26\nredefining attribute binding, 132\nscoping rules within, 118\nself parameter of methods, 119\nspecial methods, 54\nstatic methods, 22\nsuper() function in methods, 120\nsupporting pickle module, 228\ntype of, 47\nuniform access principle, 125\nversus dicts for storing data, 195\n@classmethod decorator, 48, 123, 125, 203\nClassType type, old-style classes, 139\ncleandoc() function, inspect module, 222\nclear() method\nof Element objects, 576\nof Event objects, 440\nof deque objects, 262\nof dicts, 45\nof sets, 46\nclear_flags() method, of Context objects,\n247\nclear_memo() method, of Pickler objects,\n228\n_clear_type_cache() function, sys module,\n233\nclearing a dictionary, 45\nclearing last exception, 233\nClient class, multiprocessing module, 433\nclient program, 449\nTCP example, 451\nUDP example, 486\nclient_address attribute\nof BaseHTTPRequestHandler objects,\n509\nof BaseRequestHandler objects, 490\nclock() function, time module, 191, 405\ncloneNode() method, of DOM Node objects,\n571\nclose() function, os module, 381\nclose() method\nof Connection objects, 297, 421\nof Cursor objects, 298\nof FTP objects, 498\nof HTMLParser objects, 561\nof HTTPConnection objects, 503\nof Handler objects, 364\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n647\nclose() method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2247,
      "extraction_method": "Direct"
    },
    {
      "page_number": 673,
      "chapter": null,
      "content": "of IOBase objects, 349\nof Listener objects, 434\nof Pool objects, 424\nof Queue objects, 418\nof TarFile objects, 320\nof TreeBuilder objects, 577\nof ZipFile objects, 325\nof dbm-style database objects, 310\nof dispatcher objects, 456\nof files, 159\nof generators, 20, 53, 103, 105\nof generators and synchronization, 104\nof mmap objects, 371\nof shelve objects, 311\nof socket objects, 478\nof urlopen objects, 515\nclose_when_done() method, of asynchat\nobjects, 452\nclosed attribute\nof IOBase objects, 349\nof files, 161\nclosefd attribute, of FileIO objects, 350\nclosefd parameter, to open() function, 159\nCloseKey() function, winreg module, 408\ncloserange() function, os module, 382\nclosing() function, contextlib module, 268\n__closure__ attribute, of functions, 48, 100\nclosures, 98-99\nand decorators, 101\nand nested functions, 99\nand wrappers, 100\nspeedup over classes, 100\ncmath module, 251\ncmd module, 588\ncmp() function, 203\nfilecmp module, 314\ncmpfiles() function, filecmp module, 314\nco_* attributes, of code objects, 51-52\ncode execution, in modules, 143-144\ncode migration\nPython 2 to 3, 634\npractical strategy for, 637\ncode module, 585\ncode objects, 51\nattributes of, 51\ncreating with compile() function, 115\ncode point, Unicode, 28\n__code__ attribute, of functions, 48\ncode, executing strings, 115\nCodecInfo class, codecs module, 277\ncodecs module, 167, 277\nremoval of compression codecs, 280\nuse of byte strings, 280\ncoded_value attribute, of Morsel objects,\n512\ncodeop module, 585\nCodeType type, 51, 237\n__coerce__() method, deprecation of, 134\ncoercion of numeric types, 66-67\ncollect function, gc module, 179\ncollect() function, gc module, 220\ncollect_incoming_data() method, of asyn-\nchat objects, 452\ncollection, definition of, 33\ncollections module, 138, 262\ncolorsys module, 588\ncombinations() function, itertools module,\n271\ncombine() method, of datetime class, 339\ncombining() function, unicodedata module,\n294\ncommand attribute, of\nBaseHTTPRequestHandler objects, 509\ncommand line options, 13, 157\nPython 3, 633\ndetecting settings in a program, 230\nfor interpreter, 173\nparsing with optparse, 374\ncommands debugger command, pdb mod-\nule, 188\ncommands module, 331\ncomment attribute, of ZipInfo objects, 327\nComment() function, xml.etree.ElementTree\nmodule, 575\ncomments, 6, 26\ncommit() method, of Connection objects,\n298\n648\nclose() method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2373,
      "extraction_method": "Direct"
    },
    {
      "page_number": 674,
      "chapter": null,
      "content": "common attribute, of dircmp objects, 315\ncommon_dirs attribute, of dircmp objects,\n315\ncommon_files attribute, of dircmp objects,\n315\ncommon_funny attribute, of dircmp objects,\n315\ncommonprefix() function, os.path module,\n396\ncommunicate() method, of Popen objects,\n403\ncomparison operators, 56\ncomparison, 66\nPython 3, 633\nchained, 66\nof incompatible objects, 78\nof objects, 34\nof sequences, 70\nof weak references, 242\ncompilation into bytecode, 148\ncompile() function, 115, 203\nre module, 283-284\ncompileall module, 585\ncompiler, lack of, 181\ncomplete_statement() function, sqlite3\nmodule, 305\nComplex abstract base class, 253\ncomplex numbers, 27, 39\ncmath library module, 251\ncomparison of, 66\ncomplex type, 38\ncomplex() function, 76, 203\n__complex__() method, 61-62\nand type coercion, 134\ncomposing email messages, 555\ncomposite string formatting, 8, 42, 72\nand __format__(), 56\nand lookups, 42\ncompress() function\nbz2 module, 314\nzlib module, 328\ncompress() method\nof BZ2Compressor objects, 313\nof compressobj objects, 328\ncompress_size attribute, of ZipInfo objects,\n327\ncompress_type attribute, of ZipInfo objects,\n327\ncompression\nof files, 313, 317\nzlib compression, 328\nCompressionError exception, tarfile module,\n322\ncompressobj() function, zlib module, 328\ncomputed attributes and properties, 124\nconcat() function, operator module, 274\nconcatenation\nof adjacent string literals, 27\nof lists, 12\nof strings, 11\nconcurrency, 413\nadvice on multiprocessing, 435\nand Python programs, 414\nand side effects, 96\ncoroutines, 446\nglobal interpreter lock, 414\nlimitations on multicore, 414\nmessage passing, 413-415\nmultitasking with generators, 447\nscaling issues, 415\nsynchronization problems, 414\nconcurrent programming, 413\nCondition object\nmultiprocessing module, 427\nthreading module, 441\ncondition debugger command, pdb module,\n188\ncondition variable, 441\nCondition() method, of Manager objects,\n429\nconditional expressions, 79\nconditionals, 9, 81\nConfigParser class, configparser module,\n332\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n649\nConfigParser class, configparser module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2145,
      "extraction_method": "Direct"
    },
    {
      "page_number": 675,
      "chapter": null,
      "content": "configparser module, 332\nconfiguration files, 332\ndifference from Python script, 334-335\nfor logging module, 368\nvariable substitution, 335\nconfstr() function, os module, 395\nconjugate() method\nof complex numbers, 39\nof floating point, 39\nconnect() function\ndatabase API, 297\nsqlite3 module, 304\nconnect() method\nof BaseManager objects, 431\nof FTP objects, 498\nof HTTPConnection objects, 503\nof SMTP objects, 514\nof dispatcher objects, 456\nof socket objects, 478\nconnect_ex() method, of socket objects,\n478\nconnecting processes, multiprocessing\nmodule, 433\nConnection class\ndatabase API, 297\nsqlite3 module, 305\nConnectRegistry() function, winreg module,\n408\nconsole window, Windows, 176\nContainer abstract base class, 265\ncontainer objects, 29\nand reference counting, 34\ndefinition of, 33\ncontainment test, in operator, 9\ncontains() function, operator module, 274\n__contains__() method, 58\nContentHandler class, xml.sax module, 581\nContentTooShort exception, urllib.error\nmodule, 523\nContext class, decimal module, 244\ncontext management protocol, 62\ncontext managers, 62, 89\ndecimal module, 248\ndefining with generator, 267\nlocking, 442\nnested, 267\n__context__ attribute, of Exception objects,\n213, 627\ncontextlib module, 90, 267\n@contextmanager decorator, 90\ncontinue statement, 83-84\ncontrol characters, stripping from a string,\n42\nconversion of strings to numbers, 11\nconversion operations, 76\nconvert_field() method, of Formatter\nobjects, 289\nconverting Python types to C, 611\nconverting dictionaries to a list, 16\nconverting sequences to a list, 77\nconverting sequences to a set, 15\nconverting sequences to a tuple, 77\nconverting types from C to Python, 602\nconverting types from Python to C, 597\nCookie module, see http.cookies, 511\nCookieError exception, http.cookies mod-\nule, 513\nCookieJar class, http.cookiejar module, 513\ncookielib module, see http.cookiejar, 513\ncookies\nHTTP, 511\nfetching URLs with cookie support,\n519\ncopy module, 36, 67, 219\nlimitations of, 220\ncopy() function\ncopy module, 219\nshutil module, 318\ncopy() method\nof Context objects, 247\nof dicts, 45\nof digest objects, 559\nof hmac objects, 560\nof sets, 46\ncopy2() function, shutil module, 318\n__copy__() method, 220\ncopy_reg module, 585\n650\nconfigparser module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2265,
      "extraction_method": "Direct"
    },
    {
      "page_number": 676,
      "chapter": null,
      "content": "copyfile() function, shutil module, 318\ncopyfileobj() function, shutil module, 318\ncopying directories, 318\ncopying files, 318\ncopying\nand reference counting, 35\ndeep copy, 36\ndictionary, 45\nof mutable objects, 35\nshallow copy, 36\ncopymode() function, shutil module, 318\ncopyright variable, sys module, 230\ncopysign() function, math module, 251\ncopystat() function, shutil module, 318\ncopytree() function, shutil module, 318\n@coroutine decorator example, 105\ncoroutines, 20, 104\nadvanced example, 460\nasynchronous I/O handling, 460\nbuilding a call stack of, 463\nconcurrency, 108\nconcurrent programming, 446\nexample of, 20\nexecution behavior, 105\nmessage passing, 108, 415\nmultitasking example, 447\npractical use of, 107\nrecursion, 112\nsending and returning values, 106\ntask scheduler with select(), 460\ntransferring control to another corou-\ntine, 463\nuse of next() method, 104\nuse with network programming, 467\ncos() function, math module, 251\ncosh() function, math module, 251\ncount() function, itertools module, 271\ncount() method\nof array objects, 260\nof lists, 40\nof strings, 42\ncounting, in loops, 83\ncountOf() function, operator module, 274\ncp1252 encoding, description of, 169\ncp437 encoding, description of, 169\ncPickle module, 229\ncProfile module, 190\nCPU time, obtaining, 191, 405\nCPU, obtaining number on system, 434\nCPU-bound tasks and threads, 444\ncpu_count() function, multiprocessing mod-\nule, 434\nCRC attribute, of ZipInfo objects, 327\ncrc32() function\nbinascii module, 548\nzlib module, 328\ncrc_hqx() function, binascii module, 548\ncreate_aggregate() method, of Connection\nobjects, 305\ncreate_collation() method, of Connection\nobjects, 306\ncreate_connection() function, socket mod-\nule, 473\ncreate_decimal() method, of Context\nobjects, 247\ncreate_function() method, of Connection\nobjects, 305\ncreate_socket() method, of dispatcher\nobjects, 456\ncreate_string_buffer() function, ctypes mod-\nule, 617\ncreate_system attribute, of ZipInfo objects,\n327\ncreate_unicode_buffer() function, ctypes\nmodule, 617\ncreate_version attribute, of ZipInfo objects,\n327\ncreated attribute, of Record objects, 359\nCreateKey() function, winreg module, 408\ncreating a Windows installer, 153\ncreating a binary distribution, 153\ncreating a source distribution, 153\ncreating custom string formatters, 288\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n651\ncreating custom string formatters\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2434,
      "extraction_method": "Direct"
    },
    {
      "page_number": 677,
      "chapter": null,
      "content": "creating programs, 6\ncreating random numbers, 254\ncreating user-defined instances, 22\ncreation of instances, 118\nsteps involved, 129\ncreation of .pyc and .pyo files, 148\ncritical sections, locking of, 414\ncritical() method, of Logger objects, 357\ncrypt module, 586\ncrytographic hashing functions, 559\nCSV data, example of reading, 14\nCSV files\nparsing, 548\ntype conversion of columns, 37\ncsv module, 548\nctermid() function, os module, 379\nctime() function, time module, 405\nctime() method, of date objects, 337\nCtrl-C, keyboard interrupt, 162\nctypes module, 612\narray types, 614\navailable datatypes, 614\ncasting datatypes, 617\ncreating byte strings, 617\ncreating objects from buffers, 616\nexample of, 618\nfinding library modules, 612\nloading shared libraries, 612\nmemory copying, 617\npassing pointers and references, 615\npointer types, 614\nsetting function prototypes, 613\nshared data with multiprocessing, 426\nstructure types, 615\ncunifvariate() function, random module,\n255\ncurdir variable, os module, 386\ncurly braces, and dictionary, 16\ncurrent time, obtaining, 405\n_current_frames() function, sys module,\n233\ncurrent_process() function, multiprocessing\nmodule, 434\ncurrent_thread() function, threading mod-\nule, 443\ncurrentframe() function, inspect module,\n222\ncurrying, and partial function evaluation,\n76\ncurses module, 586\nCursor class, database API, 298\ncursor() method, of Connection objects,\n298\ncwd() method, of FTP objects, 498\ncycle() function, itertools module, 271\ncycles, and garbage collection, 35\ncyclic data structures, and __del__()\nmethod, 129\nD\nd(own) debugger command, pdb module,\n188\ndaemon attribute\nof Process objects, 416\nof Thread objects, 436\ndaemonic process, 415\ndaemonic thread, 436\ndangling comma\nand print statement, 10\nand tuples, 14\nprint statement, 162\ndata attribute, of DOM Text objects, 572\ndata encapsulation, 127\ndata structures\nand dictionaries, 16\nlists and tuples, 14\nnamed tuples, 264\ndata() method, of TreeBuilder objects, 577\ndata-flow processing, and coroutines, 107\ndatabase API, 297\ndatabase interface, 297\nand threads, 302\ndatabase results, converting into dictionar-\nies, 303\n652\ncreating programs\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2174,
      "extraction_method": "Direct"
    },
    {
      "page_number": 678,
      "chapter": null,
      "content": "database\nand CGI script, 538\npersistent dictionary, 171\nDatabaseError exception, database API,\n302\ndatabases, DBM-style, 310\nDataError exception, database API, 302\nDatagramHandler class, logging module,\n362\nDatagramRequestHandler class,\nSocketServer module, 491\ndatagrams, 470\ndate and time manipulation, 336\ndate class, datetime module, 336\ndate parsing, 343, 407\nDate() function, database API, 301\ndate() method, of datetime objects, 340\ndate_time attribute, of ZipInfo objects, 327\nDateFromTicks() function, database API,\n301\ndatetime class, datetime module, 339\ndatetime module, 336\nDateTime() function, xmlrpc.client module,\n526\nday attribute, of date objects, 337\ndaylight variable, time module, 405\ndbhash module, 310\ndbm module, 310\nDBM-style databases, 310\ndeadlock, source with locking, 442\ndebug attribute\nof TarFile objects, 320\nof ZipFile objects, 325\nof sys.flags, 230\n__debug__ variable, 91, 369\ndebug() method, of Logger objects, 357\ndebugging\nCGI scripts, 539\nafter an uncaught exception, 186\nchecking for memory leaks, 221\nconfiguring the debugger, 190\nentire programs from command shell,\n189\nmanually setting a breakpoint, 186\npdb module, 186\nrunning a function, 186\nspecifying a breakpoint, 187\nuse of logging module, 355\nDecimal class, decimal module, 243\nDecimal object, converting to a fraction,\n250\ndecimal module, 39, 243\nand sum() function, 69\nand threads, 249\nrounding behavior, 245\ndecimal() function, unicodedata module,\n295\ndeclarative programming, 110\ndecode() function\nbase64 module, 547\nquopri module, 568\ndecode() method\nin Python 3, 629\nof CodecInfo objects, 277\nof IncrementalDecoder objects, 279\nof JSONDecoder objects, 565\nof strings, 29, 42, 165-166\nproper use of, 166\ndecodestring() function\nbase64 module, 547\nquopri module, 568\ndecomposition() function, unicodedata\nmodule, 295\ndecompress() function\nbz2 module, 314\nzlib module, 328\ndecompress() method\nof BZ2Decompressor objects, 314\nof decompressobj objects, 328\ndecompressobj() function, zlib module, 328\ndecorators, 22, 101\napplied to class definitions, 102, 141\ncopying function attributes, 269\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n653\ndecorators\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2208,
      "extraction_method": "Direct"
    },
    {
      "page_number": 679,
      "chapter": null,
      "content": "documentation strings, 102, 113\nexample of, 101\nmultiple, 31\nperformance benefits, 197\nplacement of, 30, 101\nrecursive functions, 102, 113\nuser-defined function attributes, 102,\n114\nwith arguments, 102\ndeep copy, 36\ndeepcopy() function, copy module, 219\n__deepcopy__() method, 220\ndef statement, 18, 48, 93\ndefault Unicode encoding, 166, 177\ndefault Unicode error handling policy, 167\ndefault arguments, 18, 93\nand mutable values, 94\nbinding of values, 93\ndefault() method, of JSONEncoder objects,\n566\ndefault_factory attribute, of defaultdict\nobjects, 263\nDefaultContext variable, decimal module,\n248\ndefaultdict() function, collections module,\n263\n__defaults__ attribute, of functions, 48\ndefaults() method, of ConfigParser objects,\n333\ndefects attribute, of Message objects, 554\ndefining functions, 18\ndefining multiple instance creation meth-\nods, 123\ndefining new exceptions, 88\ndegrees() function, math module, 251\ndel operator, on dictionaries, 16, 74\ndel statement, 35, 69\nand __del__() method, 129\nand slices, 40\ndeleting mapping items, 45\n__del__() method, 55, 129\nand program termination, 179\ndanger of defining, 129\ngarbage collection, 129, 221-222\nuses of, 55\ndel_param() method, of Message objects,\n556\ndelattr() function, 203\nand private attributes, 128\n__delattr__() method, 57-58, 131\ndelayed evaluation, 99\ndelayed execution, using threads, 437\ndelete() method, of FTP objects, 498\n__delete__() method, of descriptors, 58,\n126\nDeleteKey() function, winreg module, 409\n@deleter decorator of properties, 126\nDeleteValue() function, winreg module, 409\ndeleting items from a dictionary, 16\ndeleting sequence items, 40\ndeleting slices, 40, 69\ndeletion of instance attributes, 131\ndelimiters, 30\ndelitem() function, operator module, 274\n__delitem__() method, 58-59\nand slices, 59\ndelslice() function, operator module, 274\ndemo_app() function, wsgiref.simple_server\nmodule, 542\ndenominator attribute\nof Fraction objects, 250\nof integers, 39\nDeprecationWarning warning, 216, 238\ndeque object\ncollections module, 194\nversus list, 194\ndeque() function, collections module, 262\nDER_cert_to_PEM_cert() function, ssl mod-\nule, 488\ndereference attribute, of TarFile objects,\n320\nderived class, 119\ndescription attribute, of Cursor objects, 299\ndescriptors, 58, 126\nand metaclasses, 140\ndetecting end of file (EOF), 160\n654\ndecorators\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2360,
      "extraction_method": "Direct"
    },
    {
      "page_number": 680,
      "chapter": null,
      "content": "detecting the settings of interpreter com-\nmand line options, 230\ndevnull variable, os module, 386\nDialect class, csv module, 551\ndict type, 38\n__dict__ attribute\nof classes, 131\nof functions, 48, 114\nof instances, 50, 131\nof modules, 51, 144\nof types, 50\nof user-defined objects, 63\ndict() function, 16, 77, 204\nperformance properties, 195\ndict() method, of Manager objects, 429\ndictionary comprehension, Python 3, 623\ndictionary, 16, 44\nacceptable key types, 16\naccessing items, 16\nand Python 3 caution, 45\nand __hash__() method, 56\nand string formatting, 70, 72\nautomatic creation of initial values, 263\nclearing, 45\ncompared to defaultdict objects, 263\nconverting to a list, 16\ncopying, 45\ncreating from database results, 303\ncreation with dict() function, 204\ndefining empty, 16\ndeleting items, 16, 45\nequality of, 78\nindexing operator, 74\ninserting items, 16\nitem assignment, 74\nitem deletion, 74\niterating over keys, 17\nkey values, 44, 74\nlist of items, 45\nlookup in composite string formatting,\n42, 72\nlookup with default value, 16\nobtaining keys, 45-46\nobtaining values, 45\nperformance of, 16\nperformance of in operator, 197\npersistent with shelve module, 171\nremoving items, 16\nshared by multiple processes, 429\ntuples as keys, 74\nupdating, 45\nuse as a data structure, 16\nuse as a lookup table, 16\nusing functions as values, 37\nusing to pass keyword function argu-\nments, 95\nview objects in Python 3, 632\nDictReader() function, csv module, 550\ndicts, versus classes for storing data, 195\nDictWriter() function, csv module, 550\ndiff_files attribute, of dircmp objects, 315\ndifference operator -, of sets, 15\ndifference() method, of sets, 46\ndifference_update() method, of sets, 46\ndifflib module, 586\ndig attribute, of sys.float_info, 231\ndigest() method\nof digest objects, 559\nof hmac objects, 560\ndigest_size attribute, of digest objects, 559\ndigit() function, unicodedata module, 295\ndigits variable, string module, 287\ndir() function, 21, 24, 204\nhiding attribute names in classes, 128,\n204\ndir() method, of FTP objects, 498\n__dir__() method, 63, 128, 204\ndircmp() function, filecmp module, 314\ndirectories\ncomparing, 314\ncopying, 318\nreading files with shell wildcards, 317\nrecursive traversal, 390\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n655\ndirectories\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2330,
      "extraction_method": "Direct"
    },
    {
      "page_number": 681,
      "chapter": null,
      "content": "system functions for accessing, 386\ntemporary, 323\ntesting filenames for, 397\ndirname() function, os.path module, 396\ndis module, 585\ndis(), dis module, 193\ndisable debugger command, pdb module,\n188\ndisable() function\ngc module, 220\nlogging module, 366\ndisable_interspersed_args() method, of\nOptionParser objects, 376\ndisabling garbage collection, 220\ndisabling newline translation, 159\ndisassembly, 193\ndiscard() method, of sets, 47\ndiscard_buffers() method, of asynchat\nobjects, 452\ndispatcher class, asyncore module, 455\n__displayhook__ variable, sys module, 230\ndisplayhook() function, sys module, 176,\n233\ndisposition attribute, of FieldStorage\nobjects, 535\ndisposition_options attribute, of\nFieldStorage objects, 535\ndistributed computing, and multiprocessing\nmodule, 435\ndistributing programs, 152\ndistutils module, 152-153, 585, 596\nand extension modules, 596\ncreating binary distributions, 153\ncreating extensions with SWIG, 620\ndiv() function, operator module, 273\n__div__() method, 60\ndivision of integers, Python 3, 633\ndivision operator /, 65\ndivision operator, Python 2 versus Python\n3, 61\ndivision, truncation of integers, 61-62, 65\ndivision_new attribute, of sys.flags, 230\ndivision_warning attribute, of sys.flags, 230\ndivmod() function, 66, 204\n__divmod__() method, 60\ndllhandle variable, sys module, 230\nDLLs\ncreating with distutils, 596\nextension modules, 148\nloading with ctypes, 612\ndo_handshake() method, of ssl objects,\n487\n__doc__ attribute\nof built-in functions, 49\nof functions, 24, 48, 113\nof methods, 49\nof modules, 51\nof objects, 30\nof types, 50\nDocCGIXMLRPCRequestHandler class, xmlr-\npc.server module, 528\ndoctest module, 181-182\nverbose option, 182\nDocument class, xml.dom.minidom mod-\nule, 571\ndocumentation string, copying to decorator,\n269\ndocumentation strings, 24, 30, 48, 113\nand XML-RPC, 527\nand decorators, 102, 113\nand indentation, 30\ndoctest module, 181\nin extension modules, 595\nstripping with -OO option, 148\ntesting, 181\ndocumentElement attribute, of DOM\nDocument objects, 571\nDocXMLRPCServer class, xmlrpc.server\nmodule, 527\nDocXMLRPCServer module, 527\ndollar-variable substitution, 163\nDOM interface\nXML parsing, 568\nexample of, 573\ndont_write_bytecode attribute, of sys.flags,\n230\ndont_write_bytecode variable, sys module,\n230\n656\ndirectories\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2314,
      "extraction_method": "Direct"
    },
    {
      "page_number": 682,
      "chapter": null,
      "content": "double precision floating point, 38\ndouble-clicking on .py files, 6\ndouble-underscores, use in identifiers, 26\ndropwhile() function, itertools module, 271\ndst() method\nof time objects, 338\nof tzinfo objects, 342\nduck typing, 122\ndumbdbm module, 310\ndump() function\njson module, 564\nmarshal module, 226\npickle module, 171, 227\nxml.etree.ElementTree module, 578\ndump() method, of Pickler objects, 228\ndumps() function\njson module, 564\nmarshal module, 226\npickle module, 227\nxmlrpc.client module, 526\ndup() function, os module, 382\ndup2() function, os module, 382\ndynamic binding, of object attributes, 122\ndynamic loading, of modules, 144\ndynamic scope, lack of, 97\ndynamic typing of variables, 7\nE\n-E command line option, 173\ne variable, math module, 252\nEAI_* constants, socket module, 485\neast_asian_width() function, unicodedata\nmodule, 296\neasy_install command, setuptools package,\n155\n.egg files, 154\nand modules, 147\nand site configuration, 177\nstructure of, 147\nElement class, xml.dom.minidom module,\n572\nElement() function, xml.etree.ElementTree\nmodule, 575\nElementTree class, xml.etree.ElementTree\nmodule, 573\nElementTree interface, XML parsing, 569\nElementTree, examples of, 578\nelif statement, 9, 81\nEllipsis, 30, 51, 54\nexpression in Python 3, 626\ntype of, 51\nuse in extended slicing, 59\nuse in indexing methods, 54\nelse clause\nof try statement, 86\nof while and for loops, 84\nelse statement, 9, 81\nemail messages\ncomposing, 555\nexample of composing and sending,\n558\nexample of sending, 514\nparsing, 552\nemail package, 552\nEmax attribute, of Context objects, 247\nembedding Unicode characters in web\npages, 167\nembedding the interpreter in C programs,\n591, 608\nembedding\ncalling functions from C, 610\nconverting Python types to C, 611\nEmin attribute, of Context objects, 247\nEmpty exception, Queue module, 418, 445\nempty dictionary, 16\nempty list, 12\nempty() method, of Queue objects, 418,\n445\nenable debugger command, pdb module,\n188\nenable() function\ncgitb module, 539\ngc module, 220\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n657\nenable() function\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2118,
      "extraction_method": "Direct"
    },
    {
      "page_number": 683,
      "chapter": null,
      "content": "enable_callback_tracebacks() function,\nsqlite3 module, 305\nenable_interspersed_args() method, of\nOptionParser objects, 376\nenabling the print() function in Python 2.6,\n163\nencapsulation, 127\nencode() function\nbase64 module, 547\nquopri module, 568\nencode() method\nin Python 3, 629\nof CodecInfo objects, 277\nof IncrementalEncoder objects, 278\nof JSONEncoder objects, 566\nof strings, 42, 165-166\nproper use of, 166\nEncodedFile class, codecs module, 279\nEncodedFile object, codecs module, 167\nencodestring() function\nbase64 module, 547\nquopri module, 568\nencoding argument to open() function, 159\nencoding attribute\nof TextIOWrapper objects, 353\nof files, 161\nencoding issues with network program-\nming, 452\nencoding, of source code, 31\nend attribute, of slices, 54\nend keyword argument, to print() function,\n163\nend() method\nof MatchObject objects, 286\nof TreeBuilder objects, 577\nend_headers() method, of\nBaseHTTPRequestHandler objects, 509\nendDocument() method, of ContentHandler\nobjects, 581\nendElement() method, of ContentHandler\nobjects, 581\nendElementNS() method, of\nContentHandler objects, 581\nendheaders() method, of HTTPConnection\nobjects, 503\nendpos attribute, of MatchObject objects,\n286\nendPrefixMapping() method, of\nContentHandler objects, 581\nendswith() method, of strings, 42\n__enter__() method, of context managers,\n62, 89\nenumerate() function, 83, 204\nthreading module, 443\nEnumKey() function, winreg module, 409\nEnumValue() function, winreg module, 409\nenviron variable, os module, 158\nenviron variable, os module, 379\nenvironment variables, 158, 379\nPython 3, 633\nWSGI, 540\nexpanding in filenames, 397\nin CGI script, 533\nunsetting, 381\nused by interpreter, 174\nEnvironmentError exception, 87, 212\nEOF character, interactive mode, 7\nEOF indication, file I/O, 160\nEOFError exception, 87, 213\nepilogue attribute, of Message objects, 554\nepoll interface, Linux, 460\nepsilon attribute, of sys.float_info, 231\neq() function, operator module, 274\n__eq__() method, 57\nequal to operator ==, 66, 78\nequality comparison of objects, 34\nerrcheck attribute, of ctypes function\nobjects, 613\nerrno module, 343\nerror codes, list of system errors, 344\nerror exception, 396\nsocket module, 485\nerror messages, 157\nerror() method, of Logger objects, 357\nerror_message_format attribute, of\nBaseHTTPRequestHandler class, 508\nerrorcode variable, errno module, 344\nerrorlevel attribute, of TarFile objects, 320\n658\nenable_callback_tracebacks() function, sqlite3 module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2482,
      "extraction_method": "Direct"
    },
    {
      "page_number": 684,
      "chapter": null,
      "content": "errors attribute, of TextIOWrapper objects,\n353\nerrors parameter\nof encoding functions, 166\nto open() function, 159\nescape codes\ndisabling in a string literal, 29\nin string literals, 27\nnon-printing characters, 28\nescape() function\ncgi module, 536\nre module, 283\nxml.sax.saxutils module, 583\nescaping characters for use in HTML, 536\neval() function, 55, 77, 115, 204, 206\nand repr(), 55\nevaluation\nof function arguments, 76\noperator precedence and associativity,\n78\norder of, 78\nEvent object\nmultiprocessing module, 427\nthreading module, 440\nevent loop\nand asyncore module, 455\ncoroutines, 108\nEvent() method, of Manager objects, 429\nevent-driven I/O, 415\npolling for signals, 399\nwhen to consider, 467\nEX_* exit code constants, 391\nexc_clear() function, sys module, 233\nexc_info attribute, of Record objects, 359\nexc_info() function, sys module, 53, 89,\n233\nexcept statement, 22, 84-85\nchange of syntax, 85\n__excepthook__ variable, sys module, 230\nexcepthook() function, sys module, 85, 233\nException class, 212\nException exception, 87\nexception handling, in extension modules,\n605\nexception() method, of Logger objects, 358\nexceptions, 22, 84-85\nand locks, 23\nattributes of, 212\ncatching all, 85\ncatching multiple types, 85\ncaution with catching all exceptions, 86\nchained in Python 3, 626\nclearing last exception, 233\ndefining new, 88\ndifference from warnings, 216\nerror codes for system errors, 344\nfinally statement, 86\nhandling of, 22-23\nhierarchy of, 88\nignoring, 85\nlist of built-in, 87\nmatching rules, 85\noptimization strategies, 196\nperformance of, 197\npropagation of, 85\nreraising the last exception, 84\nvalue of, 23, 85\n.exe file, creating with distutils, 153\nexec statement, caution with legacy code,\n115\nexec() function, 115, 204\nPython 3, 631\nexec_prefix variable, sys module, 177, 230\nexecl() function, os module, 390\nexecle() function, os module, 390\nexeclp() function, os module, 390\nexecutable variable, sys module, 230\nexecute() method\nof Connection objects, 306\nof Cursor objects, 298\nexecutemany() method\nof Connection objects, 306\nof Cursor objects, 298\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n659\nexecutemany() method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2203,
      "extraction_method": "Direct"
    },
    {
      "page_number": 685,
      "chapter": null,
      "content": "executescript() method, of Connection\nobjects, 306\nexecuting programs, 6\nexecuting strings as code, 115\nexecuting system commands, 331\npopen() function, 392\nsubprocess module, 402\nsystem() function, 393\nexecution model, 81\nexecution of __init__.py files, 150\nexecution of class bodies, 117, 138\nexecv() function, os module, 390\nexecve() function, os module, 391\nexecvp() function, os module, 391\nexecvpe() function, os module, 391\nexists() function, os.path module, 396\n_exit() function, os module, 179, 391\nexit() function, sys module, 179, 233\n__exit__() method, 63\nof context managers, 62, 89\nexitcode attribute, of Process objects, 417\nexp() function, math module, 251\nexp() method, of Decimal objects, 243\nexpand() method, of MatchObject objects,\n285\nExpandEnvironmentStrings() function, win-\nreg module, 409\nexpandtabs() method, of strings, 41-42\nexpanduser() function, os.path module, 397\nexpandvars() function, os.path module, 397\nexponents, range on floating point, 38\nexpovariate() function, random module,\n255\nexpressions, 7\nextend() method\nof array objects, 260\nof deque objects, 262\nof lists, 40\nextended slices, 39, 59\nassignment to, 40, 69\ndeletion of, 40, 69\non sequences, 68\nextended slicing operator [::], 67\nextended unpacking of iterables, Python 3,\n623\nExtendedContext, decimal module, 248\nextending with C, 591\nextendleft() method, of deque objects, 262\nextensible code, with modules, 144\nextension modules, 591\ncompilation with distutils, 596\nconverting types from C to Python,\n602\nconverting types from Python to C,\n597\nctypes module, 612\ndifference in Python 3, 595\ndocumentation strings, 595\nexception handling, 605\nglobal interpreter lock, 607\nhand-written, 593\nmanual compilation, 597\nnaming of, 595\nreference counting, 607\nthreads, 607\nwrapper functions, 594\nExtension() function, distutils module, 596\nextensions_map attribute, of\nHTTPRequestHandler class, 508\nexternal_attr attribute, of ZipInfo objects,\n327\nextra attribute, of ZipInfo objects, 327\nextract() method\nof TarFile objects, 320\nof ZipFile objects, 325\nextract_stack() function, traceback module,\n236\nextract_tb() function, traceback module,\n236\nextract_version attribute, of ZipInfo objects,\n327\nextractall() method, of ZipFile objects, 325\nExtractError exception, tarfile module, 322\nextractfile() method, of TarFile objects, 320\nextsep variable, os module, 386\n660\nexecutescript() method, of Connection objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2429,
      "extraction_method": "Direct"
    },
    {
      "page_number": 686,
      "chapter": null,
      "content": "F\nF_* constants, fcntl() function, 347\nf_* attributes\nof frame objects, 52\nof statvfs objects, 389\nfabs() function, math module, 251\nfactorial() function, math module, 251\nfail() method, of TestCase objects, 185\nfailIf() method, of TestCase objects, 185\nfailIfAlmostEqual() method, of TestCase\nobjects, 185\nfailIfEqual() method, of TestCase objects,\n185\nfailUnless() method, of TestCase objects,\n185\nfailUnlessAlmostEqual() method, of\nTestCase objects, 185\nfailUnlessEqual() method, of TestCase\nobjects, 185\nfailUnlessRaises() method, of TestCase\nobjects, 185\nfailureException attribute, of TestCase\nobjects, 185\nFalse value, 9, 27, 38\nfamily attribute, of socket objects, 484\nFault exception, xmlrpc.client module, 527\nfchdir() function, os module, 379\nfchmod() function, os module, 382\nfchown() function, os module, 382\nfcntl module, 347\nfcntl() function, fcntl module, 347\nfdatasync() function, os module, 382\nfdopen() function, os module, 382\nfeed() method, of HTMLParser objects, 561\nfetchall() method, of Cursor objects, 299\nfetching URLs\nexample of, 514\nexample with authentication, 519\nexample with cookies, 519\nfetchmany() method, of Cursor objects, 299\nfetchone() method, of Cursor objects, 298\nFieldStorage() function, cgi module, 534\nfile I/O, 10\nfile attribute, of FieldStorage objects, 535\nfile descriptors, 347\nfunctions for manipulation, 382\nfile keyword argument, to print() function,\n10, 163\nfile locking, 348\nWindows, 373\nby sqlite3 module, 303\nfile modes, use with open() function, 159\nfile upload, in CGI scripts, 536\n__file__ attribute, of modules, 51\nfile-like objects, 122\nfile_offset attribute, of ZipInfo objects, 327\nfile_size attribute, of ZipInfo objects, 327\nfilecmp module, 314\nfileConfig() function, logging module, 367\nFileCookieJar class, http.cookiejar module,\n513\nFileHandler class\nlogging module, 362\nurllib.request module, 518\nFileIO class, io module, 350\nfilename attribute\nof FieldStorage objects, 535\nof Record objects, 359\nof ZipInfo objects, 327\nfilenames\nWindows drive letters, 399\nabsolute path of, 396\nin Python 3, 633\nmatching with shell wildcards, 316\nportable manipulation of, 396\nsplitting into directory and base name,\n398\ntesting for existence, 396\ntesting if directory, 397\ntesting if link, 397\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n661\nfilenames\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2363,
      "extraction_method": "Direct"
    },
    {
      "page_number": 687,
      "chapter": null,
      "content": "fileno() method\nof Connection objects, 421\nof IOBase objects, 349\nof SocketServer objects, 491\nof files, 160-161\nof files and sockets, 459\nof socket objects, 478\nof urlopen objects, 515\nfiles, 10\nabsolute path of, 396\nand Python 3, 160\nattributes of, 161\nbuffer size, 159\nbuffered binary I/O, 351\nbz2 compression, 313\ncomparing, 314\ncopying, 318\ncreation time, 397\ndecoding as Unicode, 167\ndescription of file modes, 159\ndetecting end of file (EOF), 160\nfile pointer, 161, 352\nfinding on the filesystem, 390\nfunctions for manipulating metadata,\n386\ngzip compression, 317\niterating over lines, 17-18\nlast modification time, 397\nlocking on Windows, 373\nlow-level control, 347\nlow-level system calls, 382\nmemory mapped, 370\nmethods on, 159\nopening, 10, 158-159\nopening with Unicode decoding, 167\nparsing CSV, 548\nproblems with io library module, 354\nraw binary I/O, 350\nreading line by line, 10\nseeking, 161\nsize of, 397\nsoftspace attribute and print statement,\n162\ntemporary, 323\ntesting for existence, 396\ntypes of, 159\nwriting to, 159\nfill characters in string format specifiers,\n73\nFilter class, logging module, 359\nfilter() function, 205\nand Python 3, 205\nand optimization, 197\nfnmatch module, 316\nfuture_builtins module, 217\nfilterwarnings() function, warnings module,\n239\nfinally statement, 86\nand locks, 442\nfind() method\nof Element objects, 576\nof ElementTree objects, 574\nof mmap objects, 371\nof strings, 41-42\nfind_library() function, ctypes module, 612\nfindall() function, re module, 283\nfindall() method\nof Element objects, 576\nof ElementTree objects, 574\nof Regex objects, 285\nfindCaller() method, of Logger objects, 358\nfinding all loaded modules, 144\nfinding files, 390\nfinditer() function, re module, 284\nfinditer() method, of Regex objects, 285\nfindtext() method\nof Element objects, 576\nof ElementTree objects, 574\nfinish() method, of BaseRequestHandler\nobjects, 490\nfirst-class objects, 36\nuse of, 37\nfirstChild attribute, of DOM Node objects,\n570\nflag_bits attribute, of ZipInfo objects, 327\nflags attribute\nof Context objects, 247\nof Regex objects, 284\nflags variable, sys module, 230\n662\nfileno() method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2145,
      "extraction_method": "Direct"
    },
    {
      "page_number": 688,
      "chapter": null,
      "content": "flaming death, in extension modules, 595\nfloat type, 38\nfloat() function, 13, 62, 76, 205\n__float__() method, 61-62\nand type coercion, 134\nfloat_info variable, sys module, 231\nfloating point, 27\nas dictionary key, 16\nbinary representation, 39\ncompared to decimal numbers, 243\nconverting to a fraction, 39, 250\ndefining NaN and Inf, 213, 252\ninexact representation, 12, 243\nlow-level properties of, 231\nmixing with complex numbers, 39\nprecision of, 38\nrandom number distributions, 255\nrepresentation of, 38\nFloatingPointError exception, 87, 213\nflock() function, fcntl module, 348\nfloor division, 65\nfloor() function, math module, 251\nfloordiv() function, operator module, 273\n__floordiv__() method, 60\nflush() method\nof BZ2Compressor objects, 314\nof BufferWriter objects, 352\nof Handler objects, 364\nof IOBase objects, 349\nof compressobj objects, 328\nof decompressobj objects, 329\nof files, 160\nof mmap objects, 371\nFlushKey() function, winreg module, 409\nfma() method, of Decimal objects, 243\nfmod() function, math module, 251\nfnmatch module, 316\nfnmatch() function, fnmatch module, 316\nfnmatchcase() function, fnmatch module,\n316\nfoot, how to shoot, 36, 86, 442, 617\nfor statement, 10, 17, 59, 69, 82\nand files, 10, 160\nand generators, 19\nand tuple unpacking, 15\nforcing garbage collection, 220\nforeign function interface, ctypes module,\n612\nfork() function, os module, 391\nForkingMixIn class, SocketServer module,\n493\nForkingTCPServer class, SocketServer mod-\nule, 494\nForkingUDPServer class, SocketServer mod-\nule, 494\nforkpty() function, os module, 392\nformat attribute, of Struct objects, 291\nformat codes\nfor dates and times, 406\nfor string formatting operator %, 70-71\nformat specifiers\nalignment characters, 73\ncustomized, 74\nfill character, 73\nformat() method of strings, 72-74\nnesting of fields, 74\nformat() function, 8, 11-12, 56, 77, 205\nformat() method\nformat specifier codes, 72\nof Formatter objects, 288\nof strings, 8, 42-43, 56, 72-73, 162\nof strings and variable interpolation,\n164\n__format__() method, 55-56, 74\nformat_exc() function, traceback module,\n236\nformat_exception() function, traceback\nmodule, 236\nformat_exception_only() function, traceback\nmodule, 236\nformat_list() function, traceback module,\n236\nformat_stack() function, traceback module,\n236\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n663\nformat_stack() function, traceback module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2423,
      "extraction_method": "Direct"
    },
    {
      "page_number": 689,
      "chapter": null,
      "content": "format_tb() function, traceback module,\n236\nformat_value() method, of Formatter\nobjects, 289\nformatargspec() function, inspect module,\n222\nformatargvalues() function, inspect module,\n222\nformatted printing, 8, 70-71, 162\nformatted strings, 42, 71-72\nFormatter class\nlogging module, 365\nstring module, 288\nformatter module, 587\nformatting, of log messages, 358, 365\nformatwarning() function, warnings module,\n239\nFortran common blocks, lack of, 146\nfound_terminator() method, of asynchat\nobjects, 453\nfpathconf() function, os module, 382\nfpectl module, 585\nfpformat module, 586\nFraction class, fractions module, 250\nfractions module, 39, 250\nfragment attribute\nof urlparse objects, 520\nof urlsplit objects, 521\nframe objects, 51-52\nattributes of, 52\nFrameType type, 51, 237\nfree variables, in functions, 98\nfreeze_support() function, multiprocessing\nmodule, 434\nfrexp() function, math module, 251\nfrom __future__ import, 178\nfrom module import *, 24, 145\nglobal variables, 146\nidentifiers with underscores, 26\n__all__ variable, 145\nfrom statement\nand import statement, 24\nmodule imports, 145\nfrom_address() method, of ctypes type\nobjects, 616\nfrom_buffer() method, of ctypes type\nobjects, 616\nfrom_buffer_copy() method, of ctypes type\nobjects, 616\nfrom_decimal() method, of Fraction class,\n250\nfrom_float() method, of Fraction class, 250\nfrom_iterable() method, of objects, 270\nfrom_param() method, of ctypes type\nobjects, 616\nfromfd() function, socket module, 473\nfromfile() method, of array objects, 260\nfromhex() method, of floating point, 39\nfromkeys() method, of dicts, 45\nfromlist() method, of array objects, 260\nfromordinal() method\nof date class, 336\nof datetime class, 339\nfromstring() function,\nxml.etree.ElementTree module, 575\nfromstring() method, of array objects, 260\nfromtimestamp() method\nof date class, 336\nof datetime class, 339\nfromutc() method, of tzinfo objects, 342\nfrozenset type, 38, 46, 75\nfrozenset() function, 77, 205\nfstat() function, os module, 383\nfstatvfs() function, os module, 383\nfsum() function, math module, 251\nfsync() function, os module, 383\nFTP server, uploading files to, 500\nFTP() function, ftplib module, 497\nFTPHandler class, urllib.request module,\n518\nftplib module, 497\nftruncate() function, os module, 383\nFull exception, Queue module, 418, 445\nfull() method, of Queue objects, 418, 445\nfunc attribute, of partial objects, 268\n__func__ attribute, of methods, 49\n664\nformat_tb() function, traceback module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2473,
      "extraction_method": "Direct"
    },
    {
      "page_number": 690,
      "chapter": null,
      "content": "funcName attribute, of Record objects, 359\nfunction call operator (), 47, 76\nfunctions, 18\n__doc__ attribute, 24\nand coroutines, 20\nand generators, 19\nannotations in Python 3, 624\nanonymous, 112\nas closures, 98\nas dictionary values, 37\nas objects, 98\nattributes and decorators, 102\nattributes of, 48\nbinding of default values, 93\nbuilt-in, 201\ncallback, 98\ncalling, 18, 93\nchange in func_* attribute names, 48\nchanging recursion limit, 112, 235\ncopying attributes to decorator, 269\ncreating wrappers for, 100\ndecorators, 101\ndecorators and attributes, 114\ndefault arguments, 18, 93\ndefining, 93\ndelayed execution with threads, 437\ndocumentation strings, 48, 113\nevaluation of arguments, 76\nexample of taking any number of argu-\nments, 95\nfree variables, 98\nkeyword arguments, 18, 94\nlambda operator, 112\nmodifying global variables, 18\nmutable parameters, 95\nnested, 97, 99\noptional arguments and None, 38\nparameter passing, 95\npartial evaluation, 76, 268\npickling of, 228\nrecursion, 112\nreturning multiple values from, 18, 96\nrunning in the debugger, 186\nscoping rules, 18, 96\nside effects, 95\ntermination functions, 219\ntype of built-in, 49\ntype of user-defined, 47\nuser-defined, 48\nuser-defined attributes, 114\nvariable arguments, 94\nvariable number of keyword arguments,\n95\nFunctionType type, 47, 237\nfunctools module, 76, 114, 268\nfunctor, 62\nfunny_files attribute, of dircmp objects, 315\nfuture features, enabling, 178\n__future__ module, 178\nand division, 62\nlist of features, 178\nfuture_builtins module, 217\nFutureWarning warning, 216, 238\nfuzzy date and time parsing, 343\nG\ngaierror exception, socket module, 485\ngammavariate() function, random module,\n255\ngarbage collection, 34-35, 220\nand __del__() method, 129\nand cycles, 35\nand program termination, 179\ndescription of process, 221\nobserver pattern example, 130\nproblem with __del__() method, 221\ngarbage variable, gc module, 220\ngauss() function, random module, 255\ngc module, 35, 179, 220\ngcd() function, fractions module, 251\ngdbm module, 310\nge() function, operator module, 274\n__ge__() method, 56\ngenerator expressions, 109-110\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n665\ngenerator expressions\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2221,
      "extraction_method": "Direct"
    },
    {
      "page_number": 691,
      "chapter": null,
      "content": "conditional expressions, 79\nconverting into a list, 110\ndifference from list comprehension, 110\ngenerator function, and context managers,\n90\ngenerator objects, 51, 53\nattributes of, 53\nGeneratorExit exception, 87, 104, 213\ngenerators, 19, 102-103\nand break statement in iteration, 103\nand memory efficiency, 107\nand processing pipelines, 19\nclosing, 53\nconcurrent programming, 446\nexecution model, 19\nhandling of GeneratorExit exception,\n213\nmultitasking example, 447\npractical use of, 106\nrecursion, 112\nthrowing exception in, 53\nuse with I/O, 164-165\nuse with WSGI, 165\nGeneratorType type, 51, 237\nget() function, webbrowser module, 544\nget() method\nof AsyncResult objects, 425\nof ConfigParser objects, 333\nof Element objects, 576\nof Message objects, 552\nof Queue objects, 418, 445\nof dicts, 16, 45\n__get__() method, of descriptors, 58, 126\nget_all() method, of Message objects, 552\nget_boundary() method, of Message\nobjects, 552\nget_charset() method, of Message objects,\n553\nget_charsets() method, of Message objects,\n553\nget_content_charset() method, of Message\nobjects, 553\nget_content_maintype() method, of\nMessage objects, 553\nget_content_subtype() method, of Message\nobjects, 553\nget_content_type() method, of Message\nobjects, 553\nget_count() function, gc module, 221\nget_data() method, of Request objects, 517\nget_debug() function, gc module, 221\nget_default_type() method, of Message\nobjects, 553\nget_dialect() function, csv module, 551\nget_errno() function, ctypes module, 617\nget_field() method, of Formatter objects,\n288\nget_filename() method, of Message\nobjects, 553\nget_full_url() method, of Request objects,\n517\nget_host() method, of Request objects, 517\nget_last_error() function, ctypes module,\n617\nget_logger() function, multiprocessing mod-\nule, 435\nget_method() method, of Request objects,\n517\nget_nowait() method, of Queue objects,\n418, 445\nget_objects() function, gc module, 221\nget_origin_req_host() method, of Request\nobjects, 517\nget_osfhandle() function, msvcrt module,\n372\nget_param() method, of Message objects,\n553\nget_params() method, of Message objects,\n553\nget_payload() method, of Message objects,\n554\nget_referents() function, gc module, 221\nget_referrers() function, gc module, 221\nget_selector() method, of Request objects,\n517\nget_server_certificate() function, ssl mod-\nule, 488\nget_starttag_text() method, of HTMLParser\nobjects, 561\n666\ngenerator expressions\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2421,
      "extraction_method": "Direct"
    },
    {
      "page_number": 692,
      "chapter": null,
      "content": "get_terminator() method, of asynchat\nobjects, 453\nget_threshold() function, gc module, 221\nget_type() method, of Request objects, 517\nget_unixfrom() method, of Message\nobjects, 554\nget_value() method, of Formatter objects,\n289\ngetaddrinfo() function, socket module, 473\ngetargspec() function, inspect module, 222\ngetargvalues() function, inspect module,\n222\ngetatime() function, os.path module, 397\ngetattr() function, 205\nand private attributes, 128\n__getattr__() method, 57\nand __slots__, 133\ngetAttribute() method, of DOM Element\nobjects, 572\n__getattribute__() method, 57-58, 132\nand __slots__, 133\ngetAttributeNS() method, of DOM Element\nobjects, 572\ngetboolean() method, of ConfigParser\nobjects, 333\ngetch() function, msvcrt module, 372\ngetche() function, msvcrt module, 372\ngetcheckinterval() function, sys module,\n234\ngetchildren() method, of Element objects,\n577\ngetclasstree() function, inspect module,\n222\ngetcode() method, of urlopen objects, 515\ngetcomments() function, inspect module,\n223\ngetcontext() function, decimal module, 247\ngetctime() function, os.path module, 397\ngetcwd() function, os module, 379\ngetcwdu() function, os module, 379\ngetdefaultencoding() function, sys module,\n166, 234\ngetdefaulttimeout() function, socket mod-\nule, 474\ngetdlopenflags() function, sys module, 234\ngetdoc() function, inspect module, 223\ngetEffectiveLevel() method, of Logger\nobjects, 360\ngetegid() function, os module, 379\ngetElementsByTagName() method\nof DOM Document objects, 571\nof DOM Element objects, 572\ngetElementsByTagNameNS() method\nof DOM Document objects, 571\nof DOM Element objects, 572\ngeteuid() function, os module, 380\ngetfile() function, inspect module, 223\ngetfilesystemencoding() function, sys mod-\nule, 234\ngetfirst() method, of FieldStorage objects,\n535\ngetfloat() method, of ConfigParser objects,\n333\ngetfqdn() function, socket module, 474\n_getframe() function, sys module, 234\ngetframeinfo() function, inspect module,\n223\ngetgid() function, os module, 380\ngetgroups() function, os module, 380\ngetheader() method, of HTTPResponse\nobjects, 504\ngetheaders() method, of HTTPResponse\nobjects, 504\ngethostbyaddr() function, socket module,\n474\ngethostbyname() function, socket module,\n474\ngethostbyname_ex() function, socket mod-\nule, 474\ngethostname() function, socket module,\n474\ngetinfo() method, of ZipFile objects, 326\ngetinnerframes() function, inspect module,\n223\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n667\ngetinnerframes() function, inspect module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2537,
      "extraction_method": "Direct"
    },
    {
      "page_number": 693,
      "chapter": null,
      "content": "getint() method, of ConfigParser objects,\n333\ngetitem() function, operator module, 274\n__getitem__() method, 58-59\nand slices, 59\ngetiterator() method\nof Element objects, 577\nof ElementTree objects, 574\ngetitimer() function, signal module, 399\ngetLength() method, of SAX attributes\nobjects, 582\ngetLevelName() function, logging module,\n366\ngetlist() method, of FieldStorage objects,\n535\ngetloadavg() function, os module, 395\ngetLogger() function, logging module, 356\ngetlogin() function, os module, 380\ngetmember() method, of TarFile objects,\n320\ngetmembers() function, inspect module,\n223\ngetmembers() method, of TarFile objects,\n321\ngetmodule() function, inspect module, 223\ngetmoduleinfo() function, inspect module,\n223\ngetmodulename() function, inspect module,\n224\ngetmro() function, inspect module, 224\ngetmtime() function, os.path module, 397\ngetName() method, of Thread objects, 436\ngetNameByQName() method, of SAX attrib-\nutes objects, 582\ngetnameinfo() function, socket module,\n474\ngetNames() method, of SAX attributes\nobjects, 582\ngetnames() method, of TarFile objects, 321\ngetopt module, 378\ngetouterframes() function, inspect module,\n224\ngetoutput() function, commands module,\n331\ngetpeercert() method, of ssl objects, 488\ngetpeername() method, of socket objects,\n478\ngetpgid() function, os module, 380\ngetpgrp() function, os module, 380\ngetpid() function, os module, 380\ngetpos() method, of HTMLParser objects,\n561\ngetppid() function, os module, 380\ngetprofile() function, sys module, 234\ngetprotobyname() function, socket module,\n475\ngetQNameByName() method, of SAX attrib-\nutes objects, 582\ngetQNames() method, of SAX attributes\nobjects, 582\ngetrandbits() function, random module, 254\ngetrecursionlimit() function, sys module,\n112, 234\ngetrefcount() function, sys module, 35, 234\ngetresponse() method, of HTTPConnection\nobjects, 503\ngetroot() method, of ElementTree objects,\n574\ngetservbyname() function, socket module,\n475\ngetservbyport() function, socket module,\n475\nGetSetDescriptorType type, 237\ngetsid() function, os module, 380\ngetsignal() function, signal module, 399\ngetsize() function, os.path module, 397\ngetsizeof() function, sys module, 192, 234\ngetslice() function, operator module, 274\ngetsockname() method, of socket objects,\n478\ngetsockopt() method, of socket objects,\n478\ngetsource() function, inspect module, 224\ngetsourcefile() function, inspect module,\n224\ngetsourcelines() function, inspect module,\n224\ngetstate() function, random module, 254\n668\ngetint() method, of ConfigParser objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2546,
      "extraction_method": "Direct"
    },
    {
      "page_number": 694,
      "chapter": null,
      "content": "__getstate__() method, 228\nand copying, 220\nand pickle module, 172\ngetstatusoutput() function, commands\nmodule, 332\ngettarinfo() method, of TarFile objects, 321\ngettempdir() function, tempfile module,\n323\ngettempprefix() function, tempfile module,\n323\ngettext module, 587\ngettimeout() method, of socket objects,\n482\ngetting help, help() function, 24\ngetting the current working directory, 379\ngettrace() function, sys module, 234\ngetType() method, of SAX attributes\nobjects, 582\ngetuid() function, os module, 380\ngeturl() method, of urlopen objects, 515\n_getvalue() method, of BaseProxy objects,\n433\ngetValue() method, of SAX attributes\nobjects, 582\ngetvalue() method\nof BytesIO objects, 352\nof FieldStorage objects, 535\nof StringIO objects, 354\ngetValueByQName() method, of SAX attrib-\nutes objects, 582\ngetwch() function, msvcrt module, 372\ngetwche() function, msvcrt module, 372\ngetweakrefcount() function, weakref mod-\nule, 241\ngetweakrefs() function, weakref module,\n241\ngetwindowsversion() function, sys module,\n234\ngi_* attributes, of generator objects, 53\ngid attribute, of TarInfo objects, 321\nglob module, 317\nglob() function, glob module, 317\nglobal interpreter lock, 414, 444\nand multiprocessing module, 444\nreleasing in extensions, 607\nglobal statement, 18, 96\nand modules, 143\nglobal variables, 96\nand eval(), 115\nand modules, 146\ndifference from C and Fortran, 146\nmodifying in a function, 18\nstorage of in stack frames, 52\n__globals__ attribute, of functions, 48, 99\nglobals() function, 205\ngmtime() function, time module, 406\ngname attribute, of TarInfo objects, 321\ngoto statement, lack of, 84\ngray-bearded hacker, 622\ngreater than operator >, 66\ngreater than or equal to operator >=, 66\ngreen threads, 446\ngreenlets, 446\ngroup() method, of MatchObject objects,\n285\ngroupby() function, itertools module, 271\ngroupdict() method, of MatchObject objects,\n286\ngroupindex attribute, of Regex objects, 284\ngroups() method, of MatchObject objects,\n285\ngrp module, 586\ngt() function, operator module, 274\n__gt__() method, 56\nguess_all_extensions() function, mimetypes\nmodule, 567\nguess_extension() function, mimetypes\nmodule, 567\nguess_type() function, mimetypes module,\n566\nGUI programming, use of partial function\nevaluation, 268\nGUIs, and network programming, 467\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n669\nGUIs, and network programming\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2412,
      "extraction_method": "Direct"
    },
    {
      "page_number": 695,
      "chapter": null,
      "content": "gzip module, 317\nGzipFile() function, gzip module, 317\nH\n-h command line option, 173\nh(elp) debugger command, pdb module,\n188\nhandle() function, cgitb module, 539\nhandle() method, of BaseRequestHandler\nobjects, 490\nhandle_accept() method, of dispatcher\nobjects, 455\nhandle_charref() method, of HTMLParser\nobjects, 561\nhandle_close() method, of dispatcher\nobjects, 455\nhandle_comment() method, of HTMLParser\nobjects, 561\nhandle_connect() method, of dispatcher\nobjects, 455\nhandle_data() method, of HTMLParser\nobjects, 561\nhandle_decl() method, of HTMLParser\nobjects, 561\nhandle_endtag() method, of HTMLParser\nobjects, 562\nhandle_entityref() method, of HTMLParser\nobjects, 562\nhandle_error() method\nof SocketServer class, 493\nof dispatcher objects, 455\nhandle_expt() method, of dispatcher\nobjects, 456\nhandle_pi() method, of HTMLParser objects,\n562\nhandle_read() method, of dispatcher\nobjects, 456\nhandle_startendtag() method, of\nHTMLParser objects, 562\nhandle_starttag() method, of HTMLParser\nobjects, 562\nhandle_timeout() method, of SocketServer\nclass, 493\nhandle_write() method, of dispatcher\nobjects, 456\nhas_data() method, of Request objects,\n517\nhas_header() method\nof Request objects, 517\nof Sniffer objects, 550\nhas_ipv6 variable, socket module, 475\nhas_key() method, of dicts, 45\nhas_option() method, of ConfigParser\nobjects, 333\nhas_section() method, of ConfigParser\nobjects, 333\nhasattr() function, 205\nand private attributes, 128\nhasAttribute() method, of DOM Element\nobjects, 572\nhasAttributeNS() method, of DOM Element\nobjects, 572\nhasAttributes() method, of DOM Node\nobjects, 571\nhasChildNodes() method, of DOM Node\nobjects, 571\nhash table, 16, 44\nhash table based databases, 310\nhash() function, 205\n__hash__() method, 56\nHashable abstract base class, 265\nhashlib module, 559\nexample of, 425\nheader_offset attribute, of ZipInfo objects,\n327\nheaders attribute\nof BaseHTTPRequestHandler objects,\n509\nof FieldStorage objects, 535\nheap, 269\nheapify() function, heapq module, 269\nheapmin() function, msvcrt module, 372\nheappop() function, heapq module, 269\nheappush() function, heapq module, 269\nheappushpop() function, heapq module,\n270\nheapq module, 269\nheapreplace() function, heapq module, 270\nhello world program, 5\n670\ngzip module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2268,
      "extraction_method": "Direct"
    },
    {
      "page_number": 696,
      "chapter": null,
      "content": "help() function, 24, 206\nbizarre output with decorators, 113\nherror exception, socket module, 485\nhex() function, 77, 206\nfuture_builtins module, 217\nhex() method, of floating point, 39\nhexadecimal\ncreating strings from integers, 77\ninteger literals, 27\nhexdigest() method\nof digest objects, 559\nof hmac objects, 560\nhexdigits variable, string module, 287\nhexversion variable, sys module, 231\nhiding attribute names from dir() function,\n128\nhierarchical locking, 442\nhierarchical logging, logging module, 360\nhierarchy of exceptions, 87-88\nhierarchy of objects, 137\nHIGHEST_PROTOCOL constant, pickle mod-\nule, 172\nHKEY_* constants, winreg module, 408\nHMAC authentication, 559\nhmac module, 559\nhostname attribute\nof urlparse objects, 520\nof urlsplit objects, 521\nhostname, obtaining for host machine, 474\nhour attribute, of time objects, 338\nHTML forms\nexample of, 531\nuploading with urllib package, 515\nHTML parsing, 561\nhtml.parser module, 561\nHTMLParser class, html.parser module,\n561\nHTMLParser module, see html.parser, 561\nHTMLParserError exception, html.parser\nmodule, 562\nhtonl() function, socket module, 475\nhtons() function, socket module, 475\nHTTP cookies, 511\nHTTP protocol\ndescription of, 500\nrequest methods, 501\nresponse codes, 501\nHTTP server\ncustom handling of requests, 510\nexample with asynchat module, 453\nexample with asyncore module, 457\nexample with coroutines, 466\nexample with firewall, 507\nstandalone example, 508\nuploading files in POST request, 505\nhttp package, 500\nhttp.client module, 502\nhttp.cookiejar module, 513\nhttp.cookies module, 511\nhttp.server module, 506\nHTTPBasicAuthHandler class, urllib.request\nmodule, 518-519\nHTTPConnection() function, http.client mod-\nule, 502\nHTTPCookieProcessor class, urllib.request\nmodule, 518-519\nHTTPDefaultErrorHandler class,\nurllib.request module, 518\nHTTPDigestAuthHandler class, urllib.request\nmodule, 518-519\nHTTPError exception, urllib.error module,\n523\nHTTPException exception, http.client mod-\nule, 504\nHTTPHandler class\nlogging module, 362\nurllib.request module, 518\nhttplib module, see http.client, 502\nHTTPRedirectHandler class, urllib.request\nmodule, 518\nHTTPResponse objects, http.client module,\n504\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n671\nHTTPResponse objects, http.client module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2326,
      "extraction_method": "Direct"
    },
    {
      "page_number": 697,
      "chapter": null,
      "content": "HTTPSConnection() function, http.client\nmodule, 502\nHTTPServer class, http.server module, 506\nHTTPSHandler class, urllib.request module,\n518\nhypot() function, math module, 251\nI\n-i command line option, 173-174\nI/O buffering, and generators, 165\nI/O multiplexing, 459\n__iadd__() method, 61\n__iand__() method, 61\nIBM General Decimal Arithmetic Standard,\n243\nid() function, 33, 206\nident attribute, of Thread objects, 436\nidentifiers, 26\nand first-class data, 36\ncase sensitivity, 26\nreserved words, 26\nusage of underscores, 26\nuse of Unicode in Python 3, 622\nidentity comparison of objects, 34\nidentity of objects, 33\nidentity operator is, 78\n__idiv__() method, 61\n__idivmod__() method, 61\nIDLE, 5-6\nand standard I/O streams, 162\nIEEE 754, 243\nif statement, 9, 81\nand __debug__ variable, 91\nifilter() function, itertools module, 271\nifilterfalse() function, itertools module, 271\n__ifloordiv__() method, 61\niglob() function, glob module, 317\nignorableWhitespace() method, of\nContentHandler objects, 581\nignore debugger command, pdb module,\n188\n‘ignore’ error handling, Unicode encoding,\n166\nignore_environment attribute, of sys.flags,\n230\nignore_pattern() function, shutil module,\n318\nignore_zeros attribute, of TarFile objects,\n321\nignored NameError exception in __del__,\n179\nignoring exceptions, 85\n__ilshift__() method, 61\nimag attribute\nof complex numbers, 39\nof floating point, 39\nimap() function, itertools module, 272\nimap() method, of Pool objects, 424\nimap_unordered() method, of Pool objects,\n424\nimaplib module, 587\nimghdr module, 588\nimmutability, of tuples, 14\nimmutable types, inheriting from, 55\nimmutable, definition of, 33\n__imod__() method, 61\nimp module, 224, 585\nimplicit type conversion, lack of, 62\nimport statement, 13, 23-24, 50, 143-144\nPython 3, 151\nabsolute imports in packages, 151\nand main program, 146\nand sys.modules, 144\nand sys.path variable, 147\nas qualifier, 144\ncase sensitivity, 148\ncompilation of .pyc files, 148\nexecution of modules, 143\nmodule search path, 147\nmultiple modules, 144\none-time execution of modules, 144\npackages, 150\nplacement within a program, 144\nrelative package imports, 150-151\nscoping rules of loaded code, 145\ntypes of modules, 148\nImportError exception, 87, 148, 214\n672\nHTTPSConnection() function, http.client module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2301,
      "extraction_method": "Direct"
    },
    {
      "page_number": 698,
      "chapter": null,
      "content": "importing selected symbols from a mod-\nule, 145\nImproperConnectionState exception,\nhttp.client module, 504\n__imul__() method, 61\nin operator, 9\nand __contains__ method, 58\nand checking for substrings, 69\non dicts, 16, 45, 74\non sequences, 67, 69\nin-place assignment operators, 75\nin-place file updates, 159\nin-place mathematical operators, 61\nin-place modification\nof lists, 40\nof sets, 47\nin_dll() method, of ctypes type objects, 616\nINADDR_* constants, socket module, 478\nIncompleteRead exception, http.client mod-\nule, 504\nIncrementalDecoder class, codecs module,\n279\nincrementaldecoder() method, of CodecInfo\nobjects, 279\nIncrementalEncoder class, codecs module,\n278\nincrementalencoder() method, of CodecInfo\nobjects, 278\nindentation, 8, 25\nand documentation strings, 30\nand line continuation character \\, 9\nand tabs, 26\npreferred style, 8\nputting statements on the same line, 25\nIndentationError exception, 87, 214\nindex() method\nof array objects, 260\nof lists, 40-41\nof strings, 41, 43\nIndexError exception, 69, 87, 214\nindexing operator [], 39, 67\non lists, 12\non sequences, 68\non strings, 11\non tuples, 14\nindexing, 0-based, 11\nindexOf() function, operator module, 274\nindices() method, of slices, 54\ninet_aton() function, socket module, 475\ninet_ntoa() function, socket module, 476\ninet_ntop() function, socket module, 476\ninet_pton() function, socket module, 476\ninexact representation of floating point, 12\nInf variable, decimal module, 248\nInf\ndecimal module, 244\ninfinity, 213\ninfo() method\nof Logger objects, 357\nof urlopen objects, 515\ninfolist() method, of ZipFile objects, 326\ninheritance, 21, 119\n__mro__ attribute of classes, 121\nabstract base classes, 137\nattribute binding, 119\ncalling methods in superclasses, 120\nfrom built-in types, 22\nfrom immutable types, 55\ninitialization of superclasses, 120\ninteraction with__slots__, 133\ninternal optimization of, 233\nisinstance() function, 34\nissubclass() function, 135\nmetaclasses, 139\nmethod resolution order, 121\nmultiple inheritance, 121\npreventing redefinition of methods, 128\nprivate methods, 128\nuse with exceptions, 88\n.ini files\nconfiguring logging with, 368\nreading from Python, 332\ninit() function, mimetypes module, 567\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n673\ninit() function, mimetypes module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2336,
      "extraction_method": "Direct"
    },
    {
      "page_number": 699,
      "chapter": null,
      "content": "__init__() method, 50, 54-55\nand exceptions, 88\nand inheritance, 120\nand instance creation, 129\nand metaclasses, 139\nand pickle, 228\ndefining multiple instance creation\nmethods, 123\nof classes, 22, 118\n__init__.py files in packages, 149\ninput() function, 162, 206\nPython 3, 11\ninsert() method\nof Element objects, 577\nof array objects, 260\nof lists, 12, 41\ninsertBefore() method, of DOM Node\nobjects, 571\ninserting items into a dictionary, 16\ninserting items into a list, 41\ninsort() function, bisect module, 261\ninsort_left() function, bisect module, 261\ninsort_right() function, bisect module, 261\ninspect attribute, of sys.flags, 230\ninspect module, 222\ninspecting objects, with dir(), 63\ninstall command, of setup.py files, 154\ninstall_opener() function, urllib.request\nmodule, 518\ninstallation of third-party packages, 154\nin user directory, 154\ninstalling a package, 153\ninstance methods, 48, 118\n__instancecheck__() method, 57, 136\ninstances, 117\nas callable, 50\nattribute assignment, 131\nattribute deletion, 131\ncreation of, 55, 118, 129\ndefinition of, 33\npickling of, 228\ntype of, 50\ninstantiation of abstract base class, 137\nint type, 38\nint() function, 11, 62, 76, 206\n__int__() method, 61-62\nand type coercion, 134\ninteger division, Python 3, 633\nintegers, 27\n2’s complement representation, 66\nas dictionary key, 16\nautomatic promotion to long, 27\nconversion to longs, 38\ncreating hexadecimal strings, 77\ncreating random, 254\noverflow behavior, 66\nrange of, 38\nspecifying as hex, octal, or binary, 27\nIntegral abstract base class, 253\nIntegrityError exception, database API, 302\ninteractive attribute, of sys.flags, 230\ninteractive mode, 6, 175\nand blank lines, 26\ndisplay of results, 55, 176\ninteractive terminal, 174\nInterfaceError exception, database API, 302\ninternal_attr attribute, of ZipInfo objects,\n327\nInternalError exception, database API, 302\ninternational characters\nand string comparison, 70\nin source code, 31\ninterpolation, of values in strings, 72\ninterpreter, 5\ninterpreter command line options, 173\ninterpreter environment variables, 174\ninterpreter prompts, 175\ninterpreter, -t and -tt options, 26\ninterprocess communication (IPC), 413\ninterrupt() method, of Connection objects,\n306\nintersection operator &, of sets, 15\nintersection() method, of sets, 46\nintersection_update() method, of sets, 47\ninterval timer, 399\nintrospection of objects, 222\ninv() function, operator module, 273\n674\n__init__() method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2459,
      "extraction_method": "Direct"
    },
    {
      "page_number": 700,
      "chapter": null,
      "content": "InvalidURL exception, http.client module,\n504\ninvert() function, operator module, 274\n__invert__() method, 61\nio module, 349\nPython 3, 631\nproblems associated with, 354\nIOBase abstract base class, 354\nIOBase class, io module, 349\nioctl() function, fcntl module, 348\nioctl() method, of socket objects, 482\nIOError exception, 87, 214\n__ior__() method, 61\nIP_* socket options, socket module, 480\n__ipow__() method, 61\nIPPROTO_* constants, socket module, 476\nIPv4 protocol, 470\naddress format, 471\nIPv6 protocol, 470\naddress format, 471\nIPV6_* socket options, socket module,\n480-481\nIronPython, 5\nexample of, 620\n__irshift__() method, 61\nis operator, object identity, 34, 78\nis_() function, operator module, 274\nis_alive() method\nof Process objects, 416\nof Thread objects, 436\nis_multipart() method, of Message objects,\n554\nis_not() function, operator module, 274\nis_set() method, of Event objects, 440\nis_tarfile() function, tarfile module, 319\nis_unverifiable() method, of Request\nobjects, 517\nis_zipfile() function, zipfile module, 325\nisabs() function, os.path module, 397\nisabstract() function, inspect module, 224\nisAlive() method, of Thread objects, 436\nisalnum() method, of strings, 41, 43\nisalpha() method, of strings, 43\nisatty() function, os module, 383\nisatty() method\nof IOBase objects, 349\nof files, 160\nisblk() method, of TarInfo objects, 321\nisbuiltin() function, inspect module, 224\nischr() method, of TarInfo objects, 321\nisclass() function, inspect module, 224\niscode() function, inspect module, 225\nisDaemon() method, of Thread objects, 437\nisdatadescriptor() function, inspect module,\n225\nisdev() method, of TarInfo objects, 321\nisdigit() method, of strings, 43\nisdir() function, os.path module, 397\nisdir() method, of TarInfo objects, 321\nisdisjoint() method, of sets, 46\niselement() function, xml.etree.ElementTree\nmodule, 578\nisenabled() function, gc module, 221\nisEnabledFor() method, of Logger objects,\n359\nisfifo() method, of TarInfo objects, 321\nisfile() function, os.path module, 397\nisfile() method, of TarInfo objects, 321\nisframe() function, inspect module, 225\nisfunction() function, inspect module, 225\nisgenerator() function, inspect module, 225\nisgeneratorfunction() function, inspect mod-\nule, 225\nisinf() function, math module, 252\nisinstance() function, 34, 37, 135, 206-207\nand inheritance, 134\nand proxy objects, 135\nredefining behavior of, 136\nislice() function, itertools module, 272\nislink() function, os.path module, 397\nislnk() method, of TarInfo objects, 321\nislower() method, of strings, 43\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n675\nislower() method, of strings\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2669,
      "extraction_method": "Direct"
    },
    {
      "page_number": 701,
      "chapter": null,
      "content": "ismethod() function, inspect module, 225\nismethoddescriptor() function, inspect mod-\nule, 225\nismodule() function, inspect module, 225\nismount() function, os.path module, 397\nisnan() function, math module, 252\niso-8859-1 encoding, description of, 169\nisocalendar() method, of date objects, 337\nisoformat() method\nof date objects, 337\nof time objects, 338\nisoweekday() method, of date objects, 337\nisreg() method, of TarInfo objects, 321\nisReservedKey() method, of Morsel objects,\n512\nisroutine() function, inspect module, 225\nisSameNode() method, of DOM Node\nobjects, 571\nisspace() method, of strings, 43\nissubclass() function, 135, 206\nredefining behavior of, 136\nissubset() method, of sets, 46\nissuperset() method, of sets, 46\nissym() method, of TarInfo objects, 322\nistitle() method, of strings, 43\nistraceback() function, inspect module, 225\n__isub__() method, 61\nisupper() method, of strings, 41, 43\nitemgetter() function, operator module, 275\nitems() method\nof ConfigParser objects, 333\nof Element objects, 577\nof Message objects, 552\nof dicts, 45\nof dicts in Python 3, 632\nitemsize attribute, of array objects, 259\nItemsView abstract base class, 266\niter() function, 206\n__iter__() method, 59, 82\nIterable abstract base class, 265\niteration, 10, 17, 59, 82\nbreaking out of a loop, 83\niteration variable, 82\nover a sequence, 39, 69\nover dictionary keys, 17\nover dictionary values, 45\nover multiple sequences, 83\nportable function for next() operation,\n207\nprotocol change in Python 3, 633\nprotocol of, 60, 82\nscope of iteration variable, 82\nsupported objects, 17\nunpacking of tuples, 82\nIterator abstract base class, 265\niterators, use in Python 3, 632\niterdecode() function, codecs module, 279\niterdump() method, of Connection objects,\n306\niterencode() function, codecs module, 279\niterencode() method, of JSONEncoder\nobjects, 566\niterkeyrefs() method, of WeakKeyDictionary\nobjects, 241\niterparse() function, xml.etree.ElementTree\nmodule, 578\nitertools module, 83, 270\nitervaluerefs() method, of\nWeakValueDictionary objects, 241\n__itruediv__() method, 61\n__ixor__() method, 61\nizip() function, itertools module, 83, 212,\n272\nizip_longest() function, itertools module,\n272\nJ\nJ character, on complex number literals, 27\nj(ump) debugger command, pdb module,\n188\nJava, 620\ndifference in class system, 119\nJavascript, pop-up window example, 531\njoin() function, os.path module, 397\njoin() method\nof JoinableQueue objects, 419\nof Pool objects, 424\n676\nismethod() function, inspect module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2511,
      "extraction_method": "Direct"
    },
    {
      "page_number": 702,
      "chapter": null,
      "content": "of Process objects, 416\nof Queue objects, 445\nof Thread objects, 436\nof strings, 43\njoin_thread() method, of Queue objects,\n418\nJoinableQueue() function, multiprocessing\nmodule, 419\njs_output() method\nof Morsel objects, 512\nof SimpleCookie objects, 512\nJSON (JavaScript Object Notation), 563\njson module, 563\ndifference from pickle and marshal, 565\nJSONDecoder class, json module, 565\nJSONEncoder class, json module, 566\njumpahead() function, random module,\n254\nJython, 5\nexample of, 620\nK\nkbhit() function, msvcrt module, 373\nkey attribute, of Morsel objects, 512\nkey index operator [], 44\nof dicts, 16\nkey keyword argument, to sort(), 40\nKEY_* constants, winreg module, 410\nkeyboard interrupts, 162\nKeyboardInterrupt class, 214\nKeyboardInterrupt exception, 87-88, 162\nKeyError exception, 44, 87, 214\nkeyrefs() method, of WeakKeyDictionary\nobjects, 241\nkeys() method\nof Element objects, 577\nof Message objects, 552\nof dicts, 45\nof dicts in Python 3, 632\nkeys\nacceptable types for dictionaries, 16\nof dicts, 44\nKeysView abstract base class, 266\nkeyword arguments, 18, 94\nmixing with positional arguments, 94\nkeyword module, 585\nkeyword-only arguments, Python 3, 625\nkeywords attribute, of partial objects, 268\nkill() function, os module, 392\nkill() method, of Popen objects, 403\nkillpg() function, os module, 392\nkqueue, BSD, 460\nL\nL character, on long integers, 27\nl(ist) debugger command, pdb module, 188\nlambda operator, 48, 112\nalternatives to, 274-275\nLambdaType type, 237\nlast_accepted attribute, of Listener objects,\n434\nlast_traceback variable, sys module, 231\nlast_type variable, sys module, 231\nlast_value variable, sys module, 231\nlastChild attribute, of DOM Node objects,\n570\nlastgroup attribute, of MatchObject objects,\n286\nlastindex attribute, of MatchObject objects,\n286\nlatin-1 encoding, description of, 169\nlaunching a web browser, 544\nlaunching python applications, 176\nlaunching subprocesses, 402\nexamples, 404\nlazy evaluation, 99\nlchflags() function, os module, 387\nlchmod() function, os module, 387\nlchown() function, os module, 387\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n677\nlchown() function, os module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2188,
      "extraction_method": "Direct"
    },
    {
      "page_number": 703,
      "chapter": null,
      "content": "ldexp() function, math module, 252\nle() function, operator module, 274\n__le__() method, 56\nleading 0b on integers, binary, 27\nleading 0o on integers, octal, 27\nleading 0x on integers, hexadecimal, 27\nleading b character on string literals, byte\nstrings, 29\nleading r character on strings, raw strings,\n29\nleading u character on string literals,\nUnicode strings, 28\nleft shift operator <\nleft_list attribute, of dircmp objects, 315\nleft_only attribute, of dircmp objects, 315\nlegacy code, and exec statement, 115\nlen() function, 58, 206\non dicts, 74\non mappings, 44-45\non sequences, 39-40, 67, 69\non sets, 46, 75\n__len__() method, 56, 58\nand truth testing, 56\nlength attribute, of HTTPResponse objects,\n504\nless than operator\nless than or equal to operator <=, 66\nletters variable, string module, 287\nlevelname attribute, of Record objects, 359\nlevelno attribute, of Record objects, 359\nlexical scoping, 97\nlexicographical ordering\nof UTF-8, 170\nof strings, 70\nlexists() function, os.path module, 397\nLifoQueue() function, queue module, 444\nlimit_denominator() method, of Fraction\nobjects, 250\nlimiting the output of error tracebacks, 232\nline continuation character \\, 9, 25, 29\nline continuation, and parentheses, braces,\nor brackets, 25\nline separator character for files, 379\nline structure of programs, 25\nline_buffering attribute, of TextIOWrapper\nobjects, 353\nlinecache module, 585\nlineno attribute, of Record objects, 359\nlinesep variable, os module, 379\nlink() function, os module, 387\nlinkname attribute, of TarInfo objects, 322\nLinux, 331\nLinux link-level packet protocol, 470\naddress format, 472\nLinux, epoll interface, 460\nlist comprehensions, 13\nand declarative programming, 110\nconditional expressions, 79\ncreation of tuples within, 109\ndifference from generator expression,\n110\ngeneral syntax of, 108\nscope of iteration variable, 109\nsimiliarity to SQL queries, 111\nsimiliarity to awk command, 111\nlist of Unix signal names, 400\nlist type, 38\nlist() function, 12, 40, 77, 207\napplied to dictionaries, 16\nlist() method\nof Manager objects, 429\nof TarFile objects, 321\nlist_dialects() function, csv module, 551\nlistdir() function\nPython 3, 630, 633\nos module, 387\nlisten() method\nof dispatcher objects, 456\nof socket objects, 483\nListener class, multiprocessing module,\n433\nlists, 12, 40\nappending to, 12, 40\nas sequence, 39\ncompared to array objects, 260\ncomparison of, 70\nconcatenation, 12\n678\nldexp() function, math module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2460,
      "extraction_method": "Direct"
    },
    {
      "page_number": 704,
      "chapter": null,
      "content": "counting items, 40\ndeletion of items, 69\nempty, 12\nequality of, 78\nindexing operator, 12\ninefficiency of insert(), 194\ninserting items, 12, 40, 69\nitem assignment, 12, 69\nkeeping in sorted order, 261\nlist comprehension, 108\nmaking shallow copy of, 40\nnested, 13\nrandom shuffling, 254\nreassigning a slice, 12\nremoving items, 40\nreversing, 40\nsearching, 40\nshared by multiple processes, 429\nslice assignment, 69\nslice deletion, 69\nslices, 12\nsorting, 40\nversus deque, 194, 262\nversus tuples, 14\nlittle endian format, 167\nlittle endian, packing and unpacking, 292\nljust() method, of strings, 43\nln() method, of Decimal objects, 243\nload() function\njson module, 565\nmarshal module, 226\npickle module, 171, 227\nload() method\nof SimpleCookie objects, 512\nof Unpickler objects, 228\nloads() function\njson module, 565\nmarshal module, 226\npickle module, 227\nxmlrpc.client module, 526\nlocal storage for threads, 443\nlocal variables, 96\nand eval(), 115\nstorage of in stack frames, 52\nuse before defined, 98\nlocal() function, threading module, 443\nlocalcontext() function, decimal module,\n248\nlocale module, 587\nlocale setting, and string comparison, 70\nlocalName attribute, of DOM Node objects,\n570\nlocals() function, 207\nlocaltime() function, time module, 406\nLock object\nmultiprocessing module, 427\nthreading module, 438\nLock() method, of Manager objects, 429\nLOCK_* constants, flock() function, 348\nlockf() function, fcntl module, 348\nlocking() function, msvcrt module, 373\nlocking\navoiding deadlock, 442\nfiles on Windows, 373\nmultiprocessing module, 427\nof critical sections, 414\nof files, 348\nthreading module, 439\nlocks\nand context managers, 89\nand exceptions, 23\nproper management of, 442\nlog files, real-time monitoring example, 19\nlog() function, math module, 252\nlog() method, of Logger objects, 358\nlog10() function, math module, 252\nlog10() method, of Decimal objects, 243\nlog1p() function, math module, 252\nlog_error() method, of\nBaseHTTPRequestHandler objects, 510\nlog_message() method, of\nBaseHTTPRequestHandler objects, 510\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n679\nlog_message() method, of BaseHTTPRequestHandler objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2189,
      "extraction_method": "Direct"
    },
    {
      "page_number": 705,
      "chapter": null,
      "content": "log_request() method, of\nBaseHTTPRequestHandler objects, 510\nLogAdapter() function, logging module, 366\nlogging module, 355\nadding extra fields to log messages, 365\nand multiprocessing module, 435\nbasic configuration, 355\nconfiguring with .ini files, 368\nfiltering messages, 359\nformatting of messages, 365\nhandler objects, 362\nhow to configure, 367\nincluding exceptions in log messages,\n358\nissuing log messages, 356\nlogger hierarchy, 360\nmessage handling, 361\nmessage propagation, 360\npicking logger names, 356\nusing a null logger, 369\nlogin() method\nof FTP objects, 498\nof SMTP objects, 514\nlognormvariate() function, random module,\n255\nlong integers, 27\nand integers, 38\nautomatic promotion from integers, 27\nlong type, 38\nlong() function, 207\n__long__() method, 61-62\nlookup table, and dictionaries, 16\nlookup() function\ncodecs module, 277\nunicodedata module, 296\nLookupError exception, 87, 212\nloop() function, asyncore module, 457\nlooping, 17, 82\nbreaking out prematurely, 83\nkeeping a loop counter, 83\nwhile statement, 8\nloose-coupling of objects, 122\nlow-level file manipulation, 382\nlower() method, of strings, 43\nlowercase variable, string module, 287\nlseek() function, os module, 383\nlshift() function, operator module, 274\n__lshift__() method, 60\nlstat() function, os module, 387\nlstrip() method, of strings, 43\nlt() function, operator module, 274\n__lt__() method, 56\nLWPCookieJar class, http.cookiejar module,\n513\nM\n-m command line option, 173-174\n-m pdb option to interpreter, 189\nmailbox module, 587\nmailcap module, 587\nmain program execution, 146\nmain program, and pickle module, 228\nmain thread, 413\n__main__ module, 146, 174\nmain() function, unittest module, 184\n__main__, check needed for multiprocess-\ning module, 417\nmajor() function, os module, 387\nmake_server() function,\nwsgiref.simple_server module, 542\nmakedev() function, os module, 387\nmakedirs() function, os module, 387\nmakefile() method, of socket objects, 483\nmaketrans() function, string module, 290\nmaking timing measurements, 191\nmanaged objects, multiprocessing module,\n428\nManager() function, multiprocessing mod-\nule, 428\nmant_dig attribute, of sys.float_info, 231\nmap() function, 207\nand Python 3, 207\nand optimization, 197\nfuture_builtins module, 217\nmap() method, of Pool objects, 424\nmap-reduce, multiprocessing module, 424\n680\nlog_request() method, of BaseHTTPRequestHandler objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2399,
      "extraction_method": "Direct"
    },
    {
      "page_number": 706,
      "chapter": null,
      "content": "map_async() method, of Pool objects, 425\nMapping abstract base class, 266\nmappings, 44\ndeletion of items, 45\nkey index operator, 44\nspecial methods of, 58\nMappingView abstract base class, 266\nmarshal module, 226\nmatch() function, re module, 284\nmatch() method, of Regex objects, 285\nMatchObject objects, re module, 285\nmath module, 251\nmathematical operators\nin-place, 61\nmixed types, 66-67\nmathematical special methods, 60\nmax attribute\nof date class, 337\nof datetime class, 340\nof sys.float_info, 231\nof time class, 338\nof timedelta class, 341\nmax() function, 13, 39-40, 67, 69, 207\non sets, 75\nrequired methods for user-defined\nobjects, 57\nmax_10_exp attribute, of sys.float_info,\n231\nmax_exp attribute, of sys.float_info, 231\nmaxint variable, sys module, 231\nmaxsize variable, sys module, 231\nmaxunicode variable, sys module, 231\nmd5() function, hashlib module, 559\nMemberDescriptorType type, 237\nmembership test\nof dicts, 16, 74\nof sequences, 67\nmemmove() function, ctypes module, 617\nmemoization of results, 242\nmemory efficiency\nand __slots__, 133\nof generator expressions, 110\nof generators, 107\nmemory management, 128\nchecking for leaks, 221\ncreation of instances, 129\ngarbage collection, 35, 220\nreference counting, 129\nmemory mapped files, 370\nand IPC, 413\nmemory use\narray objects, 260\nmeasuring, 192\nobtaining size of objects, 234\ntuples versus lists, 14\nmemory, location of objects, 33\nMemoryError exception, 87, 214\nMemoryHandler class, logging module, 362\nmemset() function, ctypes module, 617\nmerge() function, heapq module, 270\nMersenne Twister, 254\nMessage class, email package, 552, 555\nmessage attribute, of Exception objects,\n213\nmessage digests, 559\nmessage passing, 414-415\nand coroutines, 415\nand synchronization, 415\ncoroutines, 108\ndefinition of, 413\nsending byte buffers, 421\nsending objects between processes, 421\nmessage propagation, of log messages,\n360\nmessage queues, 415\ncoroutines, 108\nmultiprocessing module, 418\nmessage_from_file() function, email pack-\nage, 552\nmessage_from_string() function, email\npackage, 552\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n681\nmessage_from_string() function, email package\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2202,
      "extraction_method": "Direct"
    },
    {
      "page_number": 707,
      "chapter": null,
      "content": "metaclass keyword argument, of class defi-\nnitions, 139\n__metaclass__ attribute, of classes, 139\n__metaclass__ global variable, 139\nmetaclasses, 138\n__prepare__() method, 627-628\nand descriptors, 140\nand inheritance, 139\ncaution on use, 141\nexample of, 140\nhow to define, 139\nperformance benefits, 197\nuse of __new__() method, 55, 129\nuse of a custom dictionary object, 628\nmethod resolution order, and TypeError\nexception, 122\nmethod resolution\n__mro__ attribute, 121\nmultiple inheritance, 121\nsingle inheritance, 120\nmethodcaller() function, operator module,\n275\nmethodHelp() method, of ServerProxy\nobjects, 525\nmethods, 48, 117\nbound, 49, 125\ncalling process, 48\nclass, 125\n@classmethod decorator, 48\ndefining in classes, 21\ndefinition of, 118\nhandling as properties, 125\npreventing redefinition in subclasses,\n128\nstatic, 125\n@staticmethod decorator, 48\ntype of, 47\ntype of built-in, 49\nunbound, 49\nuse of super() function, 120\nmethodSignatures() method, of ServerProxy\nobjects, 525\nMethodType type, 47-48, 237\nmicrosecond attribute, of time objects, 338\nmicrothreading, 446\nmigrating code\nPython 2 to 3, 634\npractical strategy, 637\nMIMEApplication class, email package, 557\nMIMEAudio class, email package, 557\nMIMEImage class, email package, 557\nMIMEMessage class, email package, 557\nMIMEMultipart class, email package, 557\nMIMEText class, email package, 558\nmimetypes module, 566\nmin attribute\nof date class, 337\nof datetime class, 340\nof sys.float_info, 231\nof time class, 338\nof timedelta class, 341\nmin() function, 13, 39-40, 67, 69, 207\non sets, 75\nrequired methods for user-defined\nobjects, 57\nmin_10_exp attribute, of sys.float_info, 231\nmin_exp attribute, of sys.float_info, 231\nminimum requirements for supporting\nequality, 57\nminor() function, os module, 387\nminute attribute, of time objects, 338\nmirrored() function, unicodedata module,\n296\nmissing parenthesese, and tuples, 14\nmixed-type mathematical operations, 66-67\nmixin classes, 122\nmixing byte strings and Unicode, 167\nmkd() method, of FTP objects, 498\nmkdir() function, os module, 388\nmkdtemp() function, tempfile module, 323\nmkfifo() function, os module, 388\nmknod() function, os module, 388\nmkstemp() function, tempfile module, 323\nmktemp() function, tempfile module, 323\nmktime() function, time module, 406\nmmap module, 369\nmmap() function, mmap module, 370\nmod() function, operator module, 273\n682\nmetaclass keyword argument, of class definitions\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2448,
      "extraction_method": "Direct"
    },
    {
      "page_number": 708,
      "chapter": null,
      "content": "__mod__() method, 60\nmode attribute\nof FileIO objects, 350\nof TarInfo objects, 322\nof files, 161\nmodf() function, math module, 252\nmodifying global variables from a function,\n18\nmodifying the module search path, 147\nmodule attribute, of Record objects, 359\nmodule loading, 147\nmodule reloading, 149\nmodule search path\nand site module, 177\nand zip files, 147\nmodifying, 147\nsetting with environment variable, 174\nmodule unloading, 149\n__module__ attribute, of types, 50\nmodulefinder module, 585\nmodules variable, sys module, 149, 231\nmodules, 23, 143\naccessing classes, 144\nand .pyc files, 148\nas objects, 144\nattribute access, 51\nattributes of, 51\ndynamic loading, 144\nglobal namespace for functions, 96\nimporting multiple, 144\none-time execution, 144\nsearch path of, 147\nself-testing with doctest, 182\ntype of, 50\ntype of module object, 47\ntypes of recognized files, 148\nusing to write extensible programs, 144\nModuleType type, 47, 237\nmodulo operator %, 65\nmonth attribute, of date objects, 337\nMorsel class, http.cookies module, 512\nmove() function, shutil module, 319\nmove() method, of mmap objects, 371\nmoving the file pointer, 161\nMozillaCookieJar class, http.cookiejar mod-\nule, 513\n__mro__ attribute, of classes, 121\nMSG_* constants, socket module, 483\nmsvcrt module, 372\nmtime attribute, of TarInfo objects, 322\nmul() function, operator module, 273\n__mul__() method, 60\nmulti-dimensional lists, 13\nMultiCall() function, xmlrpc.client module,\n526\nmulticore, and program execution, 414\nmultiple inheritance, 120-121\nmultiple statements on the same line, 26\nmultiplexing, of I/O, 459\nmultiplication operator *, 65\nmultiprocessing module, 415\nand global interpreter lock, 444\nand pickle, 435\nconnecting separate processes, 433\ndistributed computing, 435\nlogging, 435\nmanaged objects, 428\npassing a list through shared memory,\n427\npipes, 421\nprocess pools, 424\nqueues, 418\nshared memory, 426\nsynchronization primitives, 427\nuse of __main__ check, 417\nmultithreaded chicken, 414\nmutability\ndefault function arguments, 94\ndictionary keys, 44\nfunction parameters, 95\nin-place assignment operators, 75\nreference counting, 35\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n683\nmutability\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2241,
      "extraction_method": "Direct"
    },
    {
      "page_number": 709,
      "chapter": null,
      "content": "mutable, definition of, 33\nMutableMapping abstract base class, 266\nMutableSequence abstract base class, 266\nMutableSet abstract base class, 266\nmutual exclusion lock, 438\nMySQL, accesing from Python, 297\nN\n\\N escape code, in strings, 28\nn(ext) debugger command, pdb module,\n189\nname attribute\nof FieldStorage objects, 535\nof FileIO objects, 350\nof Process objects, 417\nof Record objects, 359\nof TarInfo objects, 322\nof Thread objects, 436\nof files, 161\nname mangling, of private attributes, 127\nname variable, os module, 379\n__name__ attribute\nof built-in functions, 49\nof functions, 48\nof methods, 49\nof modules, 51\nof types, 50\n__name__ variable, of modules, 146\nname() function, unicodedata module, 296\nnamed tuples\nuse as tuples, 264\nuse by standard library, 265\nNamedTemporaryFile() function, tempfile\nmodule, 324\nnamedtuple() function, collections module,\n264\nNameError exception, 87, 214\nNameError exception in __del__ ignored,\n179\nNameError exception, and variable lookup,\n96\nnamelist() method, of ZipFile objects, 326\nNamespace() method, of Manager objects,\n429\nnamespace\nand classes, 117\nand import statement, 24, 143\nlocal variables of function, 96\nnamespaceURI attribute, of DOM Node\nobjects, 570\nNaN variable, decimal module, 248\nNaN\nnot a number, 213\nnot a number, decimal module, 244\nne() function, operator module, 274\n__ne__() method, 57\nneg() function, operator module, 273\n__neg__() method, 61\nnegative indices, 68-69\nnegInf variable, decimal module, 248\nnested classes, problem with pickle, 228\nnested functions, 97\nand closures, 99\nnested lists, 13\nnested() function, contextlib module, 267\nNetlink protocol, 470\naddress format, 472\nnetloc attribute\nof urlparse objects, 520\nof urlsplit objects, 521\nnetrc module, 587\nnetwork programming modules, Python 3\nreorganization, 497\nnetwork programming\nUnicode encoding, 452\nasynchronous, 467\nevent-driven programming, 455\ngetting hostname, 474\nintroduction, 449\nperformance of polling, 468\nnew() function\nhashlib module, 559\nhmac module, 559\n__new__() method, 54-55\nand instance creation, 129\nand metaclasses, 139\n684\nmutable, definition of\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2128,
      "extraction_method": "Direct"
    },
    {
      "page_number": 710,
      "chapter": null,
      "content": "caution when reading code, 129\nuse by immutable types, 129\nuses of, 55\nnewline character, difference on\nUnix/Windows, 159\nnewline escape code in strings, 28\nnewline parameter, to open() function, 159\nnewline suppression, print statement, 162\nnewline termination of statements, 7\nnewlines attribute\nof TextIOWrapper objects, 353\nof files, 161\nnext() function, 207\nnext() method, 59\nof TarFile objects, 321\nof files, 160\nof generators, 19, 53, 103\nof iterators, 82\nuse with coroutines, 104\n__next__() method, 59\nPython 3, 633\nof generators, 19, 103\nof iterators, 82\nnextset() method, of Cursor objects, 299\nnextSibling attribute, of DOM Node objects,\n570\nNI_* constants, socket module, 475\nnice() function, os module, 392\nnis module, 586\nnlargest() function, heapq module, 270\nnntplib module, 587\nno_site attribute, of sys.flags, 230\nnodeName attribute, of DOM Node objects,\n570\nnodeType attribute, of DOM Node objects,\n570\nnodeValue attribute, of DOM Node objects,\n570\nnon-printing characters, specifying in string\nliterals, 28\nNone, 38\nand default arguments, 94\nreturn statement in functions, 96\nnonlocal statement, Python 3, 97, 624\nnormalization of Unicode strings, 171\nnormalize() function, unicodedata module,\n171, 296\nnormalize() method, of DOM Node objects,\n571\nnormalvariate() function, random module,\n255\nnormcase() function, os.path module, 398\nnormpath() function, os.path module, 398\nnot equal to operator !=, 66\nnot operator, boolean expressions, 9, 77\nnot_() function, operator module, 274\nNotConnected exception, http.client mod-\nule, 504\nnotify() method, of Condition objects, 441\nnotify_all() method, of Condition objects,\n441\nNotImplementedError exception, 87, 214\nNotSupportedError exception, database API,\n302\nnow() method, of datetime class, 339\nnsmallest() function, heapq module, 270\nNTEventLogHandler class, logging module,\n362\nntohl() function, socket module, 476\nntohs() function, socket module, 476\nntransfercmd() method, of FTP objects, 498\nnull object, 369\nnull values, 38\nNULL-terminated strings, and UTF-8, 170\nNumber abstract base class, 253\nnumber of CPUs on system, 434\nnumbers module, 138, 252\nnumbers, example of defining new type,\n133\nnumerator attribute\nof Fraction objects, 250\nof integers, 39\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n685\nnumerator attribute\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2357,
      "extraction_method": "Direct"
    },
    {
      "page_number": 711,
      "chapter": null,
      "content": "numeric data, and strings, 11\nnumeric literals, 26-27\nnumeric type coercision, 66-67\nnumeric type hierarchy, 137, 253\nnumeric types, 38\nnumeric() function, unicodedata module,\n296\nnumpy extension, 39, 261\nO\n-O command line option, 91, 148, 173-174,\n369\nobject, 47\nobject base class, 21, 119\nobject() function, 208\nobjects, 21\nattributes of, 33\nclass of, 34\ncomparison, 34\ncomparison in Python 3, 633\ncontainer or collection, 33\ndefining a null object, 369\ndefinition of, 33\nfirst-class status, 36\ngetting a list of referrers, 221\ngetting the size of, 192\nhierarchy of, 137\nhow to copy, 36\nidentity of, 33\ninspecting with dir(), 63\ninstance of, 33\nintrospection of, 222\nmethods for comparison, 56\nname of, 35\nobtaining size of, 234\npersistence, 171\nproxies in multiprocessing module, 431\nreference counting of, 34\nrepresentation of, 131\nrequirements for ordering, 57\nsending between processes with pipes,\n421\nsending between processes with\nqueues, 418\nserializing with marshal, 226\nserializing with pickle, 227\nsharing in the interpreter, 35\nsupporting iteration, 82\ntype of, 33\nweak references to, 240\nobserver pattern, 130, 240\noct() function, 77, 208\nfuture_builtins module, 217\noctal integer literals, 27\noctdigits variable, string module, 287\nold-style classes, 139\n-OO command line option, 148, 173-174\nopen() function, 10, 158, 208\nPython 3, 159\ncodecs module, 167, 279\ncodecs module and Python 3, 279\ndbm module, 310\ndescription of file modes, 159\ndifference between Python 2 and 3,\n208\ngzip module, 317\nio module, 354\nos module, 384\nshelve module, 171, 311\ntarfile module, 319\nwebbrowser module, 544\nopen() method\nof ZipFile objects, 326\nof controller objects, 544\nopen_new() function, webbrowser module,\n544\nopen_new() method, of controller objects,\n544\nopen_new_tab() function, webbrowser mod-\nule, 544\nopen_osfhandle() function, msvcrt module,\n373\nOpenKey() function, winreg module, 410\nOpenKeyEx() function, winreg module, 410\nopenpty() function, os module, 385\nOpenSSL, 486\nexample of creating certificates, 489\noperating system, scheduling by, 414\n686\nnumeric data, and strings\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2114,
      "extraction_method": "Direct"
    },
    {
      "page_number": 712,
      "chapter": null,
      "content": "OperationalError exception, database API,\n302\noperator module, 273\nalternative to lambda, 274\nuse in optimization, 274\noperator overloading, 54\nexample of, 133\norder of operands, 134\nreversed operands, 60\ntype coercion, 134\noperators, 30, 65\nmathematical, 60\nprecedence of, 78\noptimization\n__slots__ attribute of classes, 132, 196\narray objects, 260\nattribute binding, 195-196\nbuilt-in types, 194\ncreation of instances, 195\ndecorators and metaclasses, 197\ndefinition of speedup, 192\ndeque objects, 263\ndict() function, 195\ndict lookups, 197\ndicts versus classes, 195\ndisassembly, 193\neffect of adding layers, 195\nexceptions, 196-197\nformatting of log messages, 358\nfunctional programming, 197\nimpact of I/O polling, 469\ninternal type cache, 233\nlists versus array objects, 260\nlogging module, 369\nmaking timing measurements, 191\nmap() and filter() functions, 197\nmarshal versus pickle, 226\nmeasuring memory use, 192\nrepeated timing measurements, 192\nselect() function, 467\nsorting callback functions, 275\nspeedup, 194\ntuning strategies, 194\nuse of io module, 354\nuse of multiprocessing pools, 426\nuse of operator module, 274\nuser defined classes, 195\noptimize attribute, of sys.flags, 230\noptimized mode, enabling with an environ-\nment variable, 174\noptional function arguments, 18, 93\nand None, 38\nOptionParser() function, optparse module,\n374\noptions() method, of ConfigParser objects,\n333\noptionxform() method, of ConfigParser\nobjects, 333\noptparse module, 374\nexample, 157\nor operator, boolean expressions, 9, 77\nor_() function, operator module, 274\n__or__() method, 60\nord() function, 77, 208\norder of evaluation, 78\nattempts to modify, 79\norder of operands, operator overloading,\n134\norganizing code for distribution, 152\nOS X, 331\nos module, 158, 378\nos.environ variable, 158\nos.path module, 396\nOSError exception, 87, 214\nossaudiodev module, 588\noutput() method\nof Morsel objects, 512\nof SimpleCookie objects, 512\nOutputString() method, of Morsel objects,\n513\noverflow, lack of with integers, 66\nOverflowError exception, 214\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n687\nOverflowError exception\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2162,
      "extraction_method": "Direct"
    },
    {
      "page_number": 713,
      "chapter": null,
      "content": "P\np debugger command, pdb module, 189\nP_* constants, spawnv() function, 392\npack() function, struct module, 290\npack() method, of Struct objects, 291\npack_into() function, struct module, 290\npack_into() method, of Struct objects, 291\npackages, 149\nrelative import, 150-151\nPACKET_* constants, socket module, 472\npacking\nbinary data structures, 290\nof tuples, 14\npairs, creating a list of from dictionary, 45\nparallel iteration over sequences, 83\nparameter passing to functions, 95\nparams attribute, of urlparse objects, 520\nparamstyle variable, database API, 300\npardir variable, os module, 386\nparent class, 119\nparentNode attribute, of DOM Node objects,\n570\nparetovariate() function, random module,\n256\nparse() function\nxml.dom.minidom module, 570\nxml.etree.ElementTree module, 578\nxml.sax module, 580\nparse() method\nof ElementTree objects, 574\nof Formatter objects, 288\nparse_args() method, of OptionParser\nobjects, 158, 376\nparse_header() function, cgi module, 536\nparse_multipart() function, cgi module, 536\nparse_qs() function, urllib.parse module,\n521\nparse_qsl() function, urllib.parse module,\n522\nparser module, 586\nparseString() function\nxml.dom.minidom module, 570\nxml.sax module, 580\nparsing\nCSV files, 548\nHTML, 561\nURLs, 520\nXML, 568\ncommand line options, 157, 374\nemail messages, 552\nform fields in CGI scripts, 534\nlarge XML documents with\nElementTree, 579\nrobots.txt file, 523\npartial() function\nfunctools module, 76, 268\nuse with network handlers, 510\npartition() method, of strings, 41, 43\npass statement, 9, 25, 82\npassword attribute\nof urlparse objects, 520\nof urlsplit objects, 521\npath attribute\nof BaseHTTPRequestHandler objects,\n509\nof urlparse objects, 520\nof urlsplit objects, 521\npath variable\nos module, 379\nsys module, 147, 177, 232\n__path__ attribute, of modules, 51\n__path__ variable, in packages, 151\npathconf() function, os module, 388\npathname attribute, of Record objects, 359\npathsep variable, os module, 386\npattern attribute, of Regex objects, 284\npattern syntax, regular expressions, 281\npause() function, signal module, 399\npdb module, 186\ndebugging programs from command\nshell, 189\n.pdbrc configuration file, 190\n.pdbrc configuration file, 190\npeek() method, of BufferReader objects,\n351\nPEM_cert_to_DER_cert() function, ssl mod-\nule, 488\n688\np debugger command, pdb module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2338,
      "extraction_method": "Direct"
    },
    {
      "page_number": 714,
      "chapter": null,
      "content": "PEP 249, Python Database API\nSpecification, 297\nPEP 333 (WSGI), 540\nper-user site directory, 154, 177\ninstalling packages in, 178\nperformance\nof binary file I/O, 351-352\nof generator expressions, 110\nof logging module, 369\nof type checking, 34\nPerl\nand dynamic scope, 97\ninterpretation of numeric strings vs.\nPython, 11\npermutations() function, itertools module,\n272\npersistent dictionary, shelve module, 171\nPHP, interpretation of numeric strings vs.\nPython, 11\npi variable, math module, 252\npickle module, 171, 226\n__main__ module, 228\nand multiprocessing module, 435\ncPickle, 229\nincompatible objects, 171\ninteraction with copy module, 220\nprotocol selection, 171-172\nsecurity concerns, 172\nused by shelve, 311\npickle protocol, selecting in shelve module,\n172\nPickler class, pickle module, 228\npickletools module, 586\npid attribute\nof Popen objects, 404\nof Process objects, 417\nPipe() function, multiprocessing module,\n421\npipe() function, os module, 385\npipelines and generators, 19\npipelines, and generators, 106-107\npipes module, 586\npipes, creating with subprocess module,\n403\npkgutil module, 586\nplacement of decorators, 101\nplatform module, 586\nplatform variable, sys module, 232\nplistlib module, 587\nplock() function, os module, 392\npm() function, pdb module, 186\nPOINTER() function, ctypes module, 614\npointer() function, ctypes module, 615\npoll() function, select module, 459\npoll() method\nof Connection objects, 421\nof Poll objects, 460\nof Popen objects, 403\nPOLL* constants, select module, 459\npolling, 459\nperformance of, 468-469\npolymorphism, 122\nPool() function, multiprocessing module,\n424\npop() method\nof array objects, 260\nof deque objects, 262\nof dicts, 45, 95\nof lists, 41\nof sets, 47\nPopen() function, subprocess module, 402\npopen() function, os module, 392\npopitem() method, of dicts, 45\npopleft() method, of deque objects, 262\npoplib module, 587\nport attribute\nof urlparse objects, 520\nof urlsplit objects, 521\nport number\nin network programs, 449\nlist of well known, 450\nportability, of marshal module, 226\nportable manipulation of filenames, 396\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n689\nportable manipulation of filenames\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2213,
      "extraction_method": "Direct"
    },
    {
      "page_number": 715,
      "chapter": null,
      "content": "pos attribute, of MatchObject objects, 286\npos() function, operator module, 273\n__pos__() method, 61\nPOSIX interface, 331\nposix attribute, of TarFile objects, 321\npost_mortem() function, pdb module, 186\npow() function, 66, 208\nmath module, 252\n__pow__() method, 60\npower operator **, 65\npp debugger command, pdb module, 189\npprint module, 586\npreamble attribute, of Message objects,\n554\nprec attribute, of Context objects, 247\nprecision, of floating point, 38\npredicate() function, itertools module, 271\nprefix attribute, of DOM Node objects, 570\n—prefix option to setup.py, 154\nprefix variable, sys module, 177, 232\n__prepare__() method, Python 3 meta-\nclasses, 627-628\npreventing the creation of .pyc files, 230\npreviousSibling attribute, of DOM Node\nobjects, 570\nprint statement, 6, 162\nand __str__(), 56\nand sys.stdout, 161\nfile redirection, 10, 163\nformatted output, 8, 162\nnewline suppression, 162\nsoftspace attribute of files, 162\nsyntax error with Python 3, 6\ntrailing comma, 10\nprint() function, 163, 209\nPython 3, 631\nenabling in Python 2.6, 163\nfile redirection, 163\nnewline suppression, 163\nseparator character, 163\nprint_directory() function, cgi module, 537\nprint_environ() function, cgi module, 537\nprint_environ_usage() function, cgi module,\n537\nprint_exc() function, traceback module, 236\nprint_exception() function, traceback mod-\nule, 236\nprint_form() function, cgi module, 537\nprint_last() function, traceback module,\n236\nprint_stack() function, traceback module,\n236\nprint_tb() function, traceback module,\n235-236\nprintable variable, string module, 287\nprintdir() method, of ZipFile objects, 326\nprintf() function equivalent, 8\nprinting to the screen, 10\nprinting\ncreating custom formatters, 288\ndates and times, 406\nformatted, 8\npriority queue, 269\nPriorityQueue() function, queue module,\n445\nprivate attributes, 127\nand properties, 128\nname mangling of, 127\nprivate class members, 26\nprivate methods, and inheritance, 128\nprivate specifier, lack of, 127\nprobability, random number distributions,\n255\nprocess attribute, of Record objects, 359\nprocess id, getting, 380\nProcess() function, multiprocessing module,\n416\nprocesses\nconnecting with pipes, 421\ndaemonic, 415\ndefinition of, 413\njoining, 415\nscheduling of, 414\nsending signals to, 392\nterminating, 392, 403-404, 415\nworker pools, 424\n690\npos attribute, of MatchObject objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2377,
      "extraction_method": "Direct"
    },
    {
      "page_number": 716,
      "chapter": null,
      "content": "ProcessingInstruction() function,\nxml.etree.ElementTree module, 575\nprocessingInstruction() method, of\nContentHandler objects, 581\nproducer-consumer\nwith coroutines, 20\nwith pipes, 422\nwith queues, 419\nwith threads and condition variables,\n441\nwith threads and semaphores, 439\nproduct() function, itertools module, 272\nprofile module, 190\nprofiling, 190\ninterpreting output, 191\nprogram execution model, 81\nprogram execution, main program, 146\nprogram structure, 81\nprogram termination, 7, 179, 233\nand garbage collection, 179\nbrutal, 179\nbrute force, 391\nignored NameError exception, 179\nregistering cleanup functions, 219\nprogramming errors, lack of compiler\nchecking, 181\nProgrammingError exception, database API,\n302\nprompts\nchanging, 176\ninteractive mode, 175\npropagate attribute, of Logger objects, 360\nproperties, 117\nand __setattr_() method, 131\nand private attributes, 128\ndefinition of, 124\nset and delete functions, 126\nuniform access principle, 125\nuse by methods, 125\n@property decorator, 124\nproperty() function, 126, 209\nprotected specifier, lack of, 127\nproto attribute, of socket objects, 484\nprotocol parameter, to pickle functions, 171\nprotocol_version attribute, of\nBaseHTTPRequestHandler class, 509\nProtocolError exception, xmlrpc.client mod-\nule, 527\nproxies, and attribute binding methods, 132\nproxy, 62\nproxy functions, 95\nproxy objects\nand multiprocessing module, 428, 431\nproblem with type checking, 135\nproxy() function, weakref module, 241\nProxyBasicAuthHandler class, urllib.request\nmodule, 518-519\nProxyDigestAuthHandler class, urllib.request\nmodule, 518-519\nProxyHandler class, urllib.request module,\n518-519\nProxyTypes class, weakref module, 241\nps1 variable, sys module, 232\nps2 variable, sys module, 232\n.pth files, site configuration, 177\npty module, 586\npunctuation variable, string module, 287\npush() method, of asynchat objects, 453\npush_with_producer() method, of asynchat\nobjects, 453\nput() method, of Queue objects, 418, 445\nput_nowait() method, of Queue objects,\n419, 445\nputch() function, msvcrt module, 373\nputenv() function, os module, 380\nputheader() method, of HTTPConnection\nobjects, 503\nputrequest() method, of HTTPConnection\nobjects, 503\nputwch() function, msvcrt module, 373\npwd module, 586\npwd() method, of FTP objects, 498\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n691\npwd() method, of FTP objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2410,
      "extraction_method": "Direct"
    },
    {
      "page_number": 717,
      "chapter": null,
      "content": ".py files, 6, 147\nand library modules, 23\npy2app package, 154\npy2exe package, 154\npy3k_warning attribute, of sys.flags, 230\npy3kwarning variable, sys module, 232\nPy_BEGIN_ALLOW_THREADS macro, 607\nPy_BuildValue() function, 602\npy_compile module, 586\nPy_DECREF() macro, 607\nPy_END_ALLOW_THREADS macro, 607\nPy_Finalize() function, 609\nPy_GetExecPrefix() function, 609\nPy_GetPath() function, 609\nPy_GetPrefix() function, 609\nPy_GetProgramFullPath() function, 609\nPy_INCREF() macro, 607\nPy_Initialize() function, 609\nPy_IsInitialized() function, 609\nPy_SetProgramName() function, 609\nPy_XDECREF() macro, 607\nPy_XINCREF() macro, 607\nPyArg_ParseTuple() function, 597\nPyArg_ParseTupleAndKeywords() function,\n597\nPyBytes_AsString() function, 611\n.pyc files, 147\ncompilation on import, 148\npreventing the creation of, 230\nwhen created, 148\npyclbr module, 586\n.pyd files, compiled extensions, 148\npydev, 5\npydoc command, 24\nPyErr_Clear() function, 606\nPyErr_ExceptionMatches() function, 606\nPyErr_NoMemory() function, 605\nPyErr_Occurred() function, 606\nPyErr_SetFromErrno() function, 605\nPyErr_SetFromErrnoWithFilename() func-\ntion, 605\nPyErr_SetObject() function, 605\nPyErr_SetString() function, 605\nPyEval_CallObject() function, 610\nPyEval_CallObjectWithKeywords() function,\n610\nPyExc_* exceptions, in extension modules,\n605\nPyFloat_AsDouble() function, 611\nPyImport_ImportModule() function, 610\nPyInt_AsLong() function, 611\nPyLong_AsLong() function, 611\nPyModule_AddIntConstant() function, 604\nPyModule_AddIntMacro() function, 605\nPyModule_AddObject() function, 604\nPyModule_AddStringConstant() function,\n604\nPyModule_AddStringMacro() function, 605\n.pyo files, 147\nwhen created, 148\nPyObject_GetAttrString() function, 610\nPyObject_SetAttrString() function, 610\npypi (Python Package Index), 154\npyprocessing library, 435\nPyRun_AnyFile() function, 608\nPyRun_InteractiveLoop() function, 609\nPyRun_InteractiveOne() function, 609\nPyRun_SimpleFile() function, 609\nPyRun_SimpleString() function, 609\nPyString_AsString() function, 611\nPySys_SetArgv() function, 610\nPython 3\n2to3 tool, 635-637\nEllipsis as an expression, 626\nI/O system, 349, 631\nUnicode characters in identifiers, 622\n__next__() method, 633\nabsolute imports, 634\nabstract base class, 137\nadoption of, 621\nand WSGI, 541\nbyte strings and system interfaces, 630\nchained exceptions, 626\ncommand line options, 633\ncommands module, 332\n692\n.py files\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2416,
      "extraction_method": "Direct"
    },
    {
      "page_number": 718,
      "chapter": null,
      "content": "comparison, 633\ndictionary comprehension, 623\ndictionary operations, 45\ndifference in extension modules, 595\ndifferent behavior of byte strings, 629\ndivision operator, 65\nencode() and encode() methods, 629\nenvironment variables, 633\nexception attributes, 213\nexec() function, 631\nextended iterable unpacking, 623\nfilenames, 633\nfiles, 160\nfilter() function, 205\nfunction annotations, 624\ngenerator changes, 103\nimport statement, 151\nincompatibility with Python 2, 621\ninteger division, 633\ninteractive mode encoding issues, 175\niterator protocol, 633\nkeyword-only arguments, 625\nmap() function, 207\nmetaclasses, 139, 627-628\nmigration pitfalls, 629\nnetwork programming, 452\nnext() method of generators, 53\nnonlocal statement, 624\nopen() function, 159, 208, 279\npractical porting strategy, 637\nprint() function, 209, 631\nraw_input() function, 209\nreorganization of network modules,\n497\nround() function, 209\nset comprehension, 623\nset literals, 622\nsocketserver module, 489\nstandard library reorganization, 634\nsuper() function, 120, 210, 627\nsupporting both Python 2 and 3, 638\nsyntax error with print, 6\nthird party libraries, 621\ntypes module, 237\nunbound methods, 49\nunicode() function removal, 211\nusing new built-in functions in Python\n2, 217\nview objects on dicts, 632\nviewing objects in ASCII, 201\nwho should use, 621\nxrange() and range() functions, 17\nxrange() function removal, 44, 211\nzip() function, 83, 211\npython interpreter, 6\nPYTHON* environment variables, 174\nPython.h header file, in extensions, 594\n.pyw files, 147, 176\nPyZipFile() function, zipfile module, 325\nQ\n-Q command line option, 173\nq(uit) debugger command, pdb module,\n189\nqsize() method, of Queue objects, 419, 445\nqueries, how to safely form for databases,\n300\nquery attribute\nof urlparse objects, 520\nof urlsplit objects, 521\nQueryInfoKey() function, winreg module,\n410\nQueryValue() function, winreg module, 410\nQueryValueEx() function, winreg module,\n410\nqueue module, 444\nQueue() function\nmultiprocessing module, 418\nqueue module, 444\nQueue() method, of Manager objects, 429\nqueue, circular, 262\nqueues\ncoroutines, 108\nexample with threads, 446\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n693\nqueues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2240,
      "extraction_method": "Direct"
    },
    {
      "page_number": 719,
      "chapter": null,
      "content": "message passing, 415\nmultiple consumers and producers, 420\npriority, 269\nshared by multiple processes, 429\nthread programming, 444\nquit() method\nof FTP objects, 498\nof SMTP objects, 514\nquitting the interactive interpreter, 7\nquopri module, 567\nquote() function, urllib.parse module, 522\nquote_from_bytes() function, urllib.parse\nmodule, 522\nquote_plus() function, urllib.parse module,\n522\nquoteattr() function, xml.sax.saxutils mod-\nule, 583\nquotes, difference between styles, 27\nquoting, characters in URLs, 522\nR\n!r specifier in string formatting, 74\nr character, before a string literal, 29\n‘r’ mode, to open() function, 159\nr(eturn) debugger command, pdb module,\n189\nrace condition, 193, 414\n__radd__() method, 60\nwhen invoked over __add__(), 134\nradians() function, math module, 251\nradix attribute, of sys.float_info, 231\nraise statement, 23, 84-85, 88\n__rand__() method, 61\nRAND_add() function, ssl module, 488\nRAND_egd() function, ssl module, 488\nRAND_status() function, ssl module, 488\nrandint() function, random module, 254\nrandom module, 254\nrandom numbers, and threads, 256\nrandom() function, random module, 255\nrandrange() function, random module, 254\nrange of integer values, 38\nrange() function, 17, 209\nremoval in Python 3, 17\nRational abstract base class, 253\nrational numbers, 250\nraw I/O on files, 350\nraw socket, 470\nraw strings, 29\nUnicode, 29\nbackslash rules, 29\nuse in regular expressions, 281\nraw-unicode-escape encoding, description\nof, 170\nraw_decode() method, of JSONDecoder\nobjects, 566\nraw_input() function, 10, 162, 209\nPython 3, 11, 209\nRawArray() function, multiprocessing mod-\nule, 427\nRawConfigParser class, configparser mod-\nule, 336\nRawIOBase abstract base class, 354\nRawValue() function, multiprocessing mod-\nule, 426\nRCVALL_* constants, socket module, 482\n__rdiv__() method, 60\n__rdivmod__() method, 60\nre attribute, of MatchObject objects, 286\nre module, 41, 69, 281\nread() function, os module, 385\nread() method\nof BufferReader objects, 351\nof ConfigParser objects, 333\nof FileIO objects, 350\nof HTTPResponse objects, 504\nof StreamReder objects, 278\nof TextIOWrapper objects, 353\nof ZipFile objects, 326\nof files, 159-160\nof mmap objects, 371\nof ssl objects, 488\nof urlopen objects, 515\nread-eval loop, 5\nread1() method, of BufferReader objects,\n351\n694\nqueues\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2324,
      "extraction_method": "Direct"
    },
    {
      "page_number": 720,
      "chapter": null,
      "content": "read_byte() method, of mmap objects, 371\nread_mime_types() function, mimetypes\nmodule, 567\nreadable() method\nof IOBase objects, 349\nof dispatcher objects, 456\nreadall() method, of FileIO objects, 350\nreader() function, csv module, 549\nReadError exception, tarfile module, 322\nreadfp() method, of ConfigParser objects,\n334\nreading CSV data, example of, 14\nreading configuration files, 332\nreading lines, files, 10\nreading user input, 10, 162\nreadinto() method, of BufferReader objects,\n351\nreadline library, 176\nreadline module, 586\nreadline() method\nof IOBase objects, 349\nof StreamReder objects, 278\nof TextIOWrapper objects, 353\nof files, 10, 159-160\nof mmap objects, 371\nof urlopen objects, 515\nreadlines() method\nof IOBase objects, 349\nof StreamReder objects, 278\nof files, 13, 159-160\nof urlopen objects, 515\nreadlink() function, os module, 388\nready() method, of AsyncResult objects,\n425\nReal abstract base class, 253\nreal attribute\nof complex numbers, 39\nof floating point, 39\nrealpath() function, os.path module, 398\nreason attribute, of HTTPResponse objects,\n504\nreassigning part of a list, 12\nRecord objects, logging module, 359\nrecursion limit, changing, 112, 235\nrecursion, 112\nand decorators, 102, 113\nand generator functions, 112\nrecursive traversal of directory trees, 390\nrecv() method\nof Connection objects, 421\nof dispatcher objects, 456\nof socket objects, 483\nrecv_bytes() method, of Connection objects,\n421\nrecv_bytes_into() method, of Connection\nobjects, 422\nrecv_into() method, of socket objects, 483\nrecvfrom() method, of socket objects, 483\nrecvfrom_info() method, of socket objects,\n483\nrecvmsg() system call, lack of support, 486\nreduce() function, functools module, 268\n__reduce__() method, 229\n__reduce_ex__() method, 229\nreentrant mutex lock, 438\nref() function, weakref module, 240\nreference counting, 34, 129\nand copying, 35\nand del statement, 35\nand memory use, 192\nand mutable objects, 36\nin extension modules, 607\nobtaining, 35\nreference cycles\nand garbage collection, 221\navoiding with weak references, 130,\n240\nReferenceError exception, 87, 214\nREG_* constants, winreg module, 409\nRegex objects, re module, 284\nregister command of setup.py file, 155\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n695\nregister command of setup.py file\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2325,
      "extraction_method": "Direct"
    },
    {
      "page_number": 721,
      "chapter": null,
      "content": "register() function\natexit module, 179, 219\nwebbrowser module, 544\nregister() method\nof BaseManager class, 430\nof Poll objects, 459\nof abstract base classes, 137\nregister_adapter() function, sqlite3 module,\n305\nregister_converter() function, sqlite3 mod-\nule, 304\nregister_dialect() function, csv module, 551\nregister_function() method, of\nXMLRPCServer objects, 527\nregister_instance() method, of\nXMLRPCServer objects, 527\nregister_introspection_functions() method,\nof XMLRPCServer objects, 528\nregister_multicall_functions() method, of\nXMLRPCServer objects, 528\nRegLoadKey() function, winreg module, 409\nregular expressions\npattern syntax, 281\nre module, 281\nuse of raw strings, 281\nrelational databases, accessing from\nPython, 297\nrelational operators, 9, 56\nrelative package imports, 150-151\nrelease() method\nof Condition objects, 441\nof Lock objects, 438\nof RLock objects, 439\nof Semaphore objects, 439\nreliable datagrams, 470\nreload() function, 149\nreloading modules, 149\nrelpath() function, os.path module, 398\nremote procedure call\nXML-RPC, 524\nmultiprocessing module, 423-424\nremove() function, os module, 388\nremove() method\nof Element objects, 577\nof array objects, 260\nof deque objects, 262\nof lists, 40-41\nof sets, 15, 47\nremove_option() method, of ConfigParser\nobjects, 334\nremove_section() method, of ConfigParser\nobjects, 334\nremoveChild() method, of DOM Node\nobjects, 571\nremovedirs() function, os module, 388\nremoveFilter() method\nof Handler objects, 364\nof Logger objects, 359\nremoveHandler() method, of Logger\nobjects, 361\nremoving directories, 318\nremoving files, 388\nremoving sequence items, 40\nremoving slices, 40\nrename() function, os module, 388\nrename() method, of FTP objects, 498\nrenames() function, os module, 388\nrepeat() function\ncProfile module, 190\nitertools module, 272\noperator module, 274\ntimeit module, 192\n‘replace’ error handling, Unicode encoding,\n166\nreplace() method\nof date objects, 337\nof datetime objects, 340\nof strings, 41, 43\nof time objects, 338\nreplace_header() method, of Message\nobjects, 556\nreplaceChild() method, of DOM Node\nobjects, 571\nreplacing substrings, 41\nreplication, of sequences and shallow\ncopies, 67\nreport() method, of dircmp objects, 315\nreport_full_closure() method, of dircmp\nobjects, 315\n696\nregister() function\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2304,
      "extraction_method": "Direct"
    },
    {
      "page_number": 722,
      "chapter": null,
      "content": "report_partial_closure() method, of dircmp\nobjects, 315\nrepr (reprlib) module, 586\nrepr() function, 11, 55, 77, 176, 209\nand eval(), 55\ndifference from str(), 12\n__repr__() method, 55-56\nrepresenting dates and times, 336\nrequest attribute, of BaseRequestHandler\nobjects, 490\nRequest() function, urllib.request module,\n516\nrequest() method, of HTTPConnection\nobjects, 503\nrequest_queue_size attribute, of\nSocketServer class, 492\nrequest_version attribute, of\nBaseHTTPRequestHandler objects, 509\nRequestHandlerClass attribute, of\nSocketServer objects, 492\nreraising the last exception, 84\nreserved attribute, of ZipInfo objects, 327\nreserved words, 26\nreset() method\nof HTMLParser objects, 562\nof IncrementalDecoder objects, 279\nof IncrementalEncoder objects, 278\nof StreamReder objects, 278\nof StreamWriter objects, 278\nresetwarnings() function, warnings module,\n239\nresize() function, ctypes module, 617\nresize() method, of mmap objects, 371\nresolution attribute\nof date class, 337\nof datetime class, 340\nof time class, 338\nof timedelta class, 341\nresource module, 587\nresponse time, asynchronous networking,\n467\nResponseNotReady exception, http.client\nmodule, 504\nresponses attribute, of\nBaseHTTPRequestHandler class, 509\nrestricting attribute names, 132\nrestype attribute, of ctypes function objects,\n613\nresult of last operation in interactive mode,\n6, 176\nretrbinary() method, of FTP objects, 499\nretrlines() method, of FTP objects, 499\nreturn statement, 96\nreturncode attribute, of Popen objects, 404\nreturning multiple values from a function,\n18, 96\nreverse keyword argument, to sort(), 40\nreverse() method\nof array objects, 260\nof lists, 40-41\nreversed operand methods, when invoked,\n134\nreversed operands, operator overloading,\n60\nreversed() function, 209\nreversing a list, 40\nrfile attribute\nof BaseHTTPRequestHandler objects,\n509\nof StreamRequestHandler objects, 491\nrfind() method, of strings, 41, 43\n__rfloordiv__() method, 60\nright shift operator >>, 65\nright_list attribute, of dircmp objects, 315\nright_only attribute, of dircmp objects, 315\nrindex() method, of strings, 41, 43\nrjust() method, of strings, 43\nrlcompleter module, 586\nrlecode_hqx() function, binascii module,\n548\nrledecode_hqx() function, binascii module,\n548\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n697\nrledecode_hqx() function, binascii module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2387,
      "extraction_method": "Direct"
    },
    {
      "page_number": 723,
      "chapter": null,
      "content": "RLock object\nmultiprocessing module, 427\nthreading module, 438\nRLock() method, of Manager objects, 429\n__rlshift__() method, 61\nrmd() method, of FTP objects, 499\nrmdir() function, os module, 388\n__rmod__() method, 60\nrmtree() function, shutil module, 319\n__rmul__() method, 60\nrobotparser module, 523\nrobots.txt file, 523\nrollback() method, of Connection objects,\n298\nrollover() method, of SpoolTemporaryFile\nobjects, 324\nroot logger, logging module, 355\n__ror__() method, 61\nrotate() method, of deque objects, 263\nrotating log files, 363\nRotatingFileHandler class, logging module,\n363\nround() function, 66, 209\nand Python 3, 209\nrounding attribute, of Context objects, 247\nrounding behavior, 66\nchange in Python 3, 66\nrounding, decimal module, 245\nrounds attribute, of sys.float_info, 231\nrow_factory attribute, of Connection\nobjects, 308\nrowcount attribute, of Cursor objects, 299\nrpartition() method, of strings, 41\n__rpow__() method, 61\n__rrshift__() method, 61\nrshift() function, operator module, 274\n__rshift__() method, 60\nrsplit() method, of strings, 41, 43\nrstrip() method, of strings, 43\n__rsub__() method, 60\n__rtruediv__() method, 60\nRuby, differences in object system, 124\nrun debugger command, pdb module, 189\nrun() function\ncProfile module, 190\npdb module, 186\nprofile module, 190\nrun() method\nof Process objects, 416\nof Thread objects, 436\nruncall() function, pdb module, 186\nruneval() function, pdb module, 186\nrunning programs, 6\nRuntimeError exception, 87, 214\nRuntimeWarning warning, 216, 238\n__rxor__() method, 61\nS\n!s specifier in string formatting, 74\n-S command line option, 173-174\n-s command line option, 173\ns(tep) debugger command, pdb module,\n189\nsafe_substitute() method, of Template\nobjects, 289\nSafeConfigParser class, configparser mod-\nule, 336\nsame_files attribute, of dircmp objects, 315\nsamefile() function, os.path module, 398\nsameopenfile() function, os.path module,\n398\nsamestat() function, os.path module, 398\nsample() function, random module, 255\nSaveKey() function, winreg module, 410\nSAX interface\nXML parsing, 568\nexample of, 583\nscaling, with concurrency, 415\nsched module, 587-588\nscheduler, for generators and coroutines,\n447\nscheme attribute\nof urlparse objects, 520\nof urlsplit objects, 521\nscientific notation, floating point, 27\n698\nRLock object\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2319,
      "extraction_method": "Direct"
    },
    {
      "page_number": 724,
      "chapter": null,
      "content": "scoping rules\nand module imports, 145\nand self parameter in methods, 118\nlexical scoping of functions, 97\nof classes, 118\nof function variables, 18, 96\nof iteration variable in list comprehen-\nsion, 109\nof iteration variables, 82\nscript name, 157\nsearch path, for modules, 147\nsearch() function, re module, 284\nsearch() method, of Regex objects, 285\nsearching, strings with an offset, 41\nsecond attribute, of time objects, 338\nsections() method, of ConfigParser objects,\n334\nsecure sockets layer (SSL), 486\nsecurity\nXML-RPC servers, 530\ndatabase queries, 300\nmarshal module, 226\npickle module, 172, 229\nseed() function, random module, 254\nseek() method\nof IOBase objects, 350\nof files, 160-161, 352\nof mmap objects, 371\nseekable() method, of IOBase objects, 350\nselect module, 415, 459\nsignal handling, 399\nselect() function\nand asyncore module, 455\nperformance problems, 467\nselect module, 459\nself parameter of methods, 22, 118\nwhy required, 119\n__self__ attribute\nof built-in functions, 49\nof methods, 49\nSemaphore object\nmultiprocessing module, 427\nthreading module, 439\nSemaphore objects, use for signaling, 439\nSemaphore() method, of Manager objects,\n429\nsemicolon ;, 26\nsend() method\nof Connection objects, 422\nof HTTPConnection objects, 503\nof dispatcher objects, 456\nof generators, 20, 53, 104\nof socket objects, 484\nsend_bytes() method, of Connection\nobjects, 422\nsend_error() method, of\nBaseHTTPRequestHandler objects, 509\nsend_header() method, of\nBaseHTTPRequestHandler objects, 509\nsend_response() method, of\nBaseHTTPRequestHandler objects, 509\nsend_signal() method, of Popen objects,\n403\nsendall() method, of socket objects, 484\nsendcmd() method, of FTP objects, 499\nsending email, example of, 514, 558\nsendmail() method, of SMTP objects, 514\nsendmsg() system call, lack of support, 486\nsendto() method, of socket objects, 484\nsentinel, use with queuing, 420, 446\nsep keyword argument, to print() function,\n163\nsep variable, os module, 386\nseparator character, print() function, 163\nSequence abstract base class, 266\nsequences, 39\ncomparison of, 70\nconcatenation, 67\nextended slicing of, 68\nin operator, 67\nindexing in string formatting, 72\nitem assignment, 40\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n699\nsequences\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2290,
      "extraction_method": "Direct"
    },
    {
      "page_number": 725,
      "chapter": null,
      "content": "iteration over, 39, 69\nlookup in composite string formatting,\n42\nnegative indices, 68\noperators, 67\npicking random elements, 254\nrandom sampling, 254\nreplication, 67\nshallow copies in replication, 67\nslice assignment, 40\nslicing operator, 68\nspecial methods of, 58\nunpacking, 67-68\nserve_forever() method\nof BaseManager objects, 431\nof SocketServer objects, 491\nserver attribute, of BaseRequestHandler\nobjects, 490\nserver program, 449\nTCP example, 451\nUDP example, 485\nexample of restricting access with\nHTTP, 507\nexample with SocketServer module,\n490\nexample with coroutines, 464\nserver_address attribute, of SocketServer\nobjects, 492\nserver_version attribute\nof BaseHTTPRequestHandler class,\n508\nof HTTPRequestHandler class, 507\nServerProxy() function, xmlrpc.client mod-\nule, 524\nSet abstract base class, 266\nset comprehension, Python 3, 623\nset difference operator -, 75\nset intersection operator &, 75\nset literals, Python 3, 622\nset symmetric difference operator ^, 75\nset theory, similarity to list comprehen-\nsions, 110\nset type, 38, 46, 75\nset union operator |, 75\nset() function, 15, 77, 210\nset() method\nof ConfigParser objects, 334\nof Element objects, 577\nof Event objects, 440\nof Morsel objects, 512\n__set__() method, of descriptors, 58, 126\nset_authorizer() method, of Connection\nobjects, 306\nset_boundary() method, of Message\nobjects, 556\nset_charset() method, of Message objects,\n556\nset_conversion_mode() function, ctypes\nmodule, 617\nset_debug() function, gc module, 221\nset_default_type() method, of Message\nobjects, 556\nset_defaults() method, of OptionParser\nobjects, 158, 377\nset_errno() function, ctypes module, 618\nset_executable() function, multiprocessing\nmodule, 435\nset_last_error() function, ctypes module,\n618\nset_param() method, of Message objects,\n556\nset_pasv() method, of FTP objects, 499\nset_payload() method, of Message objects,\n556\nset_progress_handler() method, of\nConnection objects, 307\nset_proxy() method, of Request objects,\n517\nset_server_documentation() method, of\nXMLRPCServer objects, 528\nset_server_name() method, of\nXMLRPCServer objects, 528\nset_server_title() method, of XMLRPCServer\nobjects, 528\nset_terminator() method, of asynchat\nobjects, 453\nset_threshold() function, gc module, 221\nset_trace() function, pdb module, 186\nset_type() method, of Message objects,\n557\n700\nsequences\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2352,
      "extraction_method": "Direct"
    },
    {
      "page_number": 726,
      "chapter": null,
      "content": "set_unixfrom() method, of Message\nobjects, 557\nset_usage() method, of OptionParser\nobjects, 377\nset_wakeup_fd() function, signal module,\n399\nsetattr() function, 210\nand private attributes, 128\n__setattr__() method, 57-58, 131\nand __slots__, 133\nsetblocking() method, of socket objects,\n484\nsetcheckinterval() function, sys module,\n235\nsetcontext() function, decimal module, 248\nsetDaemon() method, of Thread objects,\n437\nsetdefault() method\nof dicts, 45\nof dicts and defaultdict objects, 263\nsetdefaultencoding() function, sys module,\n235\nsetdefaultencoding() method, sys module,\n177\nsetdefaulttimeout() function, socket mod-\nule, 476\nsetdlopenflags() function, sys module, 235\nsetDocumentLocator() method, of\nContentHandler objects, 581\nsetegid() function, os module, 380\nseteuid() function, os module, 380\nsetFormatter() method, of Handler objects,\n365\nsetgid() function, os module, 380\nsetgroups() function, os module, 380\nsetinputsize() method, of Cursor objects,\n299\nsetitem() function, operator module, 274\n__setitem__() method, 58-59\nand slices, 59\nsetitimer() function, signal module, 399\nsetLevel() method\nof Handler objects, 364\nof Logger objects, 359\nsetmode() function, msvcrt module, 373\nsetName() method, of Thread objects, 436\nsetoutputsize() method, of Cursor objects,\n299\nsetpassword() method, of ZipFile objects,\n326\nsetpgid() function, os module, 381\nsetpgrp() function, os module, 381\nsetprofile() function\nsys module, 235\nthreading module, 444\nsetrecursionlimit() function, sys module,\n235\nsetregid() function, os module, 381\nsetreuid() function, os module, 381\n_setroot() method, of ElementTree objects,\n574\nsets, 15\nadding items, 15\ncreating from iterable objects, 46\ndifference operator, 15\nequality of, 78\nin-place modification of, 47\nintersection operator, 15\nlength of, 75\nremoving items, 15\nsymmetric difference operator, 15\nunion operator, 15\nupdating, 15\nsetsid() function, os module, 381\nsetslice() function, operator module, 274\nsetsockopt() method, of socket objects, 484\nsetstate() function, random module, 254\n__setstate__() method, 228\nand copying, 220\nand pickle module, 172\n@setter decorator of properties, 126\nsettimeout() method, of socket objects, 484\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n701\nsettimeout() method, of socket objects\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2337,
      "extraction_method": "Direct"
    },
    {
      "page_number": 727,
      "chapter": null,
      "content": "setting default encoding of standard I/O,\n175\nsettrace() function\nsys module, 235\nthreading module, 444\nsetuid() function, os module, 381\nsetUp() method\nTestCase objects, 184\nof TestCase objects, 184\nsetup() function, distutils module, 152, 596\nsetup() method, of BaseRequestHandler\nobjects, 490\nsetup.py file\nC extensions, 596\nSWIG extensions, 620\nand setuptools, 154\ncreating, 152-153\ninstall command, 153-154\ninstalling in per-user site directory, 178\nsetuptools library, 147, 154\nSetValue() function, winreg module, 411\nSetValueEx() function, winreg module, 411\nsha1() function, hashlib module, 559\nsha224() function, hashlib module, 559\nsha256() function, hashlib module, 559\nsha384() function, hashlib module, 559\nsha512() function, hashlib module, 559\nshallow copy, 36\nof dicts, 45\nof lists, 40\nsequence replication, 67\nshared arrays, multiprocessing module,\n426\nshared libraries\nextension modules, 148\nloading with ctypes, 612\nshared memory\nexample of passing a list, 427\nmultiprocessing module, 426\nsharing of objects, 35\nShelf class, shelve module, 311\nshell commands\ncollecting output from, 331\nemulating in Python, 318\nshell pipes, similarity to generators, 106\nshelve module, 171, 311\ndbhash module, 311\nselecting the pickle protocol, 172\nshlex module, 588\nshort-circuit evaluations, of boolean expres-\nsions, 78\nshowwarning() function, warnings module,\n239\nshuffle() function, random module, 255\nshutdown() function, logging module, 366\nshutdown() method\nof BaseManager objects, 431\nof SocketServer objects, 492\nof socket objects, 484\nshutil module, 318\nside effects\nin functions, 95\nreasons to avoid, 96\nSIG* signal names, 400\nSIGHUP signal, 179\nsiginterrupt() function, signal module, 400\nsignal handling, 399\nsignal module, 399\nsignal() function, signal module, 400\nsignaling, with semaphores, 439\nsignals\nclose() method of generators, 104\nlist of, 400\nmixing with threads, 402\nthrow() method of generators, 105\nSIGTERM signal, 179\nsimple_producer() function, asynchat mod-\nule, 453\nSimpleCookie() function, http.cookies mod-\nule, 512\nSimpleHandler() function, wsgiref.handlers\nmodule, 543\nSimpleHTTPRequestHandler class,\nhttp.server module, 507\nSimpleHTTPServer module, see http.server,\n506\nSimpleXMLRPCServer class, xmlrpc.server\nmodule, 527\n702\nsetting default encoding of standard I/O\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2328,
      "extraction_method": "Direct"
    },
    {
      "page_number": 728,
      "chapter": null,
      "content": "SimpleXMLRPCServer module, 527\nsin() function, math module, 252\nsingle precision floating point, 39\nsingleton tuple, 14\nsinh() function, math module, 252\nsite configuration files, 177\nsite module, 166, 174, 177\nsite-packages directory, 175\nsitecustomize module, 177\nsize attribute\nof Struct objects, 291\nof TarInfo objects, 322\nsize() method\nof FTP objects, 499\nof mmap objects, 371\nSized abstract base class, 265\nsizeof() function, ctypes module, 618\nskippedEntity() method, of ContentHandler\nobjects, 581\nsleep() function, time module, 406\nsleeping, 406\nuntil signal received, 399\nslice assignment, lists, 12\nslice objects, 51, 53\nand indexing methods, 59\nattributes of, 54\nslice type, 51\nslice() function, 53, 210\nslices, 39\nand special methods, 59\nand xrange objects, 44\nassignment to, 40, 69\ndeletion of, 40, 69\nmultidimensional, 59\nslicing operator [:], 67-68\non lists, 12\non strings, 11\n__slots__ attribute\nand __dict__ attribute of instances, 50\ncompatibility with other code, 133\ninheritance, 133\nof class definitions, 132\noptimization, 196\nSmalltalk, differences in object system, 124\nSMTP protocol, example of sending a mes-\nsage, 514\nSMTP() function, smtplib module, 514\nsmtpd module, 587\nSMTPHandler class, logging module, 363\nsmtplib module, 513\nsndhdr module, 588\nsniff() method, of Sniffer objects, 550\nSniffer() function, csv module, 550\nSO_* socket options, socket module, 479\nSOCK_* constants, socket module, 470\nsocket attribute, of SocketServer objects,\n492\nsocket module, 469\nsocket() function, socket module, 476\nsocket, definition of, 449\nsocket_type attribute, of SocketServer\nclass, 493\nSocketHandler class, logging module, 363\nsocketpair() function, socket module, 477\nsockets\naddress families, 470\nmethods on, 478\npolling with select(), 459\nspecifying network addresses, 471\ntypes of, 470\nSocketServer module, 489\nand Python 3, 489\nchanging server parameters, 492\nsoftspace attribute, of files, 161\nsort() method, of lists, 40-41\nsorted() function, 210\nsorting\nchanging behavior of, 40\nin-place on lists, 40\nrequirements for objects, 57\nreverse order, 40\nuse of operator module, 275\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n703\nsorting\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2224,
      "extraction_method": "Direct"
    },
    {
      "page_number": 729,
      "chapter": null,
      "content": "source code encoding, 31\nPython 3, 622\nspan() method, of MatchObject objects,\n286\nspawnl() function, os module, 393\nspawnle() function, os module, 393\nspawnlp() function, os module, 393\nspawnlpe() function, os module, 393\nspawnv() function, os module, 392\nspawnve() function, os module, 393\nspawnvp() function, os module, 393\nspawnvpe() function, os module, 393\nspecial methods, 21, 54\nspecial symbols, 30\nspeedup, definition of, 192\nsplit() function\nos.path module, 398\nre module, 284\nsplit() method\nof Regex objects, 285\nof strings, 14, 41, 43\nsplitdrive() function, os.path module, 398\nsplitext() function, os.path module, 398\nsplitlines() method, of strings, 44\nsplitting, strings, 14, 43\nsplitunc() function, os.path module, 398\nSpooledTemporaryFile() function, tempfile\nmodule, 324\nsprintf() function equivalent, 70\nspwd module, 587\nSQL queries\nSQL injection attack, 300\nexamples of, 309\nexecuting on database, 297\nhow to form, 300\nsimilarity to list comprehensions, 111\nSQLite database, 303\nsqlite3 module, 303\nsqrt() function, math module, 252\nsqrt() method, of Decimal objects, 243\nssl module, 486\nSSL, example of creating certificates, 489\nst_* attributes, of stat objects, 389\nstack frames, 52\nin tracebacks, 53\nstack size, for threads, 444\nstack() function, inspect module, 225\nstack_size() function, threading module,\n444\nStackless Python, 467\nstandard I/O streams, 161\nand integrated development environ-\nments, 162\nsetting the default encoding, 175\nstandard error, 157\nstandard input and output, 10\nstandard library reorganization, Python 3,\n634\nstandard_b64decode() function, base64\nmodule, 546\nstandard_b64encode() function, base64\nmodule, 546\nStandardError exception, 87\nstarmap() function, itertools module, 272\nstart attribute, of slices, 54\nstart() method\nof BaseManager objects, 431\nof MatchObject objects, 286\nof Process objects, 416\nof Thread objects, 436\nof Timer objects, 438\nof TreeBuilder objects, 577\nstartDocument() method, of\nContentHandler objects, 582\nstartElement() method, of ContentHandler\nobjects, 582\nstartElementNS() method, of\nContentHandler objects, 582\nstartfile() function, os module, 393\nstartPrefixMapping() method, of\nContentHandler objects, 582\nstartswith() method, of strings, 44\nstartup script, in interactive mode, 174\nstat module, 387, 587\nstat() function\nos module, 388\nos.path module, 398\n704\nsource code encoding\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2389,
      "extraction_method": "Direct"
    },
    {
      "page_number": 730,
      "chapter": null,
      "content": "stat_float_times() function, os module, 389\nstatement termination, 7\nand semicolons, 7\nstatements\nbreaking across multiple lines, 9\nputting on the same line, 25-26\nrunning in the debugger, 186\nstatic method, 22, 48, 123, 125\npractical use of, 123\n@staticmethod decorator, 22, 48, 123, 125,\n210\nstatistics, random number distributions,\n255\nstatus attribute, of HTTPResponse objects,\n504\nstatvfs() function, os module, 389\nstderr attribute, of Popen objects, 404\nstderr variable, sys module, 161, 232\n__stderr__ variable, sys module, 162, 232\nstdin attribute, of Popen objects, 404\nstdin variable, sys module, 10, 161, 232\n__stdin__ variable, sys module, 162, 232\nstdout attribute, of Popen objects, 404\nstdout variable, sys module, 10, 161, 232\n__stdout__ variable, sys module, 162, 232\nstep attribute, of slices, 54\nStopIteration exception, 59, 87, 215\nand generators, 103\nstorbinary() method, of FTP objects, 499\nstorlines() method, of FTP objects, 499\nstr type, 38\nstr() function, 11, 56, 76, 210\nand print, 162\ndifference from repr(), 12\n__str__() method, 55-56\nStreamError exception, tarfile module, 322\nStreamHandler class, logging module, 363\nStreamReader class, codecs module, 278\nstreamreader() method, of CodecInfo\nobjects, 278\nStreamRequestHandler class, SocketServer\nmodule, 491\nstreams, 470\nStreamWriter class, codecs module, 278\nstreamwriter() method, of CodecInfo\nobjects, 278\nstrerror() function, os module, 381\nstrftime() function, time module, 406\nstrftime() method\nof date objects, 337\nof time objects, 338\n‘strict’ error handling, Unicode encoding,\n166\nstring attribute, of MatchObject objects,\n286\nstring formatting, 70\n!r specifier, 74\n!s specifier, 74\nalignment, 73\nattribute lookup, 72\ncodes for % operator, 70-71\ncustomizing format() method, 74\ndictionaries, 72\ndictionary lookup, 72\nfill characters, 73\nformat specifiers, 72\nformatting operator %, 70\nstring interpolation, 72, 163\nstring literals, 27\nUnicode characters, 28\nand Unicode encodings, 29\nand documentation strings, 30\nbyte strings, 29\nunicode characters in source code, 31\nstring module, 287\nTemplate strings, 164\nstring_at() function, ctypes module, 618\nStringIO class, io module, 353\nstringprep module, 586\nstrings, 11\nUnicode, 41, 165\nand numeric calculations, 11\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n705\nstrings\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2367,
      "extraction_method": "Direct"
    },
    {
      "page_number": 731,
      "chapter": null,
      "content": "as a dictionary key, 16\nas in-memory text files, 353\nas sequences, 39\nbasestring object for type checking,\n202\nbyte literals, 29\nbyte strings, 41, 202\ncase conversion, 43-44\ncharacter substitution, 42\ncomparison of, 70\nconcatenation, 11\nconcatenation of adjacent literals, 27\ncreating custom formatters, 288\ndisabling escape codes in literals, 29\nencoding for URLs, 522\nescape codes in literals, 27\nescaping characters for use in HTML,\n536\nescaping characters for use in XML,\n583\nexecuting Python code contained\nwithin, 115\nformat() method, 8, 72\nformatting, 8, 42\nformatting in log messages, 358\nimmutability of, 41, 69\nindexing, 11\ninternal representation, 28\niterating over characters, 17\njoining, 43\nline structure, 11\nmixing byte strings and Unicode, 70\nmutable byte arrays, 202\npartitioning, 41\nregular expressions, 281\nreplacing substrings, 41\nsearching for substrings, 41\nslices, 11\nsorting and internationalization, 70\nspecifiers for format() method, 72-73\nsplitting, 43\nsplitting into fields, 14, 41\nstripping, 43\nunescaping XML character references,\n583\nstrip() method, of strings, 44\nstripping\ncontrol characters from a string, 42\nstrings, 44\nstrptime() function, time module, 343, 407\nstrptime() method, of datetime class, 339\nStruct class, struct module, 291\nstruct module, 290\nStructure class, ctypes module, 614\nstructures, and tuples, 14\nsub() function\noperator module, 273\nre module, 284\nsub() method, of Regex objects, 285\n__sub__() method, 60\nsubclass, 119\n__subclasscheck__() method, 57, 136\nsubdirs attribute, of dircmp objects, 315\nSubElement() function,\nxml.etree.ElementTree module, 575\nsubn() function, re module, 284\nsubn() method, of Regex objects, 285\nsubprocess module, 402\nsubprocess, definition of, 413\nsubstitute() method\nof Template objects, 289\nof Template strings, 164\nsubstrings\nchecking for existence using in, 69\nsearching for, 41\nsubtraction operator -, 65\nsucessful() method, of AsyncResult objects,\n425\nsum() function, 39-40, 67, 210\naccuracy of, 252\nand decimal module, 69\nrestriction to numeric data, 39\nversus math.fsum() function, 252\nsunau module, 588\nsuper() function, 120, 210\nPython 3, 210, 627\nsuperclass, 119\ncalling methods in, 120\nsuper() function, 120\n706\nstrings\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2241,
      "extraction_method": "Direct"
    },
    {
      "page_number": 732,
      "chapter": null,
      "content": "supporting both Python 2 and 3, 638\nsupports_unicode_filenames variable,\nos.path module, 398\nsurrogate pair, 28, 41\nsuspension, of threads, 443\nswapcase() method, of strings, 44\nSWIG, 591\nexample of, 619\ninterface file, 619\nswitch statement, lack of, 9\nsymbol module, 586\nsymbolic links, testing a filename for, 397\nsymlink() function, os module, 389\nsymmetric difference operator ^, of sets,\n15\nsymmetric_difference() method, of sets, 46\nsymmetric_difference_update() method, of\nsets, 47\nsync() method\nof dbm-style database objects, 310\nof shelve objects, 311\nsynchronization primitives\nmultiprocessing module, 427\nthreading module, 438\nsynchronization\nof close() method of generators, 104\nof concurrent programs, 414\nof throw() method of generators, 105\nSyntaxError exception, 87, 215\nPython 3 print statement, 6\nand default arguments, 93\nand except statements, 85\nSyntaxWarning warning, 216, 238\nsys module, 13, 229\nsys.argv variable, 13, 157, 174\nsys.displayhook variable, 176\nsys.exec_prefix variable, 177\nsys.exit() function, 179\nsys.modules variable, 144, 149\nsys.path variable, 147\nand site module, 177\nthird-party modules, 154\nsys.prefix variable, 177\nsys.ps1 variable, 176\nsys.ps2 variable, 176\nsys.stderr variable, 157, 161\nsys.stdin variable, 161\nsys.stdout variable, 161\nsys_version attribute, of\nBaseHTTPRequestHandler class, 508\nsysconf() function, os module, 395\nsyslog module, 587\nSysLogHandler class, logging module, 363\nsystem calls, os module, 378\nsystem error codes, 344\nsystem() function, os module, 393\nsystem.listMethods() method, of\nServerProxy objects, 525\nSystemError exception, 87, 215\nSystemExit exception, 7, 87-88, 157, 179,\n215\nT\n-t command line option, 26, 173-174\ntab escape code in strings, 28\ntabcheck attribute, of sys.flags, 230\nTabError exception, 26, 87, 215\ntabnanny module, 586\ntabs, and indentation, 26\ntag attribute, of Element objects, 576\ntagName attribute, of DOM Element\nobjects, 572\ntail attribute, of Element objects, 576\ntail command, example with generators, 19\ntail-recursion optimization, lack of, 112\ntakewhile() function, itertools module, 272\ntan() function, math module, 252\ntanh() function, math module, 252\nTarError exception, tarfile module, 322\nTarFile objects, tarfile module, 320\ntarfile module, 319\nTarInfo objects, tarfile module, 321\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n707\nTarInfo objects, tarfile module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2438,
      "extraction_method": "Direct"
    },
    {
      "page_number": 733,
      "chapter": null,
      "content": "task scheduler, example with coroutines\nand select(), 460\ntask_done() method\nof JoinableQueue objects, 419\nof Queue objects, 445\ntasklets, 446\nasynchronous I/O, 460\ntasks, and coroutines, 20\ntb_* attributes, of traceback objects, 53\ntb_lineno() function, traceback module, 236\ntbreak debugger command, pdb module,\n189\ntcgetpgrp() function, os module, 385\nTCP connection, diagram of, 450\nTCP protocol, 449\nexample code, 451\nTCP_* socket options, socket module, 482\nTCPServer class, SocketServer module, 491\ntcsetpgrp() function, os module, 385\ntearDown() method\nTestCase objects, 184\nof TestCase objects, 184\ntee() function, itertools module, 273\ntell() method\nof IOBase objects, 350\nof files, 160-161\nof mmap objects, 371\ntelnetlib module, 587\ntempdir variable, tempfile module, 324\ntempfile module, 323\nTemplate class, string module, 289\nTemplate strings\nstring module, 164\nuse in CGI script, 537\ntemplate attribute, of Template objects,\n290\ntemplate variable, tempfile module, 324\ntemporary files, 323\nTemporaryFile() function, tempfile module,\n323\nterminate() method\nof Pool objects, 425\nof Popen objects, 403-404\nof Process objects, 416\nterminating statements with semicolons, 7\ntermination\nimmediate without garbage collection,\n391\nof programs, 179\nof threads, 443\nregistering cleanup functions, 219\nsys.exit() function, 233\nwithout garbage collection, 179\ntermios module, 587\ntest module, 586\ntest() function, cgi module, 537\nTestCase class, unittest module, 184\ntesting\ndoctest module, 181\ndocumentation strings, 181\nlimitations of doctest, 183\nunit testing, 183\ntestmod() function\ndoctest() module, 182\ndoctest module, 182\ntestzip() method, of ZipFile objects, 326\nText class, xml.dom.minidom module, 572\ntext I/O, 353\ntext attribute, of Element objects, 576\ntext file mode, 159\ntext replacement, replace() method of\nstrings, 41\ntext versus bytes in Python 3, 629\ntext_factory attribute, of Connection\nobjects, 308\nTextIOBase abstract base class, 354\nTextIOWrapper class, io module, 353\ntextwrap module, 586\nthird-party libraries, and Python 3, 621\nthird-party packages\nand C/C++ code, 154\nand sys.path variable, 154\n708\ntask scheduler, example with coroutines and select()\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2204,
      "extraction_method": "Direct"
    },
    {
      "page_number": 734,
      "chapter": null,
      "content": "installation of, 154\ninstalling in per-user site directory, 154,\n178\nthis pointer, self parameter of methods,\n119\nThread class, threading module, 436\nthread attribute, of Record objects, 359\nthreading module, 436\nsynchronization primitives, 438\nThreadingMixIn class, SocketServer mod-\nule, 494\nThreadingTCPServer class, SocketServer\nmodule, 494\nThreadingUDPServer class, SocketServer\nmodule, 494\nthreadName attribute, of Record objects,\n359\nthreads\nCPU-bound tasks, 444\nadding to network servers, 494\natomic operations and disassembly, 193\ncheck interval, 234\nclose() method of generators, 104\ncompared to coroutines, 467\ncondition variables, 441\ndaemonic, 436\ndatabase modules, 302\ndecimal module, 249\ndefinition of, 413\nevents, 440\nextension modules, 607\nglobal interpreter lock, 414, 444\nlocal storage, 443\nmain thread, 413\nmutex lock, 438\nobtaining number of active, 443\nrandom number generation, 256\nreentrant mutex lock, 438\nscaling properties, 415\nscheduling of, 414\nsemaphores, 439\nsetting stack size, 444\nsetting the name, 436\nsignal handling, 402\nsignaling with semaphores, 439\nsuspending, 443\nsynchronization of, 414\ntermination of, 443\nthrow() method of generators, 105\nuse of queues, 444\nworker thread example, 446\nthreadsafety variable, database API, 302\nthrow() method, of generators, 53, 105-106\ntime and date parsing, 407\ntime class, datetime module, 338\ntime manipulation, 336\ntime module, 191, 405\naccuracy of time functions, 408\ncurrent time, 405\ntime parsing, 343\nTime() function, database API, 301\ntime() function, time module, 191, 407\ntime() method, of datetime objects, 340\ntimedelta class, datetime module, 340\nTimedRotatingFileHandler class, logging\nmodule, 363\nTimeFromTicks() function, database API,\n301\ntimeit module, 191\ntimeit() function\ncProfile module, 190\ntimeit module, 191\ntimeout attribute, of SocketServer class,\n493\ntimeout exception, socket module, 485\ntimeout, example with alarm signals, 401\nTimer() function, threading module, 437\ntimes() function, os module, 394\nTimestamp() function, database API, 301\nTimestampFromTicks() function, database\nAPI, 301\ntimetuple() method, of date objects, 337\ntimetz() method, of datetime objects, 340\ntimezone variable, time module, 405\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n709\ntimezone variable, time module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2352,
      "extraction_method": "Direct"
    },
    {
      "page_number": 735,
      "chapter": null,
      "content": "timing measurements, 191\nTIPC protocol, 470\naddress format, 472\nTIPC_* constants, socket module, 473\ntitle() method, of strings, 44\nTkinter module, 588\ntoday() method, of date class, 336\ntofile() method, of array objects, 260\ntoken module, 586\ntokenize module, 586\ntolist() method, of array objects, 260\ntoordinal() method, of date objects, 337\ntoprettyxml() method, of DOM Node\nobjects, 572\ntostring() function, xml.etree.ElementTree\nmodule, 578\ntostring() method, of array objects, 260\ntotal_changes attribute, of Connection\nobjects, 308\ntounicode() method, of array objects, 260\ntoxml() method, of DOM Node objects, 573\ntrace() function, inspect module, 225\ntraceback messages, 22\ntraceback module, 235\ntraceback objects, 51-52\nattributes of, 53\nstack frames, 53\n__traceback__ attribute, of Exception\nobjects, 213\ntracebacklimit variable, sys module, 232\ntracebacks\ncreating with traceback module, 236\nlimiting the amount of output, 232\nTracebackType type, 51, 237\ntrailing J on complex number literals, 27\ntrailing L on long integers, 27\ntrailing comma\nand tuples, 14\nprint statement, 162\ntransfercmd() method, of FTP objects, 500\ntranslate() method, of strings, 42, 44\ntraps attribute, of Context objects, 247\nTreeBuilder() function,\nxml.etree.ElementTree module, 577\ntriangular() function, random module, 256\ntriple-quoted strings, 11\nand variable interpolation, 163\nTrue value, 9, 27, 38\ntruediv() function, operator module, 273\n__truediv__() method, 60\ntrunc() function, math module, 252\ntruncate() method\nof IOBase objects, 350\nof files, 160\ntruncating division operator //, 65\ntruncation, of integer division, 61, 65\ntruth value testing, 78\ntruth values, 9\ntruth() function, operator module, 274\ntry statement, 22, 84-85\n-tt command line option, 26, 173-174\ntty module, 587\nttyname() function, os module, 385\ntuning strategies, 194\ntuple type, 38\ntuple unpacking, and for-loops, 15\ntuple() function, 77, 211\ntuples, 14\nand string formatting, 70\nas dictionary key, 16\nas dictionary keys, 74\nas sequence, 39\ncomparison on, 70\nconcatenation, 14\ncreating a list of from dictionary, 45\ncreating with named attributes, 264\nimmutability, 14\nimmutability of, 69\nindexing, 14\nmemory savings of, 14\nomission of parantheses, 14\nproblems with using as data structure,\n264\nrepresenting records, 14\nsingleton, 14\n710\ntiming measurements\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2355,
      "extraction_method": "Direct"
    },
    {
      "page_number": 736,
      "chapter": null,
      "content": "slicing, 14\nunpacking in Python 3, 623\nunpacking in iteration, 82\nuse by standard library, 265\nuse in list comprehensions, 109\nversus lists, 14\nTwisted library, 415, 467\ntwo-dimensional lists, 13, 15\ntype, 47\ntype attribute\nof FieldStorage objects, 535\nof TarInfo objects, 322\nof socket objects, 484\ntype checking\nexample with metaclass, 140\nof objects, 34\nperformance impact of, 34\nproblem with proxy objects, 135\ntype coercion, and operator overloading,\n134\ntype comparison of objects, 34\ntype conversion, 76\nlack of implicit conversion, 62\nof columns in a datafile, 37\nspecial methods for, 62\ntype hierarchies, 138\ntype objects, 50\ntype of objects, 33\ntype() function, 34, 211\nand exceptions, 89\ntype() metaclass, 138\ntype_options attribute, of FieldStorage\nobjects, 535\ntypecode attribute, of array objects, 259\nTypeError exception, 87, 215\nand function calls, 94\nand type coercion, 62\nmethod resolution order, 122\ntypes module, 47, 237\nand Python 3, 237\ntypes\nboolean, 38\nbuilt-in, 37, 201\ncallable, 47\ndictionary, 44\nfloating point, 38\nfrozenset, 46\nintegers, 38\nof sockets, 470\nset, 46\ntype of, 47\ntzinfo attribute, of time objects, 338\ntzname variable, time module, 405\ntzname() method\nof time objects, 339\nof tzinfo objects, 342\ntzset() function, time module, 407\nU\n\\U escape code, in strings, 28\n\\u escape code, in strings, 28\n-U command line option, 28, 173\n‘U’ mode, to open() function, 159\nu character, before a string literal, 28\n-u command line option, 173\nu(p) debugger command, pdb module, 189\nUDP client example, 486\nUDP communication, diagram of, 451\nUDP protocol, 449\nUDP server example, 485\nUDPServer class, SocketServer module,\n491\nuid attribute, of TarInfo objects, 322\numask() function, os module, 381\nunalias debugger command, pdb module,\n189\nuname attribute, of TarInfo objects, 322\nuname() function, os module, 381\nunary minus operator -, 65\nunary plus operator +, 65\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n711\nunary plus operator +\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2022,
      "extraction_method": "Direct"
    },
    {
      "page_number": 737,
      "chapter": null,
      "content": "unbound method, 49\nand Python 3, 49\nUnboundLocalError exception, 87, 98, 215\nunbuffered file I/O, 159\nunconsumed_tail attribute, of decompres-\nsobj objects, 329\nunderscores, usage in identifiers, 26\nunescape() function, xml.sax.saxutils mod-\nule, 583\nungetch() function, msvcrt module, 373\nungetwch() function, msvcrt module, 373\nunhexlify() function, binascii module, 548\nunichr() function, 77, 211\nUnicode character database, 293\nUnicode characters, representation of, 41\nUnicode string literals, 28\nUnicode strings, 41\nand WSGI, 541\ncommon encodings, 166\ndecomposing, 295\nencoding and decoing, 165\nencoding in network programs, 452\nerror handling options, 166\nhandling of, 165\nmixing with byte strings, 167\nnormalizing, 296\nregular expressions, 281\nunicode attribute, of sys.flags, 230\nunicode type, 38\nunicode() function, 211\nand Python 3, 211\nUnicode\nPython 2 vs. Python 3, 28\nand BOM characters, 168\nand XML, 168\nbyte order marker, 280\ncharacter encoding and decoding, 42\ncharacter properties database, 170\ncode points, 28\ncommon encodings, 168-169\nencoding in string literals, 29\nencoding of source code, 31\nfile I/O, 167\nmixing with byte strings, 70\nnormalization of strings, 171\nspecifying characters in string literals,\n28\nsurrogate pairs, 28, 41\nusing 32-bit character code points, 41\nunicode-escape encoding, description of,\n170\nunicodedata module, 170, 293\nUnicodeDecodeError exception, 87, 215\nUnicodeEncodeError exception, 87, 215\nPython 3 interactive mode, 175\nUnicodeError exception, 87, 166, 215\nUnicodeTranslateError exception, 87, 215\nunidata_version variable, unicodedata mod-\nule, 296\nunification of integer and long types, 38\nuniform access principle, 125\nuniform type arrays, 259\nuniform() function, random module, 255\nUnimplementedFileMode exception,\nhttp.client module, 504\nUnion class, ctypes module, 614\nunion operator |, of sets, 15\nunion() method, of sets, 46\nunit testing\nPython 3 migration, 635\nexample, 184\nunittest module, 183\nunittest module, 183\nexample, 184\nuniversal newline mode, 159\nUNIX domain protocol, 470\naddress format, 472\nUnix systems log, issuing message to, 363\nUnix\n#! execution of programs, 6\nper-user site directory, 177\ntime epoch definition, 405\nUnixDatagramServer class, SocketServer\nmodule, 491\nUnixStreamServer class, SocketServer mod-\nule, 491\nUnknownHandler class, urllib.request mod-\nule, 518\n712\nunbound method\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2394,
      "extraction_method": "Direct"
    },
    {
      "page_number": 738,
      "chapter": null,
      "content": "UnknownProtocol exception, http.client\nmodule, 504\nUnknownTransferEncoding exception,\nhttp.client module, 504\nunlink() function, os module, 390\nunloading modules, 149\nunpack() function, struct module, 290\nunpack() method, of Struct objects, 291\nunpack_from() function, struct module, 291\nunpack_from() method, of Struct objects,\n291\nunpacking\nbinary data structures, 290\nof sequences, 67-68\nof tuples, 14\nUnpickler class, pickle module, 228\nunquote() function, urllib.parse module,\n522\nunquote_plus() function, urllib.parse mod-\nule, 522\nunquote_to_bytes() function, urllib.parse\nmodule, 522\nunregister() method, of Poll objects, 460\nunregister_dislect() function, csv module,\n551\nunsetenv() function, os module, 381\nuntil debugger command, pdb module, 189\nunused_data attribute, of decompressobj\nobjects, 329\nunwrap() method, of ssl objects, 488\nupdate() method\nof dicts, 45\nof digest objects, 559\nof hmac objects, 560\nof sets, 15, 47\nupdate_wrapper() function, functools mod-\nule, 269\nupdating a dictionary, 45\nuploading\nfiles in CGI scripts, 536\nfiles to a HTTP server with POST, 505\nfiles to an FTP server, 500\npackages to pypi, 155\nupper() method, of strings, 44\nuppercase variable, string module, 287\nurandom() function, os module, 396\nurldefrag() function, urllib.parse module,\n521\nurlencode() function, urllib.parse module,\n522\nURLError exception, 516\nurllib.error module, 523\nurljoin() function, urllib.parse module, 521\nurllib module, 522\nsee urllib.request, 515\nurllib package, 514\nurllib.error module, 523\nurllib.parse module, 520\nurllib.request module, 515\nurllib.response module, 520\nurllib.robotparser module, 523\nurllib2 module, see urllib.request, 515\nurlopen() function, urllib.request module,\n515\nurlparse module, 520\nurlparse() function, urllib.parse module,\n520\nurlsafe_b64decode() function, base64 mod-\nule, 546\nurlsafe_b64encode() function, base64 mod-\nule, 546\nurlsplit() function, urllib.parse module, 521\nurlunparse() function, urllib.parse module,\n521\nurlunsplit() function, urllib.parse module,\n521\nuser directory, installation of packages, 154\nuser module, 586\n—user option to setup.py, 154\nuser-agent header in HTTP requests, chang-\ning, 517\nusername attribute\nof urlparse objects, 520\nof urlsplit objects, 521\nUserWarning warning, 216, 238\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n713\nUserWarning warning\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2396,
      "extraction_method": "Direct"
    },
    {
      "page_number": 739,
      "chapter": null,
      "content": "using Python as a calculator, 6\nutcfromtimestamp() method, of datetime\nclass, 339\nutcnow() method, of datetime class, 339\nutcoffset() method\nof time objects, 339\nof tzinfo objects, 342\nutctimetuple() method, of datetime objects,\n340\nUTF-16 encoding, description of, 170\nUTF-8\ncompatibility with ASCII, 170\ndescription of, 169-170\nencoding and decoding, 42\nincluding in string literals, 29\nlexicographic ordering, 170\nutime() function, os module, 390\nuu module, 587\nV\n-V command line option, 173\n-v command line option, 173-174\nvalidator() function, wsgiref.handlers mod-\nule, 543\nvalue attribute\nof FieldStorage objects, 535\nof Morsel objects, 512\nValue() function, multiprocessing module,\n426\nValue() method, of Manager objects, 429\nValueError exception, 87, 215\nand lists, 40\nand strings, 41\nvaluerefs() method, of WeakValueDictionary\nobjects, 241\nvalues() method\nof Message objects, 552\nof dicts, 45\nof dicts in Python 3, 632\nValuesView abstract base class, 266\nvariable interpolation in strings, 163\nvariable keyword arguments in function\ndefinition, 95\nvariable number of arguments in function\ndefinition, 94\nvariables, 7\nas names of objects, 35\nbinding and module imports, 145\nbinding of globals in functions, 98\nclass, 117-118\nin nested functions, 97\niteration, 82\nnaming rules, 26\nscope of, 96, 98\nvars() function, 72, 211\nverbose attribute, of sys.flags, 230\nverify_request() method, of SocketServer\nclass, 493\nversion attribute, of HTTPResponse objects,\n504\nversion information, of interpreter, 231\nversion variable, sys module, 232\nversion_info variable, sys module, 232\nvformat() method, of Formatter objects,\n288\nview objects, Python 3, 632\nvolume attribute, of ZipInfo objects, 327\nvonmisesvariate() function, random mod-\nule, 256\nW\n-W command line option, 216, 239-240\n‘w’ mode, to open() function, 159\nw(here) debugger command, pdb module,\n189\nwait() function, os module, 394\nwait() method\nof AsyncResult objects, 425\nof Condition objects, 441\nof Event objects, 440\nof Popen objects, 404\nwait3() function, os module, 394\nwait4() function, os module, 394\nwaitpid() function, os module, 394\nwalk() function, os module, 390\nwalk() method, of Message objects, 554\n714\nusing Python as a calculator\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2231,
      "extraction_method": "Direct"
    },
    {
      "page_number": 740,
      "chapter": null,
      "content": "wall-clock time, obtaining, 191\nwarn() function, warnings module, 216,\n239\nwarn_explicit() function, warnings module,\n239\nWarning warning, 216, 238\nwarning() method, of Logger objects, 357\nwarnings module, 238\nwarnings\nconverting into exceptions, 239\ndifference from exceptions, 216\nsuppression of, 238\nwarnoptions variable, sys module, 232\nWatchedFileHandler class, logging module,\n363\nwave module, 588\nWCOREDUMP() function, os module, 394\nweak reference, 130\nweak references, 240\nWeakKeyDictionary class, weakref module,\n241\nweakref module, 130, 240\nWeakValueDictionary class, weakref mod-\nule, 241\nweb frameworks, 538\nand template strings, 164\nweb programming, 531\nweb server\ncustom handling of requests, 510\nrunning standalone in Python, 508\nwebbrowser module, 544\nweekday() method, of date objects, 338\nweibullvariate() function, random module,\n256\nwell known port numbers, 450\nWEXITSTATUS() function, os module, 394\nwfile attribute\nof BaseHTTPRequestHandler objects,\n509\nof StreamRequestHandler objects, 491\nwhichdb module, 310\nwhichdb() function, dbm module, 310\nwhile statement, 8, 82\nwhitespace variable, string module, 287\nWIFCONTINUED() function, os module, 395\nWIFEXITED() function, os module, 394\nWIFSIGNALED() function, os module, 395\nWIFSTOPPED() function, os module, 395\nWinDLL() function, ctypes module, 612\nWindows, 331\naccesing registry, 408\naccessing registry, 175\ncreating a binary distribution with dis-\ntutils, 153\ndouble-clicking on Python programs,\n176\ndrive letters in filenames, 399\nfile locking, 373\nissuing message to event log, 362\nlist of error codes, 346\nmain program with multiprocessing\nmodule, 417\nper-user site directory, 177\nprocess fork with multiprocessing, 435\nrunning programs, 6\nWindowsError exception, 215\nWing IDE, 5\nwinreg module, 408\nwinsound module, 588\nwinver variable, sys module, 232\nwith statement, 62, 89\nand exceptions, 23\nand locking, 89\ndecimal module, 248\nlocking primitives, 442\nwork pools, of processes, 424\nwrap_socket() function, ssl module, 486\nwrapper functions, 95\nand closures, 100\nexample of, 101\nin extension modules, 594\nwrappers, and attribute binding methods,\n132\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n715\nwrappers, and attribute binding methods\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2278,
      "extraction_method": "Direct"
    },
    {
      "page_number": 741,
      "chapter": null,
      "content": "@wraps decorator, functools module, 114,\n269\nwritable() method\nof IOBase objects, 350\nof dispatcher objects, 456\nwrite() function, os module, 385\nwrite() method\nof BufferWriter objects, 352\nof ConfigParser objects, 334\nof ElementTree objects, 575\nof FileIO objects, 350\nof StreamWriter objects, 278\nof TextIOWrapper objects, 353\nof ZipFile objects, 326\nof files, 10, 159-160\nof mmap objects, 372\nof ssl objects, 488\nwrite_byte() method, of mmap objects, 372\nwritelines() method\nof IOBase objects, 350\nof StreamWriter objects, 278\nof files, 159-160\nwritepy() method, of ZipFile objects, 326\nwriter() function, csv module, 549\nwriterow() method\nof csv DictWriter objects, 550\nof csv writer objects, 549\nwriterows() method\nof csv DictWriter objects, 550\nof csv writer objects, 550\nwritestr() method, of ZipFile objects, 327\nwritexml() method, of DOM Node objects,\n573\nwriting to a file, 159\nWSGI (Web Server Gateway Interface), 540\nWSGI\napplication specification, 540\nexample of, 541\nintegration with web frameworks, 543\nprocessing form fields, 541\nrunning a stand-alone server, 542\nrunning in CGI scripts, 542\nuse of generators for I/O, 165\nvalidation of applications, 543\nwsgi.* environment variables, 540\nwsgiref package, 542\nwsgiref.handlers module, 542\nwsgiref.simple_server module, 542\nWSTOPSIG() function, os module, 395\nwstring_at() function, ctypes module, 618\nWTERMSIG() function, os module, 395\nX\n\\x escape code, in strings, 28\n-x command line option, 173-174\nxdrlib module, 587\nxml package, 568\nXML() function, xml.etree.ElementTree mod-\nule, 575\nXML\nescaping and unescaping characters,\n583\nexample document, 569\nincremental parsing of large files, 579\nnamespaces in ElementTree module,\n578\nparsing, 568\nXML-RPC, 524\nXML-RPC server, multithreaded example,\n494\nXML-RPC\nexample of, 529\nserver customization, 530\nxml.dom.minidom module, 570\nxml.etree.ElementTree module, 573\nxml.sax module, 580\nxml.sax.saxutils module, 583\n‘xmlcharrefreplace’ error handling, 166-167\nXMLGenerator() function, xml.sax.saxutils\nmodule, 584\nXMLID() function, xml.etree.ElementTree\nmodule, 575\nxmlrpc package, 524\nxmlrpc.client module, 524\nxmlrpc.server module, 527\nxmlrpclib module, 524\n716\nwraps decorator, functools module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 2234,
      "extraction_method": "Direct"
    },
    {
      "page_number": 742,
      "chapter": null,
      "content": "XMLRPCServer class, xmlrpc.server mod-\nule, 527\nxor() function, operator module, 274\n__xor__() method, 60\nXPATH, 569\nxrange type, 38\nxrange() compared to a list, 44\nxrange() function, 17, 44, 211\nand Python 3, 17, 44, 211\nXSLT, 569\nY\nY2K handling, 407\nyear attribute, of date objects, 337\nyield expressions, 20, 104\nyield statement, 19, 53, 102\nand context managers, 90\nuse with I/O, 164-165\nZ\nZeroDivisionError exception, 87, 215\nzfill() method, of strings, 44\n.zip files\nand modules, 147\ndecoding and encoding, 324\nuse as a code archive, 147\nzip() function, 83, 211\nand Python 3, 211\nfuture_builtins module, 217\ntype-conversion example, 37\nzipfile module, 324\nZipFile() function, zipfile module, 325\nzipimport module, 586\nZipInfo() function, zipfile module, 325\nHow can we make this index more useful? Email us at indexes@samspublishing.com\n717\nZipInfo() function, zipfile module\nF\n h  Lib\n f L\n B\nd\nff",
      "content_length": 904,
      "extraction_method": "Direct"
    }
  ],
  "enrichment": {
    "version": "1.0.0",
    "generated_by": "generate_chapter_metadata.py",
    "contains": [
      "keywords",
      "concepts",
      "summary"
    ]
  }
}